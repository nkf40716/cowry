From crackhd2 at gmail.com  Wed Apr  1 02:28:06 2015
From: crackhd2 at gmail.com (Ben Schmidt)
Date: Wed, 1 Apr 2015 11:28:06 +0200
Subject: [ovs-discuss] =?utf-8?q?=28no_subject=29?=
Message-ID: <CA+Cs8xJMzy333GWBK8YKwuW6z0VRtb2x5Up16MQJKtgK3_G_BQ@mail.gmail.com>

Hi Mailinglist,

I have a Problem with a VM Box that should use LACP bonding with tagged VLAN
ports.

Everything is up and running as I want to to, my Problem is that the speed
is horrible. A simple ssh login takes 30ish seconds that 's why I spend a
hour on debugging OpenSSH only to find out that iperf is showing
interesting results.

When I run iperf in Server mode on Box-A (OVS) and Box-B represents the
iperf Client (untagged VLAN Port, same Switch, same Subnet) I get I get
around 937MB/s. The other way around I barely get results because of
timeouts.


Here is my basic setup
######
ovs-vsctl show
8031569b-5210-4334-88fd-36704af3a667
    Bridge "vmbr0"
        Port "vlan1115"
            tag: 1115
            Interface "vlan1115"
                type: internal
        Port "bond0"
            Interface "eth1"
            Interface "eth2"
        Port "vmbr0"
            Interface "vmbr0"
                type: internal
        Port "vlan1116"
            tag: 1116
            Interface "vlan1116"
                type: internal
    ovs_version: "2.3.1"
########


cat /etc/network/interfaces = http://pastebin.ca/2967191
ifconfig = http://pastebin.ca/2967192
ovs-appctl bond/show bond0 = http://pastebin.ca/2967193
ovs-appctl lacp/show bond0 = http://pastebin.ca/2967194
ovs-vsctl list port bond0 = http://pastebin.ca/2967200


Could anyone please point me in a direction to look at.

Thanks a lot,
Ben
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150401/8cdd3a8f/attachment.html>

From amal.kammoun at supcom.tn  Wed Apr  1 03:52:57 2015
From: amal.kammoun at supcom.tn (Amal KAMMOUN)
Date: Wed, 1 Apr 2015 10:52:57 +0000
Subject: [ovs-discuss] SDN topology.
In-Reply-To: <BLU437-SMTP72C88B8D658C1D0BDE3B4FD4F30@phx.gbl>
References: <1427810799214.94157@supcom.tn>,
 <BLU437-SMTP72C88B8D658C1D0BDE3B4FD4F30@phx.gbl>
Message-ID: <1427885630471.18204@supcom.tn>

Hello Amer,


So, as you said I will try with a simple scenario like this:


VM1: Host1-------------VM2: OVS1-----------------VM3: OVS2---------VM4: Host2


I want to do the interconnection between the 2 OVSs :


            VM2: OVS1-----------------VM3: OVS2


I connected between VMs using internal-network. For each VM I configured @IP and the netmask (no gateway no dns).


I could have the ping between each other.



I made this configuration:


1) in VM2: @IP 192.168.46.220


ovs-vsctl add-br br0

ovs-vsctl add-port br0 eth0

ifconfig eth0 0

ifconfig br0 up

ifconfig br0 192.168.46.220 netmask 255.255.255.0


2) in VM3: @IP 192.168.46.181


ovs-vsctl add-br br0

ovs-vsctl add-port br0 eth0

ifconfig eth0 0

ifconfig br0 up

ifconfig br0 192.168.46.181 netmask 255.255.255.0


The ping now fails! What I have to do to get the 2 OVS connected?


Thank you so much.




________________________________
From: Amer <amer7777 at hotmail.com>
Sent: Wednesday, April 1, 2015 5:17 AM
To: Amal KAMMOUN
Cc: discuss at openvswitch.org
Subject: Re: [ovs-discuss] SDN topology.

Dear Amal

First, try with simple scenario

To connect between VMs you need to use internal-network and assign each VM to the same internal-network, then you need the IPs are in the same subnet for each two VMs.
Also, you need to crest a bridge in each OVS, like br0, then assign some interfaces to the bridge, like add-port br0 eth0, after that, give zero IP address to these interfaces, like ifconfig eth0 0, thereafter, give the bridge an IP address, like ifconfig eth0 192xxxxxxxxx netmask xxxxx.
The bridge IP needs to be written in the main interface configuration file.
To do this you need to search in this archive, I remember someone before few weeks discussed this issue and you will find my name there.
After this setup connecting each OVS to different controller will be easier.

Best regards,
Amer

On Mar 31, 2015, at 5:05 PM, Amal KAMMOUN <amal.kammoun at supcom.tn<mailto:amal.kammoun at supcom.tn>> wrote:


Hello all!


I'm trying to construct the following topology:



       VM1-  OpenFlowController1                            VM2- OpenflowController2

                            |                                                                     |
                            |                                                                     |

                            |                                                                     |
                            |                                                                     |

              VM3 ----------                                                  VM4 ----------

                      | OVS1|----------------------------------------------------------| OVS2|

                      -----------                                                           -----------

                            |                                                                     |

                            |                                                                     |

                            |                                                                     |

                       Host:VM-5                                                 Host:VM-6



All my virtual machines are made by VirtualBox.


It is possible to build such topology?


How can I connect 2 OVS running on 2 different VMs?


Thank you!

_______________________________________________
discuss mailing list
discuss at openvswitch.org<mailto:discuss at openvswitch.org>
http://openvswitch.org/mailman/listinfo/discuss
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150401/aded45f3/attachment-0001.html>

From shuchi.kapoor at aricent.com  Wed Apr  1 04:45:47 2015
From: shuchi.kapoor at aricent.com (Shuchi Kapoor)
Date: Wed, 1 Apr 2015 11:45:47 +0000
Subject: [ovs-discuss] Regarding Ovs version 2.3.1
Message-ID: <812aa339197241c8bf81014219fc468b@GURMBXV02.AD.ARICENT.COM>

Hi Team,

I have a query on OVS version 2.3.1.
On OVS version 2.3.1 whether the following features are supported "NetFlow, sFlow(R), IPFIX, SPAN, RSPAN, and GRE-tunneled mirrors ".
Your response will be highly appreciated..
Thanks in advance.

Thanks & Regards
Shuchi Kapoor

"DISCLAIMER: This message is proprietary to Aricent and is intended solely for the use of the individual to whom it is addressed. It may contain privileged or confidential information and should not be circulated or used for any purpose other than for what it is intended. If you have received this message in error, please notify the originator immediately. If you are not the intended recipient, you are notified that you are strictly prohibited from using, copying, altering, or disclosing the contents of this message. Aricent accepts no responsibility for loss or damage arising from the use of the information transmitted by this email including damage from virus."
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150401/11fe00a1/attachment.html>

From amer7777 at hotmail.com  Wed Apr  1 08:49:18 2015
From: amer7777 at hotmail.com (Amer)
Date: Wed, 1 Apr 2015 18:49:18 +0300
Subject: [ovs-discuss] SDN topology.
In-Reply-To: <1427885630471.18204@supcom.tn>
References: <1427810799214.94157@supcom.tn>
 <BLU437-SMTP72C88B8D658C1D0BDE3B4FD4F30@phx.gbl>
 <1427885630471.18204@supcom.tn>
Message-ID: <BLU436-SMTP169F573362CD1F6F2656E99D4F30@phx.gbl>

Hello,

I did it and was working fine. Note:
The br0 IP is temporary and will be deleted when you reboot. Also, the IP will return back to the eth0. I recommend write it in the interfaces configuration file.

Best regards,
Amer

> On Apr 1, 2015, at 1:52 PM, Amal KAMMOUN <amal.kammoun at supcom.tn> wrote:
> 
> Hello Amer,
> 
> 
> So, as you said I will try with a simple scenario like this:
> 
> 
> VM1: Host1-------------VM2: OVS1-----------------VM3: OVS2---------VM4: Host2
> 
> 
> I want to do the interconnection between the 2 OVSs :  
> 
> 
>             VM2: OVS1-----------------VM3: OVS2
> 
> 
> I connected between VMs using internal-network. For each VM I configured @IP and the netmask (no gateway no dns).
> 
> 
> I could have the ping between each other.
> 
>  
> I made this configuration:
> 
> 
> 1) in VM2: @IP 192.168.46.220
> 
> 
> ovs-vsctl add-br br0
> ovs-vsctl add-port br0 eth0
> ifconfig eth0 0
> 
> ifconfig br0 up
> 
> ifconfig br0 192.168.46.220 netmask 255.255.255.0
> 
> 
> 2) in VM3: @IP 192.168.46.181
> 
> ovs-vsctl add-br br0
> ovs-vsctl add-port br0 eth0
> ifconfig eth0 0
> 
> ifconfig br0 up
> 
> ifconfig br0 192.168.46.181 netmask 255.255.255.0
> 
> The ping now fails! What I have to do to get the 2 OVS connected?
> 
> 
> Thank you so much. 
>  
> 
>  
> From: Amer <amer7777 at hotmail.com>
> Sent: Wednesday, April 1, 2015 5:17 AM
> To: Amal KAMMOUN
> Cc: discuss at openvswitch.org
> Subject: Re: [ovs-discuss] SDN topology.
>  
> Dear Amal
> 
> First, try with simple scenario
> 
> To connect between VMs you need to use internal-network and assign each VM to the same internal-network, then you need the IPs are in the same subnet for each two VMs.
> Also, you need to crest a bridge in each OVS, like br0, then assign some interfaces to the bridge, like add-port br0 eth0, after that, give zero IP address to these interfaces, like ifconfig eth0 0, thereafter, give the bridge an IP address, like ifconfig eth0 192xxxxxxxxx netmask xxxxx.
> The bridge IP needs to be written in the main interface configuration file.
> To do this you need to search in this archive, I remember someone before few weeks discussed this issue and you will find my name there.
> After this setup connecting each OVS to different controller will be easier.
> 
> Best regards,
> Amer
> 
> On Mar 31, 2015, at 5:05 PM, Amal KAMMOUN <amal.kammoun at supcom.tn> wrote:
> 
>> Hello all!
>> 
>> 
>> I'm trying to construct the following topology:
>> 
>> 
>> 
>>        VM1-  OpenFlowController1                            VM2- OpenflowController2
>> 
>>                             |                                                                     |
>>                             |                                                                     |
>> 
>>                             |                                                                     |
>>                             |                                                                     |
>> 
>>               VM3 ----------                                                  VM4 ----------
>>                       | OVS1|----------------------------------------------------------| OVS2|
>> 
>>                       -----------                                                           -----------  
>>                             |                                                                     |
>> 
>>                             |                                                                     |
>> 
>>                             |                                                                     |
>> 
>>                        Host:VM-5                                                 Host:VM-6
>> 
>> 
>> 
>> All my virtual machines are made by VirtualBox.
>> 
>> 
>> It is possible to build such topology?
>> 
>> 
>> How can I connect 2 OVS running on 2 different VMs?
>> 
>> 
>> Thank you!
>> _______________________________________________
>> discuss mailing list
>> discuss at openvswitch.org
>> http://openvswitch.org/mailman/listinfo/discuss
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150401/2112a0af/attachment.html>

From jpettit at nicira.com  Wed Apr  1 09:11:08 2015
From: jpettit at nicira.com (Justin Pettit)
Date: Wed, 1 Apr 2015 09:11:08 -0700
Subject: [ovs-discuss] Regarding Ovs version 2.3.1
In-Reply-To: <812aa339197241c8bf81014219fc468b@GURMBXV02.AD.ARICENT.COM>
References: <812aa339197241c8bf81014219fc468b@GURMBXV02.AD.ARICENT.COM>
Message-ID: <AA498E07-83BD-4E0C-82C2-622B67F66A66@nicira.com>


> On Apr 1, 2015, at 4:45 AM, Shuchi Kapoor <shuchi.kapoor at aricent.com> wrote:
> 
> Hi Team,
>  
> I have a query on OVS version 2.3.1.
> On OVS version 2.3.1 whether the following features are supported “NetFlow, sFlow(R), IPFIX, SPAN, RSPAN, and GRE-tunneled mirrors “.
> Your response will be highly appreciated..

Yes.

--Justin



From blp at nicira.com  Wed Apr  1 09:15:22 2015
From: blp at nicira.com (Ben Pfaff)
Date: Wed, 1 Apr 2015 09:15:22 -0700
Subject: [ovs-discuss] vlan setfield failed
In-Reply-To: <69b08695.3acd.14c72973b5d.Coremail.zhangchen9211@126.com>
References: <69b08695.3acd.14c72973b5d.Coremail.zhangchen9211@126.com>
Message-ID: <20150401161522.GE17844@nicira.com>

On Wed, Apr 01, 2015 at 09:27:36AM +0800, 张晨 wrote:
> hi, dear all!
> 
> i use ryu to deploy my vlan policy,
> actions.append(ofp_parser.OFPActionPushVlan())
> actions.append(ofp_parser.OFPActionSetField(vlan_vid=10))
> 
> but ovs gives me an set-filed error, as you can see in the attached picture, how does it happen?

OpenFlow 1.2+ says that if vlan_vid is nonzero then the "present" bit
(with value 0x1000) has to be set.

From alexw at nicira.com  Wed Apr  1 10:32:15 2015
From: alexw at nicira.com (Alex Wang)
Date: Wed, 1 Apr 2015 10:32:15 -0700
Subject: [ovs-discuss] (no subject)
In-Reply-To: <CA+Cs8xJMzy333GWBK8YKwuW6z0VRtb2x5Up16MQJKtgK3_G_BQ@mail.gmail.com>
References: <CA+Cs8xJMzy333GWBK8YKwuW6z0VRtb2x5Up16MQJKtgK3_G_BQ@mail.gmail.com>
Message-ID: <CAArS4XWUYxP5t1UkXeoo9hLKFjDMFinbNDS1rTb5Yo_fAeGiJw@mail.gmail.com>

I'm trying to reproduce your issue, have few questions,

On Wed, Apr 1, 2015 at 2:28 AM, Ben Schmidt <crackhd2 at gmail.com> wrote:

> Hi Mailinglist,
>
> I have a Problem with a VM Box that should use LACP bonding with tagged
> VLAN ports.
>
> Everything is up and running as I want to to, my Problem is that the speed
> is horrible. A simple ssh login takes 30ish seconds that 's why I spend a
> hour on debugging OpenSSH only to find out that iperf is showing
> interesting results.
>


For ssh, you mean ssh via vmbr1 or the vlan ports?



> When I run iperf in Server mode on Box-A (OVS) and Box-B represents the
> iperf Client (untagged VLAN Port, same Switch, same Subnet) I get I get
> around 937MB/s. The other way around I barely get results because of
> timeouts.
>
>

Could you tell more about the iperf test (maybe the commands)?

What is the 'ovs-vsctl show' output of Box-B?  For traffic sent from
untagged VLAN port of Box-B, the vmbr0 of Box-A should not forward it
to tagged VLAN ports.


Thanks,
Alex Wang,


>
> Here is my basic setup
> ######
> ovs-vsctl show
> 8031569b-5210-4334-88fd-36704af3a667
>     Bridge "vmbr0"
>         Port "vlan1115"
>             tag: 1115
>             Interface "vlan1115"
>                 type: internal
>         Port "bond0"
>             Interface "eth1"
>             Interface "eth2"
>         Port "vmbr0"
>             Interface "vmbr0"
>                 type: internal
>         Port "vlan1116"
>             tag: 1116
>             Interface "vlan1116"
>                 type: internal
>     ovs_version: "2.3.1"
> ########
>
>
> cat /etc/network/interfaces = http://pastebin.ca/2967191
> ifconfig = http://pastebin.ca/2967192
> ovs-appctl bond/show bond0 = http://pastebin.ca/2967193
> ovs-appctl lacp/show bond0 = http://pastebin.ca/2967194
> ovs-vsctl list port bond0 = http://pastebin.ca/2967200
>
>
> Could anyone please point me in a direction to look at.
>
> Thanks a lot,
> Ben
>
>
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150401/eb9deedd/attachment.html>

From shuchi.kapoor at aricent.com  Thu Apr  2 01:14:02 2015
From: shuchi.kapoor at aricent.com (Shuchi Kapoor)
Date: Thu, 2 Apr 2015 08:14:02 +0000
Subject: [ovs-discuss] Regarding Ovs version 2.3.1
In-Reply-To: <AA498E07-83BD-4E0C-82C2-622B67F66A66@nicira.com>
References: <812aa339197241c8bf81014219fc468b@GURMBXV02.AD.ARICENT.COM>
 <AA498E07-83BD-4E0C-82C2-622B67F66A66@nicira.com>
Message-ID: <b764809c03e54a4cb5da9532947a0b3a@GURMBXV02.AD.ARICENT.COM>

Thanks Justin for prompt reply.
Just to add need some clarification.

There is experimental support for DPDK with OVS2.3.1.
When the DPDK based OVS is used in OVS2.3.1, are these features still supported, kindly clarify.

Thanks & Regards
Shuchi Kapoor


-----Original Message-----
From: Justin Pettit [mailto:jpettit at nicira.com]
Sent: Wednesday, April 01, 2015 9:41 PM
To: Shuchi Kapoor
Cc: discuss at openvswitch.org
Subject: Re: [ovs-discuss] Regarding Ovs version 2.3.1


> On Apr 1, 2015, at 4:45 AM, Shuchi Kapoor <shuchi.kapoor at aricent.com> wrote:
>
> Hi Team,
>
> I have a query on OVS version 2.3.1.
> On OVS version 2.3.1 whether the following features are supported “NetFlow, sFlow(R), IPFIX, SPAN, RSPAN, and GRE-tunneled mirrors “.
> Your response will be highly appreciated..

Yes.

--Justin


"DISCLAIMER: This message is proprietary to Aricent and is intended solely for the use of the individual to whom it is addressed. It may contain privileged or confidential information and should not be circulated or used for any purpose other than for what it is intended. If you have received this message in error, please notify the originator immediately. If you are not the intended recipient, you are notified that you are strictly prohibited from using, copying, altering, or disclosing the contents of this message. Aricent accepts no responsibility for loss or damage arising from the use of the information transmitted by this email including damage from virus."

From amal.kammoun at supcom.tn  Thu Apr  2 04:10:08 2015
From: amal.kammoun at supcom.tn (Amal KAMMOUN)
Date: Thu, 2 Apr 2015 11:10:08 +0000
Subject: [ovs-discuss] SDN topology.
In-Reply-To: <BLU436-SMTP169F573362CD1F6F2656E99D4F30@phx.gbl>
References: <1427810799214.94157@supcom.tn>
 <BLU437-SMTP72C88B8D658C1D0BDE3B4FD4F30@phx.gbl>
 <1427885630471.18204@supcom.tn>,
 <BLU436-SMTP169F573362CD1F6F2656E99D4F30@phx.gbl>
Message-ID: <1427973061080.64404@supcom.tn>

Dear Amer,


I appreciate your note about writing br0 IP in the interfaces configuration file. Thanks.


But I want to get the interconnection between the 2 OVS before doing that.


I read all your posts in March, I find that I have same problems as you.

Would you please tell me how did you fix your issues?


For example in these posts:

http://openvswitch.org/pipermail/discuss/2015-March/016901.html

http://openvswitch.org/pipermail/discuss/2015-March/016943.html


Best regards!


Amal.


________________________________
From: Amer <amer7777 at hotmail.com>
Sent: Wednesday, April 1, 2015 3:49 PM
To: Amal KAMMOUN
Cc: discuss at openvswitch.org
Subject: Re: [ovs-discuss] SDN topology.

Hello,

I did it and was working fine. Note:
The br0 IP is temporary and will be deleted when you reboot. Also, the IP will return back to the eth0. I recommend write it in the interfaces configuration file.

Best regards,
Amer

On Apr 1, 2015, at 1:52 PM, Amal KAMMOUN <amal.kammoun at supcom.tn<mailto:amal.kammoun at supcom.tn>> wrote:


Hello Amer,


So, as you said I will try with a simple scenario like this:


VM1: Host1-------------VM2: OVS1-----------------VM3: OVS2---------VM4: Host2


I want to do the interconnection between the 2 OVSs :


            VM2: OVS1-----------------VM3: OVS2


I connected between VMs using internal-network. For each VM I configured @IP and the netmask (no gateway no dns).


I could have the ping between each other.



I made this configuration:


1) in VM2: @IP 192.168.46.220


ovs-vsctl add-br br0

ovs-vsctl add-port br0 eth0

ifconfig eth0 0

ifconfig br0 up

ifconfig br0 192.168.46.220 netmask 255.255.255.0


2) in VM3: @IP 192.168.46.181


ovs-vsctl add-br br0

ovs-vsctl add-port br0 eth0

ifconfig eth0 0

ifconfig br0 up

ifconfig br0 192.168.46.181 netmask 255.255.255.0


The ping now fails! What I have to do to get the 2 OVS connected?


Thank you so much.




________________________________
From: Amer <amer7777 at hotmail.com<mailto:amer7777 at hotmail.com>>
Sent: Wednesday, April 1, 2015 5:17 AM
To: Amal KAMMOUN
Cc: discuss at openvswitch.org<mailto:discuss at openvswitch.org>
Subject: Re: [ovs-discuss] SDN topology.

Dear Amal

First, try with simple scenario

To connect between VMs you need to use internal-network and assign each VM to the same internal-network, then you need the IPs are in the same subnet for each two VMs.
Also, you need to crest a bridge in each OVS, like br0, then assign some interfaces to the bridge, like add-port br0 eth0, after that, give zero IP address to these interfaces, like ifconfig eth0 0, thereafter, give the bridge an IP address, like ifconfig eth0 192xxxxxxxxx netmask xxxxx.
The bridge IP needs to be written in the main interface configuration file.
To do this you need to search in this archive, I remember someone before few weeks discussed this issue and you will find my name there.
After this setup connecting each OVS to different controller will be easier.

Best regards,
Amer

On Mar 31, 2015, at 5:05 PM, Amal KAMMOUN <amal.kammoun at supcom.tn<mailto:amal.kammoun at supcom.tn>> wrote:


Hello all!


I'm trying to construct the following topology:



       VM1-  OpenFlowController1                            VM2- OpenflowController2

                            |                                                                     |
                            |                                                                     |

                            |                                                                     |
                            |                                                                     |

              VM3 ----------                                                  VM4 ----------

                      | OVS1|----------------------------------------------------------| OVS2|

                      -----------                                                           -----------

                            |                                                                     |

                            |                                                                     |

                            |                                                                     |

                       Host:VM-5                                                 Host:VM-6



All my virtual machines are made by VirtualBox.


It is possible to build such topology?


How can I connect 2 OVS running on 2 different VMs?


Thank you!

_______________________________________________
discuss mailing list
discuss at openvswitch.org<mailto:discuss at openvswitch.org>
http://openvswitch.org/mailman/listinfo/discuss
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150402/660b0999/attachment.html>

From crackhd2 at gmail.com  Thu Apr  2 07:39:55 2015
From: crackhd2 at gmail.com (Ben Schmidt)
Date: Thu, 2 Apr 2015 16:39:55 +0200
Subject: [ovs-discuss] (no subject)
In-Reply-To: <CAArS4XWUYxP5t1UkXeoo9hLKFjDMFinbNDS1rTb5Yo_fAeGiJw@mail.gmail.com>
References: <CA+Cs8xJMzy333GWBK8YKwuW6z0VRtb2x5Up16MQJKtgK3_G_BQ@mail.gmail.com>
 <CAArS4XWUYxP5t1UkXeoo9hLKFjDMFinbNDS1rTb5Yo_fAeGiJw@mail.gmail.com>
Message-ID: <CA+Cs8xJOrB-kkvKKQ8KNQJmN=90otV8DF0ci4YxgGhX1xH=Z9Q@mail.gmail.com>

Hi Alex,

thank you very much for your time.

On Wed, Apr 1, 2015 at 7:32 PM, Alex Wang <alexw at nicira.com> wrote:

> I'm trying to reproduce your issue, have few questions,
>
> On Wed, Apr 1, 2015 at 2:28 AM, Ben Schmidt <crackhd2 at gmail.com> wrote:
>
>> Hi Mailinglist,
>>
>> I have a Problem with a VM Box that should use LACP bonding with tagged
>> VLAN ports.
>>
>> Everything is up and running as I want to to, my Problem is that the
>> speed is horrible. A simple ssh login takes 30ish seconds that 's why I
>> spend a hour on debugging OpenSSH only to find out that iperf is showing
>> interesting results.
>>
>
>
> For ssh, you mean ssh via vmbr1 or the vlan ports?
>
 Sorry, forgot to mention that I am trying to connect to the vlan ports.
vmbr1, which doesn't use OVS, is fast as expected.

>
>
>
>> When I run iperf in Server mode on Box-A (OVS) and Box-B represents the
>> iperf Client (untagged VLAN Port, same Switch, same Subnet) I get I get
>> around 937MB/s. The other way around I barely get results because of
>> timeouts.
>>
>>
>
> Could you tell more about the iperf test (maybe the commands)?
>

#### box-a as iperf server, box-b as iperf client #####
[root at box-a /root $ iperf -s
------------------------------------------------------------
Server listening on TCP port 5001
TCP window size: 85.3 KByte (default)
------------------------------------------------------------
[  4] local 10.52.49.101 port 5001 connected with 10.52.49.100 port 36151
[ ID] Interval       Transfer     Bandwidth
[  4]  0.0-10.0 sec  1.10 GBytes   939 Mbits/sec

[root at box-b /root $ iperf -d -c 10.52.49.101
WARNING: option -d is not valid for server mode
------------------------------------------------------------
Client connecting to 10.52.49.101, TCP port 5001
TCP window size: 19.6 KByte (default)
------------------------------------------------------------
[  3] local 10.52.49.100 port 36151 connected with 10.52.49.101 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0-10.0 sec  1.10 GBytes   941 Mbits/sec
#########


#### box-b as iperf server, box-a as iperf client #####
[root at box-b /root $ iperf -s
------------------------------------------------------------
Server listening on TCP port 5001
TCP window size: 85.3 KByte (default)
------------------------------------------------------------
[  4] local 10.52.49.100 port 5001 connected with 10.52.49.101 port 56201

[root at box-a /root $ iperf -d -c 10.52.49.100
WARNING: option -d is not valid for server mode
------------------------------------------------------------
Client connecting to 10.52.49.100, TCP port 5001
TCP window size: 19.6 KByte (default)
------------------------------------------------------------
[  3] local 10.52.49.101 port 56201 connected with 10.52.49.100 port 5001

[ ID] Interval       Transfer     Bandwidth
[  3]  0.0-417.3 sec   256 KBytes  5.03 Kbits/sec
################


>
> What is the 'ovs-vsctl show' output of Box-B?  For traffic sent from
> untagged VLAN port of Box-B, the vmbr0 of Box-A should not forward it
> to tagged VLAN ports.
>

I hope that we have a communication Problem here and I didn't miss
something really basic about OVS and wasted everyones time.
box-b doesn't use OVS yet. box-b uses normal linux bridging on a untagged
VLAN Port (VLAN ID 1115) on a switch. box-a connects to two LACP bond'ed
Ports on that some switch that have multiple tagged VLAN IDs, one of them
being 1115.

########
[root at box-b /root $ ovs-vsctl show
872e809c-3121-4a4f-9fe8-8e436a7cf101
    ovs_version: "2.3.1"
########

Any Ideas where I could look at?


>
>
> Thanks,
> Alex Wang,
>

Thank YOU,
Ben


>
>
>>
>> Here is my basic setup
>> ######
>> ovs-vsctl show
>> 8031569b-5210-4334-88fd-36704af3a667
>>     Bridge "vmbr0"
>>         Port "vlan1115"
>>             tag: 1115
>>             Interface "vlan1115"
>>                 type: internal
>>         Port "bond0"
>>             Interface "eth1"
>>             Interface "eth2"
>>         Port "vmbr0"
>>             Interface "vmbr0"
>>                 type: internal
>>         Port "vlan1116"
>>             tag: 1116
>>             Interface "vlan1116"
>>                 type: internal
>>     ovs_version: "2.3.1"
>> ########
>>
>>
>> cat /etc/network/interfaces = http://pastebin.ca/2967191
>> ifconfig = http://pastebin.ca/2967192
>> ovs-appctl bond/show bond0 = http://pastebin.ca/2967193
>> ovs-appctl lacp/show bond0 = http://pastebin.ca/2967194
>> ovs-vsctl list port bond0 = http://pastebin.ca/2967200
>>
>>
>> Could anyone please point me in a direction to look at.
>>
>> Thanks a lot,
>> Ben
>>
>>
>> _______________________________________________
>> discuss mailing list
>> discuss at openvswitch.org
>> http://openvswitch.org/mailman/listinfo/discuss
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150402/082673fa/attachment-0001.html>

From sanghamitra.de at gmail.com  Wed Apr  1 10:55:45 2015
From: sanghamitra.de at gmail.com (Sanghamitra De)
Date: Wed, 1 Apr 2015 23:25:45 +0530
Subject: [ovs-discuss] seeking help
In-Reply-To: <CAG=b5B0QMEtozRBBVwD3p1vTNJsffE1Kr9iU0HL336PORjLEFg@mail.gmail.com>
References: <CAG=b5B1ABsOKErQAw+d3FCmcmm3EW7hm8uoD_yK=jJ6A+9A6SA@mail.gmail.com>
 <7b6fb01.11fa4.14c5c47133e.Coremail.13520814722@126.com>
 <CAG=b5B3Q51k-htgjpddMDOE9+MvRN_K=he_FEZT1GLB4Ug5jwA@mail.gmail.com>
 <CAJoNDx1m2aYW311k4Qk2xXhhkD=TuMdHdh3qD97mX2i=a4mxzw@mail.gmail.com>
 <CAG=b5B0QMEtozRBBVwD3p1vTNJsffE1Kr9iU0HL336PORjLEFg@mail.gmail.com>
Message-ID: <CAG=b5B3=9+47gZw16Gu-oBPS7KP-0QzffGGjRq3p1h3-hr5FbQ@mail.gmail.com>

Hi,
I went through /users/peertest/openvswitch-2.3.0/vswitchd/vswitch.ovsschema
this has a checksum and a version and lots of tables.

Do i need to make any changes in here??

Please help why do the following lines give error???

Kindly help!!

#ovs-vsctl add-br br-int

sudo ovs-vsctl add-br OVSbr1

sudo ovs-vsctl add-br OVSbr2



Thanks & Regards
Sanghamitra

On Mon, Mar 30, 2015 at 8:40 PM, Sanghamitra De <sanghamitra.de at gmail.com>
wrote:

> Hi. Thank You for the reply. I went through vswitch.ovsschema.
> Do i need tp make any change in vswitch.ovsschema?
>
> If YES then what change do i need to make?
>
> its a lengthy file. Can You kindly let me know the exact changes i need to
> make?
>
> Thank You & Regards
> Sanghamitra De
>
>
>
> On Sat, Mar 28, 2015 at 10:26 PM, Ping Chun Huang <pichuang at cs.nctu.edu.tw
> > wrote:
>
>> hi,
>>
>> Does any ovsdb schema in
>> "/users/peertest/openvswitch-2.3.0/vswitchd/vswitch.ovsschema"? I think you
>> loss that.
>>
>> if you want to find that, try to "locate vswitch.ovsschema"
>>
>>
>> pichuang, Ping-Chun Huang 黃秉鈞
>>
>>
>> Wireless Internet Laboratory
>> Computer Center, Department of Computer Science
>> National Chiao Tung University
>>
>> 2015-03-28 15:31 GMT+08:00 Sanghamitra De <sanghamitra.de at gmail.com>:
>>
>>> Hi,
>>> Thanks for the reply.
>>>
>>>
>>> I made the installation by the following commands:
>>>
>>> sudo mkdir /work
>>> sudo chown `whoami` /work
>>> cd /work
>>>
>>> ## Download, configure, compile, and install Open vSwitch.
>>> wget http://openvswitch.org/releases/openvswitch-2.3.0.tar.gz
>>> tar zxf openvswitch-2.3.0.tar.gz
>>> cd openvswitch-2.3.0
>>> ./configure
>>> make
>>> sudo make install
>>>
>>> sudo /sbin/modprobe openvswitch
>>>
>>>
>>>
>>>
>>>
>>> /sbin/lsmod
>>>
>>>
>>>
>>> ## Clean up.
>>> cd /
>>> sudo rm -rf /work
>>>
>>> ## Logout, used Emulab web interface to make a disk *image*. Then
>>> loaded that image to the nodes where i wanted OVS to be loaded.
>>>
>>> Then the following commands were given:
>>>
>>>
>>> #ovsdb-tool create /usr/local/etc/openvswitch/conf.db
>>> /users/peertest/openvswitch-2.3.0/vswitchd/vswitch.ovsschema
>>>
>>> # ovsdb-server --remote=punix:/usr/local/var/run/openvswitch/db.sock \
>>>
>>>                  --remote=db:Open_vSwitch,Open_vSwitch,manager_options \
>>>
>>>                  --pidfile --detach
>>>
>>>
>>>
>>>  # ovs-vsctl --no-wait init
>>>
>>> sudo ovs-vswitchd --pidfile --detach --log-file
>>>
>>>
>>> Then logged into a node which has OVS installed in the above way and gave:
>>>
>>> sudo ifconfig eth1 0
>>>
>>> sudo ifconfig eth2 0
>>>
>>>
>>> #ovs-vsctl add-br br-int
>>>
>>> sudo ovs-vsctl add-br OVSbr1
>>>
>>> sudo ovs-vsctl add-br OVSbr2
>>>
>>>
>>> Last 3 lines give error so to see the log file:
>>>
>>> cat /var/log/openvswitch/ovs-vswitchd.log
>>>
>>>
>>>
>>> Am I missing out something vital in the command? If so then Please let me know what will be the correct sequence of commands.
>>>
>>> I'm trying to do a couple of experiments by using a few nodes in Emulab. Of these 3 nodes will act as switches- so i am using the *image *(mentioned earlier) to install OVS in them. The nodes will talk to each other and switches will do the routing.  And here i am stuck with the OVS install. Next i got to write the controller.. Can you help me get the installation right?
>>>
>>>
>>>
>>> Thanks & Regards
>>>
>>> Sanghamitra De
>>>
>>>
>>>
>>>
>>> On Fri, Mar 27, 2015 at 10:58 PM, Kris <13520814722 at 126.com> wrote:
>>>
>>>> How did you install the ovs? It seems your installation is not correct.
>>>>
>>>>
>>>> KRIS
>>>>
>>>>
>>>> On 2015-03-28 01:02 , Sanghamitra De <sanghamitra.de at gmail.com> Wrote:
>>>>
>>>> Hi,
>>>>
>>>> the log file screenshot is attached.
>>>>
>>>> the following errors continue on trying the following lines:
>>>>
>>>>
>>>> #ovs-vsctl add-br br-int
>>>> ovs-vsctl: Error detected while setting up 'br-int'. See ovs-vswitchd
>>>> log for details
>>>>
>>>> # ovs-vsctl add-br br0
>>>> ovs-vsctl: Error detected while setting up 'br0'. See ovs-vswitchd log
>>>> for details
>>>>
>>>> # ovs-vsctl add-br br1
>>>> ovs-vsctl: Error detected while setting up 'br1'. See ovs-vswitchd log
>>>> for details
>>>>
>>>> why is there problem while trying to create br-int or br0, br1 for that
>>>> matter?
>>>>
>>>>
>>>> Thanks & Regards
>>>> Sanghamitra De
>>>>
>>>>
>>>>
>>>> 来自网易手机号码邮箱了解更多 <http://shouji.163.com>
>>>>
>>>
>>>
>>> _______________________________________________
>>> discuss mailing list
>>> discuss at openvswitch.org
>>> http://openvswitch.org/mailman/listinfo/discuss
>>>
>>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150401/73c1c357/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: log_file.jpg
Type: image/jpeg
Size: 331205 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150401/73c1c357/attachment-0002.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: vswitch_ovsschema.jpg
Type: image/jpeg
Size: 168900 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150401/73c1c357/attachment-0003.jpg>

From alexw at nicira.com  Thu Apr  2 10:01:12 2015
From: alexw at nicira.com (Alex Wang)
Date: Thu, 2 Apr 2015 10:01:12 -0700
Subject: [ovs-discuss] (no subject)
In-Reply-To: <CA+Cs8xJOrB-kkvKKQ8KNQJmN=90otV8DF0ci4YxgGhX1xH=Z9Q@mail.gmail.com>
References: <CA+Cs8xJMzy333GWBK8YKwuW6z0VRtb2x5Up16MQJKtgK3_G_BQ@mail.gmail.com>
 <CAArS4XWUYxP5t1UkXeoo9hLKFjDMFinbNDS1rTb5Yo_fAeGiJw@mail.gmail.com>
 <CA+Cs8xJOrB-kkvKKQ8KNQJmN=90otV8DF0ci4YxgGhX1xH=Z9Q@mail.gmail.com>
Message-ID: <CAArS4XUWe9t0+xM_Pb11gWQn6BJqLy9c-QDuAR8vmuUP8aOBAg@mail.gmail.com>

>
>
>> What is the 'ovs-vsctl show' output of Box-B?  For traffic sent from
>> untagged VLAN port of Box-B, the vmbr0 of Box-A should not forward it
>> to tagged VLAN ports.
>>
>
> I hope that we have a communication Problem here and I didn't miss
> something really basic about OVS and wasted everyones time.
> box-b doesn't use OVS yet. box-b uses normal linux bridging on a untagged
> VLAN Port (VLAN ID 1115) on a switch. box-a connects to two LACP bond'ed
> Ports on that some switch that have multiple tagged VLAN IDs, one of them
> being 1115.
>
> ########
> [root at box-b /root $ ovs-vsctl show
> 872e809c-3121-4a4f-9fe8-8e436a7cf101
>     ovs_version: "2.3.1"
> ########
>
> Any Ideas where I could look at?
>
>

Thx for providing the info~

Could you try applying the same ovs config on box-b and redo the test to
see
if linux bridge is the issue?

Thanks,
Alex Wang,



>
>>
>> Thanks,
>> Alex Wang,
>>
>
> Thank YOU,
> Ben
>
>
>>
>>
>>>
>>> Here is my basic setup
>>> ######
>>> ovs-vsctl show
>>> 8031569b-5210-4334-88fd-36704af3a667
>>>     Bridge "vmbr0"
>>>         Port "vlan1115"
>>>             tag: 1115
>>>             Interface "vlan1115"
>>>                 type: internal
>>>         Port "bond0"
>>>             Interface "eth1"
>>>             Interface "eth2"
>>>         Port "vmbr0"
>>>             Interface "vmbr0"
>>>                 type: internal
>>>         Port "vlan1116"
>>>             tag: 1116
>>>             Interface "vlan1116"
>>>                 type: internal
>>>     ovs_version: "2.3.1"
>>> ########
>>>
>>>
>>> cat /etc/network/interfaces = http://pastebin.ca/2967191
>>> ifconfig = http://pastebin.ca/2967192
>>> ovs-appctl bond/show bond0 = http://pastebin.ca/2967193
>>> ovs-appctl lacp/show bond0 = http://pastebin.ca/2967194
>>> ovs-vsctl list port bond0 = http://pastebin.ca/2967200
>>>
>>>
>>> Could anyone please point me in a direction to look at.
>>>
>>> Thanks a lot,
>>> Ben
>>>
>>>
>>> _______________________________________________
>>> discuss mailing list
>>> discuss at openvswitch.org
>>> http://openvswitch.org/mailman/listinfo/discuss
>>>
>>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150402/2acc82a4/attachment.html>

From joestringer at nicira.com  Fri Apr  3 13:47:10 2015
From: joestringer at nicira.com (Joe Stringer)
Date: Fri, 3 Apr 2015 13:47:10 -0700
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <CACjuMbx+-uhyvpX1tyPhsdyVtT3DFDd8Kq_LAH-7iKhaz-UmkA@mail.gmail.com>
 <8C992B4E-8AA6-46A2-863D-9C9FBC6D4D16@nuvula.ch>
 <CANr6G5yB6jiYD+fwYhtPDh3bxams3PNTZLqd25DVcyU1hxmquw@mail.gmail.com>
 <B32CB78D-2CF9-4F47-9515-C8A206C090A2@nuvula.ch>
 <alpine.OSX.1.10.1503311245160.389@sabyasg-mbp-02>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
Message-ID: <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>

I guess James missed the email :-) In January he posted some builds for
further investigation:

https://www.mail-archive.com/discuss at openvswitch.org/msg12049.html

It sounds like it's the exact same code, but with less compiler
optimizations, to see whether this fixed the issue. This might provide a
bit more information.

On 31 March 2015 at 14:43, Marco Kuendig <marco at nuvula.ch> wrote:

> ok, I have tested it and I can reproduce it.
>
> For testing to reproduce that core:
>
> I have a very small VM on KVM, I start and shutdown that VM every 30
> seconds. With that I get:
>
> Mar 31 16:10:13 nuv-vir-kvm-server-1 ovs-vswitchd:
> ovs|00010|daemon(monitor)|ERR|9 crashes: pid 10918 died, killed
> (Segmentation fault), core dumped, restarting
> Mar 31 16:29:20 nuv-vir-kvm-server-1 ovs-vswitchd:
> ovs|00011|daemon(monitor)|ERR|10 crashes: pid 22038 died, killed
> (Segmentation fault), core dumped, restarting
> Mar 31 23:33:04 nuv-vir-kvm-server-1 ovs-vswitchd:
> ovs|00012|daemon(monitor)|ERR|11 crashes: pid 25067 died, killed
> (Segmentation fault), core dumped, restarting
> Mar 31 23:34:43 nuv-vir-kvm-server-1 ovs-vswitchd:
> ovs|00013|daemon(monitor)|ERR|12 crashes: pid 30254 died, killed
> (Segmentation fault), core dumped, restarting
> Mar 31 23:38:49 nuv-vir-kvm-server-1 ovs-vswitchd:
> ovs|00014|daemon(monitor)|ERR|13 crashes: pid 31612 died, killed
> (Segmentation fault), core dumped, restarting
>
> The ovs-vswitchd does not restart every cycle but it cores quite often as
> you can see in the log above.
>
>
>
> [image: Nuvula AG] <http://www.nuvula.ch/>
>
> Marco Kuendig / CEO / Founder
> marco at nuvula.ch / +41 78 751 99 71
>
> Marco's Google Hangout
> <https://plus.google.com/hangouts/_/nuvula.ch/marco>
>
> Nuvula AG - Hybrid Clouds
> Weierbachstrasse 7b 8193 Eglisau Switzerland
> http://www.nuvula.ch
>
> On 31 Mar 2015, at 23:15, Marco Kuendig <marco at nuvula.ch> wrote:
>
> I think I can reproduce that bug. Not 100% sure but today I think I had it
> several times.
>
> Interesting is that it happens when a VM on kvm boots. Certainly strange
> is that several hosts crash simultaneously.
>
> My setup is a lab setup and can be accessed if it helps in troubleshooting.
>
>
> [image: Nuvula AG] <http://www.nuvula.ch/>
>
> Marco Kuendig / CEO / Founder
> marco at nuvula.ch / +41 78 751 99 71
>
> Marco's Google Hangout
> <https://plus.google.com/hangouts/_/nuvula.ch/marco>
>
> Nuvula AG - Hybrid Clouds
> Weierbachstrasse 7b 8193 Eglisau Switzerland
> http://www.nuvula.ch
>
> On 31 Mar 2015, at 23:12, Joe Stringer <joestringer at nicira.com> wrote:
>
> James, I believe you were involved last time this bug came up, I wonder if
> you ever got to the bottom of this?
>
> ---
>
> This looks the same as a bug reported in October:
>
> http://openvswitch.org/pipermail/discuss/2014-October/015429.html
>
> Ben's assessment was that there is no logical issue in the code, so
> perhaps there was weird code generation caused by GCC.
>
>
> On 31 March 2015 at 13:05, Marco Kuendig <marco at nuvula.ch> wrote:
>
>> Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from
>> /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
>> done.
>> [New LWP 32725]
>> [New LWP 32732]
>> [New LWP 32726]
>> [New LWP 32730]
>> [New LWP 32727]
>> [New LWP 32728]
>> [New LWP 32729]
>> [New LWP 32731]
>> [Thread debugging using libthread_db enabled]
>> Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
>> Core was generated by `ovs-vswitchd unix:/var/run/openvswitch/db.sock
>> -vconsole:emer -vsyslog:err -vfi'.
>> Program terminated with signal SIGSEGV, Segmentation fault.
>> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
>> 506 ../lib/netlink.c: No such file or directory.
>> (gdb) bt
>> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
>> #1  0x0000000000460473 in format_generic_odp_key (a=a at entry=0x0,
>> ds=ds at entry=0x7fff0408f3b0) at ../lib/odp-util.c:767
>> #2  0x0000000000460cd2 in format_odp_key_attr (a=a at entry=0xc485a4,
>> ma=ma at entry=0x0, ds=ds at entry=0x7fff0408f3b0, verbose=verbose at entry=true)
>>     at ../lib/odp-util.c:1332
>> #3  0x00000000004609d7 in odp_flow_format (key=<optimized out>,
>> key_len=40, mask=0x0, mask_len=0, ds=0x7fff0408f3b0, verbose=true) at
>> ../lib/odp-util.c:1402
>> #4  0x0000000000460fc4 in format_odp_key_attr (a=a at entry=0xc48580,
>> ma=ma at entry=0x0, ds=ds at entry=0x7fff0408f3b0, verbose=verbose at entry=true)
>> at ../lib/odp-util.c:987
>> #5  0x00000000004609d7 in odp_flow_format (key=key at entry=0xc48520,
>> key_len=key_len at entry=140, mask=mask at entry=0x0, mask_len=mask_len at entry
>> =0,
>>     ds=ds at entry=0x7fff0408f3b0, verbose=verbose at entry=true) at
>> ../lib/odp-util.c:1402
>> #6  0x00000000004450f3 in log_flow_message (error=error at entry=2,
>> operation=operation at entry=0x4d0e73 "flow_del", key=0xc48520,
>> key_len=140, mask=mask at entry=0x0,
>>     mask_len=mask_len at entry=0, stats=0x0, actions=actions at entry=0x0,
>> actions_len=actions_len at entry=0, dpif=<optimized out>) at
>> ../lib/dpif.c:1354
>> #7  0x00000000004453c9 in log_flow_del_message (dpif=dpif at entry=0xc489c0,
>> del=del at entry=0x7fff0408f460, error=error at entry=2) at ../lib/dpif.c:1397
>> #8  0x0000000000445433 in log_flow_del_message (error=2,
>> del=0x7fff0408f460, dpif=0xc489c0) at ../lib/dpif.c:1396
>> #9  dpif_flow_del__ (dpif=0xc489c0, del=del at entry=0x7fff0408f460) at
>> ../lib/dpif.c:945
>> #10 0x00000000004455ca in dpif_flow_del (dpif=<optimized out>,
>> key=<optimized out>, key_len=<optimized out>, stats=stats at entry=0x7fff0408f490)
>> at ../lib/dpif.c:965
>> #11 0x000000000041b423 in subfacet_uninstall (subfacet=0xbd76a0) at
>> ../ofproto/ofproto-dpif.c:4686
>> #12 0x0000000000420f18 in facet_remove (facet=facet at entry=0xbd72a0) at
>> ../ofproto/ofproto-dpif.c:4014
>> #13 0x0000000000422f52 in facet_revalidate (facet=facet at entry=0xbd72a0)
>> at ../ofproto/ofproto-dpif.c:4321
>> #14 0x0000000000424b5a in facet_lookup_valid (flow=0x7f3e700020a8,
>> ofproto=0xc52600) at ../ofproto/ofproto-dpif.c:4203
>> #15 handle_flow_miss (n_ops=<synthetic pointer>, ops=0x7fff0408fb60,
>> miss=0x7f3e70002090) at ../ofproto/ofproto-dpif.c:3339
>> #16 handle_flow_misses (fmb=fmb at entry=0x7f3e700008e0, backer=<optimized
>> out>) at ../ofproto/ofproto-dpif.c:3410
>> #17 0x0000000000425196 in handle_upcalls (backer=<optimized out>) at
>> ../ofproto/ofproto-dpif.c:3565
>> #18 dpif_backer_run_fast (backer=<optimized out>) at
>> ../ofproto/ofproto-dpif.c:1007
>> #19 type_run_fast (type=<optimized out>) at ../ofproto/ofproto-dpif.c:1024
>> #20 0x00000000004122cf in ofproto_type_run_fast (datapath_type=<optimized
>> out>, datapath_type at entry=0xc4ef20 "system") at ../ofproto/ofproto.c:1326
>> #21 0x00000000004081a5 in bridge_run_fast () at ../vswitchd/bridge.c:2318
>> #22 0x00000000004059c5 in main (argc=<optimized out>, argv=<optimized
>> out>) at ../vswitchd/ovs-vswitchd.c:119
>> (gdb)
>>
>>
>>
>> [image: Nuvula AG] <http://www.nuvula.ch/>
>>
>> Marco Kuendig / CEO / Founder
>> marco at nuvula.ch / +41 78 751 99 71
>>
>> Marco's Google Hangout
>> <https://plus.google.com/hangouts/_/nuvula.ch/marco>
>>
>> Nuvula AG - Hybrid Clouds
>> Weierbachstrasse 7b 8193 Eglisau Switzerland
>> http://www.nuvula.ch
>>
>> On 31 Mar 2015, at 22:04, Joe Stringer <joestringer at nicira.com> wrote:
>>
>> Great, we're moving. Looks like the gdb version of this is working below.
>> Do you get the gdb prompt from there? the command 'bt' should provide the
>> backtrace we're after.
>>
>> On 31 March 2015 at 12:52, Marco Kuendig <marco at nuvula.ch> wrote:
>>
>>> that brought us a step forward. thank Sab.
>>>
>>> Important to know is:
>>>
>>> I got 4 kvm servers, meshed with openvswitch. I use vxlan for tunnelling.
>>>
>>> Sometimes when I restart a domain in kvm, 3 or 4 hosts crash at the same
>>> time.
>>>
>>> I have STP enabled to avoid loops.
>>>
>>>
>>> this is the output now:
>>>
>>> root at nuv-vir-kvm-server-1 ~ # gdb /usr/sbin/ovs-vswitchd
>>> /var/crash/ovs/CoreDump
>>> GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
>>> Copyright (C) 2014 Free Software Foundation, Inc.
>>> License GPLv3+: GNU GPL version 3 or later <
>>> http://gnu.org/licenses/gpl.html>
>>> This is free software: you are free to change and redistribute it.
>>> There is NO WARRANTY, to the extent permitted by law.  Type "show
>>> copying"
>>> and "show warranty" for details.
>>> This GDB was configured as "x86_64-linux-gnu".
>>> Type "show configuration" for configuration details.
>>> For bug reporting instructions, please see:
>>> <http://www.gnu.org/software/gdb/bugs/>.
>>> Find the GDB manual and other documentation resources online at:
>>> <http://www.gnu.org/software/gdb/documentation/>.
>>> For help, type "help".
>>> Type "apropos word" to search for commands related to "word"...
>>> Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from
>>> /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
>>> done.
>>> [New LWP 32725]
>>> [New LWP 32732]
>>> [New LWP 32726]
>>> [New LWP 32730]
>>> [New LWP 32727]
>>> [New LWP 32728]
>>> [New LWP 32729]
>>> [New LWP 32731]
>>> [Thread debugging using libthread_db enabled]
>>> Using host libthread_db library
>>> "/lib/x86_64-linux-gnu/libthread_db.so.1".
>>> Core was generated by `ovs-vswitchd unix:/var/run/openvswitch/db.sock
>>> -vconsole:emer -vsyslog:err -vfi'.
>>> Program terminated with signal SIGSEGV, Segmentation fault.
>>> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
>>> 506 ../lib/netlink.c: No such file or directory.
>>>
>>>
>>> root at nuv-vir-kvm-server-1 ~ # crash /usr/sbin/ovs-vswitchd
>>> /var/crash/ovs/CoreDump
>>>
>>> crash 7.0.3
>>> Copyright (C) 2002-2013  Red Hat, Inc.
>>> Copyright (C) 2004, 2005, 2006, 2010  IBM Corporation
>>> Copyright (C) 1999-2006  Hewlett-Packard Co
>>> Copyright (C) 2005, 2006, 2011, 2012  Fujitsu Limited
>>> Copyright (C) 2006, 2007  VA Linux Systems Japan K.K.
>>> Copyright (C) 2005, 2011  NEC Corporation
>>> Copyright (C) 1999, 2002, 2007  Silicon Graphics, Inc.
>>> Copyright (C) 1999, 2000, 2001, 2002  Mission Critical Linux, Inc.
>>> This program is free software, covered by the GNU General Public License,
>>> and you are welcome to change it and/or distribute copies of it under
>>> certain conditions.  Enter "help copying" to see the conditions.
>>> This program has absolutely no warranty.  Enter "help warranty" for
>>> details.
>>>
>>>
>>> crash: /usr/sbin/ovs-vswitchd: no debugging data available
>>>
>>> root at nuv-vir-kvm-server-1 ~ # ll /var/crash/ovs/
>>> Architecture         Date                 ExecutableTimestamp  ProcCwd
>>>            ProcStatus           UserGroups
>>> CoreDump             DistroRelease        ProblemType
>>>  ProcEnviron          Signal
>>> CrashCounter         ExecutablePath       ProcCmdline          ProcMaps
>>>             Uname
>>>
>>>
>>> [image: Nuvula AG] <http://www.nuvula.ch/>
>>>
>>> Marco Kuendig / CEO / Founder
>>> marco at nuvula.ch / +41 78 751 99 71
>>>
>>> Marco's Google Hangout
>>> <https://plus.google.com/hangouts/_/nuvula.ch/marco>
>>>
>>> Nuvula AG - Hybrid Clouds
>>> Weierbachstrasse 7b 8193 Eglisau Switzerland
>>> http://www.nuvula.ch
>>>
>>> On 31 Mar 2015, at 21:45, Sabyasachi Sengupta <
>>> Sabyasachi.Sengupta at alcatel-lucent.com> wrote:
>>>
>>>
>>> Typically Ubuntu does not unpack the crashes. Can you try apport-unpack?
>>> # apport-unpack /var/crash/<name> <crash-dir>
>>>
>>> On Tue, 31 Mar 2015, Marco Kuendig wrote:
>>>
>>> thanks Joe and Ben
>>> have done:
>>> 1. installed dgb symbols for kernel....doesn't help
>>> 2. installed debug symbols for openvswitch
>>> no change, gdb and crash still don't work for me. I'm not a dev, need
>>> more help to get that backtrace done.
>>> here some output:
>>> root at nuv-vir-kvm-server-1 ~ # crash
>>>  /usr/lib/debug/boot/vmlinux-3.13.0-48-generic
>>> /var/crash/_usr_sbin_ovs-vswitchd.0.crash
>>> crash 7.0.3
>>> Copyright (C) 2002-2013  Red Hat, Inc.
>>> Copyright (C) 2004, 2005, 2006, 2010  IBM Corporation
>>> Copyright (C) 1999-2006  Hewlett-Packard Co
>>> Copyright (C) 2005, 2006, 2011, 2012  Fujitsu Limited
>>> Copyright (C) 2006, 2007  VA Linux Systems Japan K.K.
>>> Copyright (C) 2005, 2011  NEC Corporation
>>> Copyright (C) 1999, 2002, 2007  Silicon Graphics, Inc.
>>> Copyright (C) 1999, 2000, 2001, 2002  Mission Critical Linux, Inc.
>>> This program is free software, covered by the GNU General Public License,
>>> and you are welcome to change it and/or distribute copies of it under
>>> certain conditions.  Enter "help copying" to see the conditions.
>>> This program has absolutely no warranty.  Enter "help warranty" for
>>> details.
>>> crash: /var/crash/_usr_sbin_ovs-vswitchd.0.crash: not a supported file
>>> format
>>> Usage:
>>>
>>>   crash [OPTION]... NAMELIST MEMORY-IMAGE  (dumpfile form)
>>>   crash [OPTION]... [NAMELIST]             (live system form)
>>> Enter "crash -h" for details.
>>> root at nuv-vir-kvm-server-1 ~ # gdb /usr/sbin/ovs-vswitchd
>>> /var/crash/_usr_sbin_ovs-vswitchd.0.crash
>>> GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
>>> Copyright (C) 2014 Free Software Foundation, Inc.
>>> License GPLv3+: GNU GPL version 3 or later
>>> <http://gnu.org/licenses/gpl.html>
>>> This is free software: you are free to change and redistribute it.
>>> There is NO WARRANTY, to the extent permitted by law.  Type "show
>>> copying"
>>> and "show warranty" for details.
>>> This GDB was configured as "x86_64-linux-gnu".
>>> Type "show configuration" for configuration details.
>>> For bug reporting instructions, please see:
>>> <http://www.gnu.org/software/gdb/bugs/>.
>>> Find the GDB manual and other documentation resources online at:
>>> <http://www.gnu.org/software/gdb/documentation/>.
>>> For help, type "help".
>>> Type "apropos word" to search for commands related to "word"...
>>> Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from
>>> /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
>>> done.
>>> "/var/crash/_usr_sbin_ovs-vswitchd.0.crash" is not a core dump: File
>>> format not recognized
>>> (gdb) q
>>> root at nuv-vir-kvm-server-1 ~ #
>>> Nuvula AG
>>> Marco Kuendig / CEO / Founder marco at nuvula.ch / +41 78 751 99 71
>>> Marco's Google Hangout
>>> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau Switzerland
>>> http://www.nuvula.ch
>>>
>>>      On 31 Mar 2015, at 19:00, Joe Stringer
>>>      <joestringer at nicira.com> wrote:
>>> For the 'File format not recognized' problem, you might have better
>>> luck with the 'crash' utility.
>>> $ crash <binary> <crashdump>
>>> On 31 March 2015 at 08:16, Marco Kuendig <marco at nuvula.ch> wrote:
>>>      Have tried this:
>>> http://openvswitch.org/pipermail/discuss/2015-February/016582.html
>>> this is the output, so doesn't seem to be correct:
>>> root at nuv-vir-kvm-server-2 ~ # gdb /usr/sbin/ovs-vswitchd
>>> /var/crash/_usr_sbin_ovs-vswitchd.0.crash
>>> GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
>>> Copyright (C) 2014 Free Software Foundation, Inc.
>>> License GPLv3+: GNU GPL version 3 or later
>>> <http://gnu.org/licenses/gpl.html>
>>> This is free software: you are free to change and
>>> redistribute it.
>>> There is NO WARRANTY, to the extent permitted by law.  Type
>>> "show copying"
>>> and "show warranty" for details.
>>> This GDB was configured as "x86_64-linux-gnu".
>>> Type "show configuration" for configuration details.
>>> For bug reporting instructions, please see:
>>> <http://www.gnu.org/software/gdb/bugs/>.
>>> Find the GDB manual and other documentation resources online
>>> at:
>>> <http://www.gnu.org/software/gdb/documentation/>.
>>> For help, type "help".
>>> Type "apropos word" to search for commands related to
>>> "word"...
>>> Reading symbols from /usr/sbin/ovs-vswitchd...(no debugging
>>> symbols found)...done.
>>> "/var/crash/_usr_sbin_ovs-vswitchd.0.crash" is not a core
>>> dump: File format not recognized
>>> (gdb) bt
>>> No stack.
>>> (gdb) quit
>>> any more hints please ?
>>> thanks
>>> marco
>>> Nuvula AG
>>> Marco Kuendig / CEO / Founder marco at nuvula.ch / +41 78 751 99 71
>>> Marco's Google Hangout
>>> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau Switzerland
>>> http://www.nuvula.ch
>>>
>>>      On 31 Mar 2015, at 17:00, Ben Pfaff
>>>      <blp at nicira.com> wrote:
>>> Can you get a backtrace for these?
>>> On Tue, Mar 31, 2015 at 7:09 AM, Marco Kuendig
>>> <marco at nuvula.ch> wrote:
>>>      Folks,
>>> any chance of having somebody look at these crash
>>> files ?
>>> I have several servers that are loosing network
>>> connectivity because of this.
>>> Downloads:
>>>
>>> https://drive.google.com/file/d/0Bx_w1Tf2B5VSRU9yUmRpTDJLVEU/view?usp=sharing
>>> Thanks for any hint or fix
>>> marco
>>> Nuvula AG
>>> Marco Kuendig / CEO / Founder marco at nuvula.ch / +41 78 751 99 71
>>> Marco's Google Hangout
>>> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau Switzerland
>>> http://www.nuvula.ch
>>> _______________________________________________
>>> discuss mailing list
>>> discuss at openvswitch.org
>>> http://openvswitch.org/mailman/listinfo/discuss
>>> --
>>> "I don't normally do acked-by's.  I think it's my way
>>> of avoiding
>>> getting blamed when it all blows up." Andrew Morton
>>> _______________________________________________
>>> discuss mailing list
>>> discuss at openvswitch.org
>>> http://openvswitch.org/mailman/listinfo/discuss
>>>
>>>
>>>
>>
>>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150403/48aa6665/attachment-0001.html>

From rlantz at cs.stanford.edu  Fri Apr  3 17:43:01 2015
From: rlantz at cs.stanford.edu (Bob Lantz)
Date: Fri, 3 Apr 2015 17:43:01 -0700
Subject: [ovs-discuss] ovs vlan problem
In-Reply-To: <CAN2Qyzbho4E1Uf-1N79eCHCGSnUTxv7y0jN2n8ToDtguZpG1Kg@mail.gmail.com>
References: <CAN2Qyzbho4E1Uf-1N79eCHCGSnUTxv7y0jN2n8ToDtguZpG1Kg@mail.gmail.com>
Message-ID: <B9717456-8114-4B8B-8856-B075BCF4D7F4@cs.stanford.edu>

By default, OVS is running in OpenFlow mode, attached to a controller, so trying to set a VLAN that way is not a sensible thing to do.

However, what you’re trying might work with OVSBridge (—switch ovsbr).

On Mar 28, 2015, at 6:38 PM, Vinllen Chen <cvinllen at gmail.com> wrote:
> 
> Hello, Dear all:
>     I use ovs and mininet to build my net like this:
> h1--s1--s2--h3
>        |      |
>       h2   h4
>     And then i set the vlan tag:
> ovs-vsctl set port s1-h1 tag=10
> ovs-vsctl set port s1-h2 tag=20
>     As a result, i can ping successfully between every two hosts as not expected. Why different vlan tag can ping successfully? Greate appreciation for anyone's reply.
> Thanks,
> Vinllen
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss


From marco at nuvula.ch  Sat Apr  4 01:10:54 2015
From: marco at nuvula.ch (Marco Kuendig)
Date: Sat, 4 Apr 2015 10:10:54 +0200
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <CACjuMbx+-uhyvpX1tyPhsdyVtT3DFDd8Kq_LAH-7iKhaz-UmkA@mail.gmail.com>
 <8C992B4E-8AA6-46A2-863D-9C9FBC6D4D16@nuvula.ch>
 <CANr6G5yB6jiYD+fwYhtPDh3bxams3PNTZLqd25DVcyU1hxmquw@mail.gmail.com>
 <B32CB78D-2CF9-4F47-9515-C8A206C090A2@nuvula.ch>
 <alpine.OSX.1.10.1503311245160.389@sabyasg-mbp-02>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
Message-ID: <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>

Thanks Joe

I have installed from that ppa and tested again. With that version from James I can't not get the crash anymore. I restarted the VM about 50 times and nothing crashed on any server.

So it seems that this fixes the issue, but I'm not quite sure if it lowers performance (not tested, just speculation).

James,

let me know if you want me to test other versions or procedures. I can recreate the crash at will it seems.

Cheers
marco


 <http://www.nuvula.ch/>
Marco Kuendig / CEO / Founder 
marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71

Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
Nuvula AG - Hybrid Clouds 
Weierbachstrasse 7b 8193 Eglisau Switzerland 
http://www.nuvula.ch <http://www.nuvula.ch/>
> On 03 Apr 2015, at 22:47, Joe Stringer <joestringer at nicira.com> wrote:
> 
> I guess James missed the email :-) In January he posted some builds for further investigation:
> 
> https://www.mail-archive.com/discuss at openvswitch.org/msg12049.html <https://www.mail-archive.com/discuss at openvswitch.org/msg12049.html>
> 
> It sounds like it's the exact same code, but with less compiler optimizations, to see whether this fixed the issue. This might provide a bit more information.
> 
> On 31 March 2015 at 14:43, Marco Kuendig <marco at nuvula.ch <mailto:marco at nuvula.ch>> wrote:
> ok, I have tested it and I can reproduce it. 
> 
> For testing to reproduce that core: 
> 
> I have a very small VM on KVM, I start and shutdown that VM every 30 seconds. With that I get:
> 
> Mar 31 16:10:13 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00010|daemon(monitor)|ERR|9 crashes: pid 10918 died, killed (Segmentation fault), core dumped, restarting
> Mar 31 16:29:20 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00011|daemon(monitor)|ERR|10 crashes: pid 22038 died, killed (Segmentation fault), core dumped, restarting
> Mar 31 23:33:04 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00012|daemon(monitor)|ERR|11 crashes: pid 25067 died, killed (Segmentation fault), core dumped, restarting
> Mar 31 23:34:43 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00013|daemon(monitor)|ERR|12 crashes: pid 30254 died, killed (Segmentation fault), core dumped, restarting
> Mar 31 23:38:49 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00014|daemon(monitor)|ERR|13 crashes: pid 31612 died, killed (Segmentation fault), core dumped, restarting
> 
> The ovs-vswitchd does not restart every cycle but it cores quite often as you can see in the log above.
> 
> 
> 
>  <http://www.nuvula.ch/>
> Marco Kuendig / CEO / Founder 
> marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71 <tel:%2B41%2078%20751%2099%2071>
> Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
> Nuvula AG - Hybrid Clouds 
> Weierbachstrasse 7b 8193 Eglisau Switzerland 
> http://www.nuvula.ch <http://www.nuvula.ch/>
>> On 31 Mar 2015, at 23:15, Marco Kuendig <marco at nuvula.ch <mailto:marco at nuvula.ch>> wrote:
>> 
>> I think I can reproduce that bug. Not 100% sure but today I think I had it several times.
>> 
>> Interesting is that it happens when a VM on kvm boots. Certainly strange is that several hosts crash simultaneously.
>> 
>> My setup is a lab setup and can be accessed if it helps in troubleshooting.
>> 
>>  <http://www.nuvula.ch/>
>> Marco Kuendig / CEO / Founder 
>> marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71 <tel:%2B41%2078%20751%2099%2071>
>> Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
>> Nuvula AG - Hybrid Clouds 
>> Weierbachstrasse 7b 8193 Eglisau Switzerland 
>> http://www.nuvula.ch <http://www.nuvula.ch/>
>>> On 31 Mar 2015, at 23:12, Joe Stringer <joestringer at nicira.com <mailto:joestringer at nicira.com>> wrote:
>>> 
>>> James, I believe you were involved last time this bug came up, I wonder if you ever got to the bottom of this?
>>> 
>>> ---
>>> 
>>> This looks the same as a bug reported in October:
>>> 
>>> http://openvswitch.org/pipermail/discuss/2014-October/015429.html <http://openvswitch.org/pipermail/discuss/2014-October/015429.html>
>>> 
>>> Ben's assessment was that there is no logical issue in the code, so perhaps there was weird code generation caused by GCC.
>>> 
>>> 
>>> On 31 March 2015 at 13:05, Marco Kuendig <marco at nuvula.ch <mailto:marco at nuvula.ch>> wrote:
>>> Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
>>> done.
>>> [New LWP 32725]
>>> [New LWP 32732]
>>> [New LWP 32726]
>>> [New LWP 32730]
>>> [New LWP 32727]
>>> [New LWP 32728]
>>> [New LWP 32729]
>>> [New LWP 32731]
>>> [Thread debugging using libthread_db enabled]
>>> Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
>>> Core was generated by `ovs-vswitchd unix:/var/run/openvswitch/db.sock -vconsole:emer -vsyslog:err -vfi'.
>>> Program terminated with signal SIGSEGV, Segmentation fault.
>>> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
>>> 506	../lib/netlink.c: No such file or directory.
>>> (gdb) bt
>>> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
>>> #1  0x0000000000460473 in format_generic_odp_key (a=a at entry=0x0, ds=ds at entry=0x7fff0408f3b0) at ../lib/odp-util.c:767
>>> #2  0x0000000000460cd2 in format_odp_key_attr (a=a at entry=0xc485a4, ma=ma at entry=0x0, ds=ds at entry=0x7fff0408f3b0, verbose=verbose at entry=true)
>>>     at ../lib/odp-util.c:1332
>>> #3  0x00000000004609d7 in odp_flow_format (key=<optimized out>, key_len=40, mask=0x0, mask_len=0, ds=0x7fff0408f3b0, verbose=true) at ../lib/odp-util.c:1402
>>> #4  0x0000000000460fc4 in format_odp_key_attr (a=a at entry=0xc48580, ma=ma at entry=0x0, ds=ds at entry=0x7fff0408f3b0, verbose=verbose at entry=true) at ../lib/odp-util.c:987
>>> #5  0x00000000004609d7 in odp_flow_format (key=key at entry=0xc48520, key_len=key_len at entry=140, mask=mask at entry=0x0, mask_len=mask_len at entry=0,
>>>     ds=ds at entry=0x7fff0408f3b0, verbose=verbose at entry=true) at ../lib/odp-util.c:1402
>>> #6  0x00000000004450f3 in log_flow_message (error=error at entry=2, operation=operation at entry=0x4d0e73 "flow_del", key=0xc48520, key_len=140, mask=mask at entry=0x0,
>>>     mask_len=mask_len at entry=0, stats=0x0, actions=actions at entry=0x0, actions_len=actions_len at entry=0, dpif=<optimized out>) at ../lib/dpif.c:1354
>>> #7  0x00000000004453c9 in log_flow_del_message (dpif=dpif at entry=0xc489c0, del=del at entry=0x7fff0408f460, error=error at entry=2) at ../lib/dpif.c:1397
>>> #8  0x0000000000445433 in log_flow_del_message (error=2, del=0x7fff0408f460, dpif=0xc489c0) at ../lib/dpif.c:1396
>>> #9  dpif_flow_del__ (dpif=0xc489c0, del=del at entry=0x7fff0408f460) at ../lib/dpif.c:945
>>> #10 0x00000000004455ca in dpif_flow_del (dpif=<optimized out>, key=<optimized out>, key_len=<optimized out>, stats=stats at entry=0x7fff0408f490) at ../lib/dpif.c:965
>>> #11 0x000000000041b423 in subfacet_uninstall (subfacet=0xbd76a0) at ../ofproto/ofproto-dpif.c:4686
>>> #12 0x0000000000420f18 in facet_remove (facet=facet at entry=0xbd72a0) at ../ofproto/ofproto-dpif.c:4014
>>> #13 0x0000000000422f52 in facet_revalidate (facet=facet at entry=0xbd72a0) at ../ofproto/ofproto-dpif.c:4321
>>> #14 0x0000000000424b5a in facet_lookup_valid (flow=0x7f3e700020a8, ofproto=0xc52600) at ../ofproto/ofproto-dpif.c:4203
>>> #15 handle_flow_miss (n_ops=<synthetic pointer>, ops=0x7fff0408fb60, miss=0x7f3e70002090) at ../ofproto/ofproto-dpif.c:3339
>>> #16 handle_flow_misses (fmb=fmb at entry=0x7f3e700008e0, backer=<optimized out>) at ../ofproto/ofproto-dpif.c:3410
>>> #17 0x0000000000425196 in handle_upcalls (backer=<optimized out>) at ../ofproto/ofproto-dpif.c:3565
>>> #18 dpif_backer_run_fast (backer=<optimized out>) at ../ofproto/ofproto-dpif.c:1007
>>> #19 type_run_fast (type=<optimized out>) at ../ofproto/ofproto-dpif.c:1024
>>> #20 0x00000000004122cf in ofproto_type_run_fast (datapath_type=<optimized out>, datapath_type at entry=0xc4ef20 "system") at ../ofproto/ofproto.c:1326
>>> #21 0x00000000004081a5 in bridge_run_fast () at ../vswitchd/bridge.c:2318
>>> #22 0x00000000004059c5 in main (argc=<optimized out>, argv=<optimized out>) at ../vswitchd/ovs-vswitchd.c:119
>>> (gdb)
>>> 
>>> 
>>> 
>>>  <http://www.nuvula.ch/>
>>> Marco Kuendig / CEO / Founder 
>>> marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71 <tel:%2B41%2078%20751%2099%2071>
>>> Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
>>> Nuvula AG - Hybrid Clouds 
>>> Weierbachstrasse 7b 8193 Eglisau Switzerland 
>>> http://www.nuvula.ch <http://www.nuvula.ch/>
>>>> On 31 Mar 2015, at 22:04, Joe Stringer <joestringer at nicira.com <mailto:joestringer at nicira.com>> wrote:
>>>> 
>>>> Great, we're moving. Looks like the gdb version of this is working below. Do you get the gdb prompt from there? the command 'bt' should provide the backtrace we're after.
>>>> 
>>>> On 31 March 2015 at 12:52, Marco Kuendig <marco at nuvula.ch <mailto:marco at nuvula.ch>> wrote:
>>>> that brought us a step forward. thank Sab.
>>>> 
>>>> Important to know is:
>>>> 
>>>> I got 4 kvm servers, meshed with openvswitch. I use vxlan for tunnelling.
>>>> 
>>>> Sometimes when I restart a domain in kvm, 3 or 4 hosts crash at the same time.
>>>> 
>>>> I have STP enabled to avoid loops.
>>>> 
>>>> 
>>>> this is the output now:
>>>> 
>>>> root at nuv-vir-kvm-server-1 ~ # gdb /usr/sbin/ovs-vswitchd /var/crash/ovs/CoreDump
>>>> GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
>>>> Copyright (C) 2014 Free Software Foundation, Inc.
>>>> License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html <http://gnu.org/licenses/gpl.html>>
>>>> This is free software: you are free to change and redistribute it.
>>>> There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
>>>> and "show warranty" for details.
>>>> This GDB was configured as "x86_64-linux-gnu".
>>>> Type "show configuration" for configuration details.
>>>> For bug reporting instructions, please see:
>>>> <http://www.gnu.org/software/gdb/bugs/ <http://www.gnu.org/software/gdb/bugs/>>.
>>>> Find the GDB manual and other documentation resources online at:
>>>> <http://www.gnu.org/software/gdb/documentation/ <http://www.gnu.org/software/gdb/documentation/>>.
>>>> For help, type "help".
>>>> Type "apropos word" to search for commands related to "word"...
>>>> Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
>>>> done.
>>>> [New LWP 32725]
>>>> [New LWP 32732]
>>>> [New LWP 32726]
>>>> [New LWP 32730]
>>>> [New LWP 32727]
>>>> [New LWP 32728]
>>>> [New LWP 32729]
>>>> [New LWP 32731]
>>>> [Thread debugging using libthread_db enabled]
>>>> Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
>>>> Core was generated by `ovs-vswitchd unix:/var/run/openvswitch/db.sock -vconsole:emer -vsyslog:err -vfi'.
>>>> Program terminated with signal SIGSEGV, Segmentation fault.
>>>> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
>>>> 506	../lib/netlink.c: No such file or directory.
>>>> 
>>>> 
>>>> root at nuv-vir-kvm-server-1 ~ # crash /usr/sbin/ovs-vswitchd /var/crash/ovs/CoreDump
>>>> 
>>>> crash 7.0.3
>>>> Copyright (C) 2002-2013  Red Hat, Inc.
>>>> Copyright (C) 2004, 2005, 2006, 2010  IBM Corporation
>>>> Copyright (C) 1999-2006  Hewlett-Packard Co
>>>> Copyright (C) 2005, 2006, 2011, 2012  Fujitsu Limited
>>>> Copyright (C) 2006, 2007  VA Linux Systems Japan K.K.
>>>> Copyright (C) 2005, 2011  NEC Corporation
>>>> Copyright (C) 1999, 2002, 2007  Silicon Graphics, Inc.
>>>> Copyright (C) 1999, 2000, 2001, 2002  Mission Critical Linux, Inc.
>>>> This program is free software, covered by the GNU General Public License,
>>>> and you are welcome to change it and/or distribute copies of it under
>>>> certain conditions.  Enter "help copying" to see the conditions.
>>>> This program has absolutely no warranty.  Enter "help warranty" for details.
>>>> 
>>>> 
>>>> crash: /usr/sbin/ovs-vswitchd: no debugging data available
>>>> 
>>>> root at nuv-vir-kvm-server-1 ~ # ll /var/crash/ovs/
>>>> Architecture         Date                 ExecutableTimestamp  ProcCwd              ProcStatus           UserGroups
>>>> CoreDump             DistroRelease        ProblemType          ProcEnviron          Signal
>>>> CrashCounter         ExecutablePath       ProcCmdline          ProcMaps             Uname
>>>> 
>>>>  <http://www.nuvula.ch/>
>>>> Marco Kuendig / CEO / Founder 
>>>> marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71 <tel:%2B41%2078%20751%2099%2071>
>>>> Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
>>>> Nuvula AG - Hybrid Clouds 
>>>> Weierbachstrasse 7b 8193 Eglisau Switzerland 
>>>> http://www.nuvula.ch <http://www.nuvula.ch/>
>>>> 
>>>>> On 31 Mar 2015, at 21:45, Sabyasachi Sengupta <Sabyasachi.Sengupta at alcatel-lucent.com <mailto:Sabyasachi.Sengupta at alcatel-lucent.com>> wrote:
>>>>> 
>>>>> 
>>>>> Typically Ubuntu does not unpack the crashes. Can you try apport-unpack?
>>>>> # apport-unpack /var/crash/<name> <crash-dir>
>>>>> 
>>>>> On Tue, 31 Mar 2015, Marco Kuendig wrote:
>>>>> 
>>>>>> thanks Joe and Ben
>>>>>> have done:
>>>>>> 1. installed dgb symbols for kernel....doesn't help
>>>>>> 2. installed debug symbols for openvswitch
>>>>>> no change, gdb and crash still don't work for me. I'm not a dev, need
>>>>>> more help to get that backtrace done.
>>>>>> here some output:
>>>>>> root at nuv-vir-kvm-server-1 ~ # crash
>>>>>>  /usr/lib/debug/boot/vmlinux-3.13.0-48-generic
>>>>>> /var/crash/_usr_sbin_ovs-vswitchd.0.crash
>>>>>> crash 7.0.3
>>>>>> Copyright (C) 2002-2013  Red Hat, Inc.
>>>>>> Copyright (C) 2004, 2005, 2006, 2010  IBM Corporation
>>>>>> Copyright (C) 1999-2006  Hewlett-Packard Co
>>>>>> Copyright (C) 2005, 2006, 2011, 2012  Fujitsu Limited
>>>>>> Copyright (C) 2006, 2007  VA Linux Systems Japan K.K.
>>>>>> Copyright (C) 2005, 2011  NEC Corporation
>>>>>> Copyright (C) 1999, 2002, 2007  Silicon Graphics, Inc.
>>>>>> Copyright (C) 1999, 2000, 2001, 2002  Mission Critical Linux, Inc.
>>>>>> This program is free software, covered by the GNU General Public License,
>>>>>> and you are welcome to change it and/or distribute copies of it under
>>>>>> certain conditions.  Enter "help copying" to see the conditions.
>>>>>> This program has absolutely no warranty.  Enter "help warranty" for
>>>>>> details.
>>>>>> crash: /var/crash/_usr_sbin_ovs-vswitchd.0.crash: not a supported file
>>>>>> format
>>>>>> Usage:
>>>>>> 
>>>>>>   crash [OPTION]... NAMELIST MEMORY-IMAGE  (dumpfile form)
>>>>>>   crash [OPTION]... [NAMELIST]             (live system form)
>>>>>> Enter "crash -h" for details.
>>>>>> root at nuv-vir-kvm-server-1 ~ # gdb /usr/sbin/ovs-vswitchd
>>>>>> /var/crash/_usr_sbin_ovs-vswitchd.0.crash
>>>>>> GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
>>>>>> Copyright (C) 2014 Free Software Foundation, Inc.
>>>>>> License GPLv3+: GNU GPL version 3 or later
>>>>>> <http://gnu.org/licenses/gpl.html <http://gnu.org/licenses/gpl.html>>
>>>>>> This is free software: you are free to change and redistribute it.
>>>>>> There is NO WARRANTY, to the extent permitted by law.  Type "show
>>>>>> copying"
>>>>>> and "show warranty" for details.
>>>>>> This GDB was configured as "x86_64-linux-gnu".
>>>>>> Type "show configuration" for configuration details.
>>>>>> For bug reporting instructions, please see:
>>>>>> <http://www.gnu.org/software/gdb/bugs/ <http://www.gnu.org/software/gdb/bugs/>>.
>>>>>> Find the GDB manual and other documentation resources online at:
>>>>>> <http://www.gnu.org/software/gdb/documentation/ <http://www.gnu.org/software/gdb/documentation/>>.
>>>>>> For help, type "help".
>>>>>> Type "apropos word" to search for commands related to "word"...
>>>>>> Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from
>>>>>> /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
>>>>>> done.
>>>>>> "/var/crash/_usr_sbin_ovs-vswitchd.0.crash" is not a core dump: File
>>>>>> format not recognized
>>>>>> (gdb) q
>>>>>> root at nuv-vir-kvm-server-1 ~ #
>>>>>> Nuvula AG
>>>>>> Marco Kuendig / CEO / Founder marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71 <tel:%2B41%2078%20751%2099%2071>
>>>>>> Marco's Google Hangout
>>>>>> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau Switzerland http://www.nuvula.ch <http://www.nuvula.ch/>
>>>>>> 
>>>>>>      On 31 Mar 2015, at 19:00, Joe Stringer
>>>>>>      <joestringer at nicira.com <mailto:joestringer at nicira.com>> wrote:
>>>>>> For the 'File format not recognized' problem, you might have better
>>>>>> luck with the 'crash' utility.
>>>>>> $ crash <binary> <crashdump>
>>>>>> On 31 March 2015 at 08:16, Marco Kuendig <marco at nuvula.ch <mailto:marco at nuvula.ch>> wrote:
>>>>>>      Have tried this:
>>>>>> http://openvswitch.org/pipermail/discuss/2015-February/016582.html <http://openvswitch.org/pipermail/discuss/2015-February/016582.html>
>>>>>> this is the output, so doesn't seem to be correct:
>>>>>> root at nuv-vir-kvm-server-2 ~ # gdb /usr/sbin/ovs-vswitchd
>>>>>> /var/crash/_usr_sbin_ovs-vswitchd.0.crash
>>>>>> GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
>>>>>> Copyright (C) 2014 Free Software Foundation, Inc.
>>>>>> License GPLv3+: GNU GPL version 3 or later
>>>>>> <http://gnu.org/licenses/gpl.html <http://gnu.org/licenses/gpl.html>>
>>>>>> This is free software: you are free to change and
>>>>>> redistribute it.
>>>>>> There is NO WARRANTY, to the extent permitted by law.  Type
>>>>>> "show copying"
>>>>>> and "show warranty" for details.
>>>>>> This GDB was configured as "x86_64-linux-gnu".
>>>>>> Type "show configuration" for configuration details.
>>>>>> For bug reporting instructions, please see:
>>>>>> <http://www.gnu.org/software/gdb/bugs/ <http://www.gnu.org/software/gdb/bugs/>>.
>>>>>> Find the GDB manual and other documentation resources online
>>>>>> at:
>>>>>> <http://www.gnu.org/software/gdb/documentation/ <http://www.gnu.org/software/gdb/documentation/>>.
>>>>>> For help, type "help".
>>>>>> Type "apropos word" to search for commands related to
>>>>>> "word"...
>>>>>> Reading symbols from /usr/sbin/ovs-vswitchd...(no debugging
>>>>>> symbols found)...done.
>>>>>> "/var/crash/_usr_sbin_ovs-vswitchd.0.crash" is not a core
>>>>>> dump: File format not recognized
>>>>>> (gdb) bt
>>>>>> No stack.
>>>>>> (gdb) quit
>>>>>> any more hints please ?
>>>>>> thanks
>>>>>> marco
>>>>>> Nuvula AG
>>>>>> Marco Kuendig / CEO / Founder marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71 <tel:%2B41%2078%20751%2099%2071>
>>>>>> Marco's Google Hangout
>>>>>> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau Switzerland http://www.nuvula.ch <http://www.nuvula.ch/>
>>>>>> 
>>>>>>      On 31 Mar 2015, at 17:00, Ben Pfaff
>>>>>>      <blp at nicira.com <mailto:blp at nicira.com>> wrote:
>>>>>> Can you get a backtrace for these?
>>>>>> On Tue, Mar 31, 2015 at 7:09 AM, Marco Kuendig
>>>>>> <marco at nuvula.ch <mailto:marco at nuvula.ch>> wrote:
>>>>>>      Folks,
>>>>>> any chance of having somebody look at these crash
>>>>>> files ?
>>>>>> I have several servers that are loosing network
>>>>>> connectivity because of this.
>>>>>> Downloads:
>>>>>> https://drive.google.com/file/d/0Bx_w1Tf2B5VSRU9yUmRpTDJLVEU/view?usp=sharing <https://drive.google.com/file/d/0Bx_w1Tf2B5VSRU9yUmRpTDJLVEU/view?usp=sharing>
>>>>>> Thanks for any hint or fix
>>>>>> marco
>>>>>> Nuvula AG
>>>>>> Marco Kuendig / CEO / Founder marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71 <tel:%2B41%2078%20751%2099%2071>
>>>>>> Marco's Google Hangout
>>>>>> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau Switzerland http://www.nuvula.ch <http://www.nuvula.ch/>
>>>>>> _______________________________________________
>>>>>> discuss mailing list
>>>>>> discuss at openvswitch.org <mailto:discuss at openvswitch.org>
>>>>>> http://openvswitch.org/mailman/listinfo/discuss <http://openvswitch.org/mailman/listinfo/discuss>
>>>>>> --
>>>>>> "I don't normally do acked-by's.  I think it's my way
>>>>>> of avoiding
>>>>>> getting blamed when it all blows up." Andrew Morton
>>>>>> _______________________________________________
>>>>>> discuss mailing list
>>>>>> discuss at openvswitch.org <mailto:discuss at openvswitch.org>
>>>>>> http://openvswitch.org/mailman/listinfo/discuss <http://openvswitch.org/mailman/listinfo/discuss>
>>>> 
>>> 
>>> 
>> 
> 
> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150404/a68fcdcc/attachment-0001.html>

From marco at nuvula.ch  Sat Apr  4 08:04:44 2015
From: marco at nuvula.ch (Marco Kuendig)
Date: Sat, 4 Apr 2015 17:04:44 +0200
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <CACjuMbx+-uhyvpX1tyPhsdyVtT3DFDd8Kq_LAH-7iKhaz-UmkA@mail.gmail.com>
 <8C992B4E-8AA6-46A2-863D-9C9FBC6D4D16@nuvula.ch>
 <CANr6G5yB6jiYD+fwYhtPDh3bxams3PNTZLqd25DVcyU1hxmquw@mail.gmail.com>
 <B32CB78D-2CF9-4F47-9515-C8A206C090A2@nuvula.ch>
 <alpine.OSX.1.10.1503311245160.389@sabyasg-mbp-02>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
 <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
Message-ID: <3E5B9556-CB9F-4D5B-8A6D-A615C099BAD7@nuvula.ch>

Hi James

I can try to document it.

4 x Ubuntu 14.04.02 Linux servers running on intel i7 core CPU's, each with 32GB RAM

openvswitch version 2.0.2

All servers with a single NIC in different subnets (hosting provider does that)

Full mesh of the 4 boxes, see graphic here:




ovs config created with:


#!/bin/bash

# initialize script
if [ -z ${1+x} ]; then echo "hostname not set" && exit 0; else echo "hostname is set to '$1'"; fi
if [ -z ${2+x} ]; then echo "password not set" && exit 0; else echo "password is set to '$2'"; fi
if [ -z ${3+x} ]; then echo "ip-address-last-byte not set" && exit 0; else echo "ip-address-last-byte is set to '$3'"; fi

#setup OVS

cp /etc/rc.local /etc/rc.local.save
sed "/exit 0/d" -i /etc/rc.local
echo 'now=$(date +"%m_%d_%Y_%H_%M")' >>/etc/rc.local
echo 'echo $now'
echo iptables-save >>/etc/rc.local
echo route -n >>/etc/rc.local
echo ovs-vsctl show >>/etc/rc.local
echo ifconfig >>/etc/rc.local
echo ping -c 3 8.8.8.8 >>/etc/rc.local
echo service crashplan start >>/etc/rc.local
echo mkdir -p /var/log/boot >>/etc/rc.local
echo 'cp /var/log/boot.log /var/log/boot/"$now".log' >>/etc/rc.local
echo exit 0 >>/etc/rc.local


#install software

service openvswitch-switch stop
sleep 2
apt-get remove openvswitch-switch -y -q --purge

if [ -f /etc/openvswitch/conf.db ]; then rm /etc/openvswitch/conf.db ;fi


echo ifconfig before install openvswitch
ifconfig
route -n


apt-get -y -q install openvswitch-switch


#create bridges and interfaces
gatewayip=$(grep 'gateway'  /etc/network/interfaces | awk -F' ' '{print $2}' | grep \\.)


ovs-vsctl add-br ovsbr0
ovs-vsctl add-port ovsbr0 ovsbr0p1 -- set interface ovsbr0p1 type=internal
#only necessary for guests on esx
#ovs-vsctl set interface ovsbr0p1 mac=\"00:50:56:00:77:09\"
#only necessary for guests on esx

ovs-vsctl add-br ovsbr1
# disable STP until a fix is found for STP issues
ovs-vsctl set bridge ovsbr1 stp_enable=true
ovs-vsctl set bridge ovsbr1 other_config:stp-forward-delay=4
#ovs-vsctl set bridge ovsbr1 stp_enable=false


for i in 1 2 3 4 5 6 7 8 9 10 11 12 101;
do
ovs-vsctl add-br ovsbr1.$i ovsbr1 $i
ovs-vsctl add-port ovsbr1.$i ovsbr1."$i"p1 -- set interface ovsbr1."$i"p1 type=internal
ovs-vsctl set interface ovsbr1.$i mtu=1400
ovs-vsctl set interface ovsbr1."$i"p1 mtu=1400
done



#create local ovs tunnels (disable until STP fix is found)
for x in $(cat /tmp/scripts/servers.txt | sed "s/nuv-vir-kvm-server-//g");

do
hostip=$(dig +short nuv-vir-kvm-server-"$x".)
ovs-vsctl add-port ovsbr1 ovsvx"$x" vlan_mode=trunk -- set interface ovsvx"$x" type=vxlan options:key=flow options:remote_ip="$hostip"
ovs-vsctl set port ovsvx"$x" trunks=1,2,3,4,5,6,7,8,9,10,11,12,101
ovs-vsctl remove port ovsvx"$x" tag 1
done

# create remote ovs tunnels
hostshort=$(echo "$1" |sed "s/nuv-vir-kvm-server-//g")
for y in $(cat /tmp/scripts/servers.txt);
do
hostip=$(dig +short "$1".)
ssh root@"$y". ovs-vsctl add-port ovsbr1 ovsvx$hostshort vlan_mode=trunk -- set interface ovsvx$hostshort type=vxlan options:key=flow options:remote_ip=$hostip
ssh root@"$y". ovs-vsctl set port ovsvx$hostshort trunks=1,2,3,4,5,6,7,8,9,10,11,12,101
ssh root@"$y". ovs-vsctl remove port ovsvx$hostshort tag 1
done


hostnamenr=$(cat /etc/hostname | sed "s/nuv-vir-kvm-server-//g")
ovs-vsctl del-port ovsbr1 ovsvx"$hostnamenr"



#setup /etc/network/interface file

if [ -f  /etc/network/interfaces.default ]; then cp /etc/network/interfaces.default /etc/network/interfaces ; else cp /etc/network/interfaces /etc/network/interfaces.default ;fi

mv  /etc/network/interfaces  /etc/network/interfaces.tmp
sed "s/eth0/ovsbr0p1/g" -i /etc/network/interfaces.tmp
sed "/up route add/d" -i  /etc/network/interfaces.tmp
echo  dns-nameservers 192.168.1.8 >>/etc/network/interfaces.tmp
echo  dns-search  >>/etc/network/interfaces.tmp
echo >>/etc/network/interfaces.tmp
echo auto eth0 >/etc/network/interfaces
echo  iface eth0 inet manual >>/etc/network/interfaces
echo up ifconfig \$IFACE 0.0.0.0 up >>/etc/network/interfaces
echo down ifconfig \$IFACE down >>/etc/network/interfaces
echo >>/etc/network/interfaces
echo auto ovsbr0 >>/etc/network/interfaces
echo  iface ovsbr0 inet manual >>/etc/network/interfaces
echo up ifconfig \$IFACE 0.0.0.0 up >>/etc/network/interfaces
echo down ifconfig \$IFACE down >>/etc/network/interfaces
echo >>/etc/network/interfaces
echo auto ovsbr1 >>/etc/network/interfaces
echo  iface ovsbr1 inet manual >>/etc/network/interfaces
echo up ifconfig \$IFACE 0.0.0.0 up >>/etc/network/interfaces
echo down ifconfig \$IFACE down >>/etc/network/interfaces
echo mtu 1400 >>/etc/network/interfaces
cat /etc/network/interfaces.tmp >>/etc/network/interfaces



for p in 1 ;
do

echo  >>/etc/network/interfaces
echo auto ovsbr1.$p >>/etc/network/interfaces
echo  iface ovsbr1.$p inet manual >>/etc/network/interfaces
echo up ifconfig \$IFACE 0.0.0.0 up >>/etc/network/interfaces
echo down ifconfig \$IFACE down >>/etc/network/interfaces
echo mtu 1400 >>/etc/network/interfaces
echo  >>/etc/network/interfaces
echo auto ovsbr1."$p"p1 >>/etc/network/interfaces
echo iface ovsbr1."$p"p1 inet static >>/etc/network/interfaces
echo address   192.168.$p.$3 >>/etc/network/interfaces
echo  broadcast 192.168.$p.254 >>/etc/network/interfaces
echo  netmask   255.255.255.0 >>/etc/network/interfaces
echo mtu 1400 >>/etc/network/interfaces

done



#get new config active
echo routes before add-port eth0
route -n
ovs-vsctl add-port ovsbr0 eth0 && sudo ifdown -v  --exclude=lo -a && sudo ifup -v --exclude=lo -a
# route del default gw $gatewayip dev eth0
route -n
# ifconfig eth0 down
# ifconfig eth0 up
echo ifconfig before general ifdown ifup
route -n
ifconfig
sleep 5
sudo ifdown -v  --exclude=lo -a
sleep 5
sudo ifup -v --exclude=lo -a
route -n
ifconfig
sleep 5


# enable routing in server
sed "s/#net.ipv4.ip_forward=1/net.ipv4.ip_forward = 1/g" -i /etc/sysctl.conf
sysctl -w net.ipv4.ip_forward=1


#make backup of conf.db file
cp /etc/openvswitch/conf.db /etc/openvswitch/conf.db.default

#workaround for lock bug

echo '#!/bin/bash' >/etc/rc6.d/K01remove_openvswitch_lock
echo "if [ -f /etc/openvswitch/.conf.db.~lock~ ]; then rm /etc/openvswitch/.conf.db.~lock~ ;fi" >>/etc/rc6.d/K01remove_openvswitch_lock
echo "if [ -f /var/lib/openvswitch/.conf.db.~lock~ ]; then rm /var/lib/openvswitch/.conf.db.~lock~ ;fi" >>/etc/rc6.d/K01remove_openvswitch_lock
echo "if [ -f /var/lib/openvswitch/.conf.db.tmp.~lock~ ]; then rm /var/lib/openvswitch/.conf.db.tmp.~lock~ ;fi">>/etc/rc6.d/K01remove_openvswitch_lock
chmod +x /etc/rc6.d/K01remove_openvswitch_lock


# upgrade to 2.3.1
# cd /tmp
#wget http://de.archive.ubuntu.com/ubuntu/pool/main/o/openvswitch/openvswitch-common_2.3.1-0ubuntu1_amd64.deb
#wget http://de.archive.ubuntu.com/ubuntu/pool/main/o/openvswitch/openvswitch-switch_2.3.1-0ubuntu1_amd64.deb
#dpkg -i openvswitch-common_2.3.1-0ubuntu1_amd64.deb
#dpkg -i openvswitch-switch_2.3.1-0ubuntu1_amd64.deb
apt-get install -f


echo ovs_restore_config finished

I hope that is reproducible with all this information.

Cheers
marco






 <http://www.nuvula.ch/>
Marco Kuendig / CEO / Founder 
marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71

Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
Nuvula AG - Hybrid Clouds 
Weierbachstrasse 7b 8193 Eglisau Switzerland 
http://www.nuvula.ch <http://www.nuvula.ch/>
> On 04 Apr 2015, at 16:56, James Page <james.page at canonical.com> wrote:
> 
> 
> Marco
> 
> Great news that you have a reproducer - this has been blocking progress in resolving this issue as in our QA environment we've only seen this infrequently with no clear cause.
> 
> Any chance you could document your setup and specific test case that repros the problem in that bug report?
> 
> If this does turn out to be an optimiser issue we can tweak things and see what helps - a test case that anyone can use will accelerate this process
> 
> Cheers
> 
> James
> --
> James Page
> Technical Lead, OpenStack Engineering Team
> Tel: +44 (0)7545 080150
> 
> 
> On 4 Apr 2015, at 09:10, Marco Kuendig <marco at nuvula.ch <mailto:marco at nuvula.ch>> wrote:
> 
>> Thanks Joe
>> 
>> I have installed from that ppa and tested again. With that version from James I can't not get the crash anymore. I restarted the VM about 50 times and nothing crashed on any server.
>> 
>> So it seems that this fixes the issue, but I'm not quite sure if it lowers performance (not tested, just speculation).
>> 
>> James,
>> 
>> let me know if you want me to test other versions or procedures. I can recreate the crash at will it seems.
>> 
>> Cheers
>> marco
>> 
>> 
>>  <http://www.nuvula.ch/>
>> Marco Kuendig / CEO / Founder 
>> marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71
>> 
>> Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
>> Nuvula AG - Hybrid Clouds 
>> Weierbachstrasse 7b 8193 Eglisau Switzerland 
>> http://www.nuvula.ch <http://www.nuvula.ch/>
>>> On 03 Apr 2015, at 22:47, Joe Stringer <joestringer at nicira.com <mailto:joestringer at nicira.com>> wrote:
>>> 
>>> I guess James missed the email :-) In January he posted some builds for further investigation:
>>> 
>>> https://www.mail-archive.com/discuss at openvswitch.org/msg12049.html <https://www.mail-archive.com/discuss at openvswitch.org/msg12049.html>
>>> 
>>> It sounds like it's the exact same code, but with less compiler optimizations, to see whether this fixed the issue. This might provide a bit more information.
>>> 
>>> On 31 March 2015 at 14:43, Marco Kuendig <marco at nuvula.ch <mailto:marco at nuvula.ch>> wrote:
>>> ok, I have tested it and I can reproduce it. 
>>> 
>>> For testing to reproduce that core: 
>>> 
>>> I have a very small VM on KVM, I start and shutdown that VM every 30 seconds. With that I get:
>>> 
>>> Mar 31 16:10:13 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00010|daemon(monitor)|ERR|9 crashes: pid 10918 died, killed (Segmentation fault), core dumped, restarting
>>> Mar 31 16:29:20 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00011|daemon(monitor)|ERR|10 crashes: pid 22038 died, killed (Segmentation fault), core dumped, restarting
>>> Mar 31 23:33:04 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00012|daemon(monitor)|ERR|11 crashes: pid 25067 died, killed (Segmentation fault), core dumped, restarting
>>> Mar 31 23:34:43 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00013|daemon(monitor)|ERR|12 crashes: pid 30254 died, killed (Segmentation fault), core dumped, restarting
>>> Mar 31 23:38:49 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00014|daemon(monitor)|ERR|13 crashes: pid 31612 died, killed (Segmentation fault), core dumped, restarting
>>> 
>>> The ovs-vswitchd does not restart every cycle but it cores quite often as you can see in the log above.
>>> 
>>> 
>>> 
>>>  <http://www.nuvula.ch/>
>>> Marco Kuendig / CEO / Founder 
>>> marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71 <tel:%2B41%2078%20751%2099%2071>
>>> Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
>>> Nuvula AG - Hybrid Clouds 
>>> Weierbachstrasse 7b 8193 Eglisau Switzerland 
>>> http://www.nuvula.ch <http://www.nuvula.ch/>
>>>> On 31 Mar 2015, at 23:15, Marco Kuendig <marco at nuvula.ch <mailto:marco at nuvula.ch>> wrote:
>>>> 
>>>> I think I can reproduce that bug. Not 100% sure but today I think I had it several times.
>>>> 
>>>> Interesting is that it happens when a VM on kvm boots. Certainly strange is that several hosts crash simultaneously.
>>>> 
>>>> My setup is a lab setup and can be accessed if it helps in troubleshooting.
>>>> 
>>>>  <http://www.nuvula.ch/>
>>>> Marco Kuendig / CEO / Founder 
>>>> marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71 <tel:%2B41%2078%20751%2099%2071>
>>>> Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
>>>> Nuvula AG - Hybrid Clouds 
>>>> Weierbachstrasse 7b 8193 Eglisau Switzerland 
>>>> http://www.nuvula.ch <http://www.nuvula.ch/>
>>>>> On 31 Mar 2015, at 23:12, Joe Stringer <joestringer at nicira.com <mailto:joestringer at nicira.com>> wrote:
>>>>> 
>>>>> James, I believe you were involved last time this bug came up, I wonder if you ever got to the bottom of this?
>>>>> 
>>>>> ---
>>>>> 
>>>>> This looks the same as a bug reported in October:
>>>>> 
>>>>> http://openvswitch.org/pipermail/discuss/2014-October/015429.html <http://openvswitch.org/pipermail/discuss/2014-October/015429.html>
>>>>> 
>>>>> Ben's assessment was that there is no logical issue in the code, so perhaps there was weird code generation caused by GCC.
>>>>> 
>>>>> 
>>>>> On 31 March 2015 at 13:05, Marco Kuendig <marco at nuvula.ch <mailto:marco at nuvula.ch>> wrote:
>>>>> Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
>>>>> done.
>>>>> [New LWP 32725]
>>>>> [New LWP 32732]
>>>>> [New LWP 32726]
>>>>> [New LWP 32730]
>>>>> [New LWP 32727]
>>>>> [New LWP 32728]
>>>>> [New LWP 32729]
>>>>> [New LWP 32731]
>>>>> [Thread debugging using libthread_db enabled]
>>>>> Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
>>>>> Core was generated by `ovs-vswitchd unix:/var/run/openvswitch/db.sock -vconsole:emer -vsyslog:err -vfi'.
>>>>> Program terminated with signal SIGSEGV, Segmentation fault.
>>>>> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
>>>>> 506	../lib/netlink.c: No such file or directory.
>>>>> (gdb) bt
>>>>> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
>>>>> #1  0x0000000000460473 in format_generic_odp_key (a=a at entry=0x0, ds=ds at entry=0x7fff0408f3b0) at ../lib/odp-util.c:767
>>>>> #2  0x0000000000460cd2 in format_odp_key_attr (a=a at entry=0xc485a4, ma=ma at entry=0x0, ds=ds at entry=0x7fff0408f3b0, verbose=verbose at entry=true)
>>>>>     at ../lib/odp-util.c:1332
>>>>> #3  0x00000000004609d7 in odp_flow_format (key=<optimized out>, key_len=40, mask=0x0, mask_len=0, ds=0x7fff0408f3b0, verbose=true) at ../lib/odp-util.c:1402
>>>>> #4  0x0000000000460fc4 in format_odp_key_attr (a=a at entry=0xc48580, ma=ma at entry=0x0, ds=ds at entry=0x7fff0408f3b0, verbose=verbose at entry=true) at ../lib/odp-util.c:987
>>>>> #5  0x00000000004609d7 in odp_flow_format (key=key at entry=0xc48520, key_len=key_len at entry=140, mask=mask at entry=0x0, mask_len=mask_len at entry=0,
>>>>>     ds=ds at entry=0x7fff0408f3b0, verbose=verbose at entry=true) at ../lib/odp-util.c:1402
>>>>> #6  0x00000000004450f3 in log_flow_message (error=error at entry=2, operation=operation at entry=0x4d0e73 "flow_del", key=0xc48520, key_len=140, mask=mask at entry=0x0,
>>>>>     mask_len=mask_len at entry=0, stats=0x0, actions=actions at entry=0x0, actions_len=actions_len at entry=0, dpif=<optimized out>) at ../lib/dpif.c:1354
>>>>> #7  0x00000000004453c9 in log_flow_del_message (dpif=dpif at entry=0xc489c0, del=del at entry=0x7fff0408f460, error=error at entry=2) at ../lib/dpif.c:1397
>>>>> #8  0x0000000000445433 in log_flow_del_message (error=2, del=0x7fff0408f460, dpif=0xc489c0) at ../lib/dpif.c:1396
>>>>> #9  dpif_flow_del__ (dpif=0xc489c0, del=del at entry=0x7fff0408f460) at ../lib/dpif.c:945
>>>>> #10 0x00000000004455ca in dpif_flow_del (dpif=<optimized out>, key=<optimized out>, key_len=<optimized out>, stats=stats at entry=0x7fff0408f490) at ../lib/dpif.c:965
>>>>> #11 0x000000000041b423 in subfacet_uninstall (subfacet=0xbd76a0) at ../ofproto/ofproto-dpif.c:4686
>>>>> #12 0x0000000000420f18 in facet_remove (facet=facet at entry=0xbd72a0) at ../ofproto/ofproto-dpif.c:4014
>>>>> #13 0x0000000000422f52 in facet_revalidate (facet=facet at entry=0xbd72a0) at ../ofproto/ofproto-dpif.c:4321
>>>>> #14 0x0000000000424b5a in facet_lookup_valid (flow=0x7f3e700020a8, ofproto=0xc52600) at ../ofproto/ofproto-dpif.c:4203
>>>>> #15 handle_flow_miss (n_ops=<synthetic pointer>, ops=0x7fff0408fb60, miss=0x7f3e70002090) at ../ofproto/ofproto-dpif.c:3339
>>>>> #16 handle_flow_misses (fmb=fmb at entry=0x7f3e700008e0, backer=<optimized out>) at ../ofproto/ofproto-dpif.c:3410
>>>>> #17 0x0000000000425196 in handle_upcalls (backer=<optimized out>) at ../ofproto/ofproto-dpif.c:3565
>>>>> #18 dpif_backer_run_fast (backer=<optimized out>) at ../ofproto/ofproto-dpif.c:1007
>>>>> #19 type_run_fast (type=<optimized out>) at ../ofproto/ofproto-dpif.c:1024
>>>>> #20 0x00000000004122cf in ofproto_type_run_fast (datapath_type=<optimized out>, datapath_type at entry=0xc4ef20 "system") at ../ofproto/ofproto.c:1326
>>>>> #21 0x00000000004081a5 in bridge_run_fast () at ../vswitchd/bridge.c:2318
>>>>> #22 0x00000000004059c5 in main (argc=<optimized out>, argv=<optimized out>) at ../vswitchd/ovs-vswitchd.c:119
>>>>> (gdb)
>>>>> 
>>>>> 
>>>>> 
>>>>>  <http://www.nuvula.ch/>
>>>>> Marco Kuendig / CEO / Founder 
>>>>> marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71 <tel:%2B41%2078%20751%2099%2071>
>>>>> Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
>>>>> Nuvula AG - Hybrid Clouds 
>>>>> Weierbachstrasse 7b 8193 Eglisau Switzerland 
>>>>> http://www.nuvula.ch <http://www.nuvula.ch/>
>>>>>> On 31 Mar 2015, at 22:04, Joe Stringer <joestringer at nicira.com <mailto:joestringer at nicira.com>> wrote:
>>>>>> 
>>>>>> Great, we're moving. Looks like the gdb version of this is working below. Do you get the gdb prompt from there? the command 'bt' should provide the backtrace we're after.
>>>>>> 
>>>>>> On 31 March 2015 at 12:52, Marco Kuendig <marco at nuvula.ch <mailto:marco at nuvula.ch>> wrote:
>>>>>> that brought us a step forward. thank Sab.
>>>>>> 
>>>>>> Important to know is:
>>>>>> 
>>>>>> I got 4 kvm servers, meshed with openvswitch. I use vxlan for tunnelling.
>>>>>> 
>>>>>> Sometimes when I restart a domain in kvm, 3 or 4 hosts crash at the same time.
>>>>>> 
>>>>>> I have STP enabled to avoid loops.
>>>>>> 
>>>>>> 
>>>>>> this is the output now:
>>>>>> 
>>>>>> root at nuv-vir-kvm-server-1 ~ # gdb /usr/sbin/ovs-vswitchd /var/crash/ovs/CoreDump
>>>>>> GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
>>>>>> Copyright (C) 2014 Free Software Foundation, Inc.
>>>>>> License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html <http://gnu.org/licenses/gpl.html>>
>>>>>> This is free software: you are free to change and redistribute it.
>>>>>> There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
>>>>>> and "show warranty" for details.
>>>>>> This GDB was configured as "x86_64-linux-gnu".
>>>>>> Type "show configuration" for configuration details.
>>>>>> For bug reporting instructions, please see:
>>>>>> <http://www.gnu.org/software/gdb/bugs/ <http://www.gnu.org/software/gdb/bugs/>>.
>>>>>> Find the GDB manual and other documentation resources online at:
>>>>>> <http://www.gnu.org/software/gdb/documentation/ <http://www.gnu.org/software/gdb/documentation/>>.
>>>>>> For help, type "help".
>>>>>> Type "apropos word" to search for commands related to "word"...
>>>>>> Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
>>>>>> done.
>>>>>> [New LWP 32725]
>>>>>> [New LWP 32732]
>>>>>> [New LWP 32726]
>>>>>> [New LWP 32730]
>>>>>> [New LWP 32727]
>>>>>> [New LWP 32728]
>>>>>> [New LWP 32729]
>>>>>> [New LWP 32731]
>>>>>> [Thread debugging using libthread_db enabled]
>>>>>> Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
>>>>>> Core was generated by `ovs-vswitchd unix:/var/run/openvswitch/db.sock -vconsole:emer -vsyslog:err -vfi'.
>>>>>> Program terminated with signal SIGSEGV, Segmentation fault.
>>>>>> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
>>>>>> 506	../lib/netlink.c: No such file or directory.
>>>>>> 
>>>>>> 
>>>>>> root at nuv-vir-kvm-server-1 ~ # crash /usr/sbin/ovs-vswitchd /var/crash/ovs/CoreDump
>>>>>> 
>>>>>> crash 7.0.3
>>>>>> Copyright (C) 2002-2013  Red Hat, Inc.
>>>>>> Copyright (C) 2004, 2005, 2006, 2010  IBM Corporation
>>>>>> Copyright (C) 1999-2006  Hewlett-Packard Co
>>>>>> Copyright (C) 2005, 2006, 2011, 2012  Fujitsu Limited
>>>>>> Copyright (C) 2006, 2007  VA Linux Systems Japan K.K.
>>>>>> Copyright (C) 2005, 2011  NEC Corporation
>>>>>> Copyright (C) 1999, 2002, 2007  Silicon Graphics, Inc.
>>>>>> Copyright (C) 1999, 2000, 2001, 2002  Mission Critical Linux, Inc.
>>>>>> This program is free software, covered by the GNU General Public License,
>>>>>> and you are welcome to change it and/or distribute copies of it under
>>>>>> certain conditions.  Enter "help copying" to see the conditions.
>>>>>> This program has absolutely no warranty.  Enter "help warranty" for details.
>>>>>> 
>>>>>> 
>>>>>> crash: /usr/sbin/ovs-vswitchd: no debugging data available
>>>>>> 
>>>>>> root at nuv-vir-kvm-server-1 ~ # ll /var/crash/ovs/
>>>>>> Architecture         Date                 ExecutableTimestamp  ProcCwd              ProcStatus           UserGroups
>>>>>> CoreDump             DistroRelease        ProblemType          ProcEnviron          Signal
>>>>>> CrashCounter         ExecutablePath       ProcCmdline          ProcMaps             Uname
>>>>>> 
>>>>>>  <http://www.nuvula.ch/>
>>>>>> Marco Kuendig / CEO / Founder 
>>>>>> marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71 <tel:%2B41%2078%20751%2099%2071>
>>>>>> Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
>>>>>> Nuvula AG - Hybrid Clouds 
>>>>>> Weierbachstrasse 7b 8193 Eglisau Switzerland 
>>>>>> http://www.nuvula.ch <http://www.nuvula.ch/>
>>>>>> 
>>>>>>> On 31 Mar 2015, at 21:45, Sabyasachi Sengupta <Sabyasachi.Sengupta at alcatel-lucent.com <mailto:Sabyasachi.Sengupta at alcatel-lucent.com>> wrote:
>>>>>>> 
>>>>>>> 
>>>>>>> Typically Ubuntu does not unpack the crashes. Can you try apport-unpack?
>>>>>>> # apport-unpack /var/crash/<name> <crash-dir>
>>>>>>> 
>>>>>>> On Tue, 31 Mar 2015, Marco Kuendig wrote:
>>>>>>> 
>>>>>>>> thanks Joe and Ben
>>>>>>>> have done:
>>>>>>>> 1. installed dgb symbols for kernel....doesn't help
>>>>>>>> 2. installed debug symbols for openvswitch
>>>>>>>> no change, gdb and crash still don't work for me. I'm not a dev, need
>>>>>>>> more help to get that backtrace done.
>>>>>>>> here some output:
>>>>>>>> root at nuv-vir-kvm-server-1 ~ # crash
>>>>>>>>  /usr/lib/debug/boot/vmlinux-3.13.0-48-generic
>>>>>>>> /var/crash/_usr_sbin_ovs-vswitchd.0.crash
>>>>>>>> crash 7.0.3
>>>>>>>> Copyright (C) 2002-2013  Red Hat, Inc.
>>>>>>>> Copyright (C) 2004, 2005, 2006, 2010  IBM Corporation
>>>>>>>> Copyright (C) 1999-2006  Hewlett-Packard Co
>>>>>>>> Copyright (C) 2005, 2006, 2011, 2012  Fujitsu Limited
>>>>>>>> Copyright (C) 2006, 2007  VA Linux Systems Japan K.K.
>>>>>>>> Copyright (C) 2005, 2011  NEC Corporation
>>>>>>>> Copyright (C) 1999, 2002, 2007  Silicon Graphics, Inc.
>>>>>>>> Copyright (C) 1999, 2000, 2001, 2002  Mission Critical Linux, Inc.
>>>>>>>> This program is free software, covered by the GNU General Public License,
>>>>>>>> and you are welcome to change it and/or distribute copies of it under
>>>>>>>> certain conditions.  Enter "help copying" to see the conditions.
>>>>>>>> This program has absolutely no warranty.  Enter "help warranty" for
>>>>>>>> details.
>>>>>>>> crash: /var/crash/_usr_sbin_ovs-vswitchd.0.crash: not a supported file
>>>>>>>> format
>>>>>>>> Usage:
>>>>>>>> 
>>>>>>>>   crash [OPTION]... NAMELIST MEMORY-IMAGE  (dumpfile form)
>>>>>>>>   crash [OPTION]... [NAMELIST]             (live system form)
>>>>>>>> Enter "crash -h" for details.
>>>>>>>> root at nuv-vir-kvm-server-1 ~ # gdb /usr/sbin/ovs-vswitchd
>>>>>>>> /var/crash/_usr_sbin_ovs-vswitchd.0.crash
>>>>>>>> GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
>>>>>>>> Copyright (C) 2014 Free Software Foundation, Inc.
>>>>>>>> License GPLv3+: GNU GPL version 3 or later
>>>>>>>> <http://gnu.org/licenses/gpl.html <http://gnu.org/licenses/gpl.html>>
>>>>>>>> This is free software: you are free to change and redistribute it.
>>>>>>>> There is NO WARRANTY, to the extent permitted by law.  Type "show
>>>>>>>> copying"
>>>>>>>> and "show warranty" for details.
>>>>>>>> This GDB was configured as "x86_64-linux-gnu".
>>>>>>>> Type "show configuration" for configuration details.
>>>>>>>> For bug reporting instructions, please see:
>>>>>>>> <http://www.gnu.org/software/gdb/bugs/ <http://www.gnu.org/software/gdb/bugs/>>.
>>>>>>>> Find the GDB manual and other documentation resources online at:
>>>>>>>> <http://www.gnu.org/software/gdb/documentation/ <http://www.gnu.org/software/gdb/documentation/>>.
>>>>>>>> For help, type "help".
>>>>>>>> Type "apropos word" to search for commands related to "word"...
>>>>>>>> Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from
>>>>>>>> /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
>>>>>>>> done.
>>>>>>>> "/var/crash/_usr_sbin_ovs-vswitchd.0.crash" is not a core dump: File
>>>>>>>> format not recognized
>>>>>>>> (gdb) q
>>>>>>>> root at nuv-vir-kvm-server-1 ~ #
>>>>>>>> Nuvula AG
>>>>>>>> Marco Kuendig / CEO / Founder marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71 <tel:%2B41%2078%20751%2099%2071>
>>>>>>>> Marco's Google Hangout
>>>>>>>> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau Switzerland http://www.nuvula.ch <http://www.nuvula.ch/>
>>>>>>>> 
>>>>>>>>      On 31 Mar 2015, at 19:00, Joe Stringer
>>>>>>>>      <joestringer at nicira.com <mailto:joestringer at nicira.com>> wrote:
>>>>>>>> For the 'File format not recognized' problem, you might have better
>>>>>>>> luck with the 'crash' utility.
>>>>>>>> $ crash <binary> <crashdump>
>>>>>>>> On 31 March 2015 at 08:16, Marco Kuendig <marco at nuvula.ch <mailto:marco at nuvula.ch>> wrote:
>>>>>>>>      Have tried this:
>>>>>>>> http://openvswitch.org/pipermail/discuss/2015-February/016582.html <http://openvswitch.org/pipermail/discuss/2015-February/016582.html>
>>>>>>>> this is the output, so doesn't seem to be correct:
>>>>>>>> root at nuv-vir-kvm-server-2 ~ # gdb /usr/sbin/ovs-vswitchd
>>>>>>>> /var/crash/_usr_sbin_ovs-vswitchd.0.crash
>>>>>>>> GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
>>>>>>>> Copyright (C) 2014 Free Software Foundation, Inc.
>>>>>>>> License GPLv3+: GNU GPL version 3 or later
>>>>>>>> <http://gnu.org/licenses/gpl.html <http://gnu.org/licenses/gpl.html>>
>>>>>>>> This is free software: you are free to change and
>>>>>>>> redistribute it.
>>>>>>>> There is NO WARRANTY, to the extent permitted by law.  Type
>>>>>>>> "show copying"
>>>>>>>> and "show warranty" for details.
>>>>>>>> This GDB was configured as "x86_64-linux-gnu".
>>>>>>>> Type "show configuration" for configuration details.
>>>>>>>> For bug reporting instructions, please see:
>>>>>>>> <http://www.gnu.org/software/gdb/bugs/ <http://www.gnu.org/software/gdb/bugs/>>.
>>>>>>>> Find the GDB manual and other documentation resources online
>>>>>>>> at:
>>>>>>>> <http://www.gnu.org/software/gdb/documentation/ <http://www.gnu.org/software/gdb/documentation/>>.
>>>>>>>> For help, type "help".
>>>>>>>> Type "apropos word" to search for commands related to
>>>>>>>> "word"...
>>>>>>>> Reading symbols from /usr/sbin/ovs-vswitchd...(no debugging
>>>>>>>> symbols found)...done.
>>>>>>>> "/var/crash/_usr_sbin_ovs-vswitchd.0.crash" is not a core
>>>>>>>> dump: File format not recognized
>>>>>>>> (gdb) bt
>>>>>>>> No stack.
>>>>>>>> (gdb) quit
>>>>>>>> any more hints please ?
>>>>>>>> thanks
>>>>>>>> marco
>>>>>>>> Nuvula AG
>>>>>>>> Marco Kuendig / CEO / Founder marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71 <tel:%2B41%2078%20751%2099%2071>
>>>>>>>> Marco's Google Hangout
>>>>>>>> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau Switzerland http://www.nuvula.ch <http://www.nuvula.ch/>
>>>>>>>> 
>>>>>>>>      On 31 Mar 2015, at 17:00, Ben Pfaff
>>>>>>>>      <blp at nicira.com <mailto:blp at nicira.com>> wrote:
>>>>>>>> Can you get a backtrace for these?
>>>>>>>> On Tue, Mar 31, 2015 at 7:09 AM, Marco Kuendig
>>>>>>>> <marco at nuvula.ch <mailto:marco at nuvula.ch>> wrote:
>>>>>>>>      Folks,
>>>>>>>> any chance of having somebody look at these crash
>>>>>>>> files ?
>>>>>>>> I have several servers that are loosing network
>>>>>>>> connectivity because of this.
>>>>>>>> Downloads:
>>>>>>>> https://drive.google.com/file/d/0Bx_w1Tf2B5VSRU9yUmRpTDJLVEU/view?usp=sharing <https://drive.google.com/file/d/0Bx_w1Tf2B5VSRU9yUmRpTDJLVEU/view?usp=sharing>
>>>>>>>> Thanks for any hint or fix
>>>>>>>> marco
>>>>>>>> Nuvula AG
>>>>>>>> Marco Kuendig / CEO / Founder marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71 <tel:%2B41%2078%20751%2099%2071>
>>>>>>>> Marco's Google Hangout
>>>>>>>> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau Switzerland http://www.nuvula.ch <http://www.nuvula.ch/>
>>>>>>>> _______________________________________________
>>>>>>>> discuss mailing list
>>>>>>>> discuss at openvswitch.org <mailto:discuss at openvswitch.org>
>>>>>>>> http://openvswitch.org/mailman/listinfo/discuss <http://openvswitch.org/mailman/listinfo/discuss>
>>>>>>>> --
>>>>>>>> "I don't normally do acked-by's.  I think it's my way
>>>>>>>> of avoiding
>>>>>>>> getting blamed when it all blows up." Andrew Morton
>>>>>>>> _______________________________________________
>>>>>>>> discuss mailing list
>>>>>>>> discuss at openvswitch.org <mailto:discuss at openvswitch.org>
>>>>>>>> http://openvswitch.org/mailman/listinfo/discuss <http://openvswitch.org/mailman/listinfo/discuss>
>>>>>> 
>>>>> 
>>>>> 
>>>> 
>>> 
>>> 
>> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150404/a7f9990a/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PastedGraphic-1.png
Type: image/png
Size: 91859 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150404/a7f9990a/attachment-0001.png>

From james.page at ubuntu.com  Sat Apr  4 08:17:57 2015
From: james.page at ubuntu.com (James Page)
Date: Sat, 4 Apr 2015 16:17:57 +0100
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <3E5B9556-CB9F-4D5B-8A6D-A615C099BAD7@nuvula.ch>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <CACjuMbx+-uhyvpX1tyPhsdyVtT3DFDd8Kq_LAH-7iKhaz-UmkA@mail.gmail.com>
 <8C992B4E-8AA6-46A2-863D-9C9FBC6D4D16@nuvula.ch>
 <CANr6G5yB6jiYD+fwYhtPDh3bxams3PNTZLqd25DVcyU1hxmquw@mail.gmail.com>
 <B32CB78D-2CF9-4F47-9515-C8A206C090A2@nuvula.ch>
 <alpine.OSX.1.10.1503311245160.389@sabyasg-mbp-02>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
 <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
 <3E5B9556-CB9F-4D5B-8A6D-A615C099BAD7@nuvula.ch>
Message-ID: <3FE189EC-49E0-47CC-BD59-2F6E7B04B9A4@ubuntu.com>


I'd missed the fact that you where upgrading to 2.3.1 - which kernel version are you using?

--
James Page
Technical Lead, OpenStack Engineering Team
Tel: +44 (0)7545 080150


> On 4 Apr 2015, at 16:04, Marco Kuendig <marco at nuvula.ch> wrote:
> 
> # upgrade to 2.3.1
> # cd /tmp
> #wget http://de.archive.ubuntu.com/ubuntu/pool/main/o/openvswitch/openvswitch-common_2.3.1-0ubuntu1_amd64.deb
> #wget http://de.archive.ubuntu.com/ubuntu/pool/main/o/openvswitch/openvswitch-switch_2.3.1-0ubuntu1_amd64.deb
> #dpkg -i openvswitch-common_2.3.1-0ubuntu1_amd64.deb
> #dpkg -i openvswitch-switch_2.3.1-0ubuntu1_amd64.deb
> apt-get install -f
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150404/4199d1a0/attachment.html>

From marco at nuvula.ch  Sat Apr  4 08:19:28 2015
From: marco at nuvula.ch (Marco Kuendig)
Date: Sat, 4 Apr 2015 17:19:28 +0200
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <3FE189EC-49E0-47CC-BD59-2F6E7B04B9A4@ubuntu.com>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <CACjuMbx+-uhyvpX1tyPhsdyVtT3DFDd8Kq_LAH-7iKhaz-UmkA@mail.gmail.com>
 <8C992B4E-8AA6-46A2-863D-9C9FBC6D4D16@nuvula.ch>
 <CANr6G5yB6jiYD+fwYhtPDh3bxams3PNTZLqd25DVcyU1hxmquw@mail.gmail.com>
 <B32CB78D-2CF9-4F47-9515-C8A206C090A2@nuvula.ch>
 <alpine.OSX.1.10.1503311245160.389@sabyasg-mbp-02>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
 <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
 <3E5B9556-CB9F-4D5B-8A6D-A615C099BAD7@nuvula.ch>
 <3FE189EC-49E0-47CC-BD59-2F6E7B04B9A4@ubuntu.com>
Message-ID: <8CE70C04-9A31-4499-938A-85EC4D13E0BB@nuvula.ch>

nope, as you can see this is commented out. Did try that once but disabled as I recognised that ovs and kernel version have a linkage.

I have kernel 3.13.0.48

currently all servers run ovs 2.0.2

 <http://www.nuvula.ch/>
Marco Kuendig / CEO / Founder 
marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71

Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
Nuvula AG - Hybrid Clouds 
Weierbachstrasse 7b 8193 Eglisau Switzerland 
http://www.nuvula.ch <http://www.nuvula.ch/>
> On 04 Apr 2015, at 17:17, James Page <james.page at ubuntu.com> wrote:
> 
> 
> I'd missed the fact that you where upgrading to 2.3.1 - which kernel version are you using?
> 
> --
> James Page
> Technical Lead, OpenStack Engineering Team
> Tel: +44 (0)7545 080150
> 
> 
> On 4 Apr 2015, at 16:04, Marco Kuendig <marco at nuvula.ch <mailto:marco at nuvula.ch>> wrote:
> 
>> # upgrade to 2.3.1
>> # cd /tmp
>> #wget http://de.archive.ubuntu.com/ubuntu/pool/main/o/openvswitch/openvswitch-common_2.3.1-0ubuntu1_amd64.deb <http://de.archive.ubuntu.com/ubuntu/pool/main/o/openvswitch/openvswitch-common_2.3.1-0ubuntu1_amd64.deb>
>> #wget http://de.archive.ubuntu.com/ubuntu/pool/main/o/openvswitch/openvswitch-switch_2.3.1-0ubuntu1_amd64.deb <http://de.archive.ubuntu.com/ubuntu/pool/main/o/openvswitch/openvswitch-switch_2.3.1-0ubuntu1_amd64.deb>
>> #dpkg -i openvswitch-common_2.3.1-0ubuntu1_amd64.deb
>> #dpkg -i openvswitch-switch_2.3.1-0ubuntu1_amd64.deb
>> apt-get install -f

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150404/a5fc79af/attachment.html>

From james.page at ubuntu.com  Sat Apr  4 08:27:30 2015
From: james.page at ubuntu.com (James Page)
Date: Sat, 4 Apr 2015 16:27:30 +0100
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <8CE70C04-9A31-4499-938A-85EC4D13E0BB@nuvula.ch>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <CACjuMbx+-uhyvpX1tyPhsdyVtT3DFDd8Kq_LAH-7iKhaz-UmkA@mail.gmail.com>
 <8C992B4E-8AA6-46A2-863D-9C9FBC6D4D16@nuvula.ch>
 <CANr6G5yB6jiYD+fwYhtPDh3bxams3PNTZLqd25DVcyU1hxmquw@mail.gmail.com>
 <B32CB78D-2CF9-4F47-9515-C8A206C090A2@nuvula.ch>
 <alpine.OSX.1.10.1503311245160.389@sabyasg-mbp-02>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
 <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
 <3E5B9556-CB9F-4D5B-8A6D-A615C099BAD7@nuvula.ch>
 <3FE189EC-49E0-47CC-BD59-2F6E7B04B9A4@ubuntu.com>
 <8CE70C04-9A31-4499-938A-85EC4D13E0BB@ nuvula.ch>
Message-ID: <C222441F-23C1-470A-987E-123B00879EA9@ubuntu.com>

Sorry - missed that (phone email only this weekend).

Will look in full next week once I'm fully back online.

--
James Page
Technical Lead, OpenStack Engineering Team
Tel: +44 (0)7545 080150


> On 4 Apr 2015, at 16:19, Marco Kuendig <marco at nuvula.ch> wrote:
> 
> nope, as you can see this is commented out. Did try that once but disabled as I recognised that ovs and kernel version have a linkage.
> 
> I have kernel 3.13.0.48
> 
> currently all servers run ovs 2.0.2
> 
> 
> 
> Marco Kuendig / CEO / Founder 
> marco at nuvula.ch / +41 78 751 99 71
> 
> Marco's Google Hangout
> 
> Nuvula AG - Hybrid Clouds 
> Weierbachstrasse 7b 8193 Eglisau Switzerland 
> http://www.nuvula.ch
> 
> 
>> On 04 Apr 2015, at 17:17, James Page <james.page at ubuntu.com> wrote:
>> 
>> 
>> I'd missed the fact that you where upgrading to 2.3.1 - which kernel version are you using?
>> 
>> --
>> James Page
>> Technical Lead, OpenStack Engineering Team
>> Tel: +44 (0)7545 080150
>> 
>> 
>>> On 4 Apr 2015, at 16:04, Marco Kuendig <marco at nuvula.ch> wrote:
>>> 
>>> # upgrade to 2.3.1
>>> # cd /tmp
>>> #wget http://de.archive.ubuntu.com/ubuntu/pool/main/o/openvswitch/openvswitch-common_2.3.1-0ubuntu1_amd64.deb
>>> #wget http://de.archive.ubuntu.com/ubuntu/pool/main/o/openvswitch/openvswitch-switch_2.3.1-0ubuntu1_amd64.deb
>>> #dpkg -i openvswitch-common_2.3.1-0ubuntu1_amd64.deb
>>> #dpkg -i openvswitch-switch_2.3.1-0ubuntu1_amd64.deb
>>> apt-get install -f
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150404/45a9a3b7/attachment-0001.html>

From james.page at canonical.com  Sat Apr  4 07:56:02 2015
From: james.page at canonical.com (James Page)
Date: Sat, 4 Apr 2015 15:56:02 +0100
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <CACjuMbx+-uhyvpX1tyPhsdyVtT3DFDd8Kq_LAH-7iKhaz-UmkA@mail.gmail.com>
 <8C992B4E-8AA6-46A2-863D-9C9FBC6D4D16@nuvula.ch>
 <CANr6G5yB6jiYD+fwYhtPDh3bxams3PNTZLqd25DVcyU1hxmquw@mail.gmail.com>
 <B32CB78D-2CF9-4F47-9515-C8A206C090A2@nuvula.ch>
 <alpine.OSX.1.10.1503311245160.389@sabyasg-mbp-02>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
Message-ID: <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>


Marco

Great news that you have a reproducer - this has been blocking progress in resolving this issue as in our QA environment we've only seen this infrequently with no clear cause.

Any chance you could document your setup and specific test case that repros the problem in that bug report?

If this does turn out to be an optimiser issue we can tweak things and see what helps - a test case that anyone can use will accelerate this process

Cheers

James
--
James Page
Technical Lead, OpenStack Engineering Team
Tel: +44 (0)7545 080150


> On 4 Apr 2015, at 09:10, Marco Kuendig <marco at nuvula.ch> wrote:
> 
> Thanks Joe
> 
> I have installed from that ppa and tested again. With that version from James I can't not get the crash anymore. I restarted the VM about 50 times and nothing crashed on any server.
> 
> So it seems that this fixes the issue, but I'm not quite sure if it lowers performance (not tested, just speculation).
> 
> James,
> 
> let me know if you want me to test other versions or procedures. I can recreate the crash at will it seems.
> 
> Cheers
> marco
> 
> 
> 
> 
> Marco Kuendig / CEO / Founder 
> marco at nuvula.ch / +41 78 751 99 71
> 
> Marco's Google Hangout
> 
> Nuvula AG - Hybrid Clouds 
> Weierbachstrasse 7b 8193 Eglisau Switzerland 
> http://www.nuvula.ch
> 
> 
>> On 03 Apr 2015, at 22:47, Joe Stringer <joestringer at nicira.com> wrote:
>> 
>> I guess James missed the email :-) In January he posted some builds for further investigation:
>> 
>> https://www.mail-archive.com/discuss at openvswitch.org/msg12049.html
>> 
>> It sounds like it's the exact same code, but with less compiler optimizations, to see whether this fixed the issue. This might provide a bit more information.
>> 
>>> On 31 March 2015 at 14:43, Marco Kuendig <marco at nuvula.ch> wrote:
>>> ok, I have tested it and I can reproduce it. 
>>> 
>>> For testing to reproduce that core: 
>>> 
>>> I have a very small VM on KVM, I start and shutdown that VM every 30 seconds. With that I get:
>>> 
>>> Mar 31 16:10:13 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00010|daemon(monitor)|ERR|9 crashes: pid 10918 died, killed (Segmentation fault), core dumped, restarting
>>> Mar 31 16:29:20 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00011|daemon(monitor)|ERR|10 crashes: pid 22038 died, killed (Segmentation fault), core dumped, restarting
>>> Mar 31 23:33:04 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00012|daemon(monitor)|ERR|11 crashes: pid 25067 died, killed (Segmentation fault), core dumped, restarting
>>> Mar 31 23:34:43 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00013|daemon(monitor)|ERR|12 crashes: pid 30254 died, killed (Segmentation fault), core dumped, restarting
>>> Mar 31 23:38:49 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00014|daemon(monitor)|ERR|13 crashes: pid 31612 died, killed (Segmentation fault), core dumped, restarting
>>> 
>>> The ovs-vswitchd does not restart every cycle but it cores quite often as you can see in the log above.
>>> 
>>> 
>>> 
>>> 
>>> 
>>> Marco Kuendig / CEO / Founder 
>>> marco at nuvula.ch / +41 78 751 99 71
>>> 
>>> Marco's Google Hangout
>>> 
>>> Nuvula AG - Hybrid Clouds 
>>> Weierbachstrasse 7b 8193 Eglisau Switzerland 
>>> http://www.nuvula.ch
>>> 
>>> 
>>>> On 31 Mar 2015, at 23:15, Marco Kuendig <marco at nuvula.ch> wrote:
>>>> 
>>>> I think I can reproduce that bug. Not 100% sure but today I think I had it several times.
>>>> 
>>>> Interesting is that it happens when a VM on kvm boots. Certainly strange is that several hosts crash simultaneously.
>>>> 
>>>> My setup is a lab setup and can be accessed if it helps in troubleshooting.
>>>> 
>>>> 
>>>> 
>>>> Marco Kuendig / CEO / Founder 
>>>> marco at nuvula.ch / +41 78 751 99 71
>>>> 
>>>> Marco's Google Hangout
>>>> 
>>>> Nuvula AG - Hybrid Clouds 
>>>> Weierbachstrasse 7b 8193 Eglisau Switzerland 
>>>> http://www.nuvula.ch
>>>> 
>>>> 
>>>>> On 31 Mar 2015, at 23:12, Joe Stringer <joestringer at nicira.com> wrote:
>>>>> 
>>>>> James, I believe you were involved last time this bug came up, I wonder if you ever got to the bottom of this?
>>>>> 
>>>>> ---
>>>>> 
>>>>> This looks the same as a bug reported in October:
>>>>> 
>>>>> http://openvswitch.org/pipermail/discuss/2014-October/015429.html
>>>>> 
>>>>> Ben's assessment was that there is no logical issue in the code, so perhaps there was weird code generation caused by GCC.
>>>>> 
>>>>> 
>>>>>> On 31 March 2015 at 13:05, Marco Kuendig <marco at nuvula.ch> wrote:
>>>>>> Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
>>>>>> done.
>>>>>> [New LWP 32725]
>>>>>> [New LWP 32732]
>>>>>> [New LWP 32726]
>>>>>> [New LWP 32730]
>>>>>> [New LWP 32727]
>>>>>> [New LWP 32728]
>>>>>> [New LWP 32729]
>>>>>> [New LWP 32731]
>>>>>> [Thread debugging using libthread_db enabled]
>>>>>> Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
>>>>>> Core was generated by `ovs-vswitchd unix:/var/run/openvswitch/db.sock -vconsole:emer -vsyslog:err -vfi'.
>>>>>> Program terminated with signal SIGSEGV, Segmentation fault.
>>>>>> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
>>>>>> 506	../lib/netlink.c: No such file or directory.
>>>>>> (gdb) bt
>>>>>> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
>>>>>> #1  0x0000000000460473 in format_generic_odp_key (a=a at entry=0x0, ds=ds at entry=0x7fff0408f3b0) at ../lib/odp-util.c:767
>>>>>> #2  0x0000000000460cd2 in format_odp_key_attr (a=a at entry=0xc485a4, ma=ma at entry=0x0, ds=ds at entry=0x7fff0408f3b0, verbose=verbose at entry=true)
>>>>>>     at ../lib/odp-util.c:1332
>>>>>> #3  0x00000000004609d7 in odp_flow_format (key=<optimized out>, key_len=40, mask=0x0, mask_len=0, ds=0x7fff0408f3b0, verbose=true) at ../lib/odp-util.c:1402
>>>>>> #4  0x0000000000460fc4 in format_odp_key_attr (a=a at entry=0xc48580, ma=ma at entry=0x0, ds=ds at entry=0x7fff0408f3b0, verbose=verbose at entry=true) at ../lib/odp-util.c:987
>>>>>> #5  0x00000000004609d7 in odp_flow_format (key=key at entry=0xc48520, key_len=key_len at entry=140, mask=mask at entry=0x0, mask_len=mask_len at entry=0,
>>>>>>     ds=ds at entry=0x7fff0408f3b0, verbose=verbose at entry=true) at ../lib/odp-util.c:1402
>>>>>> #6  0x00000000004450f3 in log_flow_message (error=error at entry=2, operation=operation at entry=0x4d0e73 "flow_del", key=0xc48520, key_len=140, mask=mask at entry=0x0,
>>>>>>     mask_len=mask_len at entry=0, stats=0x0, actions=actions at entry=0x0, actions_len=actions_len at entry=0, dpif=<optimized out>) at ../lib/dpif.c:1354
>>>>>> #7  0x00000000004453c9 in log_flow_del_message (dpif=dpif at entry=0xc489c0, del=del at entry=0x7fff0408f460, error=error at entry=2) at ../lib/dpif.c:1397
>>>>>> #8  0x0000000000445433 in log_flow_del_message (error=2, del=0x7fff0408f460, dpif=0xc489c0) at ../lib/dpif.c:1396
>>>>>> #9  dpif_flow_del__ (dpif=0xc489c0, del=del at entry=0x7fff0408f460) at ../lib/dpif.c:945
>>>>>> #10 0x00000000004455ca in dpif_flow_del (dpif=<optimized out>, key=<optimized out>, key_len=<optimized out>, stats=stats at entry=0x7fff0408f490) at ../lib/dpif.c:965
>>>>>> #11 0x000000000041b423 in subfacet_uninstall (subfacet=0xbd76a0) at ../ofproto/ofproto-dpif.c:4686
>>>>>> #12 0x0000000000420f18 in facet_remove (facet=facet at entry=0xbd72a0) at ../ofproto/ofproto-dpif.c:4014
>>>>>> #13 0x0000000000422f52 in facet_revalidate (facet=facet at entry=0xbd72a0) at ../ofproto/ofproto-dpif.c:4321
>>>>>> #14 0x0000000000424b5a in facet_lookup_valid (flow=0x7f3e700020a8, ofproto=0xc52600) at ../ofproto/ofproto-dpif.c:4203
>>>>>> #15 handle_flow_miss (n_ops=<synthetic pointer>, ops=0x7fff0408fb60, miss=0x7f3e70002090) at ../ofproto/ofproto-dpif.c:3339
>>>>>> #16 handle_flow_misses (fmb=fmb at entry=0x7f3e700008e0, backer=<optimized out>) at ../ofproto/ofproto-dpif.c:3410
>>>>>> #17 0x0000000000425196 in handle_upcalls (backer=<optimized out>) at ../ofproto/ofproto-dpif.c:3565
>>>>>> #18 dpif_backer_run_fast (backer=<optimized out>) at ../ofproto/ofproto-dpif.c:1007
>>>>>> #19 type_run_fast (type=<optimized out>) at ../ofproto/ofproto-dpif.c:1024
>>>>>> #20 0x00000000004122cf in ofproto_type_run_fast (datapath_type=<optimized out>, datapath_type at entry=0xc4ef20 "system") at ../ofproto/ofproto.c:1326
>>>>>> #21 0x00000000004081a5 in bridge_run_fast () at ../vswitchd/bridge.c:2318
>>>>>> #22 0x00000000004059c5 in main (argc=<optimized out>, argv=<optimized out>) at ../vswitchd/ovs-vswitchd.c:119
>>>>>> (gdb)
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>> Marco Kuendig / CEO / Founder 
>>>>>> marco at nuvula.ch / +41 78 751 99 71
>>>>>> 
>>>>>> Marco's Google Hangout
>>>>>> 
>>>>>> Nuvula AG - Hybrid Clouds 
>>>>>> Weierbachstrasse 7b 8193 Eglisau Switzerland 
>>>>>> http://www.nuvula.ch
>>>>>> 
>>>>>> 
>>>>>>> On 31 Mar 2015, at 22:04, Joe Stringer <joestringer at nicira.com> wrote:
>>>>>>> 
>>>>>>> Great, we're moving. Looks like the gdb version of this is working below. Do you get the gdb prompt from there? the command 'bt' should provide the backtrace we're after.
>>>>>>> 
>>>>>>> On 31 March 2015 at 12:52, Marco Kuendig <marco at nuvula.ch> wrote:
>>>>>>>> that brought us a step forward. thank Sab.
>>>>>>>> 
>>>>>>>> Important to know is:
>>>>>>>> 
>>>>>>>> I got 4 kvm servers, meshed with openvswitch. I use vxlan for tunnelling.
>>>>>>>> 
>>>>>>>> Sometimes when I restart a domain in kvm, 3 or 4 hosts crash at the same time.
>>>>>>>> 
>>>>>>>> I have STP enabled to avoid loops.
>>>>>>>> 
>>>>>>>> 
>>>>>>>> this is the output now:
>>>>>>>> 
>>>>>>>> root at nuv-vir-kvm-server-1 ~ # gdb /usr/sbin/ovs-vswitchd /var/crash/ovs/CoreDump
>>>>>>>> GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
>>>>>>>> Copyright (C) 2014 Free Software Foundation, Inc.
>>>>>>>> License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
>>>>>>>> This is free software: you are free to change and redistribute it.
>>>>>>>> There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
>>>>>>>> and "show warranty" for details.
>>>>>>>> This GDB was configured as "x86_64-linux-gnu".
>>>>>>>> Type "show configuration" for configuration details.
>>>>>>>> For bug reporting instructions, please see:
>>>>>>>> <http://www.gnu.org/software/gdb/bugs/>.
>>>>>>>> Find the GDB manual and other documentation resources online at:
>>>>>>>> <http://www.gnu.org/software/gdb/documentation/>.
>>>>>>>> For help, type "help".
>>>>>>>> Type "apropos word" to search for commands related to "word"...
>>>>>>>> Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
>>>>>>>> done.
>>>>>>>> [New LWP 32725]
>>>>>>>> [New LWP 32732]
>>>>>>>> [New LWP 32726]
>>>>>>>> [New LWP 32730]
>>>>>>>> [New LWP 32727]
>>>>>>>> [New LWP 32728]
>>>>>>>> [New LWP 32729]
>>>>>>>> [New LWP 32731]
>>>>>>>> [Thread debugging using libthread_db enabled]
>>>>>>>> Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
>>>>>>>> Core was generated by `ovs-vswitchd unix:/var/run/openvswitch/db.sock -vconsole:emer -vsyslog:err -vfi'.
>>>>>>>> Program terminated with signal SIGSEGV, Segmentation fault.
>>>>>>>> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
>>>>>>>> 506	../lib/netlink.c: No such file or directory.
>>>>>>>> 
>>>>>>>> 
>>>>>>>> root at nuv-vir-kvm-server-1 ~ # crash /usr/sbin/ovs-vswitchd /var/crash/ovs/CoreDump
>>>>>>>> 
>>>>>>>> crash 7.0.3
>>>>>>>> Copyright (C) 2002-2013  Red Hat, Inc.
>>>>>>>> Copyright (C) 2004, 2005, 2006, 2010  IBM Corporation
>>>>>>>> Copyright (C) 1999-2006  Hewlett-Packard Co
>>>>>>>> Copyright (C) 2005, 2006, 2011, 2012  Fujitsu Limited
>>>>>>>> Copyright (C) 2006, 2007  VA Linux Systems Japan K.K.
>>>>>>>> Copyright (C) 2005, 2011  NEC Corporation
>>>>>>>> Copyright (C) 1999, 2002, 2007  Silicon Graphics, Inc.
>>>>>>>> Copyright (C) 1999, 2000, 2001, 2002  Mission Critical Linux, Inc.
>>>>>>>> This program is free software, covered by the GNU General Public License,
>>>>>>>> and you are welcome to change it and/or distribute copies of it under
>>>>>>>> certain conditions.  Enter "help copying" to see the conditions.
>>>>>>>> This program has absolutely no warranty.  Enter "help warranty" for details.
>>>>>>>> 
>>>>>>>> 
>>>>>>>> crash: /usr/sbin/ovs-vswitchd: no debugging data available
>>>>>>>> 
>>>>>>>> root at nuv-vir-kvm-server-1 ~ # ll /var/crash/ovs/
>>>>>>>> Architecture         Date                 ExecutableTimestamp  ProcCwd              ProcStatus           UserGroups
>>>>>>>> CoreDump             DistroRelease        ProblemType          ProcEnviron          Signal
>>>>>>>> CrashCounter         ExecutablePath       ProcCmdline          ProcMaps             Uname
>>>>>>>> 
>>>>>>>> 
>>>>>>>> 
>>>>>>>> Marco Kuendig / CEO / Founder 
>>>>>>>> marco at nuvula.ch / +41 78 751 99 71
>>>>>>>> 
>>>>>>>> Marco's Google Hangout
>>>>>>>> 
>>>>>>>> Nuvula AG - Hybrid Clouds 
>>>>>>>> Weierbachstrasse 7b 8193 Eglisau Switzerland 
>>>>>>>> http://www.nuvula.ch
>>>>>>>> 
>>>>>>>> 
>>>>>>>>> On 31 Mar 2015, at 21:45, Sabyasachi Sengupta <Sabyasachi.Sengupta at alcatel-lucent.com> wrote:
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> Typically Ubuntu does not unpack the crashes. Can you try apport-unpack?
>>>>>>>>> # apport-unpack /var/crash/<name> <crash-dir>
>>>>>>>>> 
>>>>>>>>>> On Tue, 31 Mar 2015, Marco Kuendig wrote:
>>>>>>>>>> 
>>>>>>>>>> thanks Joe and Ben
>>>>>>>>>> have done:
>>>>>>>>>> 1. installed dgb symbols for kernel....doesn't help
>>>>>>>>>> 2. installed debug symbols for openvswitch
>>>>>>>>>> no change, gdb and crash still don't work for me. I'm not a dev, need
>>>>>>>>>> more help to get that backtrace done.
>>>>>>>>>> here some output:
>>>>>>>>>> root at nuv-vir-kvm-server-1 ~ # crash
>>>>>>>>>>  /usr/lib/debug/boot/vmlinux-3.13.0-48-generic
>>>>>>>>>> /var/crash/_usr_sbin_ovs-vswitchd.0.crash
>>>>>>>>>> crash 7.0.3
>>>>>>>>>> Copyright (C) 2002-2013  Red Hat, Inc.
>>>>>>>>>> Copyright (C) 2004, 2005, 2006, 2010  IBM Corporation
>>>>>>>>>> Copyright (C) 1999-2006  Hewlett-Packard Co
>>>>>>>>>> Copyright (C) 2005, 2006, 2011, 2012  Fujitsu Limited
>>>>>>>>>> Copyright (C) 2006, 2007  VA Linux Systems Japan K.K.
>>>>>>>>>> Copyright (C) 2005, 2011  NEC Corporation
>>>>>>>>>> Copyright (C) 1999, 2002, 2007  Silicon Graphics, Inc.
>>>>>>>>>> Copyright (C) 1999, 2000, 2001, 2002  Mission Critical Linux, Inc.
>>>>>>>>>> This program is free software, covered by the GNU General Public License,
>>>>>>>>>> and you are welcome to change it and/or distribute copies of it under
>>>>>>>>>> certain conditions.  Enter "help copying" to see the conditions.
>>>>>>>>>> This program has absolutely no warranty.  Enter "help warranty" for
>>>>>>>>>> details.
>>>>>>>>>> crash: /var/crash/_usr_sbin_ovs-vswitchd.0.crash: not a supported file
>>>>>>>>>> format
>>>>>>>>>> Usage:
>>>>>>>>>> 
>>>>>>>>>>   crash [OPTION]... NAMELIST MEMORY-IMAGE  (dumpfile form)
>>>>>>>>>>   crash [OPTION]... [NAMELIST]             (live system form)
>>>>>>>>>> Enter "crash -h" for details.
>>>>>>>>>> root at nuv-vir-kvm-server-1 ~ # gdb /usr/sbin/ovs-vswitchd
>>>>>>>>>> /var/crash/_usr_sbin_ovs-vswitchd.0.crash
>>>>>>>>>> GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
>>>>>>>>>> Copyright (C) 2014 Free Software Foundation, Inc.
>>>>>>>>>> License GPLv3+: GNU GPL version 3 or later
>>>>>>>>>> <http://gnu.org/licenses/gpl.html>
>>>>>>>>>> This is free software: you are free to change and redistribute it.
>>>>>>>>>> There is NO WARRANTY, to the extent permitted by law.  Type "show
>>>>>>>>>> copying"
>>>>>>>>>> and "show warranty" for details.
>>>>>>>>>> This GDB was configured as "x86_64-linux-gnu".
>>>>>>>>>> Type "show configuration" for configuration details.
>>>>>>>>>> For bug reporting instructions, please see:
>>>>>>>>>> <http://www.gnu.org/software/gdb/bugs/>.
>>>>>>>>>> Find the GDB manual and other documentation resources online at:
>>>>>>>>>> <http://www.gnu.org/software/gdb/documentation/>.
>>>>>>>>>> For help, type "help".
>>>>>>>>>> Type "apropos word" to search for commands related to "word"...
>>>>>>>>>> Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from
>>>>>>>>>> /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
>>>>>>>>>> done.
>>>>>>>>>> "/var/crash/_usr_sbin_ovs-vswitchd.0.crash" is not a core dump: File
>>>>>>>>>> format not recognized
>>>>>>>>>> (gdb) q
>>>>>>>>>> root at nuv-vir-kvm-server-1 ~ #
>>>>>>>>>> Nuvula AG
>>>>>>>>>> Marco Kuendig / CEO / Founder marco at nuvula.ch / +41 78 751 99 71
>>>>>>>>>> Marco's Google Hangout
>>>>>>>>>> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau Switzerland http://www.nuvula.ch
>>>>>>>>>> 
>>>>>>>>>>      On 31 Mar 2015, at 19:00, Joe Stringer
>>>>>>>>>>      <joestringer at nicira.com> wrote:
>>>>>>>>>> For the 'File format not recognized' problem, you might have better
>>>>>>>>>> luck with the 'crash' utility.
>>>>>>>>>> $ crash <binary> <crashdump>
>>>>>>>>>> On 31 March 2015 at 08:16, Marco Kuendig <marco at nuvula.ch> wrote:
>>>>>>>>>>      Have tried this:
>>>>>>>>>> http://openvswitch.org/pipermail/discuss/2015-February/016582.html
>>>>>>>>>> this is the output, so doesn't seem to be correct:
>>>>>>>>>> root at nuv-vir-kvm-server-2 ~ # gdb /usr/sbin/ovs-vswitchd
>>>>>>>>>> /var/crash/_usr_sbin_ovs-vswitchd.0.crash
>>>>>>>>>> GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
>>>>>>>>>> Copyright (C) 2014 Free Software Foundation, Inc.
>>>>>>>>>> License GPLv3+: GNU GPL version 3 or later
>>>>>>>>>> <http://gnu.org/licenses/gpl.html>
>>>>>>>>>> This is free software: you are free to change and
>>>>>>>>>> redistribute it.
>>>>>>>>>> There is NO WARRANTY, to the extent permitted by law.  Type
>>>>>>>>>> "show copying"
>>>>>>>>>> and "show warranty" for details.
>>>>>>>>>> This GDB was configured as "x86_64-linux-gnu".
>>>>>>>>>> Type "show configuration" for configuration details.
>>>>>>>>>> For bug reporting instructions, please see:
>>>>>>>>>> <http://www.gnu.org/software/gdb/bugs/>.
>>>>>>>>>> Find the GDB manual and other documentation resources online
>>>>>>>>>> at:
>>>>>>>>>> <http://www.gnu.org/software/gdb/documentation/>.
>>>>>>>>>> For help, type "help".
>>>>>>>>>> Type "apropos word" to search for commands related to
>>>>>>>>>> "word"...
>>>>>>>>>> Reading symbols from /usr/sbin/ovs-vswitchd...(no debugging
>>>>>>>>>> symbols found)...done.
>>>>>>>>>> "/var/crash/_usr_sbin_ovs-vswitchd.0.crash" is not a core
>>>>>>>>>> dump: File format not recognized
>>>>>>>>>> (gdb) bt
>>>>>>>>>> No stack.
>>>>>>>>>> (gdb) quit
>>>>>>>>>> any more hints please ?
>>>>>>>>>> thanks
>>>>>>>>>> marco
>>>>>>>>>> Nuvula AG
>>>>>>>>>> Marco Kuendig / CEO / Founder marco at nuvula.ch / +41 78 751 99 71
>>>>>>>>>> Marco's Google Hangout
>>>>>>>>>> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau Switzerland http://www.nuvula.ch
>>>>>>>>>> 
>>>>>>>>>>      On 31 Mar 2015, at 17:00, Ben Pfaff
>>>>>>>>>>      <blp at nicira.com> wrote:
>>>>>>>>>> Can you get a backtrace for these?
>>>>>>>>>> On Tue, Mar 31, 2015 at 7:09 AM, Marco Kuendig
>>>>>>>>>> <marco at nuvula.ch> wrote:
>>>>>>>>>>      Folks,
>>>>>>>>>> any chance of having somebody look at these crash
>>>>>>>>>> files ?
>>>>>>>>>> I have several servers that are loosing network
>>>>>>>>>> connectivity because of this.
>>>>>>>>>> Downloads:
>>>>>>>>>> https://drive.google.com/file/d/0Bx_w1Tf2B5VSRU9yUmRpTDJLVEU/view?usp=sharing
>>>>>>>>>> Thanks for any hint or fix
>>>>>>>>>> marco
>>>>>>>>>> Nuvula AG
>>>>>>>>>> Marco Kuendig / CEO / Founder marco at nuvula.ch / +41 78 751 99 71
>>>>>>>>>> Marco's Google Hangout
>>>>>>>>>> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau Switzerland http://www.nuvula.ch
>>>>>>>>>> _______________________________________________
>>>>>>>>>> discuss mailing list
>>>>>>>>>> discuss at openvswitch.org
>>>>>>>>>> http://openvswitch.org/mailman/listinfo/discuss
>>>>>>>>>> --
>>>>>>>>>> "I don't normally do acked-by's.  I think it's my way
>>>>>>>>>> of avoiding
>>>>>>>>>> getting blamed when it all blows up." Andrew Morton
>>>>>>>>>> _______________________________________________
>>>>>>>>>> discuss mailing list
>>>>>>>>>> discuss at openvswitch.org
>>>>>>>>>> http://openvswitch.org/mailman/listinfo/discuss
> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150404/0872095c/attachment-0001.html>

From james.page at canonical.com  Sat Apr  4 08:01:02 2015
From: james.page at canonical.com (James Page)
Date: Sat, 4 Apr 2015 16:01:02 +0100
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <CACjuMbx+-uhyvpX1tyPhsdyVtT3DFDd8Kq_LAH-7iKhaz-UmkA@mail.gmail.com>
 <8C992B4E-8AA6-46A2-863D-9C9FBC6D4D16@nuvula.ch>
 <CANr6G5yB6jiYD+fwYhtPDh3bxams3PNTZLqd25DVcyU1hxmquw@mail.gmail.com>
 <B32CB78D-2CF9-4F47-9515-C8A206C090A2@nuvula.ch>
 <alpine.OSX.1.10.1503311245160.389@sabyasg-mbp-02>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
 <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
Message-ID: <929764B4-1289-4863-A33F-B646EAF46AFD@canonical.com>

Missed that this was not referenced:

https://bugs.launchpad.net/ubuntu/+source/openvswitch/+bug/1336555
--
James Page
Technical Lead, OpenStack Engineering Team
Tel: +44 (0)7545 080150


> On 4 Apr 2015, at 15:56, James Page <james.page at canonical.com> wrote:
> 
> 
> Marco
> 
> Great news that you have a reproducer - this has been blocking progress in resolving this issue as in our QA environment we've only seen this infrequently with no clear cause.
> 
> Any chance you could document your setup and specific test case that repros the problem in that bug report?
> 
> If this does turn out to be an optimiser issue we can tweak things and see what helps - a test case that anyone can use will accelerate this process
> 
> Cheers
> 
> James
> --
> James Page
> Technical Lead, OpenStack Engineering Team
> Tel: +44 (0)7545 080150
> 
> 
>> On 4 Apr 2015, at 09:10, Marco Kuendig <marco at nuvula.ch> wrote:
>> 
>> Thanks Joe
>> 
>> I have installed from that ppa and tested again. With that version from James I can't not get the crash anymore. I restarted the VM about 50 times and nothing crashed on any server.
>> 
>> So it seems that this fixes the issue, but I'm not quite sure if it lowers performance (not tested, just speculation).
>> 
>> James,
>> 
>> let me know if you want me to test other versions or procedures. I can recreate the crash at will it seems.
>> 
>> Cheers
>> marco
>> 
>> 
>> 
>> 
>> Marco Kuendig / CEO / Founder 
>> marco at nuvula.ch / +41 78 751 99 71
>> 
>> Marco's Google Hangout
>> 
>> Nuvula AG - Hybrid Clouds 
>> Weierbachstrasse 7b 8193 Eglisau Switzerland 
>> http://www.nuvula.ch
>> 
>> 
>>> On 03 Apr 2015, at 22:47, Joe Stringer <joestringer at nicira.com> wrote:
>>> 
>>> I guess James missed the email :-) In January he posted some builds for further investigation:
>>> 
>>> https://www.mail-archive.com/discuss at openvswitch.org/msg12049.html
>>> 
>>> It sounds like it's the exact same code, but with less compiler optimizations, to see whether this fixed the issue. This might provide a bit more information.
>>> 
>>>> On 31 March 2015 at 14:43, Marco Kuendig <marco at nuvula.ch> wrote:
>>>> ok, I have tested it and I can reproduce it. 
>>>> 
>>>> For testing to reproduce that core: 
>>>> 
>>>> I have a very small VM on KVM, I start and shutdown that VM every 30 seconds. With that I get:
>>>> 
>>>> Mar 31 16:10:13 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00010|daemon(monitor)|ERR|9 crashes: pid 10918 died, killed (Segmentation fault), core dumped, restarting
>>>> Mar 31 16:29:20 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00011|daemon(monitor)|ERR|10 crashes: pid 22038 died, killed (Segmentation fault), core dumped, restarting
>>>> Mar 31 23:33:04 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00012|daemon(monitor)|ERR|11 crashes: pid 25067 died, killed (Segmentation fault), core dumped, restarting
>>>> Mar 31 23:34:43 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00013|daemon(monitor)|ERR|12 crashes: pid 30254 died, killed (Segmentation fault), core dumped, restarting
>>>> Mar 31 23:38:49 nuv-vir-kvm-server-1 ovs-vswitchd: ovs|00014|daemon(monitor)|ERR|13 crashes: pid 31612 died, killed (Segmentation fault), core dumped, restarting
>>>> 
>>>> The ovs-vswitchd does not restart every cycle but it cores quite often as you can see in the log above.
>>>> 
>>>> 
>>>> 
>>>> 
>>>> 
>>>> Marco Kuendig / CEO / Founder 
>>>> marco at nuvula.ch / +41 78 751 99 71
>>>> 
>>>> Marco's Google Hangout
>>>> 
>>>> Nuvula AG - Hybrid Clouds 
>>>> Weierbachstrasse 7b 8193 Eglisau Switzerland 
>>>> http://www.nuvula.ch
>>>> 
>>>> 
>>>>> On 31 Mar 2015, at 23:15, Marco Kuendig <marco at nuvula.ch> wrote:
>>>>> 
>>>>> I think I can reproduce that bug. Not 100% sure but today I think I had it several times.
>>>>> 
>>>>> Interesting is that it happens when a VM on kvm boots. Certainly strange is that several hosts crash simultaneously.
>>>>> 
>>>>> My setup is a lab setup and can be accessed if it helps in troubleshooting.
>>>>> 
>>>>> 
>>>>> 
>>>>> Marco Kuendig / CEO / Founder 
>>>>> marco at nuvula.ch / +41 78 751 99 71
>>>>> 
>>>>> Marco's Google Hangout
>>>>> 
>>>>> Nuvula AG - Hybrid Clouds 
>>>>> Weierbachstrasse 7b 8193 Eglisau Switzerland 
>>>>> http://www.nuvula.ch
>>>>> 
>>>>> 
>>>>>> On 31 Mar 2015, at 23:12, Joe Stringer <joestringer at nicira.com> wrote:
>>>>>> 
>>>>>> James, I believe you were involved last time this bug came up, I wonder if you ever got to the bottom of this?
>>>>>> 
>>>>>> ---
>>>>>> 
>>>>>> This looks the same as a bug reported in October:
>>>>>> 
>>>>>> http://openvswitch.org/pipermail/discuss/2014-October/015429.html
>>>>>> 
>>>>>> Ben's assessment was that there is no logical issue in the code, so perhaps there was weird code generation caused by GCC.
>>>>>> 
>>>>>> 
>>>>>>> On 31 March 2015 at 13:05, Marco Kuendig <marco at nuvula.ch> wrote:
>>>>>>> Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
>>>>>>> done.
>>>>>>> [New LWP 32725]
>>>>>>> [New LWP 32732]
>>>>>>> [New LWP 32726]
>>>>>>> [New LWP 32730]
>>>>>>> [New LWP 32727]
>>>>>>> [New LWP 32728]
>>>>>>> [New LWP 32729]
>>>>>>> [New LWP 32731]
>>>>>>> [Thread debugging using libthread_db enabled]
>>>>>>> Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
>>>>>>> Core was generated by `ovs-vswitchd unix:/var/run/openvswitch/db.sock -vconsole:emer -vsyslog:err -vfi'.
>>>>>>> Program terminated with signal SIGSEGV, Segmentation fault.
>>>>>>> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
>>>>>>> 506	../lib/netlink.c: No such file or directory.
>>>>>>> (gdb) bt
>>>>>>> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
>>>>>>> #1  0x0000000000460473 in format_generic_odp_key (a=a at entry=0x0, ds=ds at entry=0x7fff0408f3b0) at ../lib/odp-util.c:767
>>>>>>> #2  0x0000000000460cd2 in format_odp_key_attr (a=a at entry=0xc485a4, ma=ma at entry=0x0, ds=ds at entry=0x7fff0408f3b0, verbose=verbose at entry=true)
>>>>>>>     at ../lib/odp-util.c:1332
>>>>>>> #3  0x00000000004609d7 in odp_flow_format (key=<optimized out>, key_len=40, mask=0x0, mask_len=0, ds=0x7fff0408f3b0, verbose=true) at ../lib/odp-util.c:1402
>>>>>>> #4  0x0000000000460fc4 in format_odp_key_attr (a=a at entry=0xc48580, ma=ma at entry=0x0, ds=ds at entry=0x7fff0408f3b0, verbose=verbose at entry=true) at ../lib/odp-util.c:987
>>>>>>> #5  0x00000000004609d7 in odp_flow_format (key=key at entry=0xc48520, key_len=key_len at entry=140, mask=mask at entry=0x0, mask_len=mask_len at entry=0,
>>>>>>>     ds=ds at entry=0x7fff0408f3b0, verbose=verbose at entry=true) at ../lib/odp-util.c:1402
>>>>>>> #6  0x00000000004450f3 in log_flow_message (error=error at entry=2, operation=operation at entry=0x4d0e73 "flow_del", key=0xc48520, key_len=140, mask=mask at entry=0x0,
>>>>>>>     mask_len=mask_len at entry=0, stats=0x0, actions=actions at entry=0x0, actions_len=actions_len at entry=0, dpif=<optimized out>) at ../lib/dpif.c:1354
>>>>>>> #7  0x00000000004453c9 in log_flow_del_message (dpif=dpif at entry=0xc489c0, del=del at entry=0x7fff0408f460, error=error at entry=2) at ../lib/dpif.c:1397
>>>>>>> #8  0x0000000000445433 in log_flow_del_message (error=2, del=0x7fff0408f460, dpif=0xc489c0) at ../lib/dpif.c:1396
>>>>>>> #9  dpif_flow_del__ (dpif=0xc489c0, del=del at entry=0x7fff0408f460) at ../lib/dpif.c:945
>>>>>>> #10 0x00000000004455ca in dpif_flow_del (dpif=<optimized out>, key=<optimized out>, key_len=<optimized out>, stats=stats at entry=0x7fff0408f490) at ../lib/dpif.c:965
>>>>>>> #11 0x000000000041b423 in subfacet_uninstall (subfacet=0xbd76a0) at ../ofproto/ofproto-dpif.c:4686
>>>>>>> #12 0x0000000000420f18 in facet_remove (facet=facet at entry=0xbd72a0) at ../ofproto/ofproto-dpif.c:4014
>>>>>>> #13 0x0000000000422f52 in facet_revalidate (facet=facet at entry=0xbd72a0) at ../ofproto/ofproto-dpif.c:4321
>>>>>>> #14 0x0000000000424b5a in facet_lookup_valid (flow=0x7f3e700020a8, ofproto=0xc52600) at ../ofproto/ofproto-dpif.c:4203
>>>>>>> #15 handle_flow_miss (n_ops=<synthetic pointer>, ops=0x7fff0408fb60, miss=0x7f3e70002090) at ../ofproto/ofproto-dpif.c:3339
>>>>>>> #16 handle_flow_misses (fmb=fmb at entry=0x7f3e700008e0, backer=<optimized out>) at ../ofproto/ofproto-dpif.c:3410
>>>>>>> #17 0x0000000000425196 in handle_upcalls (backer=<optimized out>) at ../ofproto/ofproto-dpif.c:3565
>>>>>>> #18 dpif_backer_run_fast (backer=<optimized out>) at ../ofproto/ofproto-dpif.c:1007
>>>>>>> #19 type_run_fast (type=<optimized out>) at ../ofproto/ofproto-dpif.c:1024
>>>>>>> #20 0x00000000004122cf in ofproto_type_run_fast (datapath_type=<optimized out>, datapath_type at entry=0xc4ef20 "system") at ../ofproto/ofproto.c:1326
>>>>>>> #21 0x00000000004081a5 in bridge_run_fast () at ../vswitchd/bridge.c:2318
>>>>>>> #22 0x00000000004059c5 in main (argc=<optimized out>, argv=<optimized out>) at ../vswitchd/ovs-vswitchd.c:119
>>>>>>> (gdb)
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> Marco Kuendig / CEO / Founder 
>>>>>>> marco at nuvula.ch / +41 78 751 99 71
>>>>>>> 
>>>>>>> Marco's Google Hangout
>>>>>>> 
>>>>>>> Nuvula AG - Hybrid Clouds 
>>>>>>> Weierbachstrasse 7b 8193 Eglisau Switzerland 
>>>>>>> http://www.nuvula.ch
>>>>>>> 
>>>>>>> 
>>>>>>>> On 31 Mar 2015, at 22:04, Joe Stringer <joestringer at nicira.com> wrote:
>>>>>>>> 
>>>>>>>> Great, we're moving. Looks like the gdb version of this is working below. Do you get the gdb prompt from there? the command 'bt' should provide the backtrace we're after.
>>>>>>>> 
>>>>>>>> On 31 March 2015 at 12:52, Marco Kuendig <marco at nuvula.ch> wrote:
>>>>>>>>> that brought us a step forward. thank Sab.
>>>>>>>>> 
>>>>>>>>> Important to know is:
>>>>>>>>> 
>>>>>>>>> I got 4 kvm servers, meshed with openvswitch. I use vxlan for tunnelling.
>>>>>>>>> 
>>>>>>>>> Sometimes when I restart a domain in kvm, 3 or 4 hosts crash at the same time.
>>>>>>>>> 
>>>>>>>>> I have STP enabled to avoid loops.
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> this is the output now:
>>>>>>>>> 
>>>>>>>>> root at nuv-vir-kvm-server-1 ~ # gdb /usr/sbin/ovs-vswitchd /var/crash/ovs/CoreDump
>>>>>>>>> GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
>>>>>>>>> Copyright (C) 2014 Free Software Foundation, Inc.
>>>>>>>>> License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
>>>>>>>>> This is free software: you are free to change and redistribute it.
>>>>>>>>> There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
>>>>>>>>> and "show warranty" for details.
>>>>>>>>> This GDB was configured as "x86_64-linux-gnu".
>>>>>>>>> Type "show configuration" for configuration details.
>>>>>>>>> For bug reporting instructions, please see:
>>>>>>>>> <http://www.gnu.org/software/gdb/bugs/>.
>>>>>>>>> Find the GDB manual and other documentation resources online at:
>>>>>>>>> <http://www.gnu.org/software/gdb/documentation/>.
>>>>>>>>> For help, type "help".
>>>>>>>>> Type "apropos word" to search for commands related to "word"...
>>>>>>>>> Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
>>>>>>>>> done.
>>>>>>>>> [New LWP 32725]
>>>>>>>>> [New LWP 32732]
>>>>>>>>> [New LWP 32726]
>>>>>>>>> [New LWP 32730]
>>>>>>>>> [New LWP 32727]
>>>>>>>>> [New LWP 32728]
>>>>>>>>> [New LWP 32729]
>>>>>>>>> [New LWP 32731]
>>>>>>>>> [Thread debugging using libthread_db enabled]
>>>>>>>>> Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
>>>>>>>>> Core was generated by `ovs-vswitchd unix:/var/run/openvswitch/db.sock -vconsole:emer -vsyslog:err -vfi'.
>>>>>>>>> Program terminated with signal SIGSEGV, Segmentation fault.
>>>>>>>>> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
>>>>>>>>> 506	../lib/netlink.c: No such file or directory.
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> root at nuv-vir-kvm-server-1 ~ # crash /usr/sbin/ovs-vswitchd /var/crash/ovs/CoreDump
>>>>>>>>> 
>>>>>>>>> crash 7.0.3
>>>>>>>>> Copyright (C) 2002-2013  Red Hat, Inc.
>>>>>>>>> Copyright (C) 2004, 2005, 2006, 2010  IBM Corporation
>>>>>>>>> Copyright (C) 1999-2006  Hewlett-Packard Co
>>>>>>>>> Copyright (C) 2005, 2006, 2011, 2012  Fujitsu Limited
>>>>>>>>> Copyright (C) 2006, 2007  VA Linux Systems Japan K.K.
>>>>>>>>> Copyright (C) 2005, 2011  NEC Corporation
>>>>>>>>> Copyright (C) 1999, 2002, 2007  Silicon Graphics, Inc.
>>>>>>>>> Copyright (C) 1999, 2000, 2001, 2002  Mission Critical Linux, Inc.
>>>>>>>>> This program is free software, covered by the GNU General Public License,
>>>>>>>>> and you are welcome to change it and/or distribute copies of it under
>>>>>>>>> certain conditions.  Enter "help copying" to see the conditions.
>>>>>>>>> This program has absolutely no warranty.  Enter "help warranty" for details.
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> crash: /usr/sbin/ovs-vswitchd: no debugging data available
>>>>>>>>> 
>>>>>>>>> root at nuv-vir-kvm-server-1 ~ # ll /var/crash/ovs/
>>>>>>>>> Architecture         Date                 ExecutableTimestamp  ProcCwd              ProcStatus           UserGroups
>>>>>>>>> CoreDump             DistroRelease        ProblemType          ProcEnviron          Signal
>>>>>>>>> CrashCounter         ExecutablePath       ProcCmdline          ProcMaps             Uname
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> Marco Kuendig / CEO / Founder 
>>>>>>>>> marco at nuvula.ch / +41 78 751 99 71
>>>>>>>>> 
>>>>>>>>> Marco's Google Hangout
>>>>>>>>> 
>>>>>>>>> Nuvula AG - Hybrid Clouds 
>>>>>>>>> Weierbachstrasse 7b 8193 Eglisau Switzerland 
>>>>>>>>> http://www.nuvula.ch
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>>> On 31 Mar 2015, at 21:45, Sabyasachi Sengupta <Sabyasachi.Sengupta at alcatel-lucent.com> wrote:
>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>>>> Typically Ubuntu does not unpack the crashes. Can you try apport-unpack?
>>>>>>>>>> # apport-unpack /var/crash/<name> <crash-dir>
>>>>>>>>>> 
>>>>>>>>>>> On Tue, 31 Mar 2015, Marco Kuendig wrote:
>>>>>>>>>>> 
>>>>>>>>>>> thanks Joe and Ben
>>>>>>>>>>> have done:
>>>>>>>>>>> 1. installed dgb symbols for kernel....doesn't help
>>>>>>>>>>> 2. installed debug symbols for openvswitch
>>>>>>>>>>> no change, gdb and crash still don't work for me. I'm not a dev, need
>>>>>>>>>>> more help to get that backtrace done.
>>>>>>>>>>> here some output:
>>>>>>>>>>> root at nuv-vir-kvm-server-1 ~ # crash
>>>>>>>>>>>  /usr/lib/debug/boot/vmlinux-3.13.0-48-generic
>>>>>>>>>>> /var/crash/_usr_sbin_ovs-vswitchd.0.crash
>>>>>>>>>>> crash 7.0.3
>>>>>>>>>>> Copyright (C) 2002-2013  Red Hat, Inc.
>>>>>>>>>>> Copyright (C) 2004, 2005, 2006, 2010  IBM Corporation
>>>>>>>>>>> Copyright (C) 1999-2006  Hewlett-Packard Co
>>>>>>>>>>> Copyright (C) 2005, 2006, 2011, 2012  Fujitsu Limited
>>>>>>>>>>> Copyright (C) 2006, 2007  VA Linux Systems Japan K.K.
>>>>>>>>>>> Copyright (C) 2005, 2011  NEC Corporation
>>>>>>>>>>> Copyright (C) 1999, 2002, 2007  Silicon Graphics, Inc.
>>>>>>>>>>> Copyright (C) 1999, 2000, 2001, 2002  Mission Critical Linux, Inc.
>>>>>>>>>>> This program is free software, covered by the GNU General Public License,
>>>>>>>>>>> and you are welcome to change it and/or distribute copies of it under
>>>>>>>>>>> certain conditions.  Enter "help copying" to see the conditions.
>>>>>>>>>>> This program has absolutely no warranty.  Enter "help warranty" for
>>>>>>>>>>> details.
>>>>>>>>>>> crash: /var/crash/_usr_sbin_ovs-vswitchd.0.crash: not a supported file
>>>>>>>>>>> format
>>>>>>>>>>> Usage:
>>>>>>>>>>> 
>>>>>>>>>>>   crash [OPTION]... NAMELIST MEMORY-IMAGE  (dumpfile form)
>>>>>>>>>>>   crash [OPTION]... [NAMELIST]             (live system form)
>>>>>>>>>>> Enter "crash -h" for details.
>>>>>>>>>>> root at nuv-vir-kvm-server-1 ~ # gdb /usr/sbin/ovs-vswitchd
>>>>>>>>>>> /var/crash/_usr_sbin_ovs-vswitchd.0.crash
>>>>>>>>>>> GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
>>>>>>>>>>> Copyright (C) 2014 Free Software Foundation, Inc.
>>>>>>>>>>> License GPLv3+: GNU GPL version 3 or later
>>>>>>>>>>> <http://gnu.org/licenses/gpl.html>
>>>>>>>>>>> This is free software: you are free to change and redistribute it.
>>>>>>>>>>> There is NO WARRANTY, to the extent permitted by law.  Type "show
>>>>>>>>>>> copying"
>>>>>>>>>>> and "show warranty" for details.
>>>>>>>>>>> This GDB was configured as "x86_64-linux-gnu".
>>>>>>>>>>> Type "show configuration" for configuration details.
>>>>>>>>>>> For bug reporting instructions, please see:
>>>>>>>>>>> <http://www.gnu.org/software/gdb/bugs/>.
>>>>>>>>>>> Find the GDB manual and other documentation resources online at:
>>>>>>>>>>> <http://www.gnu.org/software/gdb/documentation/>.
>>>>>>>>>>> For help, type "help".
>>>>>>>>>>> Type "apropos word" to search for commands related to "word"...
>>>>>>>>>>> Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from
>>>>>>>>>>> /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
>>>>>>>>>>> done.
>>>>>>>>>>> "/var/crash/_usr_sbin_ovs-vswitchd.0.crash" is not a core dump: File
>>>>>>>>>>> format not recognized
>>>>>>>>>>> (gdb) q
>>>>>>>>>>> root at nuv-vir-kvm-server-1 ~ #
>>>>>>>>>>> Nuvula AG
>>>>>>>>>>> Marco Kuendig / CEO / Founder marco at nuvula.ch / +41 78 751 99 71
>>>>>>>>>>> Marco's Google Hangout
>>>>>>>>>>> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau Switzerland http://www.nuvula.ch
>>>>>>>>>>> 
>>>>>>>>>>>      On 31 Mar 2015, at 19:00, Joe Stringer
>>>>>>>>>>>      <joestringer at nicira.com> wrote:
>>>>>>>>>>> For the 'File format not recognized' problem, you might have better
>>>>>>>>>>> luck with the 'crash' utility.
>>>>>>>>>>> $ crash <binary> <crashdump>
>>>>>>>>>>> On 31 March 2015 at 08:16, Marco Kuendig <marco at nuvula.ch> wrote:
>>>>>>>>>>>      Have tried this:
>>>>>>>>>>> http://openvswitch.org/pipermail/discuss/2015-February/016582.html
>>>>>>>>>>> this is the output, so doesn't seem to be correct:
>>>>>>>>>>> root at nuv-vir-kvm-server-2 ~ # gdb /usr/sbin/ovs-vswitchd
>>>>>>>>>>> /var/crash/_usr_sbin_ovs-vswitchd.0.crash
>>>>>>>>>>> GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
>>>>>>>>>>> Copyright (C) 2014 Free Software Foundation, Inc.
>>>>>>>>>>> License GPLv3+: GNU GPL version 3 or later
>>>>>>>>>>> <http://gnu.org/licenses/gpl.html>
>>>>>>>>>>> This is free software: you are free to change and
>>>>>>>>>>> redistribute it.
>>>>>>>>>>> There is NO WARRANTY, to the extent permitted by law.  Type
>>>>>>>>>>> "show copying"
>>>>>>>>>>> and "show warranty" for details.
>>>>>>>>>>> This GDB was configured as "x86_64-linux-gnu".
>>>>>>>>>>> Type "show configuration" for configuration details.
>>>>>>>>>>> For bug reporting instructions, please see:
>>>>>>>>>>> <http://www.gnu.org/software/gdb/bugs/>.
>>>>>>>>>>> Find the GDB manual and other documentation resources online
>>>>>>>>>>> at:
>>>>>>>>>>> <http://www.gnu.org/software/gdb/documentation/>.
>>>>>>>>>>> For help, type "help".
>>>>>>>>>>> Type "apropos word" to search for commands related to
>>>>>>>>>>> "word"...
>>>>>>>>>>> Reading symbols from /usr/sbin/ovs-vswitchd...(no debugging
>>>>>>>>>>> symbols found)...done.
>>>>>>>>>>> "/var/crash/_usr_sbin_ovs-vswitchd.0.crash" is not a core
>>>>>>>>>>> dump: File format not recognized
>>>>>>>>>>> (gdb) bt
>>>>>>>>>>> No stack.
>>>>>>>>>>> (gdb) quit
>>>>>>>>>>> any more hints please ?
>>>>>>>>>>> thanks
>>>>>>>>>>> marco
>>>>>>>>>>> Nuvula AG
>>>>>>>>>>> Marco Kuendig / CEO / Founder marco at nuvula.ch / +41 78 751 99 71
>>>>>>>>>>> Marco's Google Hangout
>>>>>>>>>>> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau Switzerland http://www.nuvula.ch
>>>>>>>>>>> 
>>>>>>>>>>>      On 31 Mar 2015, at 17:00, Ben Pfaff
>>>>>>>>>>>      <blp at nicira.com> wrote:
>>>>>>>>>>> Can you get a backtrace for these?
>>>>>>>>>>> On Tue, Mar 31, 2015 at 7:09 AM, Marco Kuendig
>>>>>>>>>>> <marco at nuvula.ch> wrote:
>>>>>>>>>>>      Folks,
>>>>>>>>>>> any chance of having somebody look at these crash
>>>>>>>>>>> files ?
>>>>>>>>>>> I have several servers that are loosing network
>>>>>>>>>>> connectivity because of this.
>>>>>>>>>>> Downloads:
>>>>>>>>>>> https://drive.google.com/file/d/0Bx_w1Tf2B5VSRU9yUmRpTDJLVEU/view?usp=sharing
>>>>>>>>>>> Thanks for any hint or fix
>>>>>>>>>>> marco
>>>>>>>>>>> Nuvula AG
>>>>>>>>>>> Marco Kuendig / CEO / Founder marco at nuvula.ch / +41 78 751 99 71
>>>>>>>>>>> Marco's Google Hangout
>>>>>>>>>>> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau Switzerland http://www.nuvula.ch
>>>>>>>>>>> _______________________________________________
>>>>>>>>>>> discuss mailing list
>>>>>>>>>>> discuss at openvswitch.org
>>>>>>>>>>> http://openvswitch.org/mailman/listinfo/discuss
>>>>>>>>>>> --
>>>>>>>>>>> "I don't normally do acked-by's.  I think it's my way
>>>>>>>>>>> of avoiding
>>>>>>>>>>> getting blamed when it all blows up." Andrew Morton
>>>>>>>>>>> _______________________________________________
>>>>>>>>>>> discuss mailing list
>>>>>>>>>>> discuss at openvswitch.org
>>>>>>>>>>> http://openvswitch.org/mailman/listinfo/discuss
>> 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150404/abe60648/attachment-0001.html>

From gulam at gulam.in  Sun Apr  5 03:34:41 2015
From: gulam at gulam.in (Bakshi Gulam)
Date: Sun, 5 Apr 2015 16:04:41 +0530
Subject: [ovs-discuss] OVS not sending the whole packet in PacketIn message
Message-ID: <CA+P_w0y9zOZe9dbNgdyi6Uyi6yy9UmAi3VZNzGFauL4SSaLt6w@mail.gmail.com>

Hi All,

I'm using OVS with OpenDaylight(ODL) controller. As soon as OVS registers
itself with ODL, ODL sends a OFPT_SET_CONFIG message with miss_send_len =
0xffff (OFPCML_NO_BUFFER). I assume the same has been successfully
configured in OVS. (Because for a subsequent OFPT_GET_CONFIG_REQUEST, I get
a OFPT_GET_CONFIG_RESPONSE with miss_send_len = 0xfff).

But PacketIn message generated due to "flow miss", contains only till TCP
header of the actual packet. Since miss_send_len is set as
OFPCML_NO_BUFFER, I'm expecting OVS to include the entire packet as payload
to PacketIn message. But for a HTTP packet, the PacketIn contains only till
TCP header.

Is this a known issue or a bug? Can somebody help me how to make OVS lift
entire packet to controller (in case of "flow-miss")?


-- 
/////////////////////////
// Bakshi Gulam        //
// http://www.gulam.in //
/////////////////////////
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150405/7abdef84/attachment.html>

From blp at nicira.com  Sun Apr  5 09:57:06 2015
From: blp at nicira.com (Ben Pfaff)
Date: Sun, 5 Apr 2015 09:57:06 -0700
Subject: [ovs-discuss] OVS not sending the whole packet in PacketIn
 message
In-Reply-To: <CA+P_w0y9zOZe9dbNgdyi6Uyi6yy9UmAi3VZNzGFauL4SSaLt6w@mail.gmail.com>
References: <CA+P_w0y9zOZe9dbNgdyi6Uyi6yy9UmAi3VZNzGFauL4SSaLt6w@mail.gmail.com>
Message-ID: <20150405165706.GA28966@nicira.com>

On Sun, Apr 05, 2015 at 04:04:41PM +0530, Bakshi Gulam wrote:
> I'm using OVS with OpenDaylight(ODL) controller. As soon as OVS registers
> itself with ODL, ODL sends a OFPT_SET_CONFIG message with miss_send_len =
> 0xffff (OFPCML_NO_BUFFER). I assume the same has been successfully
> configured in OVS. (Because for a subsequent OFPT_GET_CONFIG_REQUEST, I get
> a OFPT_GET_CONFIG_RESPONSE with miss_send_len = 0xfff).
> 
> But PacketIn message generated due to "flow miss", contains only till TCP
> header of the actual packet. Since miss_send_len is set as
> OFPCML_NO_BUFFER, I'm expecting OVS to include the entire packet as payload
> to PacketIn message. But for a HTTP packet, the PacketIn contains only till
> TCP header.
> 
> Is this a known issue or a bug? Can somebody help me how to make OVS lift
> entire packet to controller (in case of "flow-miss")?

You're not the first to report this but I've been unable to reproduce it
in my testing.  Can you provide a simple reproduction case?  If you can,
I'll fix it.  (If it involves installing ODL then that isn't simple
enough for me.)

From shuchi.kapoor at aricent.com  Mon Apr  6 04:32:20 2015
From: shuchi.kapoor at aricent.com (Shuchi Kapoor)
Date: Mon, 6 Apr 2015 11:32:20 +0000
Subject: [ovs-discuss] Regarding Ovs version 2.3.1
References: <812aa339197241c8bf81014219fc468b@GURMBXV02.AD.ARICENT.COM>
 <AA498E07-83BD-4E0C-82C2-622B67F66A66@nicira.com> 
Message-ID: <d2643e0f9bfd4005aabf704639fe9c76@GURMBXV02.AD.ARICENT.COM>

Hi team,

Just a soft reminder..
Please revert if anyone is having any info on below statement.

" There is experimental support for DPDK with OVS2.3.1.
When the DPDK based OVS is used in OVS2.3.1, are these features(sflow,netflow, IPFIX, SPAN, RSPAN, and GRE-tunneled mirrors) still supported, kindly clarify."


Thanks & Regards
Shuchi Kapoor


-----Original Message-----
From: Shuchi Kapoor
Sent: Thursday, April 02, 2015 1:44 PM
To: 'Justin Pettit'
Cc: discuss at openvswitch.org
Subject: RE: [ovs-discuss] Regarding Ovs version 2.3.1

Thanks Justin for prompt reply.
Just to add need some clarification.

There is experimental support for DPDK with OVS2.3.1.
When the DPDK based OVS is used in OVS2.3.1, are these features still supported, kindly clarify.

Thanks & Regards
Shuchi Kapoor


-----Original Message-----
From: Justin Pettit [mailto:jpettit at nicira.com]
Sent: Wednesday, April 01, 2015 9:41 PM
To: Shuchi Kapoor
Cc: discuss at openvswitch.org
Subject: Re: [ovs-discuss] Regarding Ovs version 2.3.1


> On Apr 1, 2015, at 4:45 AM, Shuchi Kapoor <shuchi.kapoor at aricent.com> wrote:
>
> Hi Team,
>
> I have a query on OVS version 2.3.1.
> On OVS version 2.3.1 whether the following features are supported “NetFlow, sFlow(R), IPFIX, SPAN, RSPAN, and GRE-tunneled mirrors “.
> Your response will be highly appreciated..

Yes.

--Justin


"DISCLAIMER: This message is proprietary to Aricent and is intended solely for the use of the individual to whom it is addressed. It may contain privileged or confidential information and should not be circulated or used for any purpose other than for what it is intended. If you have received this message in error, please notify the originator immediately. If you are not the intended recipient, you are notified that you are strictly prohibited from using, copying, altering, or disclosing the contents of this message. Aricent accepts no responsibility for loss or damage arising from the use of the information transmitted by this email including damage from virus."

From navneet.singh2012 at gmail.com  Mon Apr  6 04:35:04 2015
From: navneet.singh2012 at gmail.com (Navneet Singh)
Date: Mon, 6 Apr 2015 17:05:04 +0530
Subject: [ovs-discuss] Need help on MPLS implementation
Message-ID: <CAOCzzULyDKJ9Ues6wH3o51iA8-D3gNc9k-3MC-yQpjDPntT-DQ@mail.gmail.com>

Hi All,

I want to know more about mpls implementation using OVS. There is way of
implementing mpls directly through kernel patch on linux kernel 2.6.35, but
I have learnt that it can be easily done through OVS. What functionalities
of mpls ovs supports?
Please share any link or documents if any to help me implement mpls through
ovs.

--
Navneet
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150406/a27c8da6/attachment.html>

From rbryant at redhat.com  Mon Apr  6 08:35:52 2015
From: rbryant at redhat.com (Russell Bryant)
Date: Mon, 06 Apr 2015 11:35:52 -0400
Subject: [ovs-discuss] Error in building Latest OVS in Fedora
In-Reply-To: <1BA01C3192A665469272B2597052DDFF56EB75FE@BGSMSX104.gar.corp.intel.com>
References: <1BA01C3192A665469272B2597052DDFF56EB75FE@BGSMSX104.gar.corp.intel.com>
Message-ID: <5522A7D8.8080604@redhat.com>

On 03/27/2015 05:46 AM, Radhakrishnan, Sharmila wrote:
> Hi All,
> 
> I did a fresh clone for OVS today on  Fedora21 machine(kernel -
> 3.17.8-300.fc21.x86_64).
> 
>  
> 
> I configured it to
> 
> ./configure --with-linux=/lib/modules/3.17.8-300.fc21.x86_64/build
> 
>  
> 
> And when I ran ‘make’ I get the below error:
> 
>  
> 
> make[4]: Entering directory '/usr/src/kernels/3.17.8-300.fc21.x86_64'
> 
>   CC [M]  /usr/src/ovs/datapath/linux/actions.o
> 
>   CC [M]  /usr/src/ovs/datapath/linux/datapath.o
> 
> /usr/src/ovs/datapath/linux/datapath.c: In function â€˜dp_initâ€™:
> 
> /usr/src/ovs/datapath/linux/datapath.c:2268:10: error: macro "__DATE__"
> might prevent reproducible builds [-Werror=date-time]
> 
>    VERSION);
> 
>           ^

Add the following to your 'make' command:

$ make EXTRA_CFLAGS="-Wno-error=date-time"

-- 
Russell Bryant

From prashanthvarma.manthena at gmail.com  Mon Apr  6 07:56:58 2015
From: prashanthvarma.manthena at gmail.com (Prashanth Varma Manthena)
Date: Mon, 6 Apr 2015 16:56:58 +0200
Subject: [ovs-discuss] My M.Sc. thesis report and our IEEE NetSoft 2015
	Conference paper
Message-ID: <CA+byYf9u2E+a-Bs5E-avvOyggyNpevW2kqSWQiRm-O0CKhncSw@mail.gmail.com>

Dear all,

I just want to update you all with the information regarding my M.Sc.
thesis report and our IEEE NetSoft 2015 Conference paper.

I thought, this information might be useful for some in the OVS discuss
list as my proposed architecture's proof-of-concept (PoC) implementation
involves OVS-enabled physical switches as its OpenFlow-enabled physical
switches.

*1) M.Sc. Thesis *

*Title: *Network-as-a-Service Architecture with SDN and NFV: A Proposed
Evolutionary Approach for Service Provider Networks

My M.Sc. thesis report can be accessed online at TU Delft's institutional
repository, here is the url:
http://repository.tudelft.nl/view/ir/uuid:ce16a77c-f286-4dd7-89ba-5b38ccb2cf68/


*2) IEEE NetSoft 2015 Conference Paper *

Our conference paper based on my M.Sc. graduation project and thesis got
accepted for 1st IEEE Conference on Network Softwarization (IEEE Netsoft
2015), London, UK, April 13-17, 2015.

*Title: *An SDN-based Architecture for Network-as-a-Service

*Abstract:* Network-as-a-Service (NaaS) is a cloud-based service model that
offers on-demand network connectivity and the provisioning and management
of network services. However, the actual orchestration of dynamically
allocating underlying resources to customer requirements is not trivial. In
this paper, we propose an SDN-based approach to support the NaaS model. We
implement a proof-of-concept (PoC) on a physical testbed and validate it
through experimental performance evaluation

Here is the URL to access the conference paper:
http://www.nas.its.tudelft.nl/people/Fernando/papers/SDN4NaaS.pdf


*3) PoC source code*

My proof-of-concept (PoC) source code was published as open source on
GitHub and can be found on "TUDelftNAS" GitHub page under the repository
name "SDN-NaaSPlatform", here is the URL:
https://github.com/TUDelftNAS/SDN-NaaSPlatform

Most importantly, I want to thank you all for your support and help. This
whole thing would not have been possible without your constant help and
support.

Let me know, if you need any additional information from my side.

With regards,
*M.P.V. Manthena (Prashanth)*

M.Sc. in Electrical Engineering
Delft University of Technology (TU Delft), The Netherlands

LinkedIn Profile : http://nl.linkedin.com/in/prashanthvarma/
Personal Website: http://prashanthvarma.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150406/f5b1deb6/attachment-0001.html>

From blp at nicira.com  Mon Apr  6 09:58:56 2015
From: blp at nicira.com (Ben Pfaff)
Date: Mon, 6 Apr 2015 09:58:56 -0700
Subject: [ovs-discuss] My M.Sc. thesis report and our IEEE NetSoft 2015
 Conference paper
In-Reply-To: <CA+byYf9u2E+a-Bs5E-avvOyggyNpevW2kqSWQiRm-O0CKhncSw@mail.gmail.com>
References: <CA+byYf9u2E+a-Bs5E-avvOyggyNpevW2kqSWQiRm-O0CKhncSw@mail.gmail.com>
Message-ID: <20150406165856.GA7848@nicira.com>

On Mon, Apr 06, 2015 at 04:56:58PM +0200, Prashanth Varma Manthena wrote:
> I just want to update you all with the information regarding my M.Sc.
> thesis report and our IEEE NetSoft 2015 Conference paper.

Congratulations on your paper being accepted and (presumably) your
graduation.

I skimmed through your conference paper.  Do you have any direct
advice or suggestions for the Open vSwitch project?

From gulam at gulam.in  Mon Apr  6 10:15:50 2015
From: gulam at gulam.in (Bakshi Gulam)
Date: Mon, 6 Apr 2015 22:45:50 +0530
Subject: [ovs-discuss] OVS not sending the whole packet in PacketIn
	message
In-Reply-To: <20150405165706.GA28966@nicira.com>
References: <CA+P_w0y9zOZe9dbNgdyi6Uyi6yy9UmAi3VZNzGFauL4SSaLt6w@mail.gmail.com>
 <20150405165706.GA28966@nicira.com>
Message-ID: <CA+P_w0zkO=6P7CVS-jdBsxTA0xDB4ej-toQ=3cOTtj=LCMbO7A@mail.gmail.com>

Hi Ben,

Thanks for getting me back. I've not tested this with any controller other
than ODL. But installing ODL isn't that complex. In fact, no "installation"
is required. You can just download the pre-compiled binary from here
<https://nexus.opendaylight.org/content/repositories/opendaylight.release/org/opendaylight/integration/distributions-base/0.1.1/distributions-base-0.1.1-osgipackage.zip>
and after unzipping just running *run.sh* script will start the ODL
controller. No additional configuration is required (by default ODL will
listen on port 6633).

So, the reproduction steps are really simple.
1. Download and unzip ODL (hydrogen release) from here
<https://nexus.opendaylight.org/content/repositories/opendaylight.release/org/opendaylight/integration/distributions-base/0.1.1/distributions-base-0.1.1-osgipackage.zip>.
Run *run.sh* script.
2. Start Wireshark(or any other packet capture tool) and make it listen on
loopback interface.
3. Start Mininet with *--controller=remote* option. (I'm using Mininet. I
don't know the equivalent command line option in case if we run OVS
directly. I'm assuming you would be knowing it.)

You can see the ODL issuing a OFPT_SET_CONFIG with miss_send_len=0xffff and
you can also confirm it by observing the OFPT_GET_CONFIG_RESPONSE from OVS.

4. When no flows are installed, send HTTP traffic to switch. Due to
"flow-miss", OVS will lift the packet to ODL. You can see only TCP header
included in PacketIn message. (If you are using Mininet, you can start a
Simple Web Server and Client as mentioned here
<http://mininet.org/walkthrough/#run-a-simple-web-server-and-client> to
generate HTTP packets.)

Hope this will help you in reproducing this issue.

On Sun, Apr 5, 2015 at 10:27 PM, Ben Pfaff <blp at nicira.com> wrote:

> On Sun, Apr 05, 2015 at 04:04:41PM +0530, Bakshi Gulam wrote:
> > I'm using OVS with OpenDaylight(ODL) controller. As soon as OVS registers
> > itself with ODL, ODL sends a OFPT_SET_CONFIG message with miss_send_len =
> > 0xffff (OFPCML_NO_BUFFER). I assume the same has been successfully
> > configured in OVS. (Because for a subsequent OFPT_GET_CONFIG_REQUEST, I
> get
> > a OFPT_GET_CONFIG_RESPONSE with miss_send_len = 0xfff).
> >
> > But PacketIn message generated due to "flow miss", contains only till TCP
> > header of the actual packet. Since miss_send_len is set as
> > OFPCML_NO_BUFFER, I'm expecting OVS to include the entire packet as
> payload
> > to PacketIn message. But for a HTTP packet, the PacketIn contains only
> till
> > TCP header.
> >
> > Is this a known issue or a bug? Can somebody help me how to make OVS lift
> > entire packet to controller (in case of "flow-miss")?
>
> You're not the first to report this but I've been unable to reproduce it
> in my testing.  Can you provide a simple reproduction case?  If you can,
> I'll fix it.  (If it involves installing ODL then that isn't simple
> enough for me.)
>



-- 
/////////////////////////
// Bakshi Gulam        //
// http://www.gulam.in //
/////////////////////////
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150406/5ddc0a81/attachment.html>

From prashanthvarma.manthena at gmail.com  Mon Apr  6 13:59:33 2015
From: prashanthvarma.manthena at gmail.com (Prashanth Varma Manthena)
Date: Mon, 6 Apr 2015 22:59:33 +0200
Subject: [ovs-discuss] My M.Sc. thesis report and our IEEE NetSoft 2015
 Conference paper
In-Reply-To: <20150406165856.GA7848@nicira.com>
References: <CA+byYf9u2E+a-Bs5E-avvOyggyNpevW2kqSWQiRm-O0CKhncSw@mail.gmail.com>
 <20150406165856.GA7848@nicira.com>
Message-ID: <CA+byYf-zQzEVLYa9QF4TfKMF=+o+OtdZy=CNdTG6awkGPLRB6A@mail.gmail.com>

Dear Mr. Pfaff,

First of all, thank you for your quick response and wishes.

Moreover, I successfully defended my thesis and graduated with a good final
grade from the university (TU Delft, The Netherlands) in February this
year.

All I have to say is that the Open vSwitch project is driving the
revolution and innovation in network architectures and services.
Furthermore, It is making SDN and NFV based research much more accessible,
open, and collaborative.

I personally was able to test, implement, and validate SDN
architectures successfully against real-world networks using OVS switches.
OVS physical switches with hardware (ASIC) support for IP/MPLS operations
were able to perform as good as any vendor-specific (legacy) switches and
routers. Here are my findings (refer second paragraph in pg. 52 of my
thesis):

During the performance evaluation experiments on the PoC physical network
testbed, it was found that Testbed Setup B involves slightly higher
round-trip delay/time (RTD/RTT) compared to that of Testbed Setup A (by
around 100 milliseconds). The main reason behind this is that the two open
switches, 48 port 1 GbE Pica8 P-3290 open switches, in Testbed Setup B’s
network core support MPLS switching operations (push, pop, and swap) in
their CPU instead of their hardware ASICs. Thus, the involved open switches
in the proposed evolutionary approach must support MPLS switching
operations in their hardware ASICs for much faster switching, avoidance of
network bottlenecks, and to prevent unnecessary load on the switch CPUs.

I have couple of direct advises and suggestions to the Open vSwitch project:

1) Compare the performance of different implementations (software,
physical, and hardware (ASIC) support) of OVS switches . Such information
would be very useful and inspirational for service providers and network
operators, who are planing to implement SDN and NFV  based architectures
for their production and real-world networks.

2) Push towards open-standards based network configuration protocols with
fully-programmable interfaces to realize overall virtualization of
networks. From my experiences, most of the vendors implementing OVS in
their switches still only support vendor-specific CLI and web-based network
configuration, this will change with much more support for network
configuration protocols like NETCONF and OF-CONFIG along wth OVSDB from the
Open vSwitch project.


Let me know, if you need any additional information from my side.


With regards,
*M.P.V. Manthena (Prashanth)*

M.Sc. in Electrical Engineering
Delft University of Technology (TU Delft), The Netherlands

LinkedIn Profile : http://nl.linkedin.com/in/prashanthvarma/
Personal Website: http://prashanthvarma.com/

On Mon, Apr 6, 2015 at 6:58 PM, Ben Pfaff <blp at nicira.com> wrote:

> On Mon, Apr 06, 2015 at 04:56:58PM +0200, Prashanth Varma Manthena wrote:
> > I just want to update you all with the information regarding my M.Sc.
> > thesis report and our IEEE NetSoft 2015 Conference paper.
>
> Congratulations on your paper being accepted and (presumably) your
> graduation.
>
> I skimmed through your conference paper.  Do you have any direct
> advice or suggestions for the Open vSwitch project?
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150406/162623cc/attachment.html>

From marco at nuvula.ch  Tue Apr  7 02:33:05 2015
From: marco at nuvula.ch (Marco Kuendig)
Date: Tue, 7 Apr 2015 11:33:05 +0200
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <C222441F-23C1-470A-987E-123B00879EA9@ubuntu.com>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <CACjuMbx+-uhyvpX1tyPhsdyVtT3DFDd8Kq_LAH-7iKhaz-UmkA@mail.gmail.com>
 <8C992B4E-8AA6-46A2-863D-9C9FBC6D4D16@nuvula.ch>
 <CANr6G5yB6jiYD+fwYhtPDh3bxams3PNTZLqd25DVcyU1hxmquw@mail.gmail.com>
 <B32CB78D-2CF9-4F47-9515-C8A206C090A2@nuvula.ch>
 <alpine.OSX.1.10.1503311245160.389@sabyasg-mbp-02>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
 <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
 <3E5B9556-CB9F-4D5B-8A6D-A615C099BAD7@nuvula.ch>
 <3FE189EC-49E0-47CC-BD59-2F6E7B04B9A4@ubuntu.com>
 <8CE70C04-9A31-4499-938A-85EC4D13E0BB@nuvula.ch>
 <C222441F-23C1-470A-987E-123B00879EA9@ubuntu.com>
Message-ID: <117DA076-BD34-4C01-94AE-22949AEF0E42@nuvula.ch>

Hi James

got another crash today with the optimisation disabled package:

here the backtrace (at the end is the one with the debug symbols)

Cheers
marco



root at nuv-vir-kvm-server-2 ~ # ll /var/crash
total 696K
drwxrwxrwt  2 root root 4.0K Apr  7 11:20 ./
drwxr-xr-x 13 root root 4.0K Mar 19 16:21 ../
-rw-r--r--  1 root root  272 Apr  7 10:32 kexec_cmd
-rw-rw----  1 root root    0 Apr  7 11:20 .lock
-rw-r-----  1 root root 682K Apr  7 11:20 _usr_sbin_ovs-vswitchd.0.crash
root at nuv-vir-kvm-server-2 ~ # gdb
GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
Copyright (C) 2014 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
<http://www.gnu.org/software/gdb/documentation/>.
For help, type "help".
Type "apropos word" to search for commands related to "word".
(gdb) Quit
(gdb) quit
root at nuv-vir-kvm-server-2 ~ # apport-unpack /var/crash/_usr_sbin_ovs-vswitchd.0.crash /var/crash/ovs
root at nuv-vir-kvm-server-2 ~ # gdb /usr/sbin/ovs-vswitchd /var/crash/ovs/CoreDump
GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
Copyright (C) 2014 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
<http://www.gnu.org/software/gdb/documentation/>.
For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from /usr/sbin/ovs-vswitchd...(no debugging symbols found)...done.
[New LWP 1262]
[New LWP 1268]
[New LWP 1274]
[New LWP 1264]
[New LWP 1277]
[New LWP 1280]
[New LWP 1289]
[New LWP 1283]
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
Core was generated by `ovs-vswitchd unix:/var/run/openvswitch/db.sock -vconsole:emer -vsyslog:err -vfi'.
Program terminated with signal SIGSEGV, Segmentation fault.
#0  0x0000000000459340 in ?? ()
(gdb) bt
#0  0x0000000000459340 in ?? ()
#1  0x0000000000460473 in ?? ()
#2  0x0000000000460cd2 in ?? ()
#3  0x00000000004609d7 in ?? ()
#4  0x0000000000460fc4 in ?? ()
#5  0x00000000004609d7 in ?? ()
#6  0x00000000004450f3 in ?? ()
#7  0x00000000004453c9 in ?? ()
#8  0x0000000000445433 in ?? ()
#9  0x00000000004455ca in ?? ()
#10 0x000000000041b423 in ?? ()
#11 0x0000000000420f18 in ?? ()
#12 0x0000000000422f52 in ?? ()
#13 0x0000000000424b5a in ?? ()
#14 0x0000000000425196 in ?? ()
#15 0x00000000004122cf in ?? ()
#16 0x00000000004081a5 in ?? ()
#17 0x00000000004059b6 in ?? ()
#18 0x00007fabfe617ec5 in __libc_start_main (main=0x405620, argc=11, argv=0x7fff228eef38, init=<optimized out>, fini=<optimized out>, rtld_fini=<optimized out>,
    stack_end=0x7fff228eef28) at libc-start.c:287
#19 0x0000000000405b19 in ?? ()
(gdb) Quit
(gdb) quit
root at nuv-vir-kvm-server-2 ~ # apt-get install openvswitch-switch-dbgsym
Reading package lists... Done
Building dependency tree
Reading state information... Done
E: Unable to locate package openvswitch-switch-dbgsym
root at nuv-vir-kvm-server-2 ~ # apt-get install openvswitch-switch
Display all 45636 possibilities? (y or n)
root at nuv-vir-kvm-server-2 ~ # apt-get install openvswitch-
openvswitch-common           openvswitch-datapath-dkms    openvswitch-dbg              openvswitch-pki              openvswitch-test
openvswitch-controller       openvswitch-datapath-source  openvswitch-ipsec            openvswitch-switch
root at nuv-vir-kvm-server-2 ~ # apt-get install openvswitch-dbg
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following extra packages will be installed:
  openvswitch-controller openvswitch-pki
The following NEW packages will be installed:
  openvswitch-controller openvswitch-dbg openvswitch-pki
0 upgraded, 3 newly installed, 0 to remove and 3 not upgraded.
Need to get 3,833 kB of archives.
After this operation, 27.0 MB of additional disk space will be used.
Do you want to continue? [Y/n] y
Get:1 http://ppa.launchpad.net/james-page/openvswitch/ubuntu/ trusty/main openvswitch-pki all 2.0.2-0ubuntu0.14.04.2~ubuntu14.04.1~ppa1 [27.6 kB]
Get:2 http://ppa.launchpad.net/james-page/openvswitch/ubuntu/ trusty/main openvswitch-controller amd64 2.0.2-0ubuntu0.14.04.2~ubuntu14.04.1~ppa1 [281 kB]
Get:3 http://ppa.launchpad.net/james-page/openvswitch/ubuntu/ trusty/main openvswitch-dbg amd64 2.0.2-0ubuntu0.14.04.2~ubuntu14.04.1~ppa1 [3,525 kB]
Fetched 3,833 kB in 2s (1,876 kB/s)
Selecting previously unselected package openvswitch-pki.
(Reading database ... 90676 files and directories currently installed.)
Preparing to unpack .../openvswitch-pki_2.0.2-0ubuntu0.14.04.2~ubuntu14.04.1~ppa1_all.deb ...
Unpacking openvswitch-pki (2.0.2-0ubuntu0.14.04.2~ubuntu14.04.1~ppa1) ...
Selecting previously unselected package openvswitch-controller.
Preparing to unpack .../openvswitch-controller_2.0.2-0ubuntu0.14.04.2~ubuntu14.04.1~ppa1_amd64.deb ...
Unpacking openvswitch-controller (2.0.2-0ubuntu0.14.04.2~ubuntu14.04.1~ppa1) ...
Selecting previously unselected package openvswitch-dbg.
Preparing to unpack .../openvswitch-dbg_2.0.2-0ubuntu0.14.04.2~ubuntu14.04.1~ppa1_amd64.deb ...
Unpacking openvswitch-dbg (2.0.2-0ubuntu0.14.04.2~ubuntu14.04.1~ppa1) ...
Processing triggers for man-db (2.6.7.1-1ubuntu1) ...
Processing triggers for ureadahead (0.100.0-16) ...
ureadahead will be reprofiled on next reboot
Setting up openvswitch-pki (2.0.2-0ubuntu0.14.04.2~ubuntu14.04.1~ppa1) ...
Creating controllerca...
Creating switchca...
Setting up openvswitch-controller (2.0.2-0ubuntu0.14.04.2~ubuntu14.04.1~ppa1) ...
 * Starting ovs-controller  ovs-controller                                                                                                                           2015-04-07T09:29:42Z|00001|stream_ssl|INFO|Trusting CA cert from /etc/openvswitch-controller/cacert.pem (/C=US/ST=CA/O=Open vSwitch/OU=switchca/CN=OVS switchca CA Certificate (2015 Apr 07 11:29:39)) (fingerprint 7b:f6:88:7c:82:88:61:7f:31:82:c3:79:76:12:83:4a:86:50:4b:ee)
                                                                                                                                                              [ OK ]
Processing triggers for ureadahead (0.100.0-16) ...
Setting up openvswitch-dbg (2.0.2-0ubuntu0.14.04.2~ubuntu14.04.1~ppa1) ...
root at nuv-vir-kvm-server-2 ~ # gdb /usr/sbin/ovs-vswitchd /var/crash/ovs/CoreDump
GNU gdb (Ubuntu 7.7.1-0ubuntu5~14.04.2) 7.7.1
Copyright (C) 2014 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
<http://www.gnu.org/software/gdb/documentation/>.
For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
done.
[New LWP 1262]
[New LWP 1268]
[New LWP 1274]
[New LWP 1264]
[New LWP 1277]
[New LWP 1280]
[New LWP 1289]
[New LWP 1283]
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
Core was generated by `ovs-vswitchd unix:/var/run/openvswitch/db.sock -vconsole:emer -vsyslog:err -vfi'.
Program terminated with signal SIGSEGV, Segmentation fault.
#0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
506	../lib/netlink.c: No such file or directory.
(gdb) bt
#0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
#1  0x0000000000460473 in format_generic_odp_key (a=a at entry=0x0, ds=ds at entry=0x7fff228e0520) at ../lib/odp-util.c:767
#2  0x0000000000460cd2 in format_odp_key_attr (a=a at entry=0x1b8cdb4, ma=ma at entry=0x0, ds=ds at entry=0x7fff228e0520, verbose=verbose at entry=true)
    at ../lib/odp-util.c:1332
#3  0x00000000004609d7 in odp_flow_format (key=<optimized out>, key_len=40, mask=0x0, mask_len=0, ds=0x7fff228e0520, verbose=true) at ../lib/odp-util.c:1402
#4  0x0000000000460fc4 in format_odp_key_attr (a=a at entry=0x1b8cd90, ma=ma at entry=0x0, ds=ds at entry=0x7fff228e0520, verbose=verbose at entry=true)
    at ../lib/odp-util.c:987
#5  0x00000000004609d7 in odp_flow_format (key=key at entry=0x1b8cd30, key_len=key_len at entry=140, mask=mask at entry=0x0, mask_len=mask_len at entry=0,
    ds=ds at entry=0x7fff228e0520, verbose=verbose at entry=true) at ../lib/odp-util.c:1402
#6  0x00000000004450f3 in log_flow_message (error=error at entry=2, operation=operation at entry=0x4d0e73 "flow_del", key=0x1b8cd30, key_len=140, mask=mask at entry=0x0,
    mask_len=mask_len at entry=0, stats=0x0, actions=actions at entry=0x0, actions_len=actions_len at entry=0, dpif=<optimized out>) at ../lib/dpif.c:1354
#7  0x00000000004453c9 in log_flow_del_message (dpif=dpif at entry=0x1b5d4c0, del=del at entry=0x7fff228e05d0, error=error at entry=2) at ../lib/dpif.c:1397
#8  0x0000000000445433 in log_flow_del_message (error=2, del=0x7fff228e05d0, dpif=0x1b5d4c0) at ../lib/dpif.c:1396
#9  dpif_flow_del__ (dpif=0x1b5d4c0, del=del at entry=0x7fff228e05d0) at ../lib/dpif.c:945
#10 0x00000000004455ca in dpif_flow_del (dpif=<optimized out>, key=<optimized out>, key_len=<optimized out>, stats=stats at entry=0x7fff228e0600) at ../lib/dpif.c:965
#11 0x000000000041b423 in subfacet_uninstall (subfacet=0x1b38af0) at ../ofproto/ofproto-dpif.c:4686
#12 0x0000000000420f18 in facet_remove (facet=facet at entry=0x1b386f0) at ../ofproto/ofproto-dpif.c:4014
#13 0x0000000000422f52 in facet_revalidate (facet=facet at entry=0x1b386f0) at ../ofproto/ofproto-dpif.c:4321
#14 0x0000000000424b5a in facet_lookup_valid (flow=0x7fabe8000c68, ofproto=0x1b69e50) at ../ofproto/ofproto-dpif.c:4203
#15 handle_flow_miss (n_ops=<synthetic pointer>, ops=0x7fff228e0cd0, miss=0x7fabe8000c50) at ../ofproto/ofproto-dpif.c:3339
#16 handle_flow_misses (fmb=fmb at entry=0x7fabe80008e0, backer=<optimized out>) at ../ofproto/ofproto-dpif.c:3410
#17 0x0000000000425196 in handle_upcalls (backer=<optimized out>) at ../ofproto/ofproto-dpif.c:3565
#18 dpif_backer_run_fast (backer=<optimized out>) at ../ofproto/ofproto-dpif.c:1007
#19 type_run_fast (type=<optimized out>) at ../ofproto/ofproto-dpif.c:1024
#20 0x00000000004122cf in ofproto_type_run_fast (datapath_type=<optimized out>, datapath_type at entry=0x1ad7540 "system") at ../ofproto/ofproto.c:1326
#21 0x00000000004081a5 in bridge_run_fast () at ../vswitchd/bridge.c:2318
#22 0x00000000004059b6 in main (argc=<optimized out>, argv=<optimized out>) at ../vswitchd/ovs-vswitchd.c:117
(gdb) quit



 <http://www.nuvula.ch/>
Marco Kuendig / CEO / Founder 
marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71

Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
Nuvula AG - Hybrid Clouds 
Weierbachstrasse 7b 8193 Eglisau Switzerland 
http://www.nuvula.ch <http://www.nuvula.ch/>
> On 04 Apr 2015, at 17:27, James Page <james.page at ubuntu.com> wrote:
> 
> Sorry - missed that (phone email only this weekend).
> 
> Will look in full next week once I'm fully back online.
> 
> --
> James Page
> Technical Lead, OpenStack Engineering Team
> Tel: +44 (0)7545 080150
> 
> 
> On 4 Apr 2015, at 16:19, Marco Kuendig <marco at nuvula.ch <mailto:marco at nuvula.ch>> wrote:
> 
>> nope, as you can see this is commented out. Did try that once but disabled as I recognised that ovs and kernel version have a linkage.
>> 
>> I have kernel 3.13.0.48
>> 
>> currently all servers run ovs 2.0.2
>> 
>>  <http://www.nuvula.ch/>
>> Marco Kuendig / CEO / Founder 
>> marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71
>> 
>> Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
>> Nuvula AG - Hybrid Clouds 
>> Weierbachstrasse 7b 8193 Eglisau Switzerland 
>> http://www.nuvula.ch <http://www.nuvula.ch/>
>>> On 04 Apr 2015, at 17:17, James Page <james.page at ubuntu.com <mailto:james.page at ubuntu.com>> wrote:
>>> 
>>> 
>>> I'd missed the fact that you where upgrading to 2.3.1 - which kernel version are you using?
>>> 
>>> --
>>> James Page
>>> Technical Lead, OpenStack Engineering Team
>>> Tel: +44 (0)7545 080150
>>> 
>>> 
>>> On 4 Apr 2015, at 16:04, Marco Kuendig <marco at nuvula.ch <mailto:marco at nuvula.ch>> wrote:
>>> 
>>>> # upgrade to 2.3.1
>>>> # cd /tmp
>>>> #wget http://de.archive.ubuntu.com/ubuntu/pool/main/o/openvswitch/openvswitch-common_2.3.1-0ubuntu1_amd64.deb <http://de.archive.ubuntu.com/ubuntu/pool/main/o/openvswitch/openvswitch-common_2.3.1-0ubuntu1_amd64.deb>
>>>> #wget http://de.archive.ubuntu.com/ubuntu/pool/main/o/openvswitch/openvswitch-switch_2.3.1-0ubuntu1_amd64.deb <http://de.archive.ubuntu.com/ubuntu/pool/main/o/openvswitch/openvswitch-switch_2.3.1-0ubuntu1_amd64.deb>
>>>> #dpkg -i openvswitch-common_2.3.1-0ubuntu1_amd64.deb
>>>> #dpkg -i openvswitch-switch_2.3.1-0ubuntu1_amd64.deb
>>>> apt-get install -f
>> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150407/4e24526c/attachment-0001.html>

From james.page at ubuntu.com  Tue Apr  7 11:20:08 2015
From: james.page at ubuntu.com (James Page)
Date: Tue, 07 Apr 2015 19:20:08 +0100
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <117DA076-BD34-4C01-94AE-22949AEF0E42@nuvula.ch>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <CANr6G5yB6jiYD+fwYhtPDh3bxams3PNTZLqd25DVcyU1hxmquw@mail.gmail.com>
 <B32CB78D-2CF9-4F47-9515-C8A206C090A2@nuvula.ch>
 <alpine.OSX.1.10.1503311245160.389@sabyasg-mbp-02>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
 <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
 <3E5B9556-CB9F-4D5B-8A6D-A615C099BAD7@nuvula.ch>
 <3FE189EC-49E0-47CC-BD59-2F6E7B04B9A4@ubuntu.com>
 <8CE70C04-9A31-4499-938A-85EC4D13E0BB@nuvula.ch>
 <C222441F-23C1-470A-987E-123B00879EA9@ubuntu.com>
 <117DA076-BD34-4C01-94AE-22949AEF0E42@nuvula.ch>
Message-ID: <55241FD8.1040704@ubuntu.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Hi Marco

On 07/04/15 10:33, Marco Kuendig wrote:
> got another crash today with the optimisation disabled package:
> 
> here the backtrace (at the end is the one with the debug symbols)

Hmm - looks like the same backtrace to me; so maybe this not an
optimizer problem after all.

Would you be willing to try to reproduce on the newer 3.16 HWE kernel
on 14.04 (linux-image-hwe-generic-trusty)? I have a hypothesis on what
might be causing this issue, but I've not been able to prove it yet
and the 3.16 kernel has the required fix in the openvswitch module.

[...]
> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506 
> 506../lib/netlink.c: No such file or directory. (gdb) bt #0
> nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506 #1
> 0x0000000000460473 in format_generic_odp_key (a=a at entry=0x0, 
> ds=ds at entry=0x7fff228e0520) at ../lib/odp-util.c:767 #2
> 0x0000000000460cd2 in format_odp_key_attr (a=a at entry=0x1b8cdb4, 
> ma=ma at entry=0x0, ds=ds at entry=0x7fff228e0520,
> verbose=verbose at entry=true) at ../lib/odp-util.c:1332 #3
> 0x00000000004609d7 in odp_flow_format (key=<optimized out>, 
> key_len=40, mask=0x0, mask_len=0, ds=0x7fff228e0520, verbose=true)
> at ../lib/odp-util.c:1402 #4  0x0000000000460fc4 in
> format_odp_key_attr (a=a at entry=0x1b8cd90, ma=ma at entry=0x0,
> ds=ds at entry=0x7fff228e0520, verbose=verbose at entry=true) at
> ../lib/odp-util.c:987 #5  0x00000000004609d7 in odp_flow_format
> (key=key at entry=0x1b8cd30, key_len=key_len at entry=140,
> mask=mask at entry=0x0, mask_len=mask_len at entry=0, 
> ds=ds at entry=0x7fff228e0520, verbose=verbose at entry=true) at 
> ../lib/odp-util.c:1402 #6  0x00000000004450f3 in log_flow_message
> (error=error at entry=2, operation=operation at entry=0x4d0e73
> "flow_del", key=0x1b8cd30, key_len=140, mask=mask at entry=0x0, 
> mask_len=mask_len at entry=0, stats=0x0, actions=actions at entry=0x0, 
> actions_len=actions_len at entry=0, dpif=<optimized out>) at
> ../lib/dpif.c:1354 #7  0x00000000004453c9 in log_flow_del_message 
> (dpif=dpif at entry=0x1b5d4c0, del=del at entry=0x7fff228e05d0, 
> error=error at entry=2) at ../lib/dpif.c:1397 #8  0x0000000000445433
> in log_flow_del_message (error=2, del=0x7fff228e05d0,
> dpif=0x1b5d4c0) at ../lib/dpif.c:1396 #9  dpif_flow_del__
> (dpif=0x1b5d4c0, del=del at entry=0x7fff228e05d0) at 
> ../lib/dpif.c:945 #10 0x00000000004455ca in dpif_flow_del
> (dpif=<optimized out>, key=<optimized out>, key_len=<optimized
> out>, stats=stats at entry=0x7fff228e0600) at ../lib/dpif.c:965 #11
> 0x000000000041b423 in subfacet_uninstall (subfacet=0x1b38af0) at 
> ../ofproto/ofproto-dpif.c:4686 #12 0x0000000000420f18 in
> facet_remove (facet=facet at entry=0x1b386f0) at 
> ../ofproto/ofproto-dpif.c:4014 #13 0x0000000000422f52 in
> facet_revalidate (facet=facet at entry=0x1b386f0) at
> ../ofproto/ofproto-dpif.c:4321 #14 0x0000000000424b5a in
> facet_lookup_valid (flow=0x7fabe8000c68, ofproto=0x1b69e50) at
> ../ofproto/ofproto-dpif.c:4203 #15 handle_flow_miss
> (n_ops=<synthetic pointer>, ops=0x7fff228e0cd0, 
> miss=0x7fabe8000c50) at ../ofproto/ofproto-dpif.c:3339 #16
> handle_flow_misses (fmb=fmb at entry=0x7fabe80008e0,
> backer=<optimized out>) at ../ofproto/ofproto-dpif.c:3410 #17
> 0x0000000000425196 in handle_upcalls (backer=<optimized out>) at 
> ../ofproto/ofproto-dpif.c:3565 #18 dpif_backer_run_fast
> (backer=<optimized out>) at ../ofproto/ofproto-dpif.c:1007 #19
> type_run_fast (type=<optimized out>) at
> ../ofproto/ofproto-dpif.c:1024 #20 0x00000000004122cf in
> ofproto_type_run_fast (datapath_type=<optimized out>,
> datapath_type at entry=0x1ad7540 "system") at
> ../ofproto/ofproto.c:1326 #21 0x00000000004081a5 in bridge_run_fast
> () at ../vswitchd/bridge.c:2318 #22 0x00000000004059b6 in main
> (argc=<optimized out>, argv=<optimized out>) at
> ../vswitchd/ovs-vswitchd.c:117 (gdb) quit


- -- 
James Page
Ubuntu and Debian Developer
james.page at ubuntu.com
jamespage at debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQIcBAEBCAAGBQJVJB/YAAoJEL/srsug59jDAs8P/3Vy774c1CoyomZAaMnXdlb8
kQm1zYTAWJEJk0Ms3SfaI8roihnhBUB/JS34Ns3FkJXHHTqHpQH2sL+wnRj4jVYZ
TLB8V4t2zezVvl6gFyKdYqMBz+/RGp7yFWG32b3eczMsZDUJCgvGoHdr8dW5sbVm
uFNMZLv5on670NZn8QP/Th8iAHX0dB7Q9QX+QNSNeAg43PHXOoPiy2f8zIbczU+Q
mBUGY5NBWnnJkQStyecP8cII81adXyS/NZwJvf4LaGIZ8q9MW9/dc8C6t/DaYd/a
GZ4jcYBnDMOQd1adPqi3oDx8UtEsK+Z8XOJzueU7mLvzxkRYScNLhv5lmiGP3/Gv
Lr7D0IWFe6pEV1BxGgBZGU51Nle9LiLC2ERmPX5a0g7YZZ6pKdPNmwj93KWvvY4b
sJDBSF7ynQxbDbaDct7ZE2WqEdurkZ1wcFu6c2j6+vf2UKRHZ/J53GpAnYsGS5eL
u8PVqZv4896Vs1nvLZddhN6MrHc4Qu0vSIRA1PcvI350LYcBi8y5wN514H0H8/vr
jy6WBqLRBpXBjReJTHxORKAH6vTIub7IzrIFEM0eQQyhqc0p6Szw2U2p+FQNrD/T
MUY5Sl9hAZTzGGpDkjQfxnyv1NNuozrUXqAs+0SHXw2hsIazKwlN+rJ3nENJPPXo
qjXPMYZeGI4IjXJuvfsZ
=8H5s
-----END PGP SIGNATURE-----

From crackhd2 at gmail.com  Tue Apr  7 11:33:34 2015
From: crackhd2 at gmail.com (Ben Schmidt)
Date: Tue, 7 Apr 2015 20:33:34 +0200
Subject: [ovs-discuss] (no subject)
In-Reply-To: <CAArS4XUWe9t0+xM_Pb11gWQn6BJqLy9c-QDuAR8vmuUP8aOBAg@mail.gmail.com>
References: <CA+Cs8xJMzy333GWBK8YKwuW6z0VRtb2x5Up16MQJKtgK3_G_BQ@mail.gmail.com>
 <CAArS4XWUYxP5t1UkXeoo9hLKFjDMFinbNDS1rTb5Yo_fAeGiJw@mail.gmail.com>
 <CA+Cs8xJOrB-kkvKKQ8KNQJmN=90otV8DF0ci4YxgGhX1xH=Z9Q@mail.gmail.com>
 <CAArS4XUWe9t0+xM_Pb11gWQn6BJqLy9c-QDuAR8vmuUP8aOBAg@mail.gmail.com>
Message-ID: <CA+Cs8xJqO1SqCrfhfsstdks3h9Lrv-GT9XiTfNSfVDhxrU=1tw@mail.gmail.com>

On Thu, Apr 2, 2015 at 7:01 PM, Alex Wang <alexw at nicira.com> wrote:

>
>>> What is the 'ovs-vsctl show' output of Box-B?  For traffic sent from
>>> untagged VLAN port of Box-B, the vmbr0 of Box-A should not forward it
>>> to tagged VLAN ports.
>>>
>>
>> I hope that we have a communication Problem here and I didn't miss
>> something really basic about OVS and wasted everyones time.
>> box-b doesn't use OVS yet. box-b uses normal linux bridging on a untagged
>> VLAN Port (VLAN ID 1115) on a switch. box-a connects to two LACP bond'ed
>> Ports on that some switch that have multiple tagged VLAN IDs, one of them
>> being 1115.
>>
>> ########
>> [root at box-b /root $ ovs-vsctl show
>> 872e809c-3121-4a4f-9fe8-8e436a7cf101
>>     ovs_version: "2.3.1"
>> ########
>>
>> Any Ideas where I could look at?
>>
>>
>
> Thx for providing the info~
>
> Could you try applying the same ovs config on box-b and redo the test to
> see
> if linux bridge is the issue?
>
> Thanks,
> Alex Wang,
>

Hi Alex,

thanks for your help.
So I setup box-b in the same way as box-a on the switch as well as the
interfaces.
A ping between the boxes is fine, fast and reliable. unfortunately the
iperf is super slow in both directions now.

box-a > http://pastebin.ca/2969003
box-b > http://pastebin.ca/2969001

box-b - ovs-vsctl show > http://pastebin.ca/2968991
box-a - ovs-vsctl show > http://pastebin.ca/2968993

iperf box-a > box-b > http://pastebin.ca/2969005
iperf box-b > box-a > http://pastebin.ca/2969006


So in order to get somewhere I removed tagged vlans from the 2x2 LACP
ports, setup these 4 ports to a untagged VLAN but kept the LACP Config to
try giving the OVS bridge a IP directly.
No Problems at all, fast and reliable ping as well as almost 1GBit/s in
both directions.

Next Step was to also also use a tagged port along the untagged one. Same
Problem, ping is fine but iperf doesn't get me anywhere.

So it seems that I only run into these Problems when I use tagged VLANs. Is
there something special about tagged VLANs using OVS because I've used
dozens of these switches without any Problems.
Oh yeah, I already replaced the switch before even asking this mailinglist.

Thanks,
Ben


>
>
>>
>>>
>>> Thanks,
>>> Alex Wang,
>>>
>>
>> Thank YOU,
>> Ben
>>
>>
>>>
>>>
>>>>
>>>> Here is my basic setup
>>>> ######
>>>> ovs-vsctl show
>>>> 8031569b-5210-4334-88fd-36704af3a667
>>>>     Bridge "vmbr0"
>>>>         Port "vlan1115"
>>>>             tag: 1115
>>>>             Interface "vlan1115"
>>>>                 type: internal
>>>>         Port "bond0"
>>>>             Interface "eth1"
>>>>             Interface "eth2"
>>>>         Port "vmbr0"
>>>>             Interface "vmbr0"
>>>>                 type: internal
>>>>         Port "vlan1116"
>>>>             tag: 1116
>>>>             Interface "vlan1116"
>>>>                 type: internal
>>>>     ovs_version: "2.3.1"
>>>> ########
>>>>
>>>>
>>>> cat /etc/network/interfaces = http://pastebin.ca/2967191
>>>> ifconfig = http://pastebin.ca/2967192
>>>> ovs-appctl bond/show bond0 = http://pastebin.ca/2967193
>>>> ovs-appctl lacp/show bond0 = http://pastebin.ca/2967194
>>>> ovs-vsctl list port bond0 = http://pastebin.ca/2967200
>>>>
>>>>
>>>> Could anyone please point me in a direction to look at.
>>>>
>>>> Thanks a lot,
>>>> Ben
>>>>
>>>>
>>>> _______________________________________________
>>>> discuss mailing list
>>>> discuss at openvswitch.org
>>>> http://openvswitch.org/mailman/listinfo/discuss
>>>>
>>>>
>>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150407/960381c2/attachment.html>

From wuhao.thu at gmail.com  Tue Apr  7 13:32:23 2015
From: wuhao.thu at gmail.com (Hao Wu)
Date: Tue, 7 Apr 2015 13:32:23 -0700
Subject: [ovs-discuss] Can I add parameters to NetFlow module bypassing
 the database?
In-Reply-To: <20150330165902.GF16645@nicira.com>
References: <CAHmvmjEys5_ZJu0-rphHyi1N1r8X5iK9OGuPyUG9PC7gWWsafg@mail.gmail.com>
 <20150330165902.GF16645@nicira.com>
Message-ID: <CAHmvmjHr58-NSnpf1exe+QfW20nUNxYvQQ7TotQpbn7OBM6aUg@mail.gmail.com>

Hi Ben,

   Thanks for your kind advice. Sorry for the late response since I'm on
travel last week.

   Currently, I want to add the bloom filter into the datapath to select
the packets to be measured by Netflow. So, I really hope to know the way in
which the packets in datapath are sent to the Netflow module.

   I read the OVS code, and found the flow_update function is called in
void xlate_push_stats() and void xlate_actions(), then, xlate_actions() is
called by static void upcall_xlate(), then, upcall_xlate() is called by
static int process_upcall() in the case of "MISS_UPCALL". I'm confused why
the measured packets are classified as MISS_UPCALL, rather than
"FLOW_SAMPLE_UPCALL" in that switch-case? And what is the "xlate" related
file used for? I need to know this because I have to choose a correct
position to set my bloom filter.

   Thanks.

+++++++++++++++++
Best,
Hao

On Mon, Mar 30, 2015 at 9:59 AM, Ben Pfaff <blp at nicira.com> wrote:

> On Sat, Mar 28, 2015 at 02:06:54PM -0700, Hao Wu wrote:
> >    I add a bloom filter struct into the netflow module,
> /ofproto/netflow.c.
> > Now I insert items into the bloom filter through command ovs-vsctl, as
> the
> > same way to update the parameters in netflow module, like active_timeout
> or
> > targets, etc.. But I find the parameters are written into the ovs
> database
> > first, under ovs-vsctl command, then sent to the netflow module, in which
> > the update throughput is too slow. Is there any way that I can add items
> > into my bloom filter directly and bypass the database? like the way to
> add
> > flow item into flow table? Many thanks.
>
> You can add support through OpenFlow messages.  See the FAQ for a
> starting point:
>
> ### Q: How do I implement a new OpenFlow message?
>
> A: Add your new message to "enum ofpraw" and "enum ofptype" in
>    lib/ofp-msgs.h, following the existing pattern.  Then recompile and
>    fix all of the new warnings, implementing new functionality for the
>    new message as needed.  (If you configure with --enable-Werror, as
>    described in [INSTALL.md], then it is impossible to miss any warnings.)
>
>    If you need to add an OpenFlow vendor extension message for a
>    vendor that doesn't yet have any extension messages, then you will
>    also need to edit build-aux/extract-ofp-msgs.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150407/cbcbb1d9/attachment.html>

From marco at nuvula.ch  Wed Apr  8 02:00:13 2015
From: marco at nuvula.ch (Marco Kuendig)
Date: Wed, 8 Apr 2015 11:00:13 +0200
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <55241FD8.1040704@ubuntu.com>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <CANr6G5yB6jiYD+fwYhtPDh3bxams3PNTZLqd25DVcyU1hxmquw@mail.gmail.com>
 <B32CB78D-2CF9-4F47-9515-C8A206C090A2@nuvula.ch>
 <alpine.OSX.1.10.1503311245160.389@sabyasg-mbp-02>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
 <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
 <3E5B9556-CB9F-4D5B-8A6D-A615C099BAD7@nuvula.ch>
 <3FE189EC-49E0-47CC-BD59-2F6E7B04B9A4@ubuntu.com>
 <8CE70C04-9A31-4499-938A-85EC4D13E0BB@nuvula.ch>
 <C222441F-23C1-470A-987E-123B00879EA9@ubuntu.com>
 <117DA076-BD34-4C01-94AE-22949AEF0E42@nuvula.ch> <55241FD8.1040704@ubuntu.com>
Message-ID: <439374DD-3859-459B-8E55-3A81AFE49765@nuvula.ch>

Hi James

yes, I would be willing to do that. I will upgrade two servers to the 3.16 kernel.

Cheers
marco


 <http://www.nuvula.ch/>
Marco Kuendig / CEO / Founder 
marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71

Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
Nuvula AG - Hybrid Clouds 
Weierbachstrasse 7b 8193 Eglisau Switzerland 
http://www.nuvula.ch <http://www.nuvula.ch/>
> On 07 Apr 2015, at 20:20, James Page <james.page at ubuntu.com> wrote:
> 
> 
> 
> Would you be willing to try to reproduce on the newer 3.16 HWE k

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150408/c579f264/attachment.html>

From xuchenhui_cd at nuaa.edu.cn  Tue Apr  7 20:29:43 2015
From: xuchenhui_cd at nuaa.edu.cn (Allen)
Date: Wed, 8 Apr 2015 11:29:43 +0800 (GMT+08:00)
Subject: [ovs-discuss] Does OpenVSwitch 2.1.3 support priority queue in SDN ?
Message-ID: <116f028.297c.14c97138cd0.Coremail.xuchenhui_cd@nuaa.edu.cn>

Hi,
 
I configure the OpenVSwitch 2.1.3 for QoS application in SDN (OpenFlow13). I can't watch any change after I configure different priority queue for specified port of OVS. And I also Set-Queue number for different flows in RYU controller. Does OVS support priority queue ?


thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150408/cc524cf7/attachment-0001.html>

From sanghamitra.de at gmail.com  Wed Apr  8 03:29:31 2015
From: sanghamitra.de at gmail.com (Sanghamitra De)
Date: Wed, 8 Apr 2015 15:59:31 +0530
Subject: [ovs-discuss] having trouble while trying to install OVS-2.3.1 in
 Ubuntu 14.04 LTS 64 bit
Message-ID: <CAG=b5B3u4P3jWZ+pdx+mRTtW1UtuHPxKkqAK3-wFnwG7trzP9g@mail.gmail.com>

Hi,
To install OVS-2.3.1 in Ubuntu 14.04 LTS 64 bit, I used the following
command sequence which went fine:

sudo mkdir /work
cd /work
wget http://openvswitch.org/releases/openvswitch-2.3.1.tar.gz
tar zxf openvswitch-2.3.1.tar.gz
cd openvswitch-2.3.1
./configure --with-linux=/lib/modules/`uname -r`/build
sudo make modules_install
sudo /sbin/modprobe openvswitch

/sbin/lsmod
cd /
sudo rm -rf /work

After that i made a disc image to use it on other nodes.

However, the following commands for configuring ovs throw error as per the
attached screenshot.


#ovsdb-tool create /usr/local/etc/openvswitch/conf.db
/users/peertest/openvswitch-2.3.1/vswitchd/vswitch.ovsschema
# ovsdb-server --remote=punix:/usr/local/var/run/openvswitch/db.sock
\                 --remote=db:Open_vSwitch,Open_vSwitch,manager_options \
                 --pidfile --detach

What to do?


Do i move straight over to execute the following sequence of configuring
OVS without executing the above 2 commands which give error:

ovs-vsctl --no-wait init
sudo ovs-vswitchd --pidfile --detach --log-file
sudo ovs-vsctl add-br OVSbr1sudo ovs-vsctl add-br OVSbr2sudo ifconfig eth2
0sudo ifconfig eth3 0sudo ovs-vsctl add-port OVSbr1 eth2sudo ovs-vsctl
add-port OVSbr2 eth3sudo ovs-vsctl show


Can anyone kindly give me the command sequence required??? Please help.

PS: errors generated can be seen from the attached screenshot


Thanks & Regards
Sanghamitra
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150408/ce56288b/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: error.jpg
Type: image/jpeg
Size: 75647 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150408/ce56288b/attachment-0001.jpg>

From jeff.tu at qq.com  Wed Apr  8 21:41:55 2015
From: jeff.tu at qq.com (=?utf-8?B?5p2c5rW35rab?=)
Date: Thu, 9 Apr 2015 12:41:55 +0800
Subject: [ovs-discuss] help: about ovs bond configure
Message-ID: <tencent_101D6E8A7F87870C13620979@qq.com>

hi  everybody,
  I want to ask a question about ovs bond.please help me if you know it.
 i am a newbie for learning openvswitch,recently i got a problem when i config ovs bond.
 some detail as follow:
 my system version is centos7 ,kernel is 3.10.0-123.20.1.el7.x86_64. i already config physical switch LACP .
----
 [root at host26 network-scripts]# uname -r
3.10.0-123.20.1.el7.x86_64
[root at host26 network-scripts]# cat /etc/redhat-release 
CentOS Linux release 7.0.1406 (Core)‍
------
‍ I want to bind multiple network interfaces(such as  p2p1 and p3p1) together into a single,simultaneously‍
increasing the bandwidth and providing redundancy.‍
my config files is:
[root at host26 network-scripts]# less ifcfg-ovsbr0 
DEVICE=ovsbr0
ONBOOT=yes
BOOTPROTO=static
USERCTL=no
IPV6INIT=no
IPADDR=172.18.10.42        #another server  is  172.18.10.43
TYPE=OVSBridge
DEVICETYPE=ovs
HOTPLUG=no‍



[root at host26 network-scripts]# less ifcfg-bond0 
DEVICE=bond0
ONBOOT=yes
BOOTPROTO=none
USERCTL=no
IPV6INIT=no
OVS_BRIDGE=ovsbr0
TYPE=OVSBond
BOND_IFACES="p2p1 p3p1"
OVS_OPTIONS="bond_mode=balance-tcp lacp=active other_config:lacp-time=fast"
HOTPLUG=no‍



[root at host26 network-scripts]# less ifcfg-p2p1
DEVICE=p2p1
TYPE=Ethernet
ONBOOT=yes
HOTPLUG=no‍



[root at host26 network-scripts]# less ifcfg-p3p1
DEVICE=p3p1
TYPE=Ethernet
ONBOOT=yes
HOTPLUG=no‍



when i restart network


[root at host26 network-scripts]# ovs-vsctl show
60792242-29d8-4686-9cf5-1ea6cf99bc21
    Bridge "ovsbr0"
        Port "ovsbr0"
            Interface "ovsbr0"
                type: internal
        Port "bond0"
            Interface "p3p1"
            Interface "p2p1"
    ovs_version: "2.0.0"‍



[root at host26 network-scripts]# ovs-appctl bond/show
---- bond0 ----
bond_mode: balance-tcp
bond-hash-basis: 0
updelay: 0 ms
downdelay: 10 ms
next rebalance: 806 ms
lacp_status: negotiated


slave p2p1: enabled
        active slave
        may_enable: true
        hash 143: 0 kB load


slave p3p1: enabled
        may_enable: true
        hash 133: 0 kB load‍







root at host26 network-scripts]# ovs-appctl lacp/show
---- bond0 ----
        status: active negotiated
        sys_id: 00:0a:f7:75:ca:60
        sys_priority: 65534
        aggregation key: 1
        lacp_time: fast


slave: p2p1: current attached
        port_id: 2
        port_priority: 65535
        may_enable: true


        actor sys_id: 00:0a:f7:75:ca:60
        actor sys_priority: 65534
        actor port_id: 2
        actor port_priority: 65535
        actor key: 1
        actor state: activity timeout aggregation synchronized collecting distributing


        partner sys_id: 64:3e:8c:41:2d:50
        partner sys_priority: 0
        partner port_id: 3
        partner port_priority: 32768
        partner key: 9025
        partner state: activity aggregation synchronized collecting distributing


slave: p3p1: current attached
        port_id: 1
        port_priority: 65535
        may_enable: true


        actor sys_id: 00:0a:f7:75:ca:60
        actor sys_priority: 65534
        actor port_id: 1
        actor port_priority: 65535
        actor key: 1
        actor state: activity timeout aggregation synchronized collecting distributing


        partner sys_id: 64:3e:8c:41:2d:50
        partner sys_priority: 0
        partner port_id: 6
        partner port_priority: 32768
        partner key: 9025
        partner state: activity aggregation synchronized collecting distributing‍



my second server is 172.18.10.43, full same config as above just ip address!!


when i use iperf3 and ping to test the bandwidth,as follow:

i found the bandwidth is increasing,exceed one nic's throughput , but problem is coming.  when i down one of the physical nic,the network is interrupt about one minutes,in other words,it's can't providing redundancy normally,how can i change this config to ‍satisfy my ‍purpose.   ‍


I look forward to your early reply,thank you very much.‍


sincerely 

‍

2015.4.9
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150409/2e366553/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 98FA5B0C at AE440102.13032655
Type: application/octet-stream
Size: 22726 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150409/2e366553/attachment-0001.obj>

From sharmila.radhakrishnan at intel.com  Thu Apr  9 00:00:00 2015
From: sharmila.radhakrishnan at intel.com (Radhakrishnan, Sharmila)
Date: Thu, 9 Apr 2015 07:00:00 +0000
Subject: [ovs-discuss]  Mapping dpdk ports to linux interfaces
Message-ID: <1BA01C3192A665469272B2597052DDFF56ECD202@BGSMSX104.gar.corp.intel.com>

Hi,
We can add dpdk port(after binding them  with the linux interfaces eth0 & eth1 for example) using command

ovs-vsctl add-port br0 dpdk0 -- set Interface dpdk0 type=dpdk.

I wanted to   understand if there is any command/file which I can look into to get which port(eth0/eth1) is mapped to dpdk0(or dpdk 'nth' port). Basically, wanted to understand the port mapping of dpdk ports to linux port name or the bus:pci:slot info.

Thanks in Advance for your help!

Regards,
Sharmila

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150409/5b71c53a/attachment.html>

From navneet.singh2012 at gmail.com  Thu Apr  9 00:15:59 2015
From: navneet.singh2012 at gmail.com (Navneet Singh)
Date: Thu, 9 Apr 2015 12:45:59 +0530
Subject: [ovs-discuss] Pushing multiple mpls label
Message-ID: <CAOCzzU+sD2obR7xHJf3+7QbhO0LFddELfjQK-pzNZ9pH5O459w@mail.gmail.com>

Hi All,

I am trying to push multiple mpls labels through openvswitch. I used the
command

> ovs-ofctl add-flow br0
> "in_port=1,action=push_mpls:0x8847,set_field:10->mpls_label,set_field:20->mpls_label,output=2"
>

Command is accepted without error, the flows are matched but I cannot see 2
labels during test. It only shows mpls label 20. I also tried this command
with -O OpenFlow13 but with same result. I am using OVS 2.3.1.

Please help me with this issue. Any small help will be appreciated.

--
Thanks
Navneet
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150409/67a9e538/attachment.html>

From federico.iezzi at hp.com  Thu Apr  9 00:33:40 2015
From: federico.iezzi at hp.com (Iezzi, Federico)
Date: Thu, 9 Apr 2015 07:33:40 +0000
Subject: [ovs-discuss] New release?
Message-ID: <6B8573EBEA47DA438B0DA2226C90B43202065F88@G1W3650.americas.hpqcorp.net>

Hi all,

Is it the right time to create a new git branch for the next OVS version and think about the feature freeze?

Regards,
Federico
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150409/a0e99fe2/attachment.html>

From jpettit at nicira.com  Thu Apr  9 00:37:21 2015
From: jpettit at nicira.com (Justin Pettit)
Date: Thu, 9 Apr 2015 00:37:21 -0700
Subject: [ovs-discuss] New release?
In-Reply-To: <6B8573EBEA47DA438B0DA2226C90B43202065F88@G1W3650.americas.hpqcorp.net>
References: <6B8573EBEA47DA438B0DA2226C90B43202065F88@G1W3650.americas.hpqcorp.net>
Message-ID: <113C2CC8-89A1-418A-910F-2EA5117F1F4B@nicira.com>

A major goal for OVS 2.4 is Linux connection tracking support.  We're still working with the Linux kernel upstream community on that.  Hopefully that will get resolved soon, and then we'll branch 2.4.

--Justin


> On Apr 9, 2015, at 12:33 AM, Iezzi, Federico <federico.iezzi at hp.com> wrote:
> 
> Hi all,
>  
> Is it the right time to create a new git branch for the next OVS version and think about the feature freeze?
>  
> Regards,
> Federico
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss


From 745460565 at qq.com  Thu Apr  9 00:40:48 2015
From: 745460565 at qq.com (=?gb18030?B?zuKzrLHq?=)
Date: Thu, 9 Apr 2015 15:40:48 +0800
Subject: [ovs-discuss] ovs-vsctl:Error detected while setting up 'vn0'.See
	ovs-vswitchd log for details.
Message-ID: <tencent_472C7D753FDE06C41FFBBEE8@qq.com>

hi dear all.
when i use this command----- ovs-vsctl add-port br0 vn0
an error occurred.
-------ovs-vsctl:Error detected while setting up 'vn0'.See ovs-vswitchd log for details.
i dont know why. my ovs version is 2.3.1, and my ubuntu version is 12.4.5


Thanks 
bush
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150409/1788bde0/attachment-0001.html>

From amal.kammoun at supcom.tn  Thu Apr  9 04:25:00 2015
From: amal.kammoun at supcom.tn (Amal KAMMOUN)
Date: Thu, 9 Apr 2015 11:25:00 +0000
Subject: [ovs-discuss] SDN topology.
In-Reply-To: <1427973061080.64404@supcom.tn>
References: <1427810799214.94157@supcom.tn>
 <BLU437-SMTP72C88B8D658C1D0BDE3B4FD4F30@phx.gbl>
 <1427885630471.18204@supcom.tn>,
 <BLU436-SMTP169F573362CD1F6F2656E99D4F30@phx.gbl>,
 <1427973061080.64404@supcom.tn>
Message-ID: <1428578752765.11999@supcom.tn>

So my configuration was right but the problem was that my OVS-VMs had the same @MAC!!

Now it is solved.


Thank you so much for your time.


Best regards,


Amal.

________________________________
From: Amal KAMMOUN
Sent: Thursday, April 2, 2015 11:10 AM
To: Amer
Cc: discuss at openvswitch.org
Subject: Re: [ovs-discuss] SDN topology.


Dear Amer,


I appreciate your note about writing br0 IP in the interfaces configuration file. Thanks.


But I want to get the interconnection between the 2 OVS before doing that.


I read all your posts in March, I find that I have same problems as you.

Would you please tell me how did you fix your issues?


For example in these posts:

http://openvswitch.org/pipermail/discuss/2015-March/016901.html

http://openvswitch.org/pipermail/discuss/2015-March/016943.html


Best regards!


Amal.


________________________________
From: Amer <amer7777 at hotmail.com>
Sent: Wednesday, April 1, 2015 3:49 PM
To: Amal KAMMOUN
Cc: discuss at openvswitch.org
Subject: Re: [ovs-discuss] SDN topology.

Hello,

I did it and was working fine. Note:
The br0 IP is temporary and will be deleted when you reboot. Also, the IP will return back to the eth0. I recommend write it in the interfaces configuration file.

Best regards,
Amer

On Apr 1, 2015, at 1:52 PM, Amal KAMMOUN <amal.kammoun at supcom.tn<mailto:amal.kammoun at supcom.tn>> wrote:


Hello Amer,


So, as you said I will try with a simple scenario like this:


VM1: Host1-------------VM2: OVS1-----------------VM3: OVS2---------VM4: Host2


I want to do the interconnection between the 2 OVSs :


            VM2: OVS1-----------------VM3: OVS2


I connected between VMs using internal-network. For each VM I configured @IP and the netmask (no gateway no dns).


I could have the ping between each other.



I made this configuration:


1) in VM2: @IP 192.168.46.220


ovs-vsctl add-br br0

ovs-vsctl add-port br0 eth0

ifconfig eth0 0

ifconfig br0 up

ifconfig br0 192.168.46.220 netmask 255.255.255.0


2) in VM3: @IP 192.168.46.181


ovs-vsctl add-br br0

ovs-vsctl add-port br0 eth0

ifconfig eth0 0

ifconfig br0 up

ifconfig br0 192.168.46.181 netmask 255.255.255.0


The ping now fails! What I have to do to get the 2 OVS connected?


Thank you so much.




________________________________
From: Amer <amer7777 at hotmail.com<mailto:amer7777 at hotmail.com>>
Sent: Wednesday, April 1, 2015 5:17 AM
To: Amal KAMMOUN
Cc: discuss at openvswitch.org<mailto:discuss at openvswitch.org>
Subject: Re: [ovs-discuss] SDN topology.

Dear Amal

First, try with simple scenario

To connect between VMs you need to use internal-network and assign each VM to the same internal-network, then you need the IPs are in the same subnet for each two VMs.
Also, you need to crest a bridge in each OVS, like br0, then assign some interfaces to the bridge, like add-port br0 eth0, after that, give zero IP address to these interfaces, like ifconfig eth0 0, thereafter, give the bridge an IP address, like ifconfig eth0 192xxxxxxxxx netmask xxxxx.
The bridge IP needs to be written in the main interface configuration file.
To do this you need to search in this archive, I remember someone before few weeks discussed this issue and you will find my name there.
After this setup connecting each OVS to different controller will be easier.

Best regards,
Amer

On Mar 31, 2015, at 5:05 PM, Amal KAMMOUN <amal.kammoun at supcom.tn<mailto:amal.kammoun at supcom.tn>> wrote:


Hello all!


I'm trying to construct the following topology:



       VM1-  OpenFlowController1                            VM2- OpenflowController2

                            |                                                                     |
                            |                                                                     |

                            |                                                                     |
                            |                                                                     |

              VM3 ----------                                                  VM4 ----------

                      | OVS1|----------------------------------------------------------| OVS2|

                      -----------                                                           -----------

                            |                                                                     |

                            |                                                                     |

                            |                                                                     |

                       Host:VM-5                                                 Host:VM-6



All my virtual machines are made by VirtualBox.


It is possible to build such topology?


How can I connect 2 OVS running on 2 different VMs?


Thank you!

_______________________________________________
discuss mailing list
discuss at openvswitch.org<mailto:discuss at openvswitch.org>
http://openvswitch.org/mailman/listinfo/discuss
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150409/1ba0d3ad/attachment.html>

From joestringer at nicira.com  Thu Apr  9 09:56:58 2015
From: joestringer at nicira.com (Joe Stringer)
Date: Thu, 9 Apr 2015 09:56:58 -0700
Subject: [ovs-discuss] having trouble while trying to install OVS-2.3.1
 in Ubuntu 14.04 LTS 64 bit
In-Reply-To: <CAG=b5B3u4P3jWZ+pdx+mRTtW1UtuHPxKkqAK3-wFnwG7trzP9g@mail.gmail.com>
References: <CAG=b5B3u4P3jWZ+pdx+mRTtW1UtuHPxKkqAK3-wFnwG7trzP9g@mail.gmail.com>
Message-ID: <CANr6G5zTs5rV3vfGN9-YUBN5zQFeCBv8rrLMJE9_yo3haruQnA@mail.gmail.com>

You built and installed the kernel module, but skipped the userspace utilities.

After ./configure ..., you need to 'make' and 'make install'.

On 8 April 2015 at 03:29, Sanghamitra De <sanghamitra.de at gmail.com> wrote:
> Hi,
> To install OVS-2.3.1 in Ubuntu 14.04 LTS 64 bit, I used the following
> command sequence which went fine:
>
> sudo mkdir /work
> cd /work
> wget http://openvswitch.org/releases/openvswitch-2.3.1.tar.gz
> tar zxf openvswitch-2.3.1.tar.gz
> cd openvswitch-2.3.1
> ./configure --with-linux=/lib/modules/`uname -r`/build
> sudo make modules_install
> sudo /sbin/modprobe openvswitch
>
> /sbin/lsmod
> cd /
> sudo rm -rf /work
>
> After that i made a disc image to use it on other nodes.
>
> However, the following commands for configuring ovs throw error as per the
> attached screenshot.
>
>
> #ovsdb-tool create /usr/local/etc/openvswitch/conf.db
> /users/peertest/openvswitch-2.3.1/vswitchd/vswitch.ovsschema
> # ovsdb-server --remote=punix:/usr/local/var/run/openvswitch/db.sock \
> --remote=db:Open_vSwitch,Open_vSwitch,manager_options \
>                  --pidfile --detach
>
> What to do?
>
>
> Do i move straight over to execute the following sequence of configuring OVS
> without executing the above 2 commands which give error:
>
> ovs-vsctl --no-wait init
> sudo ovs-vswitchd --pidfile --detach --log-file
> sudo ovs-vsctl add-br OVSbr1sudo ovs-vsctl add-br OVSbr2sudo ifconfig eth2
> 0sudo ifconfig eth3 0sudo ovs-vsctl add-port OVSbr1 eth2sudo ovs-vsctl
> add-port OVSbr2 eth3sudo ovs-vsctl show
>
>
> Can anyone kindly give me the command sequence required??? Please help.
>
> PS: errors generated can be seen from the attached screenshot
>
>
> Thanks & Regards
> Sanghamitra
>
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss
>

From autolocaer at vip.qq.com  Wed Apr  8 21:38:06 2015
From: autolocaer at vip.qq.com (=?utf-8?B?5p2c5rW35rab?=)
Date: Thu, 9 Apr 2015 12:38:06 +0800
Subject: [ovs-discuss] help: about ovs bond configure
Message-ID: <tencent_59C1F4C067334C85055ABEAA@qq.com>

hi  everybody,
  I want to ask a question about ovs bond.please help me if you know it.
 i am a newbie for learning openvswitch,recently i got a problem when i config ovs bond.
 some detail as follow:
 my system version is centos7 ,kernel is 3.10.0-123.20.1.el7.x86_64. i already config physical switch LACP .
----
 [root at host26 network-scripts]# uname -r
3.10.0-123.20.1.el7.x86_64
[root at host26 network-scripts]# cat /etc/redhat-release 
CentOS Linux release 7.0.1406 (Core)‍
------
‍ I want to bind multiple network interfaces(such as  p2p1 and p3p1) together into a single,simultaneously‍
increasing the bandwidth and providing redundancy.‍
my config files is:
[root at host26 network-scripts]# less ifcfg-ovsbr0 
DEVICE=ovsbr0
ONBOOT=yes
BOOTPROTO=static
USERCTL=no
IPV6INIT=no
IPADDR=172.18.10.42        #another server  is  172.18.10.43
TYPE=OVSBridge
DEVICETYPE=ovs
HOTPLUG=no‍



[root at host26 network-scripts]# less ifcfg-bond0 
DEVICE=bond0
ONBOOT=yes
BOOTPROTO=none
USERCTL=no
IPV6INIT=no
OVS_BRIDGE=ovsbr0
TYPE=OVSBond
BOND_IFACES="p2p1 p3p1"
OVS_OPTIONS="bond_mode=balance-tcp lacp=active other_config:lacp-time=fast"
HOTPLUG=no‍



[root at host26 network-scripts]# less ifcfg-p2p1
DEVICE=p2p1
TYPE=Ethernet
ONBOOT=yes
HOTPLUG=no‍



[root at host26 network-scripts]# less ifcfg-p3p1
DEVICE=p3p1
TYPE=Ethernet
ONBOOT=yes
HOTPLUG=no‍



when i restart network


[root at host26 network-scripts]# ovs-vsctl show
60792242-29d8-4686-9cf5-1ea6cf99bc21
    Bridge "ovsbr0"
        Port "ovsbr0"
            Interface "ovsbr0"
                type: internal
        Port "bond0"
            Interface "p3p1"
            Interface "p2p1"
    ovs_version: "2.0.0"‍



[root at host26 network-scripts]# ovs-appctl bond/show
---- bond0 ----
bond_mode: balance-tcp
bond-hash-basis: 0
updelay: 0 ms
downdelay: 10 ms
next rebalance: 806 ms
lacp_status: negotiated


slave p2p1: enabled
        active slave
        may_enable: true
        hash 143: 0 kB load


slave p3p1: enabled
        may_enable: true
        hash 133: 0 kB load‍







root at host26 network-scripts]# ovs-appctl lacp/show
---- bond0 ----
        status: active negotiated
        sys_id: 00:0a:f7:75:ca:60
        sys_priority: 65534
        aggregation key: 1
        lacp_time: fast


slave: p2p1: current attached
        port_id: 2
        port_priority: 65535
        may_enable: true


        actor sys_id: 00:0a:f7:75:ca:60
        actor sys_priority: 65534
        actor port_id: 2
        actor port_priority: 65535
        actor key: 1
        actor state: activity timeout aggregation synchronized collecting distributing


        partner sys_id: 64:3e:8c:41:2d:50
        partner sys_priority: 0
        partner port_id: 3
        partner port_priority: 32768
        partner key: 9025
        partner state: activity aggregation synchronized collecting distributing


slave: p3p1: current attached
        port_id: 1
        port_priority: 65535
        may_enable: true


        actor sys_id: 00:0a:f7:75:ca:60
        actor sys_priority: 65534
        actor port_id: 1
        actor port_priority: 65535
        actor key: 1
        actor state: activity timeout aggregation synchronized collecting distributing


        partner sys_id: 64:3e:8c:41:2d:50
        partner sys_priority: 0
        partner port_id: 6
        partner port_priority: 32768
        partner key: 9025
        partner state: activity aggregation synchronized collecting distributing‍



my second server is 172.18.10.43, full same config as above just ip address!!


when i use iperf3 and ping to test the bandwidth,as follow:

i found the bandwidth is increasing,exceed one nic's throughput , but problem is coming.  when i down one of the physical nic,the network is interrupt about one minutes,in other words,it's can't providing redundancy normally,how can i change this config to ‍satisfy my ‍purpose.   ‍


I look forward to your early reply,thank you very much.‍


sincerely 

‍

2015.4.9
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150409/0c24f56c/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 5BAC21A4 at 01907479.2E022655
Type: application/octet-stream
Size: 22726 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150409/0c24f56c/attachment-0001.obj>

From xuchenhui_cd at nuaa.edu.cn  Thu Apr  9 01:02:08 2015
From: xuchenhui_cd at nuaa.edu.cn (Allen)
Date: Thu, 9 Apr 2015 16:02:08 +0800 (GMT+08:00)
Subject: [ovs-discuss] Queue added but not shown using ovs-ofctl
Message-ID: <1f8821c.33fe.14c9d33562d.Coremail.xuchenhui_cd@nuaa.edu.cn>

Hi,


Can you resolve your problem? I meet the same situation with you .I use the OpenFlow1.3 and OVS 2.1.3. When I run the command :ovs-ofctl queue-stats s1 3  -O OpenFlow13 .The results: OFPST_QUEUE  reply (OF1.3) (xid=0x2): 0 queues .I don't know why occure this situation.


thanks

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150409/6046ae65/attachment.html>

From xuchenhui_cd at nuaa.edu.cn  Thu Apr  9 01:42:19 2015
From: xuchenhui_cd at nuaa.edu.cn (Allen)
Date: Thu, 9 Apr 2015 16:42:19 +0800 (GMT+08:00)
Subject: [ovs-discuss] ovs-vsctl created queue is not shown when using
 ovs-ofctl queue-stats <br_name>
Message-ID: <19c18db.349b.14c9d581cdb.Coremail.xuchenhui_cd@nuaa.edu.cn>

Hi,


Do you resolve your problem ? I meet the same problem with you. And Ben said that check the logs and send him,but I don't know how to look logs.


>On Fri, Feb 21, 2014 at 11:24:31AM -0600, Zhe Zhang wrote:
>[...]
>> Then I tried to check the queue stat by using ovs-ofctl queue-stats <br_name>, the output is:
>>>> OFPST_QUEUE reply (xid=0x2): 0 queues
>>>> I believe the queue actually is not created based on this output, but I don't know why this is not working. Any suggestions on this?

>I would look in the logs.


thanks.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150409/a5d4f173/attachment.html>

From jpettit at nicira.com  Thu Apr  9 11:08:29 2015
From: jpettit at nicira.com (Justin Pettit)
Date: Thu, 9 Apr 2015 11:08:29 -0700
Subject: [ovs-discuss] ovs-vsctl:Error detected while setting up
	'vn0'.See ovs-vswitchd log for details.
In-Reply-To: <tencent_472C7D753FDE06C41FFBBEE8@qq.com>
References: <tencent_472C7D753FDE06C41FFBBEE8@qq.com>
Message-ID: <CF79A0A8-FF9A-4674-9C8F-7BFA2046F407@nicira.com>

Well, as the error message says, what's in the ovs-vswitchd log?

--Justin


> On Apr 9, 2015, at 12:40 AM, 吴超标 <745460565 at qq.com> wrote:
> 
> hi dear all.
> when i use this command----- ovs-vsctl add-port br0 vn0
> an error occurred.
> -------ovs-vsctl:Error detected while setting up 'vn0'.See ovs-vswitchd log for details.
> i dont know why. my ovs version is 2.3.1, and my ubuntu version is 12.4.5
> 
> Thanks 
> bush
> 
>  
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss


From marco at nuvula.ch  Thu Apr  9 12:53:55 2015
From: marco at nuvula.ch (Marco Kuendig)
Date: Thu, 9 Apr 2015 21:53:55 +0200
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <55241FD8.1040704@ubuntu.com>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <CANr6G5yB6jiYD+fwYhtPDh3bxams3PNTZLqd25DVcyU1hxmquw@mail.gmail.com>
 <B32CB78D-2CF9-4F47-9515-C8A206C090A2@nuvula.ch>
 <alpine.OSX.1.10.1503311245160.389@sabyasg-mbp-02>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
 <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
 <3E5B9556-CB9F-4D5B-8A6D-A615C099BAD7@nuvula.ch>
 <3FE189EC-49E0-47CC-BD59-2F6E7B04B9A4@ubuntu.com>
 <8CE70C04-9A31-4499-938A-85EC4D13E0BB@nuvula.ch>
 <C222441F-23C1-470A-987E-123B00879EA9@ubuntu.com>
 <117DA076-BD34-4C01-94AE-22949AEF0E42@nuvula.ch> <55241FD8.1040704@ubuntu.com>
Message-ID: <4F761000-A521-40E9-9D47-413D2B1ACA13@nuvula.ch>

Hi James

new info. Today a crash happened simultaneously on 4 servers:

root at nuv-vir-kvm-server-3 ~ # for l in 1 2 3 5 ; do ssh nuv-vir-kvm-server-$l ls /var/crash -l ; done
total 532
-rw-r--r-- 1 root root    272 Apr  8 11:09 kexec_cmd
drwxr-xr-x 2 root root   4096 Mar 31 21:47 ovs
-rw-r----- 1 root root 535190 Apr  9 19:30 _usr_sbin_ovs-vswitchd.0.crash
total 676
-rw-r--r-- 1 root root    272 Apr  7 10:32 kexec_cmd
drwxr-xr-x 2 root root   4096 Apr  7 11:26 ovs
-rw-r----- 1 root root 683554 Apr  9 19:33 _usr_sbin_ovs-vswitchd.0.crash
total 3200
-rw-r--r-- 1 root root     272 Apr  9 11:30 kexec_cmd
-rw-r----- 1 root root 1892442 Apr  8 12:02 _usr_bin_ceph-osd.0.crash
-rw-r----- 1 root root  598097 Apr  9 19:30 _usr_sbin_ovs-vswitchd.0.crash
-rw-r----- 1 root root  771277 Apr  9 11:31 _usr_sbin_smbd.0.crash
total 4392
-rw-r--r-- 1 root root     272 Apr  9 11:32 kexec_cmd
-rw-r----- 1 root root 3816939 Apr  9 21:39 _usr_bin_ceph-mds.0.crash
-rw-r----- 1 root root   59233 Apr  9 06:25 _usr_lib_squid3_pinger.0.crash
-rw-r----- 1 root root  611846 Apr  9 19:31 _usr_sbin_ovs-vswitchd.0.crash

They crashed all at the same couple of minutes.


Here the 4 BT from all 4 servers:

~ # for l in 1 2 3 5 ; do echo ; echo kvm-"$l" ; echo ; ssh nuv-vir-kvm-server-"$l" gdb /usr/sbin/ovs-vswitchd /var/crash/ovs/CoreDump -ex bt -ex quit --quiet ;echo  ; done

kvm-1

Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
done.
[New LWP 1155]
[New LWP 1160]
[New LWP 1173]
[New LWP 1183]
[New LWP 1163]
[New LWP 1168]
[New LWP 1178]
[New LWP 1157]
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
Core was generated by `ovs-vswitchd unix:/var/run/openvswitch/db.sock -vconsole:emer -vsyslog:err -vfi'.
Program terminated with signal SIGSEGV, Segmentation fault.
#0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
506	../lib/netlink.c: No such file or directory.
#0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
#1  0x0000000000460473 in format_generic_odp_key (a=a at entry=0x0,
    ds=ds at entry=0x7fff6ef422f0) at ../lib/odp-util.c:767
#2  0x0000000000460cd2 in format_odp_key_attr (a=a at entry=0x1afad54,
    ma=ma at entry=0x0, ds=ds at entry=0x7fff6ef422f0, verbose=verbose at entry=true)
    at ../lib/odp-util.c:1332
#3  0x00000000004609d7 in odp_flow_format (key=<optimized out>, key_len=40,
    mask=0x0, mask_len=0, ds=0x7fff6ef422f0, verbose=true)
    at ../lib/odp-util.c:1402
#4  0x0000000000460fc4 in format_odp_key_attr (a=a at entry=0x1afad30,
    ma=ma at entry=0x0, ds=ds at entry=0x7fff6ef422f0, verbose=verbose at entry=true)
    at ../lib/odp-util.c:987
#5  0x00000000004609d7 in odp_flow_format (key=key at entry=0x1afacd0,
    key_len=key_len at entry=140, mask=mask at entry=0x0,
    mask_len=mask_len at entry=0, ds=ds at entry=0x7fff6ef422f0,
    verbose=verbose at entry=true) at ../lib/odp-util.c:1402
#6  0x00000000004450f3 in log_flow_message (error=error at entry=2,
    operation=operation at entry=0x4d0e73 "flow_del", key=0x1afacd0,
    key_len=140, mask=mask at entry=0x0, mask_len=mask_len at entry=0, stats=0x0,
    actions=actions at entry=0x0, actions_len=actions_len at entry=0,
    dpif=<optimized out>) at ../lib/dpif.c:1354
#7  0x00000000004453c9 in log_flow_del_message (dpif=dpif at entry=0x1b27ce0,
    del=del at entry=0x7fff6ef423a0, error=error at entry=2) at ../lib/dpif.c:1397
#8  0x0000000000445433 in log_flow_del_message (error=2, del=0x7fff6ef423a0,
    dpif=0x1b27ce0) at ../lib/dpif.c:1396
#9  dpif_flow_del__ (dpif=0x1b27ce0, del=del at entry=0x7fff6ef423a0)
    at ../lib/dpif.c:945
#10 0x00000000004455ca in dpif_flow_del (dpif=<optimized out>,
    key=<optimized out>, key_len=<optimized out>,
    stats=stats at entry=0x7fff6ef423d0) at ../lib/dpif.c:965
#11 0x000000000041b423 in subfacet_uninstall (subfacet=0x1b0cd70)
    at ../ofproto/ofproto-dpif.c:4686
#12 0x0000000000420f18 in facet_remove (facet=facet at entry=0x1b0c970)
    at ../ofproto/ofproto-dpif.c:4014
#13 0x0000000000422f52 in facet_revalidate (facet=facet at entry=0x1b0c970)
    at ../ofproto/ofproto-dpif.c:4321
#14 0x0000000000424b5a in facet_lookup_valid (flow=0x7fb56c000c68,
    ofproto=0x1b2b8f0) at ../ofproto/ofproto-dpif.c:4203
#15 handle_flow_miss (n_ops=<synthetic pointer>, ops=0x7fff6ef42aa0,
    miss=0x7fb56c000c50) at ../ofproto/ofproto-dpif.c:3339
#16 handle_flow_misses (fmb=fmb at entry=0x7fb56c0008e0, backer=<optimized out>)
    at ../ofproto/ofproto-dpif.c:3410
#17 0x0000000000425196 in handle_upcalls (backer=<optimized out>)
    at ../ofproto/ofproto-dpif.c:3565
#18 dpif_backer_run_fast (backer=<optimized out>)
    at ../ofproto/ofproto-dpif.c:1007
#19 type_run_fast (type=<optimized out>) at ../ofproto/ofproto-dpif.c:1024
#20 0x00000000004122cf in ofproto_type_run_fast (
    datapath_type=<optimized out>, datapath_type at entry=0x1aed670 "system")
    at ../ofproto/ofproto.c:1326
#21 0x00000000004081a5 in bridge_run_fast () at ../vswitchd/bridge.c:2318
#22 0x00000000004059c5 in main (argc=<optimized out>, argv=<optimized out>)
    at ../vswitchd/ovs-vswitchd.c:119


kvm-2

Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
done.
[New LWP 11556]
[New LWP 11561]
[New LWP 11557]
[New LWP 11558]
[New LWP 11563]
[New LWP 11559]
[New LWP 11560]
[New LWP 11562]
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
Core was generated by `ovs-vswitchd unix:/var/run/openvswitch/db.sock -vconsole:emer -vsyslog:err -vfi'.
Program terminated with signal SIGSEGV, Segmentation fault.
#0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
506	../lib/netlink.c: No such file or directory.
#0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
#1  0x0000000000460473 in format_generic_odp_key (a=a at entry=0x0,
    ds=ds at entry=0x7fff228e0520) at ../lib/odp-util.c:767
#2  0x0000000000460cd2 in format_odp_key_attr (a=a at entry=0x1b59814,
    ma=ma at entry=0x0, ds=ds at entry=0x7fff228e0520, verbose=verbose at entry=true)
    at ../lib/odp-util.c:1332
#3  0x00000000004609d7 in odp_flow_format (key=<optimized out>, key_len=40,
    mask=0x0, mask_len=0, ds=0x7fff228e0520, verbose=true)
    at ../lib/odp-util.c:1402
#4  0x0000000000460fc4 in format_odp_key_attr (a=a at entry=0x1b597f0,
    ma=ma at entry=0x0, ds=ds at entry=0x7fff228e0520, verbose=verbose at entry=true)
    at ../lib/odp-util.c:987
#5  0x00000000004609d7 in odp_flow_format (key=key at entry=0x1b59790,
    key_len=key_len at entry=140, mask=mask at entry=0x0,
    mask_len=mask_len at entry=0, ds=ds at entry=0x7fff228e0520,
    verbose=verbose at entry=true) at ../lib/odp-util.c:1402
#6  0x00000000004450f3 in log_flow_message (error=error at entry=2,
    operation=operation at entry=0x4d0e73 "flow_del", key=0x1b59790,
    key_len=140, mask=mask at entry=0x0, mask_len=mask_len at entry=0, stats=0x0,
    actions=actions at entry=0x0, actions_len=actions_len at entry=0,
    dpif=<optimized out>) at ../lib/dpif.c:1354
#7  0x00000000004453c9 in log_flow_del_message (dpif=dpif at entry=0x1b86f10,
    del=del at entry=0x7fff228e05d0, error=error at entry=2) at ../lib/dpif.c:1397
#8  0x0000000000445433 in log_flow_del_message (error=2, del=0x7fff228e05d0,
    dpif=0x1b86f10) at ../lib/dpif.c:1396
#9  dpif_flow_del__ (dpif=0x1b86f10, del=del at entry=0x7fff228e05d0)
    at ../lib/dpif.c:945
#10 0x00000000004455ca in dpif_flow_del (dpif=<optimized out>,
    key=<optimized out>, key_len=<optimized out>,
    stats=stats at entry=0x7fff228e0600) at ../lib/dpif.c:965
#11 0x000000000041b423 in subfacet_uninstall (subfacet=0x1b2f9f0)
    at ../ofproto/ofproto-dpif.c:4686
#12 0x0000000000420f18 in facet_remove (facet=facet at entry=0x1b2f5f0)
    at ../ofproto/ofproto-dpif.c:4014
#13 0x0000000000422f52 in facet_revalidate (facet=facet at entry=0x1b2f5f0)
    at ../ofproto/ofproto-dpif.c:4321
#14 0x0000000000424b5a in facet_lookup_valid (flow=0x7fabf800b5b8,
    ofproto=0x1b917d0) at ../ofproto/ofproto-dpif.c:4203
#15 handle_flow_miss (n_ops=<synthetic pointer>, ops=0x7fff228e0cd0,
    miss=0x7fabf800b5a0) at ../ofproto/ofproto-dpif.c:3339
#16 handle_flow_misses (fmb=fmb at entry=0x7fabf800b230, backer=<optimized out>)
    at ../ofproto/ofproto-dpif.c:3410
#17 0x0000000000425196 in handle_upcalls (backer=<optimized out>)
    at ../ofproto/ofproto-dpif.c:3565
#18 dpif_backer_run_fast (backer=<optimized out>)
    at ../ofproto/ofproto-dpif.c:1007
#19 type_run_fast (type=<optimized out>) at ../ofproto/ofproto-dpif.c:1024
#20 0x00000000004122cf in ofproto_type_run_fast (
    datapath_type=<optimized out>, datapath_type at entry=0x1b7ec50 "system")
    at ../ofproto/ofproto.c:1326
#21 0x00000000004081a5 in bridge_run_fast () at ../vswitchd/bridge.c:2318
#22 0x00000000004059c5 in main (argc=<optimized out>, argv=<optimized out>)
    at ../vswitchd/ovs-vswitchd.c:119


kvm-3

Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
done.
[New LWP 1009]
[New LWP 1028]
[New LWP 1042]
[New LWP 1021]
[New LWP 1017]
[New LWP 1023]
[New LWP 1047]
[New LWP 1034]
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
Core was generated by `ovs-vswitchd unix:/var/run/openvswitch/db.sock -vconsole:emer -vsyslog:err -vfi'.
Program terminated with signal SIGSEGV, Segmentation fault.
#0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
506	../lib/netlink.c: No such file or directory.
#0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
#1  0x0000000000460473 in format_generic_odp_key (a=a at entry=0x0,
    ds=ds at entry=0x7fff77f5c400) at ../lib/odp-util.c:767
#2  0x0000000000460cd2 in format_odp_key_attr (a=a at entry=0xe1bd14,
    ma=ma at entry=0x0, ds=ds at entry=0x7fff77f5c400, verbose=verbose at entry=true)
    at ../lib/odp-util.c:1332
#3  0x00000000004609d7 in odp_flow_format (key=<optimized out>, key_len=40,
    mask=0x0, mask_len=0, ds=0x7fff77f5c400, verbose=true)
    at ../lib/odp-util.c:1402
#4  0x0000000000460fc4 in format_odp_key_attr (a=a at entry=0xe1bcf0,
    ma=ma at entry=0x0, ds=ds at entry=0x7fff77f5c400, verbose=verbose at entry=true)
    at ../lib/odp-util.c:987
#5  0x00000000004609d7 in odp_flow_format (key=key at entry=0xe1bc90,
    key_len=key_len at entry=140, mask=mask at entry=0x0,
    mask_len=mask_len at entry=0, ds=ds at entry=0x7fff77f5c400,
    verbose=verbose at entry=true) at ../lib/odp-util.c:1402
#6  0x00000000004450f3 in log_flow_message (error=error at entry=2,
    operation=operation at entry=0x4d0e73 "flow_del", key=0xe1bc90, key_len=140,
    mask=mask at entry=0x0, mask_len=mask_len at entry=0, stats=0x0,
    actions=actions at entry=0x0, actions_len=actions_len at entry=0,
    dpif=<optimized out>) at ../lib/dpif.c:1354
#7  0x00000000004453c9 in log_flow_del_message (dpif=dpif at entry=0xda7750,
    del=del at entry=0x7fff77f5c4b0, error=error at entry=2) at ../lib/dpif.c:1397
#8  0x0000000000445433 in log_flow_del_message (error=2, del=0x7fff77f5c4b0,
    dpif=0xda7750) at ../lib/dpif.c:1396
#9  dpif_flow_del__ (dpif=0xda7750, del=del at entry=0x7fff77f5c4b0)
    at ../lib/dpif.c:945
#10 0x00000000004455ca in dpif_flow_del (dpif=<optimized out>,
    key=<optimized out>, key_len=<optimized out>,
    stats=stats at entry=0x7fff77f5c4e0) at ../lib/dpif.c:965
#11 0x000000000041b423 in subfacet_uninstall (subfacet=0xd61bb0)
    at ../ofproto/ofproto-dpif.c:4686
#12 0x0000000000420f18 in facet_remove (facet=facet at entry=0xd617b0)
    at ../ofproto/ofproto-dpif.c:4014
#13 0x0000000000422f52 in facet_revalidate (facet=facet at entry=0xd617b0)
    at ../ofproto/ofproto-dpif.c:4321
#14 0x0000000000424b5a in facet_lookup_valid (flow=0x7f0638000908,
    ofproto=0xdaf0a0) at ../ofproto/ofproto-dpif.c:4203
#15 handle_flow_miss (n_ops=<synthetic pointer>, ops=0x7fff77f5cbb0,
    miss=0x7f06380008f0) at ../ofproto/ofproto-dpif.c:3339
#16 handle_flow_misses (fmb=fmb at entry=0x7f06380008e0, backer=<optimized out>)
    at ../ofproto/ofproto-dpif.c:3410
#17 0x0000000000425196 in handle_upcalls (backer=<optimized out>)
    at ../ofproto/ofproto-dpif.c:3565
#18 dpif_backer_run_fast (backer=<optimized out>)
    at ../ofproto/ofproto-dpif.c:1007
#19 type_run_fast (type=<optimized out>) at ../ofproto/ofproto-dpif.c:1024
#20 0x00000000004122cf in ofproto_type_run_fast (
    datapath_type=<optimized out>, datapath_type at entry=0xd788a0 "system")
    at ../ofproto/ofproto.c:1326
#21 0x00000000004081a5 in bridge_run_fast () at ../vswitchd/bridge.c:2318
#22 0x00000000004059c5 in main (argc=<optimized out>, argv=<optimized out>)
    at ../vswitchd/ovs-vswitchd.c:119


kvm-5

Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
done.
[New LWP 1446]
[New LWP 1451]
[New LWP 1448]
[New LWP 1459]
[New LWP 1469]
[New LWP 1464]
[New LWP 1474]
[New LWP 1455]
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
Core was generated by `ovs-vswitchd unix:/var/run/openvswitch/db.sock -vconsole:emer -vsyslog:err -vfi'.
Program terminated with signal SIGSEGV, Segmentation fault.
#0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
506	../lib/netlink.c: No such file or directory.
#0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
#1  0x0000000000460473 in format_generic_odp_key (a=a at entry=0x0,
    ds=ds at entry=0x7fff84d1c0b0) at ../lib/odp-util.c:767
#2  0x0000000000460cd2 in format_odp_key_attr (a=a at entry=0xbf62a4,
    ma=ma at entry=0x0, ds=ds at entry=0x7fff84d1c0b0, verbose=verbose at entry=true)
    at ../lib/odp-util.c:1332
#3  0x00000000004609d7 in odp_flow_format (key=<optimized out>, key_len=40,
    mask=0x0, mask_len=0, ds=0x7fff84d1c0b0, verbose=true)
    at ../lib/odp-util.c:1402
#4  0x0000000000460fc4 in format_odp_key_attr (a=a at entry=0xbf6280,
    ma=ma at entry=0x0, ds=ds at entry=0x7fff84d1c0b0, verbose=verbose at entry=true)
    at ../lib/odp-util.c:987
#5  0x00000000004609d7 in odp_flow_format (key=key at entry=0xbf6220,
    key_len=key_len at entry=140, mask=mask at entry=0x0,
    mask_len=mask_len at entry=0, ds=ds at entry=0x7fff84d1c0b0,
    verbose=verbose at entry=true) at ../lib/odp-util.c:1402
#6  0x00000000004450f3 in log_flow_message (error=error at entry=2,
    operation=operation at entry=0x4d0e73 "flow_del", key=0xbf6220, key_len=140,
    mask=mask at entry=0x0, mask_len=mask_len at entry=0, stats=0x0,
    actions=actions at entry=0x0, actions_len=actions_len at entry=0,
    dpif=<optimized out>) at ../lib/dpif.c:1354
#7  0x00000000004453c9 in log_flow_del_message (dpif=dpif at entry=0xb82440,
    del=del at entry=0x7fff84d1c160, error=error at entry=2) at ../lib/dpif.c:1397
#8  0x0000000000445433 in log_flow_del_message (error=2, del=0x7fff84d1c160,
    dpif=0xb82440) at ../lib/dpif.c:1396
#9  dpif_flow_del__ (dpif=0xb82440, del=del at entry=0x7fff84d1c160)
    at ../lib/dpif.c:945
#10 0x00000000004455ca in dpif_flow_del (dpif=<optimized out>,
    key=<optimized out>, key_len=<optimized out>,
    stats=stats at entry=0x7fff84d1c190) at ../lib/dpif.c:965
#11 0x000000000041b423 in subfacet_uninstall (subfacet=0xbf82f0)
    at ../ofproto/ofproto-dpif.c:4686
#12 0x0000000000420f18 in facet_remove (facet=0xbf7ef0)
    at ../ofproto/ofproto-dpif.c:4014
#13 0x0000000000422f52 in facet_revalidate (facet=facet at entry=0xbf7ef0)
    at ../ofproto/ofproto-dpif.c:4321
#14 0x0000000000424b5a in facet_lookup_valid (flow=0x7fd548000c68,
    ofproto=0xb87ec0) at ../ofproto/ofproto-dpif.c:4203
#15 handle_flow_miss (n_ops=<synthetic pointer>, ops=0x7fff84d1c860,
    miss=0x7fd548000c50) at ../ofproto/ofproto-dpif.c:3339
#16 handle_flow_misses (fmb=fmb at entry=0x7fd5480008e0, backer=<optimized out>)
    at ../ofproto/ofproto-dpif.c:3410
#17 0x0000000000425196 in handle_upcalls (backer=<optimized out>)
    at ../ofproto/ofproto-dpif.c:3565
#18 dpif_backer_run_fast (backer=<optimized out>)
    at ../ofproto/ofproto-dpif.c:1007
#19 type_run_fast (type=<optimized out>) at ../ofproto/ofproto-dpif.c:1024
#20 0x00000000004122cf in ofproto_type_run_fast (
    datapath_type=<optimized out>, datapath_type at entry=0xb2eaf0 "system")
    at ../ofproto/ofproto.c:1326
#21 0x00000000004081a5 in bridge_run_fast () at ../vswitchd/bridge.c:2318
#22 0x00000000004059c5 in main (argc=<optimized out>, argv=<optimized out>)
    at ../vswitchd/ovs-vswitchd.c:119

They all run the non-optimised code.

Cheers
marco


 <http://www.nuvula.ch/>
Marco Kuendig / CEO / Founder 
marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71

Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
Nuvula AG - Hybrid Clouds 
Weierbachstrasse 7b 8193 Eglisau Switzerland 
http://www.nuvula.ch <http://www.nuvula.ch/>
> On 07 Apr 2015, at 20:20, James Page <james.page at ubuntu.com> wrote:
> 
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA256
> 
> Hi Marco
> 
> On 07/04/15 10:33, Marco Kuendig wrote:
>> got another crash today with the optimisation disabled package:
>> 
>> here the backtrace (at the end is the one with the debug symbols)
> 
> Hmm - looks like the same backtrace to me; so maybe this not an
> optimizer problem after all.
> 
> Would you be willing to try to reproduce on the newer 3.16 HWE kernel
> on 14.04 (linux-image-hwe-generic-trusty)? I have a hypothesis on what
> might be causing this issue, but I've not been able to prove it yet
> and the 3.16 kernel has the required fix in the openvswitch module.
> 
> [...]
>> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506 
>> 506../lib/netlink.c: No such file or directory. (gdb) bt #0
>> nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506 #1
>> 0x0000000000460473 in format_generic_odp_key (a=a at entry=0x0, 
>> ds=ds at entry=0x7fff228e0520) at ../lib/odp-util.c:767 #2
>> 0x0000000000460cd2 in format_odp_key_attr (a=a at entry=0x1b8cdb4, 
>> ma=ma at entry=0x0, ds=ds at entry=0x7fff228e0520,
>> verbose=verbose at entry=true) at ../lib/odp-util.c:1332 #3
>> 0x00000000004609d7 in odp_flow_format (key=<optimized out>, 
>> key_len=40, mask=0x0, mask_len=0, ds=0x7fff228e0520, verbose=true)
>> at ../lib/odp-util.c:1402 #4  0x0000000000460fc4 in
>> format_odp_key_attr (a=a at entry=0x1b8cd90, ma=ma at entry=0x0,
>> ds=ds at entry=0x7fff228e0520, verbose=verbose at entry=true) at
>> ../lib/odp-util.c:987 #5  0x00000000004609d7 in odp_flow_format
>> (key=key at entry=0x1b8cd30, key_len=key_len at entry=140,
>> mask=mask at entry=0x0, mask_len=mask_len at entry=0, 
>> ds=ds at entry=0x7fff228e0520, verbose=verbose at entry=true) at 
>> ../lib/odp-util.c:1402 #6  0x00000000004450f3 in log_flow_message
>> (error=error at entry=2, operation=operation at entry=0x4d0e73
>> "flow_del", key=0x1b8cd30, key_len=140, mask=mask at entry=0x0, 
>> mask_len=mask_len at entry=0, stats=0x0, actions=actions at entry=0x0, 
>> actions_len=actions_len at entry=0, dpif=<optimized out>) at
>> ../lib/dpif.c:1354 #7  0x00000000004453c9 in log_flow_del_message 
>> (dpif=dpif at entry=0x1b5d4c0, del=del at entry=0x7fff228e05d0, 
>> error=error at entry=2) at ../lib/dpif.c:1397 #8  0x0000000000445433
>> in log_flow_del_message (error=2, del=0x7fff228e05d0,
>> dpif=0x1b5d4c0) at ../lib/dpif.c:1396 #9  dpif_flow_del__
>> (dpif=0x1b5d4c0, del=del at entry=0x7fff228e05d0) at 
>> ../lib/dpif.c:945 #10 0x00000000004455ca in dpif_flow_del
>> (dpif=<optimized out>, key=<optimized out>, key_len=<optimized
>> out>, stats=stats at entry=0x7fff228e0600) at ../lib/dpif.c:965 #11
>> 0x000000000041b423 in subfacet_uninstall (subfacet=0x1b38af0) at 
>> ../ofproto/ofproto-dpif.c:4686 #12 0x0000000000420f18 in
>> facet_remove (facet=facet at entry=0x1b386f0) at 
>> ../ofproto/ofproto-dpif.c:4014 #13 0x0000000000422f52 in
>> facet_revalidate (facet=facet at entry=0x1b386f0) at
>> ../ofproto/ofproto-dpif.c:4321 #14 0x0000000000424b5a in
>> facet_lookup_valid (flow=0x7fabe8000c68, ofproto=0x1b69e50) at
>> ../ofproto/ofproto-dpif.c:4203 #15 handle_flow_miss
>> (n_ops=<synthetic pointer>, ops=0x7fff228e0cd0, 
>> miss=0x7fabe8000c50) at ../ofproto/ofproto-dpif.c:3339 #16
>> handle_flow_misses (fmb=fmb at entry=0x7fabe80008e0,
>> backer=<optimized out>) at ../ofproto/ofproto-dpif.c:3410 #17
>> 0x0000000000425196 in handle_upcalls (backer=<optimized out>) at 
>> ../ofproto/ofproto-dpif.c:3565 #18 dpif_backer_run_fast
>> (backer=<optimized out>) at ../ofproto/ofproto-dpif.c:1007 #19
>> type_run_fast (type=<optimized out>) at
>> ../ofproto/ofproto-dpif.c:1024 #20 0x00000000004122cf in
>> ofproto_type_run_fast (datapath_type=<optimized out>,
>> datapath_type at entry=0x1ad7540 "system") at
>> ../ofproto/ofproto.c:1326 #21 0x00000000004081a5 in bridge_run_fast
>> () at ../vswitchd/bridge.c:2318 #22 0x00000000004059b6 in main
>> (argc=<optimized out>, argv=<optimized out>) at
>> ../vswitchd/ovs-vswitchd.c:117 (gdb) quit
> 
> 
> - -- 
> James Page
> Ubuntu and Debian Developer
> james.page at ubuntu.com
> jamespage at debian.org
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v2
> 
> iQIcBAEBCAAGBQJVJB/YAAoJEL/srsug59jDAs8P/3Vy774c1CoyomZAaMnXdlb8
> kQm1zYTAWJEJk0Ms3SfaI8roihnhBUB/JS34Ns3FkJXHHTqHpQH2sL+wnRj4jVYZ
> TLB8V4t2zezVvl6gFyKdYqMBz+/RGp7yFWG32b3eczMsZDUJCgvGoHdr8dW5sbVm
> uFNMZLv5on670NZn8QP/Th8iAHX0dB7Q9QX+QNSNeAg43PHXOoPiy2f8zIbczU+Q
> mBUGY5NBWnnJkQStyecP8cII81adXyS/NZwJvf4LaGIZ8q9MW9/dc8C6t/DaYd/a
> GZ4jcYBnDMOQd1adPqi3oDx8UtEsK+Z8XOJzueU7mLvzxkRYScNLhv5lmiGP3/Gv
> Lr7D0IWFe6pEV1BxGgBZGU51Nle9LiLC2ERmPX5a0g7YZZ6pKdPNmwj93KWvvY4b
> sJDBSF7ynQxbDbaDct7ZE2WqEdurkZ1wcFu6c2j6+vf2UKRHZ/J53GpAnYsGS5eL
> u8PVqZv4896Vs1nvLZddhN6MrHc4Qu0vSIRA1PcvI350LYcBi8y5wN514H0H8/vr
> jy6WBqLRBpXBjReJTHxORKAH6vTIub7IzrIFEM0eQQyhqc0p6Szw2U2p+FQNrD/T
> MUY5Sl9hAZTzGGpDkjQfxnyv1NNuozrUXqAs+0SHXw2hsIazKwlN+rJ3nENJPPXo
> qjXPMYZeGI4IjXJuvfsZ
> =8H5s
> -----END PGP SIGNATURE-----

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150409/b8fa097f/attachment-0001.html>

From jeff.tu at qq.com  Thu Apr  9 19:28:34 2015
From: jeff.tu at qq.com (=?utf-8?B?5p2c5rW35rab?=)
Date: Fri, 10 Apr 2015 10:28:34 +0800
Subject: [ovs-discuss] =?utf-8?b?5Zue5aSN77yaIGhlbHA6IGFib3V0IG92cyBib25k?=
 =?utf-8?q?_configure?=
In-Reply-To: <tencent_78AF4DC80FEFD2B863412479@qq.com>
References: <tencent_101D6E8A7F87870C13620979@qq.com>
 <tencent_78AF4DC80FEFD2B863412479@qq.com>
Message-ID: <tencent_3E1FB4351D97B1136DF15399@qq.com>

anybody know about it?  please tell me how to modify it .


------------------ 原始邮件 ------------------
发件人: "杜海涛";<jeff.tu at qq.com>;
发送时间: 2015年4月9日(星期四) 中午12:41
收件人: "discuss"<discuss at openvswitch.org>; 

主题: [ovs-discuss] help: about ovs bond configure



hi  everybody,
  I want to ask a question about ovs bond.please help me if you know it.
 i am a newbie for learning openvswitch,recently i got a problem when i config ovs bond.
 some detail as follow:
 my system version is centos7 ,kernel is 3.10.0-123.20.1.el7.x86_64. i already config physical switch LACP .
----
 [root at host26 network-scripts]# uname -r
3.10.0-123.20.1.el7.x86_64
[root at host26 network-scripts]# cat /etc/redhat-release 
CentOS Linux release 7.0.1406 (Core)‍
------
‍ I want to bind multiple network interfaces(such as  p2p1 and p3p1) together into a single,simultaneously‍
increasing the bandwidth and providing redundancy.‍
my config files is:
[root at host26 network-scripts]# less ifcfg-ovsbr0 
DEVICE=ovsbr0
ONBOOT=yes
BOOTPROTO=static
USERCTL=no
IPV6INIT=no
IPADDR=172.18.10.42        #another server  is  172.18.10.43
TYPE=OVSBridge
DEVICETYPE=ovs
HOTPLUG=no‍



[root at host26 network-scripts]# less ifcfg-bond0 
DEVICE=bond0
ONBOOT=yes
BOOTPROTO=none
USERCTL=no
IPV6INIT=no
OVS_BRIDGE=ovsbr0
TYPE=OVSBond
BOND_IFACES="p2p1 p3p1"
OVS_OPTIONS="bond_mode=balance-tcp lacp=active other_config:lacp-time=fast"
HOTPLUG=no‍



[root at host26 network-scripts]# less ifcfg-p2p1
DEVICE=p2p1
TYPE=Ethernet
ONBOOT=yes
HOTPLUG=no‍



[root at host26 network-scripts]# less ifcfg-p3p1
DEVICE=p3p1
TYPE=Ethernet
ONBOOT=yes
HOTPLUG=no‍



when i restart network


[root at host26 network-scripts]# ovs-vsctl show
60792242-29d8-4686-9cf5-1ea6cf99bc21
    Bridge "ovsbr0"
        Port "ovsbr0"
            Interface "ovsbr0"
                type: internal
        Port "bond0"
            Interface "p3p1"
            Interface "p2p1"
    ovs_version: "2.0.0"‍



[root at host26 network-scripts]# ovs-appctl bond/show
---- bond0 ----
bond_mode: balance-tcp
bond-hash-basis: 0
updelay: 0 ms
downdelay: 10 ms
next rebalance: 806 ms
lacp_status: negotiated


slave p2p1: enabled
        active slave
        may_enable: true
        hash 143: 0 kB load


slave p3p1: enabled
        may_enable: true
        hash 133: 0 kB load‍







root at host26 network-scripts]# ovs-appctl lacp/show
---- bond0 ----
        status: active negotiated
        sys_id: 00:0a:f7:75:ca:60
        sys_priority: 65534
        aggregation key: 1
        lacp_time: fast


slave: p2p1: current attached
        port_id: 2
        port_priority: 65535
        may_enable: true


        actor sys_id: 00:0a:f7:75:ca:60
        actor sys_priority: 65534
        actor port_id: 2
        actor port_priority: 65535
        actor key: 1
        actor state: activity timeout aggregation synchronized collecting distributing


        partner sys_id: 64:3e:8c:41:2d:50
        partner sys_priority: 0
        partner port_id: 3
        partner port_priority: 32768
        partner key: 9025
        partner state: activity aggregation synchronized collecting distributing


slave: p3p1: current attached
        port_id: 1
        port_priority: 65535
        may_enable: true


        actor sys_id: 00:0a:f7:75:ca:60
        actor sys_priority: 65534
        actor port_id: 1
        actor port_priority: 65535
        actor key: 1
        actor state: activity timeout aggregation synchronized collecting distributing


        partner sys_id: 64:3e:8c:41:2d:50
        partner sys_priority: 0
        partner port_id: 6
        partner port_priority: 32768
        partner key: 9025
        partner state: activity aggregation synchronized collecting distributing‍



my second server is 172.18.10.43, full same config as above just ip address!!


when i use iperf3 and ping to test the bandwidth,as follow:

i found the bandwidth is increasing,exceed one nic's throughput , but problem is coming.  when i down one of the physical nic,the network is interrupt about one minutes,in other words,it's can't providing redundancy normally,how can i change this config to ‍satisfy my ‍purpose.   ‍


I look forward to your early reply,thank you very much.‍


sincerely 

‍

2015.4.9
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150410/67920b86/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 5EF23124 at A2A37D10.52352755
Type: application/octet-stream
Size: 22726 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150410/67920b86/attachment-0001.obj>

From 745460565 at qq.com  Thu Apr  9 20:33:30 2015
From: 745460565 at qq.com (=?utf-8?B?5ZC06LaF5qCH?=)
Date: Fri, 10 Apr 2015 11:33:30 +0800
Subject: [ovs-discuss] =?utf-8?b?5Zue5aSN77yaICBvdnMtdnNjdGw6RXJyb3IgZGV0?=
 =?utf-8?q?ected_while_setting_up_=27vn0=27=2ESeeovs-vswitchd_log_for_deta?=
 =?utf-8?q?ils=2E?=
In-Reply-To: <CANr6G5yNbUDsmWawHJ0_+a1MSUFX6cxmCjHi+McmDXtJcLZPGA@mail.gmail.com>
References: <tencent_472C7D753FDE06C41FFBBEE8@qq.com>
 <CANr6G5yNbUDsmWawHJ0_+a1MSUFX6cxmCjHi+McmDXtJcLZPGA@mail.gmail.com>
Message-ID: <tencent_7DF1AECD4E87362314122834@qq.com>

hi Joe & justin
thanks for your help.

i created two commands 
#ovs-vsctl add-br br0
#ovs-vsctl add-port br0 vn0
and the ovs-log is here
----------------------------------------------------------------------------------------------------------------------------------------------------------
2015-04-10T02:38:32.193Z|00001|vlog|INFO|opened log file /usr/local/var/log/openvswitch/ovs-vswitchd.log
2015-04-10T02:38:32.194Z|00002|reconnect|INFO|unix:/usr/local/var/run/openvswitch/db.sock: connecting...
2015-04-10T02:38:32.195Z|00003|reconnect|INFO|unix:/usr/local/var/run/openvswitch/db.sock: connected
2015-04-10T02:38:32.195Z|00004|bridge|INFO|ovs-vswitchd (Open vSwitch) 2.3.1
2015-04-10T02:40:24.354Z|00005|memory|INFO|1504 kB peak resident set size after 112.2 seconds
2015-04-10T02:40:24.355Z|00006|dpif|WARN|system at ovs-system: failed to put[create] (Invalid argument) skb_priority(0),skb_mark(0),recirc_id(0x1),dp_hash(0x1),in_port(0),eth(src=00:00:00:00:00:00,dst=00:00:00:00:00:00)
2015-04-10T02:40:24.355Z|00007|ofproto_dpif|INFO|system at ovs-system: Datapath does not support recirculation
2015-04-10T02:40:24.355Z|00008|dpif|WARN|system at ovs-system: execute userspace(pid=0,userdata(00000000)) failed (Numerical result out of range) on packet metadata=0,in_port=0,vlan_tci=0x0000,dl_src=00:00:00:00:00:00,dl_dst=00:00:00:00:00:00,dl_type=0x1234
2015-04-10T02:40:24.355Z|00009|ofproto_dpif|WARN|system at ovs-system: datapath does not support variable-length userdata feature (needs Linux 3.10+ or kernel module from OVS 1..11+).  The NXAST_SAMPLE action will be ignored.
2015-04-10T02:40:24.355Z|00010|dpif|WARN|system at ovs-system: failed to put[create] (Invalid argument) skb_priority(0),skb_mark(0),in_port(0),eth(src=00:00:00:00:00:00,dst=00:00:00:00:00:00),eth_type(0x8847),mpls(label=0,tc=0,ttl=0,bos=1)
2015-04-10T02:40:24.355Z|00011|ofproto_dpif|INFO|system at ovs-system: MPLS label stack length probed as 0
2015-04-10T02:40:24.359Z|00012|bridge|INFO|bridge br0: added interface br0 on port 65534
2015-04-10T02:40:24.360Z|00013|bridge|INFO|bridge br0: using datapath ID 0000d6f3df37754c
2015-04-10T02:40:24.360Z|00014|connmgr|INFO|br0: added service controller "punix:/usr/local/var/run/openvswitch/br0.mgmt"
2015-04-10T02:40:52.290Z|00015|bridge|WARN|could not open network device vn0 (No such device)‍
-------------------------------------------------------------------------------------------------------------------------------------------------------
the last  sentence says "could not open network device vn0 (No such device)‍", i dont know what it means.

I have resintalled my ubuntu system three times (13.10, 12.04.5 ,12.04.2), and reinstalled ovs N times.
is there a  possible that my installation has problems?
my installation process is following (I tried two methods)
-----------------Method one----------------
1. wget http://openvswitch.org/releases/openvswitch-2.3.1.tar.gz‍
2. tar -xzf openvswitch-2.3.1.tar.gz‍
3. cd openvswitch-2.3.0‍
4. ./configure --with-linux=/lib/modules/`uname -r`/build‍
5. make && make install‍
6. make modules_install‍
7. /sbin/modprobe openvswitch‍
8. mkdir -p /usr/local/etc/openvswitch‍
9.ovsdb-tool create /usr/local/etc/openvswitch/conf.db vswitchd/vswitch.ovsschema‍
---------------------------------------------------
------------------Method two----------------

1. wget http://openvswitch.org/releases/openvswitch-2.3.1.tar.gz
2. tar -xzf openvswitch-2.3.1.tar.gz
3. cd openvswitch-2.3.0
4. ./configure --with-linux=/lib/modules/`uname -r`/build
5. make && make install
6. insmod datapath/linux/openvswitch.ko‍
7. make modules_install
8. /sbin/modprobe openvswitch
9. mkdir -p /usr/local/etc/openvswitch
10.ovsdb-tool create /usr/local/etc/openvswitch/conf.db vswitchd/vswitch.ovsschema
‍
------------------------------------------------------
But in Method two, the sixth step "insmod datapath/linux/openvswitch.ko‍" ,I got an error,something like " openvswitch.ko no mudles ", then i use two commands  "modprobe gre ,modporbe libcrc32c", the sixth step pass.

is there any step i miss? what happened in the end.......>_<
 
thanks & gratitude
bush

------------------ 原始邮件 ------------------
发件人: "Joe Stringer";<joestringer at nicira.com>;
发送时间: 2015年4月10日(星期五) 凌晨0:54
收件人: "吴超标"<745460565 at qq.com>; 

主题: Re: [ovs-discuss] ovs-vsctl:Error detected while setting up 'vn0'.Seeovs-vswitchd log for details.




Did you see the ovs-vswitchd log for details?

(Probably somewhere like /var/run/openvswitch/ovs-vswitchd.log)
 On 9 Apr 2015 00:42, "吴超标" <745460565 at qq.com> wrote:
hi dear all.
when i use this command----- ovs-vsctl add-port br0 vn0
an error occurred.
-------ovs-vsctl:Error detected while setting up 'vn0'.See ovs-vswitchd log for details.
i dont know why. my ovs version is 2.3.1, and my ubuntu version is 12.4.5


Thanks 
bush



 

_______________________________________________
 discuss mailing list
 discuss at openvswitch.org
 http://openvswitch.org/mailman/listinfo/discuss
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150410/01aba94c/attachment.html>

From joestringer at nicira.com  Thu Apr  9 23:29:22 2015
From: joestringer at nicira.com (Joe Stringer)
Date: Thu, 9 Apr 2015 23:29:22 -0700
Subject: [ovs-discuss] ovs-vsctl:Error detected while setting up
 'vn0'.Seeovs-vswitchd log for details.
In-Reply-To: <tencent_7DF1AECD4E87362314122834@qq.com>
References: <tencent_472C7D753FDE06C41FFBBEE8@qq.com>
 <CANr6G5yNbUDsmWawHJ0_+a1MSUFX6cxmCjHi+McmDXtJcLZPGA@mail.gmail.com>
 <tencent_7DF1AECD4E87362314122834@qq.com>
Message-ID: <CANr6G5ydEpjUOEV2=VEdWhLUKa62Xt14SHh=wkB_CMET0uWHRQ@mail.gmail.com>

If you don't specify the type of the interface when you add it to OVS,
then it attempts to use a system interface. It looks like 'vn0'
doesn't exist on your system, so OVS can't attach it to the bridge.
Try either creating the device first (eg using 'ip' tools) or
specifying a different port type to add (eg internal, gre, vxlan,
etc). There are plenty of examples of adding different port types
around the internet (and a few in the FAQ, too).

On 9 April 2015 at 20:33, 吴超标 <745460565 at qq.com> wrote:
> hi Joe & justin
> thanks for your help.
>
> i created two commands
> #ovs-vsctl add-br br0
> #ovs-vsctl add-port br0 vn0
> and the ovs-log is here
> ----------------------------------------------------------------------------------------------------------------------------------------------------------
> 2015-04-10T02:38:32.193Z|00001|vlog|INFO|opened log file
> /usr/local/var/log/openvswitch/ovs-vswitchd.log
> 2015-04-10T02:38:32.194Z|00002|reconnect|INFO|unix:/usr/local/var/run/openvswitch/db.sock:
> connecting...
> 2015-04-10T02:38:32.195Z|00003|reconnect|INFO|unix:/usr/local/var/run/openvswitch/db.sock:
> connected
> 2015-04-10T02:38:32.195Z|00004|bridge|INFO|ovs-vswitchd (Open vSwitch) 2.3.1
> 2015-04-10T02:40:24.354Z|00005|memory|INFO|1504 kB peak resident set size
> after 112.2 seconds
> 2015-04-10T02:40:24.355Z|00006|dpif|WARN|system at ovs-system: failed to
> put[create] (Invalid argument)
> skb_priority(0),skb_mark(0),recirc_id(0x1),dp_hash(0x1),in_port(0),eth(src=00:00:00:00:00:00,dst=00:00:00:00:00:00)
> 2015-04-10T02:40:24.355Z|00007|ofproto_dpif|INFO|system at ovs-system: Datapath
> does not support recirculation
> 2015-04-10T02:40:24.355Z|00008|dpif|WARN|system at ovs-system: execute
> userspace(pid=0,userdata(00000000)) failed (Numerical result out of range)
> on packet
> metadata=0,in_port=0,vlan_tci=0x0000,dl_src=00:00:00:00:00:00,dl_dst=00:00:00:00:00:00,dl_type=0x1234
> 2015-04-10T02:40:24.355Z|00009|ofproto_dpif|WARN|system at ovs-system: datapath
> does not support variable-length userdata feature (needs Linux 3.10+ or
> kernel module from OVS 1..11+).  The NXAST_SAMPLE action will be ignored.
> 2015-04-10T02:40:24.355Z|00010|dpif|WARN|system at ovs-system: failed to
> put[create] (Invalid argument)
> skb_priority(0),skb_mark(0),in_port(0),eth(src=00:00:00:00:00:00,dst=00:00:00:00:00:00),eth_type(0x8847),mpls(label=0,tc=0,ttl=0,bos=1)
> 2015-04-10T02:40:24.355Z|00011|ofproto_dpif|INFO|system at ovs-system: MPLS
> label stack length probed as 0
> 2015-04-10T02:40:24.359Z|00012|bridge|INFO|bridge br0: added interface br0
> on port 65534
> 2015-04-10T02:40:24.360Z|00013|bridge|INFO|bridge br0: using datapath ID
> 0000d6f3df37754c
> 2015-04-10T02:40:24.360Z|00014|connmgr|INFO|br0: added service controller
> "punix:/usr/local/var/run/openvswitch/br0.mgmt"
> 2015-04-10T02:40:52.290Z|00015|bridge|WARN|could not open network device vn0
> (No such device)‍
> -------------------------------------------------------------------------------------------------------------------------------------------------------
> the last  sentence says "could not open network device vn0 (No such
> device)‍", i dont know what it means.
>
> I have resintalled my ubuntu system three times (13.10, 12.04.5 ,12.04.2),
> and reinstalled ovs N times.
> is there a  possible that my installation has problems?
> my installation process is following (I tried two methods)
> -----------------Method one----------------
> 1. wget http://openvswitch.org/releases/openvswitch-2.3.1.tar.gz‍
> 2. tar -xzf openvswitch-2.3.1.tar.gz‍
> 3. cd openvswitch-2.3.0‍
> 4. ./configure --with-linux=/lib/modules/`uname -r`/build‍
> 5. make && make install‍
> 6. make modules_install‍
> 7. /sbin/modprobe openvswitch‍
> 8. mkdir -p /usr/local/etc/openvswitch‍
> 9.ovsdb-tool create /usr/local/etc/openvswitch/conf.db
> vswitchd/vswitch.ovsschema‍
> ---------------------------------------------------
> ------------------Method two----------------
> 1. wget http://openvswitch.org/releases/openvswitch-2.3.1.tar.gz
> 2. tar -xzf openvswitch-2.3.1.tar.gz
> 3. cd openvswitch-2.3.0
> 4. ./configure --with-linux=/lib/modules/`uname -r`/build
> 5. make && make install
> 6. insmod datapath/linux/openvswitch.ko‍
> 7. make modules_install
> 8. /sbin/modprobe openvswitch
> 9. mkdir -p /usr/local/etc/openvswitch
> 10.ovsdb-tool create /usr/local/etc/openvswitch/conf.db
> vswitchd/vswitch.ovsschema
> ‍
> ------------------------------------------------------
> But in Method two, the sixth step "insmod datapath/linux/openvswitch.ko‍" ,I
> got an error,something like " openvswitch.ko no mudles ", then i use two
> commands  "modprobe gre ,modporbe libcrc32c", the sixth step pass.
>
> is there any step i miss? what happened in the end.......>_<
>
> thanks & gratitude
> bush
> ------------------ 原始邮件 ------------------
> 发件人: "Joe Stringer";<joestringer at nicira.com>;
> 发送时间: 2015年4月10日(星期五) 凌晨0:54
> 收件人: "吴超标"<745460565 at qq.com>;
> 主题: Re: [ovs-discuss] ovs-vsctl:Error detected while setting up
> 'vn0'.Seeovs-vswitchd log for details.
>
> Did you see the ovs-vswitchd log for details?
>
> (Probably somewhere like /var/run/openvswitch/ovs-vswitchd.log)
>
> On 9 Apr 2015 00:42, "吴超标" <745460565 at qq.com> wrote:
>>
>> hi dear all.
>> when i use this command----- ovs-vsctl add-port br0 vn0
>> an error occurred.
>> -------ovs-vsctl:Error detected while setting up 'vn0'.See ovs-vswitchd
>> log for details.
>> i dont know why. my ovs version is 2.3.1, and my ubuntu version is 12.4.5
>>
>> Thanks
>> bush
>>
>>
>>
>> _______________________________________________
>> discuss mailing list
>> discuss at openvswitch.org
>> http://openvswitch.org/mailman/listinfo/discuss
>>
>

From joestringer at nicira.com  Thu Apr  9 23:30:44 2015
From: joestringer at nicira.com (Joe Stringer)
Date: Thu, 9 Apr 2015 23:30:44 -0700
Subject: [ovs-discuss] having trouble while trying to install OVS-2.3.1
 in Ubuntu 14.04 LTS 64 bit
In-Reply-To: <CAG=b5B1zBekWWY3z5x7Dg9Q5ZF1L1aMW0zHjQ_F0_uw081-zXg@mail.gmail.com>
References: <CAG=b5B3u4P3jWZ+pdx+mRTtW1UtuHPxKkqAK3-wFnwG7trzP9g@mail.gmail.com>
 <CANr6G5zTs5rV3vfGN9-YUBN5zQFeCBv8rrLMJE9_yo3haruQnA@mail.gmail.com>
 <CAG=b5B1zBekWWY3z5x7Dg9Q5ZF1L1aMW0zHjQ_F0_uw081-zXg@mail.gmail.com>
Message-ID: <CANr6G5wCiZqKNmti4pi8pZPMDXKqXp6_B8CNHV=hU5iXvpBGdg@mail.gmail.com>

On 9 April 2015 at 23:17, Sanghamitra De <sanghamitra.de at gmail.com> wrote:
> Will simply addition of 'make' and 'make install' as per the above sequence
> ensure that i do not get the error from the configuration commands as given
> in red?

Yes.

From rault.clement at gmail.com  Fri Apr 10 09:15:18 2015
From: rault.clement at gmail.com (=?UTF-8?Q?Cl=C3=A9ment_Rault?=)
Date: Fri, 10 Apr 2015 18:15:18 +0200
Subject: [ovs-discuss] How to monitor packets being dropped? Sent back a
 packet back to the port where it came from?
Message-ID: <CACXMTR_YOAipR=MwY7OJGYXCkqQff2NQJjAEnzEYB9PpA3n11A@mail.gmail.com>

Hi,

I am trying to develop inband mechanisms for fast reaction to failures
and I am experiencing a very high packet loss.

"--- 11.0.0.2 ping statistics ---
573 packets transmitted, 13 received, 97% packet loss, time 574650ms
rtt min/avg/max/mdev = 1.259/2.291/5.683/1.140 ms"

which is probably due to the fact that some of my packets get in a
infinite (or not infinite but very long) loop (even though it
shouldn't happen) but I would like to
understand why and where they get dropped.

And therefore I would like to know if there is a way to check if a
switch (I am using mininet) is dropping packets?

Because I didn't put any rule to drop them and I am not decrementing
the ttl so it cannot from that...

What is the default behaviour/scenario for a OVS switch to decide to
drop a packet?

Could it be because sometimes I am sending the packet back to the port
where the packet came from?

Best,
Clément

From autolocaer at vip.qq.com  Thu Apr  9 19:25:39 2015
From: autolocaer at vip.qq.com (=?utf-8?B?5p2c5rW35rab?=)
Date: Fri, 10 Apr 2015 10:25:39 +0800
Subject: [ovs-discuss] =?utf-8?b?5Zue5aSN77yaIGhlbHA6IGFib3V0IG92cyBib25k?=
 =?utf-8?q?_configure?=
In-Reply-To: <tencent_101D6E8A7F87870C13620979@qq.com>
References: <tencent_101D6E8A7F87870C13620979@qq.com>
Message-ID: <tencent_78AF4DC80FEFD2B863412479@qq.com>

anybody know about it?  please tell me how to modify it .


------------------ 原始邮件 ------------------
发件人: "杜海涛";<jeff.tu at qq.com>;
发送时间: 2015年4月9日(星期四) 中午12:41
收件人: "discuss"<discuss at openvswitch.org>; 

主题: [ovs-discuss] help: about ovs bond configure



hi  everybody,
  I want to ask a question about ovs bond.please help me if you know it.
 i am a newbie for learning openvswitch,recently i got a problem when i config ovs bond.
 some detail as follow:
 my system version is centos7 ,kernel is 3.10.0-123.20.1.el7.x86_64. i already config physical switch LACP .
----
 [root at host26 network-scripts]# uname -r
3.10.0-123.20.1.el7.x86_64
[root at host26 network-scripts]# cat /etc/redhat-release 
CentOS Linux release 7.0.1406 (Core)‍
------
‍ I want to bind multiple network interfaces(such as  p2p1 and p3p1) together into a single,simultaneously‍
increasing the bandwidth and providing redundancy.‍
my config files is:
[root at host26 network-scripts]# less ifcfg-ovsbr0 
DEVICE=ovsbr0
ONBOOT=yes
BOOTPROTO=static
USERCTL=no
IPV6INIT=no
IPADDR=172.18.10.42        #another server  is  172.18.10.43
TYPE=OVSBridge
DEVICETYPE=ovs
HOTPLUG=no‍



[root at host26 network-scripts]# less ifcfg-bond0 
DEVICE=bond0
ONBOOT=yes
BOOTPROTO=none
USERCTL=no
IPV6INIT=no
OVS_BRIDGE=ovsbr0
TYPE=OVSBond
BOND_IFACES="p2p1 p3p1"
OVS_OPTIONS="bond_mode=balance-tcp lacp=active other_config:lacp-time=fast"
HOTPLUG=no‍



[root at host26 network-scripts]# less ifcfg-p2p1
DEVICE=p2p1
TYPE=Ethernet
ONBOOT=yes
HOTPLUG=no‍



[root at host26 network-scripts]# less ifcfg-p3p1
DEVICE=p3p1
TYPE=Ethernet
ONBOOT=yes
HOTPLUG=no‍



when i restart network


[root at host26 network-scripts]# ovs-vsctl show
60792242-29d8-4686-9cf5-1ea6cf99bc21
    Bridge "ovsbr0"
        Port "ovsbr0"
            Interface "ovsbr0"
                type: internal
        Port "bond0"
            Interface "p3p1"
            Interface "p2p1"
    ovs_version: "2.0.0"‍



[root at host26 network-scripts]# ovs-appctl bond/show
---- bond0 ----
bond_mode: balance-tcp
bond-hash-basis: 0
updelay: 0 ms
downdelay: 10 ms
next rebalance: 806 ms
lacp_status: negotiated


slave p2p1: enabled
        active slave
        may_enable: true
        hash 143: 0 kB load


slave p3p1: enabled
        may_enable: true
        hash 133: 0 kB load‍







root at host26 network-scripts]# ovs-appctl lacp/show
---- bond0 ----
        status: active negotiated
        sys_id: 00:0a:f7:75:ca:60
        sys_priority: 65534
        aggregation key: 1
        lacp_time: fast


slave: p2p1: current attached
        port_id: 2
        port_priority: 65535
        may_enable: true


        actor sys_id: 00:0a:f7:75:ca:60
        actor sys_priority: 65534
        actor port_id: 2
        actor port_priority: 65535
        actor key: 1
        actor state: activity timeout aggregation synchronized collecting distributing


        partner sys_id: 64:3e:8c:41:2d:50
        partner sys_priority: 0
        partner port_id: 3
        partner port_priority: 32768
        partner key: 9025
        partner state: activity aggregation synchronized collecting distributing


slave: p3p1: current attached
        port_id: 1
        port_priority: 65535
        may_enable: true


        actor sys_id: 00:0a:f7:75:ca:60
        actor sys_priority: 65534
        actor port_id: 1
        actor port_priority: 65535
        actor key: 1
        actor state: activity timeout aggregation synchronized collecting distributing


        partner sys_id: 64:3e:8c:41:2d:50
        partner sys_priority: 0
        partner port_id: 6
        partner port_priority: 32768
        partner key: 9025
        partner state: activity aggregation synchronized collecting distributing‍



my second server is 172.18.10.43, full same config as above just ip address!!


when i use iperf3 and ping to test the bandwidth,as follow:

i found the bandwidth is increasing,exceed one nic's throughput , but problem is coming.  when i down one of the physical nic,the network is interrupt about one minutes,in other words,it's can't providing redundancy normally,how can i change this config to ‍satisfy my ‍purpose.   ‍


I look forward to your early reply,thank you very much.‍


sincerely 

‍

2015.4.9
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150410/2896c155/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: B3C6A6F3 at 1CDE0B75.A3342755
Type: application/octet-stream
Size: 22726 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150410/2896c155/attachment-0001.obj>

From sanghamitra.de at gmail.com  Thu Apr  9 23:17:53 2015
From: sanghamitra.de at gmail.com (Sanghamitra De)
Date: Fri, 10 Apr 2015 11:47:53 +0530
Subject: [ovs-discuss] having trouble while trying to install OVS-2.3.1
 in Ubuntu 14.04 LTS 64 bit
In-Reply-To: <CANr6G5zTs5rV3vfGN9-YUBN5zQFeCBv8rrLMJE9_yo3haruQnA@mail.gmail.com>
References: <CAG=b5B3u4P3jWZ+pdx+mRTtW1UtuHPxKkqAK3-wFnwG7trzP9g@mail.gmail.com>
 <CANr6G5zTs5rV3vfGN9-YUBN5zQFeCBv8rrLMJE9_yo3haruQnA@mail.gmail.com>
Message-ID: <CAG=b5B1zBekWWY3z5x7Dg9Q5ZF1L1aMW0zHjQ_F0_uw081-zXg@mail.gmail.com>

Thank You Joe for your reply.

So the command sequence should have been

sudo mkdir /work
cd /work
wget http://openvswitch.org/releases/openvswitch-2.3.1.tar.gz
tar zxf openvswitch-2.3.1.tar.gz
cd openvswitch-2.3.1
./configure --with-linux=/lib/modules/`uname -r`/build
make
make install
sudo make modules_install
sudo /sbin/modprobe openvswitch

/sbin/lsmod
cd /
sudo rm -rf /work

After that the disc image may be used to load into other nodes.
then:

#ovsdb-tool create /usr/local/etc/openvswitch/conf.db
/users/peertest/openvswitch-2.3.1/vswitchd/vswitch.ovsschema
# ovsdb-server --remote=punix:/usr/local/var/run/openvswitch/db.sock
\                 --remote=db:Open_vSwitch,Open_vSwitch,manager_options \
                 --pidfile --detach

ovs-vsctl --no-wait init
sudo ovs-vswitchd --pidfile --detach --log-file
sudo ovs-vsctl add-br OVSbr1
sudo ovs-vsctl add-br OVSbr2
sudo ifconfig eth2 0
sudo ifconfig eth3 0
sudo ovs-vsctl add-port OVSbr1 eth2
sudo ovs-vsctl add-port OVSbr2 eth3
sudo ovs-vsctl show



Will simply addition of 'make' and 'make install' as per the above sequence
ensure that i do not get the error from the configuration commands as given
in red?

I will try this sequence and let you know.

Thank You once again.

Regards
Sanghamitra De




On Thu, Apr 9, 2015 at 10:26 PM, Joe Stringer <joestringer at nicira.com>
wrote:

> You built and installed the kernel module, but skipped the userspace
> utilities.
>
> After ./configure ..., you need to 'make' and 'make install'.
>
> On 8 April 2015 at 03:29, Sanghamitra De <sanghamitra.de at gmail.com> wrote:
> > Hi,
> > To install OVS-2.3.1 in Ubuntu 14.04 LTS 64 bit, I used the following
> > command sequence which went fine:
> >
> > sudo mkdir /work
> > cd /work
> > wget http://openvswitch.org/releases/openvswitch-2.3.1.tar.gz
> > tar zxf openvswitch-2.3.1.tar.gz
> > cd openvswitch-2.3.1
> > ./configure --with-linux=/lib/modules/`uname -r`/build
> > sudo make modules_install
> > sudo /sbin/modprobe openvswitch
> >
> > /sbin/lsmod
> > cd /
> > sudo rm -rf /work
> >
> > After that i made a disc image to use it on other nodes.
> >
> > However, the following commands for configuring ovs throw error as per
> the
> > attached screenshot.
> >
> >
> > #ovsdb-tool create /usr/local/etc/openvswitch/conf.db
> > /users/peertest/openvswitch-2.3.1/vswitchd/vswitch.ovsschema
> > # ovsdb-server --remote=punix:/usr/local/var/run/openvswitch/db.sock \
> > --remote=db:Open_vSwitch,Open_vSwitch,manager_options \
> >                  --pidfile --detach
> >
> > What to do?
> >
> >
> > Do i move straight over to execute the following sequence of configuring
> OVS
> > without executing the above 2 commands which give error:
> >
> > ovs-vsctl --no-wait init
> > sudo ovs-vswitchd --pidfile --detach --log-file
> > sudo ovs-vsctl add-br OVSbr1sudo ovs-vsctl add-br OVSbr2sudo ifconfig
> eth2
> > 0sudo ifconfig eth3 0sudo ovs-vsctl add-port OVSbr1 eth2sudo ovs-vsctl
> > add-port OVSbr2 eth3sudo ovs-vsctl show
> >
> >
> > Can anyone kindly give me the command sequence required??? Please help.
> >
> > PS: errors generated can be seen from the attached screenshot
> >
> >
> > Thanks & Regards
> > Sanghamitra
> >
> > _______________________________________________
> > discuss mailing list
> > discuss at openvswitch.org
> > http://openvswitch.org/mailman/listinfo/discuss
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150410/b05386de/attachment.html>

From alexw at nicira.com  Fri Apr 10 10:19:26 2015
From: alexw at nicira.com (Alex Wang)
Date: Fri, 10 Apr 2015 10:19:26 -0700
Subject: [ovs-discuss]
	=?utf-8?b?5Zue5aSN77yaIGhlbHA6IGFib3V0IG92cyBib25k?=
	=?utf-8?q?_configure?=
In-Reply-To: <tencent_78AF4DC80FEFD2B863412479@qq.com>
References: <tencent_101D6E8A7F87870C13620979@qq.com>
 <tencent_78AF4DC80FEFD2B863412479@qq.com>
Message-ID: <CAArS4XU6abHUPChNAfqHjzwKNE1te-qtjtKqDwBM-nhEvEMHSA@mail.gmail.com>

I'm trying to reproduce the issue... well be helpful if you can provide

'ovs-appctl lacp/show' and 'ovs-appctl bond/show' 10 seconds after you
bring down the nic,

Thanks,
Alex Wang,


On Thu, Apr 9, 2015 at 7:25 PM, 杜海涛 <autolocaer at vip.qq.com> wrote:

> anybody know about it?  please tell me how to modify it .
>
> ------------------ 原始邮件 ------------------
> *发件人:* "杜海涛";<jeff.tu at qq.com>;
> *发送时间:* 2015年4月9日(星期四) 中午12:41
> *收件人:* "discuss"<discuss at openvswitch.org>;
> *主题:* [ovs-discuss] help: about ovs bond configure
>
> hi  everybody,
>   I want to ask a question about ovs bond.please help me if you know it.
>  i am a newbie for learning openvswitch,recently i got a problem when i
> config ovs bond.
>  some detail as follow:
>  my system version is centos7 ,kernel is 3.10.0-123.20.1.el7.x86_64. i
> already config physical switch LACP .
> ----
>  [root at host26 network-scripts]# uname -r
> 3.10.0-123.20.1.el7.x86_64
> [root at host26 network-scripts]# cat /etc/redhat-release
> CentOS Linux release 7.0.1406 (Core)‍
> ------
> ‍ I want to bind multiple network interfaces(such as  p2p1 and p3p1)
> together into a single,simultaneously‍
> increasing the bandwidth and providing redundancy.‍
> my config files is:
> [root at host26 network-scripts]# less ifcfg-ovsbr0
> DEVICE=ovsbr0
> ONBOOT=yes
> BOOTPROTO=static
> USERCTL=no
> IPV6INIT=no
> IPADDR=172.18.10.42        #another server  is  172.18.10.43
> TYPE=OVSBridge
> DEVICETYPE=ovs
> HOTPLUG=no‍
>
> [root at host26 network-scripts]# less ifcfg-bond0
> DEVICE=bond0
> ONBOOT=yes
> BOOTPROTO=none
> USERCTL=no
> IPV6INIT=no
> OVS_BRIDGE=ovsbr0
> TYPE=OVSBond
> BOND_IFACES="p2p1 p3p1"
> OVS_OPTIONS="bond_mode=balance-tcp lacp=active other_config:lacp-time=fast"
> HOTPLUG=no‍
>
> [root at host26 network-scripts]# less ifcfg-p2p1
> DEVICE=p2p1
> TYPE=Ethernet
> ONBOOT=yes
> HOTPLUG=no‍
>
> [root at host26 network-scripts]# less ifcfg-p3p1
> DEVICE=p3p1
> TYPE=Ethernet
> ONBOOT=yes
> HOTPLUG=no‍
>
> when i restart network
>
> [root at host26 network-scripts]# ovs-vsctl show
> 60792242-29d8-4686-9cf5-1ea6cf99bc21
>     Bridge "ovsbr0"
>         Port "ovsbr0"
>             Interface "ovsbr0"
>                 type: internal
>         Port "bond0"
>             Interface "p3p1"
>             Interface "p2p1"
>     ovs_version: "2.0.0"‍
>
> [root at host26 network-scripts]# ovs-appctl bond/show
> ---- bond0 ----
> bond_mode: balance-tcp
> bond-hash-basis: 0
> updelay: 0 ms
> downdelay: 10 ms
> next rebalance: 806 ms
> lacp_status: negotiated
>
> slave p2p1: enabled
>         active slave
>         may_enable: true
>         hash 143: 0 kB load
>
> slave p3p1: enabled
>         may_enable: true
>         hash 133: 0 kB load‍
>
>
>
> root at host26 network-scripts]# ovs-appctl lacp/show
> ---- bond0 ----
>         status: active negotiated
>         sys_id: 00:0a:f7:75:ca:60
>         sys_priority: 65534
>         aggregation key: 1
>         lacp_time: fast
>
> slave: p2p1: current attached
>         port_id: 2
>         port_priority: 65535
>         may_enable: true
>
>         actor sys_id: 00:0a:f7:75:ca:60
>         actor sys_priority: 65534
>         actor port_id: 2
>         actor port_priority: 65535
>         actor key: 1
>         actor state: activity timeout aggregation synchronized collecting
> distributing
>
>         partner sys_id: 64:3e:8c:41:2d:50
>         partner sys_priority: 0
>         partner port_id: 3
>         partner port_priority: 32768
>         partner key: 9025
>         partner state: activity aggregation synchronized collecting
> distributing
>
> slave: p3p1: current attached
>         port_id: 1
>         port_priority: 65535
>         may_enable: true
>
>         actor sys_id: 00:0a:f7:75:ca:60
>         actor sys_priority: 65534
>         actor port_id: 1
>         actor port_priority: 65535
>         actor key: 1
>         actor state: activity timeout aggregation synchronized collecting
> distributing
>
>         partner sys_id: 64:3e:8c:41:2d:50
>         partner sys_priority: 0
>         partner port_id: 6
>         partner port_priority: 32768
>         partner key: 9025
>         partner state: activity aggregation synchronized collecting
> distributing‍
>
> my second server is 172.18.10.43, full same config as above just ip
> address!!
>
> when i use iperf3 and ping to test the bandwidth,as follow:
> i found the bandwidth is increasing,exceed one nic's throughput , but
> problem is coming.  when i down one of the physical nic,the network is interrupt
> about one minutes,in other words,it's can't providing redundancy
> normally,how can i change this config to ‍satisfy my ‍purpose.   ‍
>
> I look forward to your early reply,thank you very much.‍
>
> sincerely
> ‍
> 2015.4.9
>
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150410/c99423ce/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: B3C6A6F3 at 1CDE0B75.A3342755
Type: application/octet-stream
Size: 22726 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150410/c99423ce/attachment-0001.obj>

From alexw at nicira.com  Fri Apr 10 10:45:29 2015
From: alexw at nicira.com (Alex Wang)
Date: Fri, 10 Apr 2015 10:45:29 -0700
Subject: [ovs-discuss]
	=?utf-8?b?5Zue5aSN77yaIGhlbHA6IGFib3V0IG92cyBib25k?=
	=?utf-8?q?_configure?=
In-Reply-To: <CAArS4XU6abHUPChNAfqHjzwKNE1te-qtjtKqDwBM-nhEvEMHSA@mail.gmail.com>
References: <tencent_101D6E8A7F87870C13620979@qq.com>
 <tencent_78AF4DC80FEFD2B863412479@qq.com>
 <CAArS4XU6abHUPChNAfqHjzwKNE1te-qtjtKqDwBM-nhEvEMHSA@mail.gmail.com>
Message-ID: <CAArS4XWfWE0mrv3Oqh3JJEgesRQnNwmZbFECjE8hKgPpFA+rHw@mail.gmail.com>

I could not reproduce the issue with both end having lacp-time=fast...

After checking your 'ovs-appctl lacp/show' output, I saw that your physical
switch was config'ed with lacp-time=slow...  That's why you have the delayed
failover...

Thanks,
Alex Wang,

On Fri, Apr 10, 2015 at 10:19 AM, Alex Wang <alexw at nicira.com> wrote:

>
> I'm trying to reproduce the issue... well be helpful if you can provide
>
> 'ovs-appctl lacp/show' and 'ovs-appctl bond/show' 10 seconds after you
> bring down the nic,
>
> Thanks,
> Alex Wang,
>
>
> On Thu, Apr 9, 2015 at 7:25 PM, 杜海涛 <autolocaer at vip.qq.com> wrote:
>
>> anybody know about it?  please tell me how to modify it .
>>
>> ------------------ 原始邮件 ------------------
>> *发件人:* "杜海涛";<jeff.tu at qq.com>;
>> *发送时间:* 2015年4月9日(星期四) 中午12:41
>> *收件人:* "discuss"<discuss at openvswitch.org>;
>> *主题:* [ovs-discuss] help: about ovs bond configure
>>
>> hi  everybody,
>>   I want to ask a question about ovs bond.please help me if you know it.
>>  i am a newbie for learning openvswitch,recently i got a problem when i
>> config ovs bond.
>>  some detail as follow:
>>  my system version is centos7 ,kernel is 3.10.0-123.20.1.el7.x86_64. i
>> already config physical switch LACP .
>> ----
>>  [root at host26 network-scripts]# uname -r
>> 3.10.0-123.20.1.el7.x86_64
>> [root at host26 network-scripts]# cat /etc/redhat-release
>> CentOS Linux release 7.0.1406 (Core)‍
>> ------
>> ‍ I want to bind multiple network interfaces(such as  p2p1 and p3p1)
>> together into a single,simultaneously‍
>> increasing the bandwidth and providing redundancy.‍
>> my config files is:
>> [root at host26 network-scripts]# less ifcfg-ovsbr0
>> DEVICE=ovsbr0
>> ONBOOT=yes
>> BOOTPROTO=static
>> USERCTL=no
>> IPV6INIT=no
>> IPADDR=172.18.10.42        #another server  is  172.18.10.43
>> TYPE=OVSBridge
>> DEVICETYPE=ovs
>> HOTPLUG=no‍
>>
>> [root at host26 network-scripts]# less ifcfg-bond0
>> DEVICE=bond0
>> ONBOOT=yes
>> BOOTPROTO=none
>> USERCTL=no
>> IPV6INIT=no
>> OVS_BRIDGE=ovsbr0
>> TYPE=OVSBond
>> BOND_IFACES="p2p1 p3p1"
>> OVS_OPTIONS="bond_mode=balance-tcp lacp=active
>> other_config:lacp-time=fast"
>> HOTPLUG=no‍
>>
>> [root at host26 network-scripts]# less ifcfg-p2p1
>> DEVICE=p2p1
>> TYPE=Ethernet
>> ONBOOT=yes
>> HOTPLUG=no‍
>>
>> [root at host26 network-scripts]# less ifcfg-p3p1
>> DEVICE=p3p1
>> TYPE=Ethernet
>> ONBOOT=yes
>> HOTPLUG=no‍
>>
>> when i restart network
>>
>> [root at host26 network-scripts]# ovs-vsctl show
>> 60792242-29d8-4686-9cf5-1ea6cf99bc21
>>     Bridge "ovsbr0"
>>         Port "ovsbr0"
>>             Interface "ovsbr0"
>>                 type: internal
>>         Port "bond0"
>>             Interface "p3p1"
>>             Interface "p2p1"
>>     ovs_version: "2.0.0"‍
>>
>> [root at host26 network-scripts]# ovs-appctl bond/show
>> ---- bond0 ----
>> bond_mode: balance-tcp
>> bond-hash-basis: 0
>> updelay: 0 ms
>> downdelay: 10 ms
>> next rebalance: 806 ms
>> lacp_status: negotiated
>>
>> slave p2p1: enabled
>>         active slave
>>         may_enable: true
>>         hash 143: 0 kB load
>>
>> slave p3p1: enabled
>>         may_enable: true
>>         hash 133: 0 kB load‍
>>
>>
>>
>> root at host26 network-scripts]# ovs-appctl lacp/show
>> ---- bond0 ----
>>         status: active negotiated
>>         sys_id: 00:0a:f7:75:ca:60
>>         sys_priority: 65534
>>         aggregation key: 1
>>         lacp_time: fast
>>
>> slave: p2p1: current attached
>>         port_id: 2
>>         port_priority: 65535
>>         may_enable: true
>>
>>         actor sys_id: 00:0a:f7:75:ca:60
>>         actor sys_priority: 65534
>>         actor port_id: 2
>>         actor port_priority: 65535
>>         actor key: 1
>>         actor state: activity timeout aggregation synchronized collecting
>> distributing
>>
>>         partner sys_id: 64:3e:8c:41:2d:50
>>         partner sys_priority: 0
>>         partner port_id: 3
>>         partner port_priority: 32768
>>         partner key: 9025
>>         partner state: activity aggregation synchronized collecting
>> distributing
>>
>> slave: p3p1: current attached
>>         port_id: 1
>>         port_priority: 65535
>>         may_enable: true
>>
>>         actor sys_id: 00:0a:f7:75:ca:60
>>         actor sys_priority: 65534
>>         actor port_id: 1
>>         actor port_priority: 65535
>>         actor key: 1
>>         actor state: activity timeout aggregation synchronized collecting
>> distributing
>>
>>         partner sys_id: 64:3e:8c:41:2d:50
>>         partner sys_priority: 0
>>         partner port_id: 6
>>         partner port_priority: 32768
>>         partner key: 9025
>>         partner state: activity aggregation synchronized collecting
>> distributing‍
>>
>> my second server is 172.18.10.43, full same config as above just ip
>> address!!
>>
>> when i use iperf3 and ping to test the bandwidth,as follow:
>> i found the bandwidth is increasing,exceed one nic's throughput , but
>> problem is coming.  when i down one of the physical nic,the network is interrupt
>> about one minutes,in other words,it's can't providing redundancy
>> normally,how can i change this config to ‍satisfy my ‍purpose.   ‍
>>
>> I look forward to your early reply,thank you very much.‍
>>
>> sincerely
>> ‍
>> 2015.4.9
>>
>> _______________________________________________
>> discuss mailing list
>> discuss at openvswitch.org
>> http://openvswitch.org/mailman/listinfo/discuss
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150410/769ddc1c/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: B3C6A6F3 at 1CDE0B75.A3342755
Type: application/octet-stream
Size: 22726 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150410/769ddc1c/attachment-0001.obj>

From cristina.palomo.regidor at ericsson.com  Fri Apr 10 12:26:20 2015
From: cristina.palomo.regidor at ericsson.com (Cristina Palomo Regidor)
Date: Fri, 10 Apr 2015 19:26:20 +0000
Subject: [ovs-discuss] ovs bridge dropping packages
Message-ID: <B0FC8B6A85BDD34FA799343D4664C6D61D0D7142@ESESSMB209.ericsson.se>

Hello,
I have ovs 2.1.2 and sles12.
Ifconfig mybridge is showing dropped packets.
Cat /sys/class/net/mybridge/statistics/rx_dropped is showing 1437

What could be the reason of the dropped packages? How can I troubleshoot? The vnets and physical interfaces are not dropping any packets.

Thanks and BR/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150410/d1c4c342/attachment.html>

From amer7777 at hotmail.com  Sat Apr 11 03:17:15 2015
From: amer7777 at hotmail.com (Amer)
Date: Sat, 11 Apr 2015 13:17:15 +0300
Subject: [ovs-discuss] SDN topology.
In-Reply-To: <1428578752765.11999@supcom.tn>
References: <1427810799214.94157@supcom.tn>
 <BLU437-SMTP72C88B8D658C1D0BDE3B4FD4F30@phx.gbl>
 <1427885630471.18204@supcom.tn>
 <BLU436-SMTP169F573362CD1F6F2656E99D4F30@phx.gbl>
 <1427973061080.64404@supcom.tn> <1428578752765.11999@supcom.tn>
Message-ID: <BLU436-SMTP2470C7EEAE7AFBF9CA3F833D4F90@phx.gbl>

Dear Amal

I apologize, I was in vacation, may you please tell me what was your problem to have a good documented record and how you fixed it.

Best regards,
Amer

> On Apr 9, 2015, at 2:25 PM, Amal KAMMOUN <amal.kammoun at supcom.tn> wrote:
> 
> So my configuration was right but the problem was that my OVS-VMs had the same @MAC!!
> 
> Now it is solved.
> 
> 
> Thank you so much for your time.
> 
> 
> Best regards,
> 
> 
> Amal.
>  
> From: Amal KAMMOUN
> Sent: Thursday, April 2, 2015 11:10 AM
> To: Amer
> Cc: discuss at openvswitch.org
> Subject: Re: [ovs-discuss] SDN topology.
>  
> Dear Amer,
> 
> 
> I appreciate your note about writing br0 IP in the interfaces configuration file. Thanks.
> 
> 
> But I want to get the interconnection between the 2 OVS before doing that.
> 
> 
> I read all your posts in March, I find that I have same problems as you.
> 
> Would you please tell me how did you fix your issues?
> 
> 
> For example in these posts:
> 
> http://openvswitch.org/pipermail/discuss/2015-March/016901.html 
> http://openvswitch.org/pipermail/discuss/2015-March/016943.html 
> 
> 
> Best regards!
> 
> 
> Amal. 
> 
>  
> From: Amer <amer7777 at hotmail.com>
> Sent: Wednesday, April 1, 2015 3:49 PM
> To: Amal KAMMOUN
> Cc: discuss at openvswitch.org
> Subject: Re: [ovs-discuss] SDN topology.
>  
> Hello,
> 
> I did it and was working fine. Note:
> The br0 IP is temporary and will be deleted when you reboot. Also, the IP will return back to the eth0. I recommend write it in the interfaces configuration file.
> 
> Best regards,
> Amer
> 
> On Apr 1, 2015, at 1:52 PM, Amal KAMMOUN <amal.kammoun at supcom.tn> wrote:
> 
>> Hello Amer,
>> 
>> 
>> So, as you said I will try with a simple scenario like this:
>> 
>> 
>> VM1: Host1-------------VM2: OVS1-----------------VM3: OVS2---------VM4: Host2
>> 
>> 
>> I want to do the interconnection between the 2 OVSs :  
>> 
>> 
>>             VM2: OVS1-----------------VM3: OVS2
>> 
>> 
>> I connected between VMs using internal-network. For each VM I configured @IP and the netmask (no gateway no dns).
>> 
>> 
>> I could have the ping between each other.
>> 
>>  
>> I made this configuration:
>> 
>> 
>> 1) in VM2: @IP 192.168.46.220
>> 
>> 
>> ovs-vsctl add-br br0
>> ovs-vsctl add-port br0 eth0
>> ifconfig eth0 0
>> 
>> ifconfig br0 up
>> 
>> ifconfig br0 192.168.46.220 netmask 255.255.255.0
>> 
>> 
>> 2) in VM3: @IP 192.168.46.181
>> 
>> ovs-vsctl add-br br0
>> ovs-vsctl add-port br0 eth0
>> ifconfig eth0 0
>> 
>> ifconfig br0 up
>> 
>> ifconfig br0 192.168.46.181 netmask 255.255.255.0
>> 
>> The ping now fails! What I have to do to get the 2 OVS connected?
>> 
>> 
>> Thank you so much. 
>>  
>> 
>>  
>> From: Amer <amer7777 at hotmail.com>
>> Sent: Wednesday, April 1, 2015 5:17 AM
>> To: Amal KAMMOUN
>> Cc: discuss at openvswitch.org
>> Subject: Re: [ovs-discuss] SDN topology.
>>  
>> Dear Amal
>> 
>> First, try with simple scenario
>> 
>> To connect between VMs you need to use internal-network and assign each VM to the same internal-network, then you need the IPs are in the same subnet for each two VMs.
>> Also, you need to crest a bridge in each OVS, like br0, then assign some interfaces to the bridge, like add-port br0 eth0, after that, give zero IP address to these interfaces, like ifconfig eth0 0, thereafter, give the bridge an IP address, like ifconfig eth0 192xxxxxxxxx netmask xxxxx.
>> The bridge IP needs to be written in the main interface configuration file.
>> To do this you need to search in this archive, I remember someone before few weeks discussed this issue and you will find my name there.
>> After this setup connecting each OVS to different controller will be easier.
>> 
>> Best regards,
>> Amer
>> 
>> On Mar 31, 2015, at 5:05 PM, Amal KAMMOUN <amal.kammoun at supcom.tn> wrote:
>> 
>>> Hello all!
>>> 
>>> 
>>> I'm trying to construct the following topology:
>>> 
>>> 
>>> 
>>>        VM1-  OpenFlowController1                            VM2- OpenflowController2
>>> 
>>>                             |                                                                     |
>>>                             |                                                                     |
>>> 
>>>                             |                                                                     |
>>>                             |                                                                     |
>>> 
>>>               VM3 ----------                                                  VM4 ----------
>>>                       | OVS1|----------------------------------------------------------| OVS2|
>>> 
>>>                       -----------                                                           -----------  
>>>                             |                                                                     |
>>> 
>>>                             |                                                                     |
>>> 
>>>                             |                                                                     |
>>> 
>>>                        Host:VM-5                                                 Host:VM-6
>>> 
>>> 
>>> 
>>> All my virtual machines are made by VirtualBox.
>>> 
>>> 
>>> It is possible to build such topology?
>>> 
>>> 
>>> How can I connect 2 OVS running on 2 different VMs?
>>> 
>>> 
>>> Thank you!
>>> _______________________________________________
>>> discuss mailing list
>>> discuss at openvswitch.org
>>> http://openvswitch.org/mailman/listinfo/discuss
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150411/3125b1fb/attachment-0001.html>

From sanghamitra.de at gmail.com  Sat Apr 11 05:21:14 2015
From: sanghamitra.de at gmail.com (Sanghamitra De)
Date: Sat, 11 Apr 2015 17:51:14 +0530
Subject: [ovs-discuss] having trouble while trying to install OVS-2.3.1
 in Ubuntu 14.04 LTS 64 bit
In-Reply-To: <CANr6G5wCiZqKNmti4pi8pZPMDXKqXp6_B8CNHV=hU5iXvpBGdg@mail.gmail.com>
References: <CAG=b5B3u4P3jWZ+pdx+mRTtW1UtuHPxKkqAK3-wFnwG7trzP9g@mail.gmail.com>
 <CANr6G5zTs5rV3vfGN9-YUBN5zQFeCBv8rrLMJE9_yo3haruQnA@mail.gmail.com>
 <CAG=b5B1zBekWWY3z5x7Dg9Q5ZF1L1aMW0zHjQ_F0_uw081-zXg@mail.gmail.com>
 <CANr6G5wCiZqKNmti4pi8pZPMDXKqXp6_B8CNHV=hU5iXvpBGdg@mail.gmail.com>
Message-ID: <CAG=b5B2oC_Mb2FD==r6b8=dPZLt+PfpjtxXQBLNNzTgs53cg2g@mail.gmail.com>

Hi,
I ran the command sequence as:

sudo mkdir /work
cd /work
wget http://openvswitch.org/releases/openvswitch-2.3.1.tar.gz
tar zxf openvswitch-2.3.1.tar.gz
cd openvswitch-2.3.1
./configure --with-linux=/lib/modules/`uname -r`/build
make
make install
sudo make modules_install
sudo /sbin/modprobe openvswitch

/sbin/lsmod
cd /
sudo rm -rf /work

After that the disc image was used to load into other nodes.

and then from one of the nodes i was going to try the following sequence:

#ovsdb-tool create /usr/local/etc/openvswitch/conf.db
/users/peertest/openvswitch-2.3.1/vswitchd/vswitch.ovsschema
# ovsdb-server --remote=punix:/usr/local/var/run/openvswitch/db.sock \
--remote=db:Open_vSwitch,Open_vSwitch,manager_options \ --pidfile --detach

ovs-vsctl --no-wait init
sudo ovs-vswitchd --pidfile --detach --log-file
sudo ovs-vsctl add-br OVSbr1
sudo ovs-vsctl add-br OVSbr2
sudo ifconfig eth2 0
sudo ifconfig eth3 0
sudo ovs-vsctl add-port OVSbr1 eth2
sudo ovs-vsctl add-port OVSbr2 eth3
sudo ovs-vsctl show


but on giving the very first command in the sequence it throws an error
like the one showed in the screenshot attached.

It seems the file openvswitch-2.3.1 is not present inside /users/peertest/

how is this even possible? anywhere wrong in the sequence?



Thanks

Sanghamitra

On Fri, Apr 10, 2015 at 12:00 PM, Joe Stringer <joestringer at nicira.com>
wrote:

> On 9 April 2015 at 23:17, Sanghamitra De <sanghamitra.de at gmail.com> wrote:
> > Will simply addition of 'make' and 'make install' as per the above
> sequence
> > ensure that i do not get the error from the configuration commands as
> given
> > in red?
>
> Yes.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150411/05b0cadf/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: er1.jpg
Type: image/jpeg
Size: 91495 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150411/05b0cadf/attachment-0001.jpg>

From tony at tonyfinn.com  Sun Apr 12 07:04:36 2015
From: tony at tonyfinn.com (Tony Finn)
Date: Sun, 12 Apr 2015 15:04:36 +0100
Subject: [ovs-discuss] Tunneling Setup Questions
In-Reply-To: <552A7A10.8090003@tonyfinn.com>
References: <552A7A10.8090003@tonyfinn.com>
Message-ID: <552A7B74.3070809@tonyfinn.com>

Hi all,

I'm currently trying to set up a test setup for tunnelling using Open
vSwitch. As this was originally to to investigate Geneve, I have built
the latest release from the master branch, but the issues I have also
occur when I try to use GRE so I suspect the problem is user error
rather than anything to do with incomplete Geneve support.

The setup I'm trying to create is as follows:


client1(10.0.0.1) ---|        (br-ext 10.0.10.1)        (br-ext
10.0.10.2)     |---- client 3 (10.0.0.3)
                                   |--------- [OVS1] - - - - Tunnel - -
- - [OVS2]  --------|
client2 (10.0.0.2)---|        (br-int 10.0.0.5) (br-int 10.0.0.6) |----
client 4 (10.0.0.4)

All the clients and OVS devices are virtualbox VMs.

What I have done so far:

Setup two bridges on each OVS1 and OVS2. The first, br-ext has one port,
the external connection between OVS1 and OVS2. On OVS1 I have given it
the IP address 10.0.10.1 and on OVS2 I have given it the IP address
10.0.10.2. The second is br-int. On each OVS VM it is connected to three
ports - the two external connections to the client machines connected to
that OVS, and a tunnel port. The VMs themselves are given IP addresses
ranging from 10.0.0.1/24 to 10.0.0.4/24 .

I have tried using both Geneve and NVGRE for the tunnel port, using GRE
I used the command (on OVS1):

ovs-vsctl add-port br-int gre1 -- set interface gre1 type=gre
options:remote_ip=10.0.10.2

and on OVS2:

ovs-vsctl add-port br-int gre1 -- set interface gre1 type=gre
options:remote_ip=10.0.10.1

When trying Geneve I had used the same command except with type=geneve
and a port name of geneve1.

However, using both Geneve and NVGRE I had the same outcome:

client1 and client2 are able to ping OVS1's br-int
client3 and client4 are able to ping OVS2's br-int
OVS1 is able to ping OVS2's br-ext

However, clients, even those on the same OVS bridge are not able to ping
each other. Using Wireshark, I can see the ARP requests being sent from
the client, including GRE encapsulated packets being sent across the
tunnel. However, the clients do not appear to be receiving these packets
as they never send an ARP reply of their own.

Is there anything I have missed?

Other potentially useful information:

* This is all running on Arch Linux, using kernel 3.19 with the kernel
provided openvswitch module
* None of the physical interfaces involved are assigned IP addresses,
only the bridges
* The clients and OVS machines were cloned from each other, but MAC
addresses have been randomised.
* The OVS machines have one other interface, assigned an IP address
10.0.2.15/24 for external internet address. This is also the default
gateway on these machines.

Regards,
Tony Finn




From tony at tonyfinn.com  Sun Apr 12 09:15:46 2015
From: tony at tonyfinn.com (Tony Finn)
Date: Sun, 12 Apr 2015 17:15:46 +0100
Subject: [ovs-discuss] Tunneling Setup Questions
In-Reply-To: <552A7B74.3070809@tonyfinn.com>
References: <552A7A10.8090003@tonyfinn.com> <552A7B74.3070809@tonyfinn.com>
Message-ID: <552A9A32.6070101@tonyfinn.com>

I have found the issue, so you can ignore this post, just adding it here 
in case anyone else runs into this problem:

All involved interfaces on the OVS VMs need to have promiscous mode 
enabled in the Virtualbox config or Virtualbox will silently drop the 
forwarded packets.

Regards,
Tony

On 12/04/2015 15:04, Tony Finn wrote:
> Hi all,
>
> I'm currently trying to set up a test setup for tunnelling using Open
> vSwitch. As this was originally to to investigate Geneve, I have built
> the latest release from the master branch, but the issues I have also
> occur when I try to use GRE so I suspect the problem is user error
> rather than anything to do with incomplete Geneve support.
>
> The setup I'm trying to create is as follows:
>
>
> client1(10.0.0.1) ---|        (br-ext 10.0.10.1)        (br-ext
> 10.0.10.2)     |---- client 3 (10.0.0.3)
>                                   |--------- [OVS1] - - - - Tunnel - -
> - - [OVS2]  --------|
> client2 (10.0.0.2)---|        (br-int 10.0.0.5) (br-int 10.0.0.6) |----
> client 4 (10.0.0.4)
>
> All the clients and OVS devices are virtualbox VMs.
>
> What I have done so far:
>
> Setup two bridges on each OVS1 and OVS2. The first, br-ext has one port,
> the external connection between OVS1 and OVS2. On OVS1 I have given it
> the IP address 10.0.10.1 and on OVS2 I have given it the IP address
> 10.0.10.2. The second is br-int. On each OVS VM it is connected to three
> ports - the two external connections to the client machines connected to
> that OVS, and a tunnel port. The VMs themselves are given IP addresses
> ranging from 10.0.0.1/24 to 10.0.0.4/24 .
>
> I have tried using both Geneve and NVGRE for the tunnel port, using GRE
> I used the command (on OVS1):
>
> ovs-vsctl add-port br-int gre1 -- set interface gre1 type=gre
> options:remote_ip=10.0.10.2
>
> and on OVS2:
>
> ovs-vsctl add-port br-int gre1 -- set interface gre1 type=gre
> options:remote_ip=10.0.10.1
>
> When trying Geneve I had used the same command except with type=geneve
> and a port name of geneve1.
>
> However, using both Geneve and NVGRE I had the same outcome:
>
> client1 and client2 are able to ping OVS1's br-int
> client3 and client4 are able to ping OVS2's br-int
> OVS1 is able to ping OVS2's br-ext
>
> However, clients, even those on the same OVS bridge are not able to ping
> each other. Using Wireshark, I can see the ARP requests being sent from
> the client, including GRE encapsulated packets being sent across the
> tunnel. However, the clients do not appear to be receiving these packets
> as they never send an ARP reply of their own.
>
> Is there anything I have missed?
>
> Other potentially useful information:
>
> * This is all running on Arch Linux, using kernel 3.19 with the kernel
> provided openvswitch module
> * None of the physical interfaces involved are assigned IP addresses,
> only the bridges
> * The clients and OVS machines were cloned from each other, but MAC
> addresses have been randomised.
> * The OVS machines have one other interface, assigned an IP address
> 10.0.2.15/24 for external internet address. This is also the default
> gateway on these machines.
>
> Regards,
> Tony Finn
>
>
>


From djhon9813 at gmail.com  Mon Apr 13 00:01:25 2015
From: djhon9813 at gmail.com (david jhon)
Date: Mon, 13 Apr 2015 12:01:25 +0500
Subject: [ovs-discuss] Using popen() or system() calls from inside
	openvswitch source code
Message-ID: <CANPUzQ2QpM8_n6Mk8rfvdVELf05Yfc1F4g34ObunJb4iEQ5sSw@mail.gmail.com>

Hi everyone,

I want to run a command from inside openvswitch code from
ofproto/ofproto-dpif-xlate.c. with popen(), openvswitch compiles and runs
successfully but it does not run command.

With system(), openvswitch fails to compile with following error:

blacklisted due to thread safety issues. I tried running system command
with ovs_mutex lock and unlock routines, but it makes no difference.

Please let me know what am I doing wrong here. How could a linux command be
run from openvswitch. Your help/guidance in this regard will be highly
valuable and appreciated.

Kind Regards,
David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150413/3d64b04b/attachment.html>

From amal.kammoun at supcom.tn  Mon Apr 13 01:34:06 2015
From: amal.kammoun at supcom.tn (Amal KAMMOUN)
Date: Mon, 13 Apr 2015 08:34:06 +0000
Subject: [ovs-discuss] SDN topology.
In-Reply-To: <BLU436-SMTP2470C7EEAE7AFBF9CA3F833D4F90@phx.gbl>
References: <1427810799214.94157@supcom.tn>
 <BLU437-SMTP72C88B8D658C1D0BDE3B4FD4F30@phx.gbl>
 <1427885630471.18204@supcom.tn>
 <BLU436-SMTP169F573362CD1F6F2656E99D4F30@phx.gbl>
 <1427973061080.64404@supcom.tn> <1428578752765.11999@supcom.tn>,
 <BLU436-SMTP2470C7EEAE7AFBF9CA3F833D4F90@phx.gbl>
Message-ID: <1428914043730.47610@supcom.tn>

Hello Amer,


So my 2 VM that contains OVS had the same adress MAC.
-->​ A problem in ethernet packets

--> ping failed.



________________________________
From: Amer <amer7777 at hotmail.com>
Sent: Saturday, April 11, 2015 10:17 AM
To: Amal KAMMOUN
Cc: discuss at openvswitch.org
Subject: Re: [ovs-discuss] SDN topology.

Dear Amal

I apologize, I was in vacation, may you please tell me what was your problem to have a good documented record and how you fixed it.

Best regards,
Amer

On Apr 9, 2015, at 2:25 PM, Amal KAMMOUN <amal.kammoun at supcom.tn<mailto:amal.kammoun at supcom.tn>> wrote:


So my configuration was right but the problem was that my OVS-VMs had the same @MAC!!

Now it is solved.


Thank you so much for your time.


Best regards,


Amal.

________________________________
From: Amal KAMMOUN
Sent: Thursday, April 2, 2015 11:10 AM
To: Amer
Cc: discuss at openvswitch.org<mailto:discuss at openvswitch.org>
Subject: Re: [ovs-discuss] SDN topology.


Dear Amer,


I appreciate your note about writing br0 IP in the interfaces configuration file. Thanks.


But I want to get the interconnection between the 2 OVS before doing that.


I read all your posts in March, I find that I have same problems as you.

Would you please tell me how did you fix your issues?


For example in these posts:

http://openvswitch.org/pipermail/discuss/2015-March/016901.html

http://openvswitch.org/pipermail/discuss/2015-March/016943.html


Best regards!


Amal.


________________________________
From: Amer <amer7777 at hotmail.com<mailto:amer7777 at hotmail.com>>
Sent: Wednesday, April 1, 2015 3:49 PM
To: Amal KAMMOUN
Cc: discuss at openvswitch.org<mailto:discuss at openvswitch.org>
Subject: Re: [ovs-discuss] SDN topology.

Hello,

I did it and was working fine. Note:
The br0 IP is temporary and will be deleted when you reboot. Also, the IP will return back to the eth0. I recommend write it in the interfaces configuration file.

Best regards,
Amer

On Apr 1, 2015, at 1:52 PM, Amal KAMMOUN <amal.kammoun at supcom.tn<mailto:amal.kammoun at supcom.tn>> wrote:


Hello Amer,


So, as you said I will try with a simple scenario like this:


VM1: Host1-------------VM2: OVS1-----------------VM3: OVS2---------VM4: Host2


I want to do the interconnection between the 2 OVSs :


            VM2: OVS1-----------------VM3: OVS2


I connected between VMs using internal-network. For each VM I configured @IP and the netmask (no gateway no dns).


I could have the ping between each other.



I made this configuration:


1) in VM2: @IP 192.168.46.220


ovs-vsctl add-br br0

ovs-vsctl add-port br0 eth0

ifconfig eth0 0

ifconfig br0 up

ifconfig br0 192.168.46.220 netmask 255.255.255.0


2) in VM3: @IP 192.168.46.181


ovs-vsctl add-br br0

ovs-vsctl add-port br0 eth0

ifconfig eth0 0

ifconfig br0 up

ifconfig br0 192.168.46.181 netmask 255.255.255.0


The ping now fails! What I have to do to get the 2 OVS connected?


Thank you so much.




________________________________
From: Amer <amer7777 at hotmail.com<mailto:amer7777 at hotmail.com>>
Sent: Wednesday, April 1, 2015 5:17 AM
To: Amal KAMMOUN
Cc: discuss at openvswitch.org<mailto:discuss at openvswitch.org>
Subject: Re: [ovs-discuss] SDN topology.

Dear Amal

First, try with simple scenario

To connect between VMs you need to use internal-network and assign each VM to the same internal-network, then you need the IPs are in the same subnet for each two VMs.
Also, you need to crest a bridge in each OVS, like br0, then assign some interfaces to the bridge, like add-port br0 eth0, after that, give zero IP address to these interfaces, like ifconfig eth0 0, thereafter, give the bridge an IP address, like ifconfig eth0 192xxxxxxxxx netmask xxxxx.
The bridge IP needs to be written in the main interface configuration file.
To do this you need to search in this archive, I remember someone before few weeks discussed this issue and you will find my name there.
After this setup connecting each OVS to different controller will be easier.

Best regards,
Amer

On Mar 31, 2015, at 5:05 PM, Amal KAMMOUN <amal.kammoun at supcom.tn<mailto:amal.kammoun at supcom.tn>> wrote:


Hello all!


I'm trying to construct the following topology:



       VM1-  OpenFlowController1                            VM2- OpenflowController2

                            |                                                                     |
                            |                                                                     |

                            |                                                                     |
                            |                                                                     |

              VM3 ----------                                                  VM4 ----------

                      | OVS1|----------------------------------------------------------| OVS2|

                      -----------                                                           -----------

                            |                                                                     |

                            |                                                                     |

                            |                                                                     |

                       Host:VM-5                                                 Host:VM-6



All my virtual machines are made by VirtualBox.


It is possible to build such topology?


How can I connect 2 OVS running on 2 different VMs?


Thank you!

_______________________________________________
discuss mailing list
discuss at openvswitch.org<mailto:discuss at openvswitch.org>
http://openvswitch.org/mailman/listinfo/discuss
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150413/bcff6881/attachment-0001.html>

From cristina.palomo.regidor at ericsson.com  Mon Apr 13 01:38:40 2015
From: cristina.palomo.regidor at ericsson.com (Cristina Palomo Regidor)
Date: Mon, 13 Apr 2015 08:38:40 +0000
Subject: [ovs-discuss] ovs bridge dropping packages
In-Reply-To: <B0FC8B6A85BDD34FA799343D4664C6D61D0D7142@ESESSMB209.ericsson.se>
References: <B0FC8B6A85BDD34FA799343D4664C6D61D0D7142@ESESSMB209.ericsson.se>
Message-ID: <B0FC8B6A85BDD34FA799343D4664C6D61D0D7B90@ESESSMB209.ericsson.se>

Hello,
I have been troubleshooting and discovered that "ovs-dpctl dump-flows" show some flows with action dropped.
These flows are the ones that have as destination the multicast address "224.0.0.1". I have a bond with two fiber interfaces enabled in active/standby.

Is this a correct behavior in openvswitch?

Thanks and BR/

From: discuss [mailto:discuss-bounces at openvswitch.org] On Behalf Of Cristina Palomo Regidor
Sent: viernes, 10 de abril de 2015 21:26
To: discuss at openvswitch.org
Subject: [ovs-discuss] ovs bridge dropping packages

Hello,
I have ovs 2.1.2 and sles12.
Ifconfig mybridge is showing dropped packets.
Cat /sys/class/net/mybridge/statistics/rx_dropped is showing 1437

What could be the reason of the dropped packages? How can I troubleshoot? The vnets and physical interfaces are not dropping any packets.

Thanks and BR/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150413/f3985079/attachment.html>

From thomasfherbert at gmail.com  Mon Apr 13 05:21:40 2015
From: thomasfherbert at gmail.com (Thomas F Herbert)
Date: Mon, 13 Apr 2015 08:21:40 -0400
Subject: [ovs-discuss] Python for semi-automation of qemu with ovs/dpdk/vhost
Message-ID: <552BB4D4.2020603@gmail.com>

All:

I wrote some python to  simplify and semi-automate the setup of 
ovs/dpdk/vhost and launch qemu guests. Contributions, critiques and 
thoughts are welcome:

https://github.com/tfherbert/QemuPie.

Currently supports simple bridging and dpdk/vhost cuse. dpdk/vhost/user 
and other data path configuration to be added.

--Tom

-- 
Thomas F Herbert
Principal Software Engineer
Red Hat
therbert at redhat.com


-- 
Thomas F. Herbert

From Clement.MOUTET at cea.fr  Mon Apr 13 05:55:48 2015
From: Clement.MOUTET at cea.fr (=?iso-8859-1?Q?MOUTET_Cl=E9ment?=)
Date: Mon, 13 Apr 2015 12:55:48 +0000
Subject: [ovs-discuss] Not receiving LLDP packets
Message-ID: <DC4647301E6B9244B82B4B0C961D996F52A23C@EXDAG0-A3.intra.cea.fr>

Hi,
I am currently using openvswitch with an SDN controller and I am experiencing an issue; I can't receive LLDP packets.
I have two openvswitches, s1 and s2, connected threw an ethernet cable that send LLDP packets to each other. (it is the way OpenDaylight discovers the network topology)
For each  of theses switches, I created a virtual bridge, and added the port that I wanted :
ovs-vsctl add-br br0
ovs-vsctl add-port br0 eth1

When I do a tcpdump on eth1, I can see LLDP packets sent and received. But when I do tcpdump on br0, I only see the LLDP packets sent. It seems that LLDP packets received in eth0 are not transmitted to br0.
Does someone know what I should do ?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150413/2f44d70b/attachment.html>

From shettyg at nicira.com  Mon Apr 13 09:08:40 2015
From: shettyg at nicira.com (Gurucharan Shetty)
Date: Mon, 13 Apr 2015 09:08:40 -0700
Subject: [ovs-discuss] [ovs-dev] How to destroy a single queue at the
	qos?
In-Reply-To: <22d5328c.17813.14cb37d26e4.Coremail.laoz103@126.com>
References: <22d5328c.17813.14cb37d26e4.Coremail.laoz103@126.com>
Message-ID: <CAHbON5pD6W0fid9YHaPVi6f-bMbWfzavTAFV7UKoccVTRdV3EQ@mail.gmail.com>

You need to remove the reference of the queue from the qos table and
destroy the queue in a single transaction.

e.g:

* Create qos and queue records:
ovs-vsctl -- set port p0 qos=@newqos -- --id=@newqos create qos
type=linux-htb other-config:max-rate=900000000
queues=10=@q0,20=@q1,30=@q2 -- --id=@q0 create queue
other-config:min-rate=720000000 other-config:max-rate=900000000 --
--id=@q1 create queue other-config:min-rate=0
other-config:max-rate=90000000 -- --id=@q2 create queue
other-config:min-rate=0 other-config:max-rate=90000000

* Look at the record:
ovs-vsctl list qos
_uuid               : e472fc24-2d9b-4e5d-8283-906b7b9504d5
external_ids        : {}
other_config        : {max-rate="900000000"}
queues              : {10=efe0afff-79db-4712-a85c-5e2e0018dd04,
20=680e8ec5-a8d2-4b1b-b6c7-0b648ebf102d,
30=ebee7bdf-33ab-46b6-b073-83c5419274bf}
type                : linux-htb


* Remove queue '10'
ovs-vsctl remove qos e472fc24-2d9b-4e5d-8283-906b7b9504d5 queues 10 --
destroy queue efe0afff-79db-4712-a85c-5e2e0018dd04

On Mon, Apr 13, 2015 at 8:54 AM, zy <laoz103 at 126.com> wrote:
> cc discuss
>     I am testing OVS version 2.3.1 and have the same problem. Is there anyone knows about the issue, or I have to disconnect QoS and all queues first before I destroy one specific queue.
> And could you pls explain what's role of QoS in this scenario  (ie：why do we need to create a qos at a port first and then add queues to qos  rather than just add queues to port directly )
>
>
> thanks
>
>
>
> 发件人:周二 [mailto:zhouje1005 at 163.com]
> 发送时间: 2015年4月13日 15:21
> 收件人: dev at openvswitch.org
> 抄送:张勇
> 主题: How to destroy a single queue at the qos?
>
>
>
> Hi:
>
>       We have a problem to destroy a single queue on the qos.
>
>
>
>       We first set a qos at a port : ovs-vsctl set port eth0 qos=@newqos -- --id=@newqos create qos external_ids:qos=eth0 type=linux-htb other-config:max-rate=1000000000
>
> Then add two queues to the qos:  ovs-vsctl -- add qos eth0 queue 123=@queue10M -- --id=@queue10M create queue external_ids:name=1M-for-tap1 other-config:max-rate=10000000
>
>                                     ovs-vsctl -- add qos eth0 queue 223=@queue10M -- --id=@queue10M create queue external_ids:name=1M-for-tap2 other-config:max-rate=10000000
>
>
>
> Now we want to destroy only queue 123, and we have to disconnect the link between qos and queues : ovs-vsctl clear qos eth0 queues. This will also disconnect the link for 223. Would any one help us to destroy queue 123 and does not influence queue 223?
>
>
>
> Thanks for your help!
> _______________________________________________
> dev mailing list
> dev at openvswitch.org
> http://openvswitch.org/mailman/listinfo/dev

From azmanshafii1972 at gmail.com  Mon Apr 13 02:40:50 2015
From: azmanshafii1972 at gmail.com (azman shafii)
Date: Mon, 13 Apr 2015 17:40:50 +0800
Subject: [ovs-discuss] How to connect two OVS bridge
Message-ID: <CAM9YyShBW1DWsJ0nnJGndB-pnns5_e-rWUT6mjqW_fsALnfuyw@mail.gmail.com>

Hi, i'm tried to connect myLaptop to VM in Redhat Openstack server.

using command,
 ovs-vsctl set interface vport1 type=patch options:peer=qvo689dd8ce-a7
ovs-vsctl set interface qvo689dd8ce-a7 type=patch options:peer=vport1

But not working.


]# ovs-vsctl show
0ed689ce-e2fe-4897-b457-f5e6a2342d3b
    Bridge br-ex
        Port br-ex
            Interface br-ex
                type: internal
        Port "enp3s4f0"
            Interface "enp3s4f0"
    Bridge "br-ex2"
        Port "br-ex2"
            Interface "br-ex2"
                type: internal
        Port "vport1"
            Interface "vport1"
                type: patch
                options: {peer="qvo689dd8ce-a7"}
        Port "enp3s4f1"
            Interface "enp3s4f1"
    Bridge br-tun
        fail_mode: secure
        Port br-tun
            Interface br-tun
                type: internal
        Port patch-int
            Interface patch-int
                type: patch
                options: {peer=patch-tun}
    Bridge br-int
        fail_mode: secure
        Port br-int
            Interface br-int
                type: internal
        Port "qvo689dd8ce-a7"
            tag: 2
            Interface "qvo689dd8ce-a7"
                type: patch
                options: {peer="vport1"}
        Port patch-tun
            Interface patch-tun
                type: patch
                options: {peer=patch-int}
    ovs_version: "2.1.3"

Please somebody can help me.

thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150413/af0a77ba/attachment-0001.html>

From raghu401sfdc at gmail.com  Mon Apr 13 04:41:50 2015
From: raghu401sfdc at gmail.com (Raghu Devisetty)
Date: Mon, 13 Apr 2015 17:11:50 +0530
Subject: [ovs-discuss] open vswitch with xen
Message-ID: <CANfGnwFdqWt8gaExv9ZDaCPi1WEkWcf5zYqr5C8k0SVv35gy-w@mail.gmail.com>

Hi,

This mail regarding how to work with open v switch in xen server
virtualization(citrix). Can you please give me some pictured manner
example.


Regards,

Raghu.D
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150413/fc6e3cef/attachment.html>

From alexw at nicira.com  Mon Apr 13 10:33:30 2015
From: alexw at nicira.com (Alex Wang)
Date: Mon, 13 Apr 2015 10:33:30 -0700
Subject: [ovs-discuss] (no subject)
In-Reply-To: <CA+Cs8xJqO1SqCrfhfsstdks3h9Lrv-GT9XiTfNSfVDhxrU=1tw@mail.gmail.com>
References: <CA+Cs8xJMzy333GWBK8YKwuW6z0VRtb2x5Up16MQJKtgK3_G_BQ@mail.gmail.com>
 <CAArS4XWUYxP5t1UkXeoo9hLKFjDMFinbNDS1rTb5Yo_fAeGiJw@mail.gmail.com>
 <CA+Cs8xJOrB-kkvKKQ8KNQJmN=90otV8DF0ci4YxgGhX1xH=Z9Q@mail.gmail.com>
 <CAArS4XUWe9t0+xM_Pb11gWQn6BJqLy9c-QDuAR8vmuUP8aOBAg@mail.gmail.com>
 <CA+Cs8xJqO1SqCrfhfsstdks3h9Lrv-GT9XiTfNSfVDhxrU=1tw@mail.gmail.com>
Message-ID: <CAArS4XX6Hhgv4bxu_08Y1r+pmQS8k7EJ1Us1zF8Ksy8_-SB8Gw@mail.gmail.com>

Sorry for the delayed reply,

I tried to reproduce it on my own setup, and did not see the issue.  I used
hing3, rather than iperf... will do again using iperf.

At the same time, could you provide the output of following cmd while
running
iperf (using all VLAN tagged ports) and on both boxes...

`ovs-dpctl show`
`ovs-appctl dpif/dump-flows vmbr0`

Thanks,
Alex Wang,

On Tue, Apr 7, 2015 at 11:33 AM, Ben Schmidt <crackhd2 at gmail.com> wrote:

>
>
> On Thu, Apr 2, 2015 at 7:01 PM, Alex Wang <alexw at nicira.com> wrote:
>
>>
>>>> What is the 'ovs-vsctl show' output of Box-B?  For traffic sent from
>>>> untagged VLAN port of Box-B, the vmbr0 of Box-A should not forward it
>>>> to tagged VLAN ports.
>>>>
>>>
>>> I hope that we have a communication Problem here and I didn't miss
>>> something really basic about OVS and wasted everyones time.
>>> box-b doesn't use OVS yet. box-b uses normal linux bridging on a
>>> untagged VLAN Port (VLAN ID 1115) on a switch. box-a connects to two LACP
>>> bond'ed Ports on that some switch that have multiple tagged VLAN IDs, one
>>> of them being 1115.
>>>
>>> ########
>>> [root at box-b /root $ ovs-vsctl show
>>> 872e809c-3121-4a4f-9fe8-8e436a7cf101
>>>     ovs_version: "2.3.1"
>>> ########
>>>
>>> Any Ideas where I could look at?
>>>
>>>
>>
>> Thx for providing the info~
>>
>> Could you try applying the same ovs config on box-b and redo the test to
>> see
>> if linux bridge is the issue?
>>
>> Thanks,
>> Alex Wang,
>>
>
> Hi Alex,
>
> thanks for your help.
> So I setup box-b in the same way as box-a on the switch as well as the
> interfaces.
> A ping between the boxes is fine, fast and reliable. unfortunately the
> iperf is super slow in both directions now.
>
> box-a > http://pastebin.ca/2969003
> box-b > http://pastebin.ca/2969001
>
> box-b - ovs-vsctl show > http://pastebin.ca/2968991
> box-a - ovs-vsctl show > http://pastebin.ca/2968993
>
> iperf box-a > box-b > http://pastebin.ca/2969005
> iperf box-b > box-a > http://pastebin.ca/2969006
>
>
> So in order to get somewhere I removed tagged vlans from the 2x2 LACP
> ports, setup these 4 ports to a untagged VLAN but kept the LACP Config to
> try giving the OVS bridge a IP directly.
> No Problems at all, fast and reliable ping as well as almost 1GBit/s in
> both directions.
>
> Next Step was to also also use a tagged port along the untagged one. Same
> Problem, ping is fine but iperf doesn't get me anywhere.
>
> So it seems that I only run into these Problems when I use tagged VLANs.
> Is there something special about tagged VLANs using OVS because I've used
> dozens of these switches without any Problems.
> Oh yeah, I already replaced the switch before even asking this mailinglist.
>
> Thanks,
> Ben
>
>
>>
>>
>>>
>>>>
>>>> Thanks,
>>>> Alex Wang,
>>>>
>>>
>>> Thank YOU,
>>> Ben
>>>
>>>
>>>>
>>>>
>>>>>
>>>>> Here is my basic setup
>>>>> ######
>>>>> ovs-vsctl show
>>>>> 8031569b-5210-4334-88fd-36704af3a667
>>>>>     Bridge "vmbr0"
>>>>>         Port "vlan1115"
>>>>>             tag: 1115
>>>>>             Interface "vlan1115"
>>>>>                 type: internal
>>>>>         Port "bond0"
>>>>>             Interface "eth1"
>>>>>             Interface "eth2"
>>>>>         Port "vmbr0"
>>>>>             Interface "vmbr0"
>>>>>                 type: internal
>>>>>         Port "vlan1116"
>>>>>             tag: 1116
>>>>>             Interface "vlan1116"
>>>>>                 type: internal
>>>>>     ovs_version: "2.3.1"
>>>>> ########
>>>>>
>>>>>
>>>>> cat /etc/network/interfaces = http://pastebin.ca/2967191
>>>>> ifconfig = http://pastebin.ca/2967192
>>>>> ovs-appctl bond/show bond0 = http://pastebin.ca/2967193
>>>>> ovs-appctl lacp/show bond0 = http://pastebin.ca/2967194
>>>>> ovs-vsctl list port bond0 = http://pastebin.ca/2967200
>>>>>
>>>>>
>>>>> Could anyone please point me in a direction to look at.
>>>>>
>>>>> Thanks a lot,
>>>>> Ben
>>>>>
>>>>>
>>>>> _______________________________________________
>>>>> discuss mailing list
>>>>> discuss at openvswitch.org
>>>>> http://openvswitch.org/mailman/listinfo/discuss
>>>>>
>>>>>
>>>>
>>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150413/41580f01/attachment.html>

From pshelar at nicira.com  Mon Apr 13 11:08:52 2015
From: pshelar at nicira.com (Pravin Shelar)
Date: Mon, 13 Apr 2015 11:08:52 -0700
Subject: [ovs-discuss] Pushing multiple mpls label
In-Reply-To: <CAOCzzU+sD2obR7xHJf3+7QbhO0LFddELfjQK-pzNZ9pH5O459w@mail.gmail.com>
References: <CAOCzzU+sD2obR7xHJf3+7QbhO0LFddELfjQK-pzNZ9pH5O459w@mail.gmail.com>
Message-ID: <CALnjE+peDrJCS3UsC+ignsMa+8ZqL0EkuhfP9BdnRXk+KY9_EA@mail.gmail.com>

On Thu, Apr 9, 2015 at 12:15 AM, Navneet Singh
<navneet.singh2012 at gmail.com> wrote:
> Hi All,
>
> I am trying to push multiple mpls labels through openvswitch. I used the
> command
>>
>> ovs-ofctl add-flow br0
>> "in_port=1,action=push_mpls:0x8847,set_field:10->mpls_label,set_field:20->mpls_label,output=2"
>
>
> Command is accepted without error, the flows are matched but I cannot see 2
> labels during test. It only shows mpls label 20. I also tried this command
> with -O OpenFlow13 but with same result. I am using OVS 2.3.1.
>

Can you try same test on master branch?

From marco at nuvula.ch  Mon Apr 13 12:43:19 2015
From: marco at nuvula.ch (Marco Kuendig)
Date: Mon, 13 Apr 2015 21:43:19 +0200
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <55241FD8.1040704@ubuntu.com>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <CANr6G5yB6jiYD+fwYhtPDh3bxams3PNTZLqd25DVcyU1hxmquw@mail.gmail.com>
 <B32CB78D-2CF9-4F47-9515-C8A206C090A2@nuvula.ch>
 <alpine.OSX.1.10.1503311245160.389@sabyasg-mbp-02>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
 <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
 <3E5B9556-CB9F-4D5B-8A6D-A615C099BAD7@nuvula.ch>
 <3FE189EC-49E0-47CC-BD59-2F6E7B04B9A4@ubuntu.com>
 <8CE70C04-9A31-4499-938A-85EC4D13E0BB@nuvula.ch>
 <C222441F-23C1-470A-987E-123B00879EA9@ubuntu.com>
 <117DA076-BD34-4C01-94AE-22949AEF0E42@nuvula.ch> <55241FD8.1040704@ubuntu.com>
Message-ID: <EE28E066-A1DA-4816-A7D5-024698D67B37@nuvula.ch>

Folks,

I have tried to install the HWE kernel but my servers won't boot afterwards. Does anybody have a tip to get these correctly installed ?

 I have currently Ubuntu 14.04.02 and have installed the HWE drivers with apt-get install linux-image-hwe-generic-trusty

The kernel installs but the servers don't boot correctly anymore. Unfortunately I don't have console access to these devices and don't know exactly what the problem is. The are hardware cloud servers with no console access. The only thing I have is a rescue image that boots via PXE. So I can change stuff, but won't see the actual boot process.

Any tip is appreciated.

Installing this HWE kernel would help in troubleshooting the openvswitch crashes we regularly see.

cheers
marco


 <http://www.nuvula.ch/>
Marco Kuendig / CEO / Founder 
marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71

Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
Nuvula AG - Hybrid Clouds 
Weierbachstrasse 7b 8193 Eglisau Switzerland 
http://www.nuvula.ch <http://www.nuvula.ch/>
> On 07 Apr 2015, at 20:20, James Page <james.page at ubuntu.com> wrote:
> 
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA256
> 
> Hi Marco
> 
> On 07/04/15 10:33, Marco Kuendig wrote:
>> got another crash today with the optimisation disabled package:
>> 
>> here the backtrace (at the end is the one with the debug symbols)
> 
> Hmm - looks like the same backtrace to me; so maybe this not an
> optimizer problem after all.
> 
> Would you be willing to try to reproduce on the newer 3.16 HWE kernel
> on 14.04 (linux-image-hwe-generic-trusty)? I have a hypothesis on what
> might be causing this issue, but I've not been able to prove it yet
> and the 3.16 kernel has the required fix in the openvswitch module.
> 
> [...]
>> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506 
>> 506../lib/netlink.c: No such file or directory. (gdb) bt #0
>> nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506 #1
>> 0x0000000000460473 in format_generic_odp_key (a=a at entry=0x0, 
>> ds=ds at entry=0x7fff228e0520) at ../lib/odp-util.c:767 #2
>> 0x0000000000460cd2 in format_odp_key_attr (a=a at entry=0x1b8cdb4, 
>> ma=ma at entry=0x0, ds=ds at entry=0x7fff228e0520,
>> verbose=verbose at entry=true) at ../lib/odp-util.c:1332 #3
>> 0x00000000004609d7 in odp_flow_format (key=<optimized out>, 
>> key_len=40, mask=0x0, mask_len=0, ds=0x7fff228e0520, verbose=true)
>> at ../lib/odp-util.c:1402 #4  0x0000000000460fc4 in
>> format_odp_key_attr (a=a at entry=0x1b8cd90, ma=ma at entry=0x0,
>> ds=ds at entry=0x7fff228e0520, verbose=verbose at entry=true) at
>> ../lib/odp-util.c:987 #5  0x00000000004609d7 in odp_flow_format
>> (key=key at entry=0x1b8cd30, key_len=key_len at entry=140,
>> mask=mask at entry=0x0, mask_len=mask_len at entry=0, 
>> ds=ds at entry=0x7fff228e0520, verbose=verbose at entry=true) at 
>> ../lib/odp-util.c:1402 #6  0x00000000004450f3 in log_flow_message
>> (error=error at entry=2, operation=operation at entry=0x4d0e73
>> "flow_del", key=0x1b8cd30, key_len=140, mask=mask at entry=0x0, 
>> mask_len=mask_len at entry=0, stats=0x0, actions=actions at entry=0x0, 
>> actions_len=actions_len at entry=0, dpif=<optimized out>) at
>> ../lib/dpif.c:1354 #7  0x00000000004453c9 in log_flow_del_message 
>> (dpif=dpif at entry=0x1b5d4c0, del=del at entry=0x7fff228e05d0, 
>> error=error at entry=2) at ../lib/dpif.c:1397 #8  0x0000000000445433
>> in log_flow_del_message (error=2, del=0x7fff228e05d0,
>> dpif=0x1b5d4c0) at ../lib/dpif.c:1396 #9  dpif_flow_del__
>> (dpif=0x1b5d4c0, del=del at entry=0x7fff228e05d0) at 
>> ../lib/dpif.c:945 #10 0x00000000004455ca in dpif_flow_del
>> (dpif=<optimized out>, key=<optimized out>, key_len=<optimized
>> out>, stats=stats at entry=0x7fff228e0600) at ../lib/dpif.c:965 #11
>> 0x000000000041b423 in subfacet_uninstall (subfacet=0x1b38af0) at 
>> ../ofproto/ofproto-dpif.c:4686 #12 0x0000000000420f18 in
>> facet_remove (facet=facet at entry=0x1b386f0) at 
>> ../ofproto/ofproto-dpif.c:4014 #13 0x0000000000422f52 in
>> facet_revalidate (facet=facet at entry=0x1b386f0) at
>> ../ofproto/ofproto-dpif.c:4321 #14 0x0000000000424b5a in
>> facet_lookup_valid (flow=0x7fabe8000c68, ofproto=0x1b69e50) at
>> ../ofproto/ofproto-dpif.c:4203 #15 handle_flow_miss
>> (n_ops=<synthetic pointer>, ops=0x7fff228e0cd0, 
>> miss=0x7fabe8000c50) at ../ofproto/ofproto-dpif.c:3339 #16
>> handle_flow_misses (fmb=fmb at entry=0x7fabe80008e0,
>> backer=<optimized out>) at ../ofproto/ofproto-dpif.c:3410 #17
>> 0x0000000000425196 in handle_upcalls (backer=<optimized out>) at 
>> ../ofproto/ofproto-dpif.c:3565 #18 dpif_backer_run_fast
>> (backer=<optimized out>) at ../ofproto/ofproto-dpif.c:1007 #19
>> type_run_fast (type=<optimized out>) at
>> ../ofproto/ofproto-dpif.c:1024 #20 0x00000000004122cf in
>> ofproto_type_run_fast (datapath_type=<optimized out>,
>> datapath_type at entry=0x1ad7540 "system") at
>> ../ofproto/ofproto.c:1326 #21 0x00000000004081a5 in bridge_run_fast
>> () at ../vswitchd/bridge.c:2318 #22 0x00000000004059b6 in main
>> (argc=<optimized out>, argv=<optimized out>) at
>> ../vswitchd/ovs-vswitchd.c:117 (gdb) quit
> 
> 
> - -- 
> James Page
> Ubuntu and Debian Developer
> james.page at ubuntu.com
> jamespage at debian.org
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v2
> 
> iQIcBAEBCAAGBQJVJB/YAAoJEL/srsug59jDAs8P/3Vy774c1CoyomZAaMnXdlb8
> kQm1zYTAWJEJk0Ms3SfaI8roihnhBUB/JS34Ns3FkJXHHTqHpQH2sL+wnRj4jVYZ
> TLB8V4t2zezVvl6gFyKdYqMBz+/RGp7yFWG32b3eczMsZDUJCgvGoHdr8dW5sbVm
> uFNMZLv5on670NZn8QP/Th8iAHX0dB7Q9QX+QNSNeAg43PHXOoPiy2f8zIbczU+Q
> mBUGY5NBWnnJkQStyecP8cII81adXyS/NZwJvf4LaGIZ8q9MW9/dc8C6t/DaYd/a
> GZ4jcYBnDMOQd1adPqi3oDx8UtEsK+Z8XOJzueU7mLvzxkRYScNLhv5lmiGP3/Gv
> Lr7D0IWFe6pEV1BxGgBZGU51Nle9LiLC2ERmPX5a0g7YZZ6pKdPNmwj93KWvvY4b
> sJDBSF7ynQxbDbaDct7ZE2WqEdurkZ1wcFu6c2j6+vf2UKRHZ/J53GpAnYsGS5eL
> u8PVqZv4896Vs1nvLZddhN6MrHc4Qu0vSIRA1PcvI350LYcBi8y5wN514H0H8/vr
> jy6WBqLRBpXBjReJTHxORKAH6vTIub7IzrIFEM0eQQyhqc0p6Szw2U2p+FQNrD/T
> MUY5Sl9hAZTzGGpDkjQfxnyv1NNuozrUXqAs+0SHXw2hsIazKwlN+rJ3nENJPPXo
> qjXPMYZeGI4IjXJuvfsZ
> =8H5s
> -----END PGP SIGNATURE-----

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150413/fd5de4f6/attachment.html>

From alexw at nicira.com  Mon Apr 13 16:00:34 2015
From: alexw at nicira.com (Alex Wang)
Date: Mon, 13 Apr 2015 16:00:34 -0700
Subject: [ovs-discuss] (no subject)
In-Reply-To: <CAArS4XX6Hhgv4bxu_08Y1r+pmQS8k7EJ1Us1zF8Ksy8_-SB8Gw@mail.gmail.com>
References: <CA+Cs8xJMzy333GWBK8YKwuW6z0VRtb2x5Up16MQJKtgK3_G_BQ@mail.gmail.com>
 <CAArS4XWUYxP5t1UkXeoo9hLKFjDMFinbNDS1rTb5Yo_fAeGiJw@mail.gmail.com>
 <CA+Cs8xJOrB-kkvKKQ8KNQJmN=90otV8DF0ci4YxgGhX1xH=Z9Q@mail.gmail.com>
 <CAArS4XUWe9t0+xM_Pb11gWQn6BJqLy9c-QDuAR8vmuUP8aOBAg@mail.gmail.com>
 <CA+Cs8xJqO1SqCrfhfsstdks3h9Lrv-GT9XiTfNSfVDhxrU=1tw@mail.gmail.com>
 <CAArS4XX6Hhgv4bxu_08Y1r+pmQS8k7EJ1Us1zF8Ksy8_-SB8Gw@mail.gmail.com>
Message-ID: <CAArS4XUVhN5mD48fONHRinymEx6VzWJSwir7vWU-tCT3OJaDeg@mail.gmail.com>

Just set the same environment using ovs 2.3.1 (commit:
0dfed4b Set release dates for 2.3.1.) and tried using iperf~

root at promg-2n-a-dhcp85:~/alex_dev/openvswitch# ovs-vsctl show
b40f32d2-85f5-46f2-b907-230ea3dc663a
    Bridge "br0"
        Port "br0"
            Interface "br0"
                type: internal
        Port "vlan20"
            tag: 20
            Interface "vlan20"
                type: internal
        Port "bond0"
            Interface "eth3"
            Interface "eth4"
        Port "vlan10"
            tag: 10
            Interface "vlan10"
                type: internal
    ovs_version: "2.3.1"


Still could not reproduce the issue...

May be worth double check the kernel module version, and the exact commit
of your ovs.

Thanks,
Alex Wang,


On Mon, Apr 13, 2015 at 10:33 AM, Alex Wang <alexw at nicira.com> wrote:

> Sorry for the delayed reply,
>
> I tried to reproduce it on my own setup, and did not see the issue.  I used
> hing3, rather than iperf... will do again using iperf.
>
> At the same time, could you provide the output of following cmd while
> running
> iperf (using all VLAN tagged ports) and on both boxes...
>
> `ovs-dpctl show`
> `ovs-appctl dpif/dump-flows vmbr0`
>
> Thanks,
> Alex Wang,
>
> On Tue, Apr 7, 2015 at 11:33 AM, Ben Schmidt <crackhd2 at gmail.com> wrote:
>
>>
>>
>> On Thu, Apr 2, 2015 at 7:01 PM, Alex Wang <alexw at nicira.com> wrote:
>>
>>>
>>>>> What is the 'ovs-vsctl show' output of Box-B?  For traffic sent from
>>>>> untagged VLAN port of Box-B, the vmbr0 of Box-A should not forward it
>>>>> to tagged VLAN ports.
>>>>>
>>>>
>>>> I hope that we have a communication Problem here and I didn't miss
>>>> something really basic about OVS and wasted everyones time.
>>>> box-b doesn't use OVS yet. box-b uses normal linux bridging on a
>>>> untagged VLAN Port (VLAN ID 1115) on a switch. box-a connects to two LACP
>>>> bond'ed Ports on that some switch that have multiple tagged VLAN IDs, one
>>>> of them being 1115.
>>>>
>>>> ########
>>>> [root at box-b /root $ ovs-vsctl show
>>>> 872e809c-3121-4a4f-9fe8-8e436a7cf101
>>>>     ovs_version: "2.3.1"
>>>> ########
>>>>
>>>> Any Ideas where I could look at?
>>>>
>>>>
>>>
>>> Thx for providing the info~
>>>
>>> Could you try applying the same ovs config on box-b and redo the test to
>>> see
>>> if linux bridge is the issue?
>>>
>>> Thanks,
>>> Alex Wang,
>>>
>>
>> Hi Alex,
>>
>> thanks for your help.
>> So I setup box-b in the same way as box-a on the switch as well as the
>> interfaces.
>> A ping between the boxes is fine, fast and reliable. unfortunately the
>> iperf is super slow in both directions now.
>>
>> box-a > http://pastebin.ca/2969003
>> box-b > http://pastebin.ca/2969001
>>
>> box-b - ovs-vsctl show > http://pastebin.ca/2968991
>> box-a - ovs-vsctl show > http://pastebin.ca/2968993
>>
>> iperf box-a > box-b > http://pastebin.ca/2969005
>> iperf box-b > box-a > http://pastebin.ca/2969006
>>
>>
>> So in order to get somewhere I removed tagged vlans from the 2x2 LACP
>> ports, setup these 4 ports to a untagged VLAN but kept the LACP Config to
>> try giving the OVS bridge a IP directly.
>> No Problems at all, fast and reliable ping as well as almost 1GBit/s in
>> both directions.
>>
>> Next Step was to also also use a tagged port along the untagged one. Same
>> Problem, ping is fine but iperf doesn't get me anywhere.
>>
>> So it seems that I only run into these Problems when I use tagged VLANs.
>> Is there something special about tagged VLANs using OVS because I've used
>> dozens of these switches without any Problems.
>> Oh yeah, I already replaced the switch before even asking this
>> mailinglist.
>>
>> Thanks,
>> Ben
>>
>>
>>>
>>>
>>>>
>>>>>
>>>>> Thanks,
>>>>> Alex Wang,
>>>>>
>>>>
>>>> Thank YOU,
>>>> Ben
>>>>
>>>>
>>>>>
>>>>>
>>>>>>
>>>>>> Here is my basic setup
>>>>>> ######
>>>>>> ovs-vsctl show
>>>>>> 8031569b-5210-4334-88fd-36704af3a667
>>>>>>     Bridge "vmbr0"
>>>>>>         Port "vlan1115"
>>>>>>             tag: 1115
>>>>>>             Interface "vlan1115"
>>>>>>                 type: internal
>>>>>>         Port "bond0"
>>>>>>             Interface "eth1"
>>>>>>             Interface "eth2"
>>>>>>         Port "vmbr0"
>>>>>>             Interface "vmbr0"
>>>>>>                 type: internal
>>>>>>         Port "vlan1116"
>>>>>>             tag: 1116
>>>>>>             Interface "vlan1116"
>>>>>>                 type: internal
>>>>>>     ovs_version: "2.3.1"
>>>>>> ########
>>>>>>
>>>>>>
>>>>>> cat /etc/network/interfaces = http://pastebin.ca/2967191
>>>>>> ifconfig = http://pastebin.ca/2967192
>>>>>> ovs-appctl bond/show bond0 = http://pastebin.ca/2967193
>>>>>> ovs-appctl lacp/show bond0 = http://pastebin.ca/2967194
>>>>>> ovs-vsctl list port bond0 = http://pastebin.ca/2967200
>>>>>>
>>>>>>
>>>>>> Could anyone please point me in a direction to look at.
>>>>>>
>>>>>> Thanks a lot,
>>>>>> Ben
>>>>>>
>>>>>>
>>>>>> _______________________________________________
>>>>>> discuss mailing list
>>>>>> discuss at openvswitch.org
>>>>>> http://openvswitch.org/mailman/listinfo/discuss
>>>>>>
>>>>>>
>>>>>
>>>>
>>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150413/848c9952/attachment-0001.html>

From jpettit at nicira.com  Mon Apr 13 22:29:58 2015
From: jpettit at nicira.com (Justin Pettit)
Date: Mon, 13 Apr 2015 22:29:58 -0700
Subject: [ovs-discuss] open vswitch with xen
In-Reply-To: <CANfGnwFdqWt8gaExv9ZDaCPi1WEkWcf5zYqr5C8k0SVv35gy-w@mail.gmail.com>
References: <CANfGnwFdqWt8gaExv9ZDaCPi1WEkWcf5zYqr5C8k0SVv35gy-w@mail.gmail.com>
Message-ID: <6DAF8E4B-A252-4AB3-8EAA-4D5732F5C1B8@nicira.com>

XenServer has worked natively with OVS for years.  Here's some documentation that ships with OVS about it, though:

	https://github.com/openvswitch/ovs/blob/master/INSTALL.XenServer.md

Hope that helps.

--Justin


> On Apr 13, 2015, at 4:41 AM, Raghu Devisetty <raghu401sfdc at gmail.com> wrote:
> 
> Hi,
> 
> This mail regarding how to work with open v switch in xen server virtualization(citrix). Can you please give me some pictured manner example.      
> 
> 
> Regards,
> 
> Raghu.D
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss


From jpettit at nicira.com  Mon Apr 13 22:32:32 2015
From: jpettit at nicira.com (Justin Pettit)
Date: Mon, 13 Apr 2015 22:32:32 -0700
Subject: [ovs-discuss] How to connect two OVS bridge
In-Reply-To: <CAM9YyShBW1DWsJ0nnJGndB-pnns5_e-rWUT6mjqW_fsALnfuyw@mail.gmail.com>
References: <CAM9YyShBW1DWsJ0nnJGndB-pnns5_e-rWUT6mjqW_fsALnfuyw@mail.gmail.com>
Message-ID: <999941B7-A5C6-4C9D-8E49-DC942061B0D9@nicira.com>

I don't know what it means to have a VLAN configured on a patch port as "qvo689dd8ce-a7" does, but otherwise it's hard to know what the problem may be since you haven't provided any details about what you've tried and what you're seeing.

--Justin


> On Apr 13, 2015, at 2:40 AM, azman shafii <azmanshafii1972 at gmail.com> wrote:
> 
> Hi, i'm tried to connect myLaptop to VM in Redhat Openstack server.
> 
> using command,
>  ovs-vsctl set interface vport1 type=patch options:peer=qvo689dd8ce-a7
> ovs-vsctl set interface qvo689dd8ce-a7 type=patch options:peer=vport1
> 
> But not working.
> 
> 
> ]# ovs-vsctl show
> 0ed689ce-e2fe-4897-b457-f5e6a2342d3b
>     Bridge br-ex
>         Port br-ex
>             Interface br-ex
>                 type: internal
>         Port "enp3s4f0"
>             Interface "enp3s4f0"
>     Bridge "br-ex2"
>         Port "br-ex2"
>             Interface "br-ex2"
>                 type: internal
>         Port "vport1"
>             Interface "vport1"
>                 type: patch
>                 options: {peer="qvo689dd8ce-a7"}
>         Port "enp3s4f1"
>             Interface "enp3s4f1"
>     Bridge br-tun
>         fail_mode: secure
>         Port br-tun
>             Interface br-tun
>                 type: internal
>         Port patch-int
>             Interface patch-int
>                 type: patch
>                 options: {peer=patch-tun}
>     Bridge br-int
>         fail_mode: secure
>         Port br-int
>             Interface br-int
>                 type: internal
>         Port "qvo689dd8ce-a7"
>             tag: 2
>             Interface "qvo689dd8ce-a7"
>                 type: patch
>                 options: {peer="vport1"}
>         Port patch-tun
>             Interface patch-tun
>                 type: patch
>                 options: {peer=patch-int}
>     ovs_version: "2.1.3"
> 
> Please somebody can help me.
> 
> thanks
> 
> 
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss


From jpettit at nicira.com  Mon Apr 13 22:41:06 2015
From: jpettit at nicira.com (Justin Pettit)
Date: Mon, 13 Apr 2015 22:41:06 -0700
Subject: [ovs-discuss] Not receiving LLDP packets
In-Reply-To: <DC4647301E6B9244B82B4B0C961D996F52A23C@EXDAG0-A3.intra.cea.fr>
References: <DC4647301E6B9244B82B4B0C961D996F52A23C@EXDAG0-A3.intra.cea.fr>
Message-ID: <F48155BD-EB5E-441C-9500-20E67A451B3C@nicira.com>

Are there any flows on that bridge?  If not, you probably just have the "normal" flow that drops many types of BPDUs as described in the ovs-vswitchd.conf.db man page.

--Justin


> On Apr 13, 2015, at 5:55 AM, MOUTET Clément <Clement.MOUTET at cea.fr> wrote:
> 
> Hi,
> I am currently using openvswitch with an SDN controller and I am experiencing an issue; I can't receive LLDP packets.
> I have two openvswitches, s1 and s2, connected threw an ethernet cable that send LLDP packets to each other. (it is the way OpenDaylight discovers the network topology)
> For each  of theses switches, I created a virtual bridge, and added the port that I wanted : 
> ovs-vsctl add-br br0
> ovs-vsctl add-port br0 eth1
> 
> When I do a tcpdump on eth1, I can see LLDP packets sent and received. But when I do tcpdump on br0, I only see the LLDP packets sent. It seems that LLDP packets received in eth0 are not transmitted to br0.
> Does someone know what I should do ?
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss


From jpettit at nicira.com  Mon Apr 13 22:54:24 2015
From: jpettit at nicira.com (Justin Pettit)
Date: Mon, 13 Apr 2015 22:54:24 -0700
Subject: [ovs-discuss] ovs bridge dropping packages
In-Reply-To: <B0FC8B6A85BDD34FA799343D4664C6D61D0D7B90@ESESSMB209.ericsson.se>
References: <B0FC8B6A85BDD34FA799343D4664C6D61D0D7142@ESESSMB209.ericsson.se>
 <B0FC8B6A85BDD34FA799343D4664C6D61D0D7B90@ESESSMB209.ericsson.se>
Message-ID: <DA33BA88-FF08-454F-A47E-6599302AF3BA@nicira.com>

I wouldn't have expected that.  You could see why OVS is doing that by running "ofproto/trace" as described in the ovs-vswitchd man page.

--Justin


> On Apr 13, 2015, at 1:38 AM, Cristina Palomo Regidor <cristina.palomo.regidor at ericsson.com> wrote:
> 
> Hello,
> I have been troubleshooting and discovered that “ovs-dpctl dump-flows” show some flows with action dropped.
> These flows are the ones that have as destination the multicast address “224.0.0.1”. I have a bond with two fiber interfaces enabled in active/standby.
>  
> Is this a correct behavior in openvswitch?
>  
> Thanks and BR/
>  
> From: discuss [mailto:discuss-bounces at openvswitch.org] On Behalf Of Cristina Palomo Regidor
> Sent: viernes, 10 de abril de 2015 21:26
> To: discuss at openvswitch.org
> Subject: [ovs-discuss] ovs bridge dropping packages
>  
> Hello,
> I have ovs 2.1.2 and sles12. 
> Ifconfig mybridge is showing dropped packets.
> Cat /sys/class/net/mybridge/statistics/rx_dropped is showing 1437
>  
> What could be the reason of the dropped packages? How can I troubleshoot? The vnets and physical interfaces are not dropping any packets.
>  
> Thanks and BR/
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss


From wchunx416 at 126.com  Mon Apr 13 23:53:37 2015
From: wchunx416 at 126.com (Fang)
Date: Tue, 14 Apr 2015 14:53:37 +0800 (CST)
Subject: [ovs-discuss] change packet flow
Message-ID: <48b9eef0.24b70.14cb6b461a1.Coremail.wchunx416@126.com>

Hello,
I have two host installed ovs 2.0.1.Every host has two network card eth1 and eth2.
Two vms on host1.

I can ping from vm1 to vm2.Now I want to change the packet flow like the read line
in picture.

I had set br0 stp_enable=true.

on host1:
ovs-ofctl show br0 | grep addr
 1(tap1): addr:fa:45:84:29:aa:77
 2(tap2): addr:0a:65:8e:0b:aa:4d
 3(eth1): addr:00:81:81:81:81:01
 4(eth2): addr:00:81:81:81:81:02
 LOCAL(br0): addr:00:81:81:81:81:01

I add a flow: output packet from port 1 to port 3.
ovs-ofctl dump-flows br0
NXST_FLOW reply (xid=0x4):
 cookie=0xa, duration=241.229s, table=0, n_packets=243, n_bytes=12422, idle_age=2, priority=10,in_port=1 actions=output:3
 cookie=0x0, duration=10511.65s, table=0, n_packets=1287759, n_bytes=77663334, idle_age=30, priority=0 actions=NORMAL

But vm1 can't ping vm2 any more.
I use tcpdump to catch the packet
eth1 on host1:
00:11:22:33:44:01 > ff:ff:ff:ff:ff:ff, ethertype ARP (0x0806), length 42: Request who-has 10.0.1.2 tell 10.0.1.1, length 28
eth1 on host2:
00:11:22:33:44:01 > ff:ff:ff:ff:ff:ff, ethertype ARP (0x0806), length 60: Request who-has 10.0.1.2 tell 10.0.1.1, length 46
but I can't catch the arp packet on eth2(host2).

on host2
ovs-ofctl show br0 | grep addr
 1(eth1): addr:00:91:91:91:91:01
 2(eth2): addr:00:91:91:91:91:02
 LOCAL(br0): addr:00:91:91:91:91:01

I tried to add a flow:
ovs-ofctl dump-flows br0
NXST_FLOW reply (xid=0x4):
 cookie=0xa, duration=996.847s, table=0, n_packets=1499, n_bytes=90148, idle_age=1, in_port=1 actions=output:2
 cookie=0x0, duration=4882.24s, table=0, n_packets=90432, n_bytes=5929592, idle_age=1, priority=0 actions=NORMAL
But it takes no effert.

I don't know how to achieve my goal,could somebody help me?Thanks.
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150414/6a7813b3/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: flow1.png
Type: image/png
Size: 21108 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150414/6a7813b3/attachment-0001.png>

From shettyg at nicira.com  Tue Apr 14 07:27:07 2015
From: shettyg at nicira.com (Gurucharan Shetty)
Date: Tue, 14 Apr 2015 07:27:07 -0700
Subject: [ovs-discuss] [ovs-dev] How to destroy a single queue at the
	qos?
In-Reply-To: <157a408b.15d70.14cb59a1070.Coremail.zhouje1005@163.com>
References: <22d5328c.17813.14cb37d26e4.Coremail.laoz103@126.com>
 <CAHbON5pD6W0fid9YHaPVi6f-bMbWfzavTAFV7UKoccVTRdV3EQ@mail.gmail.com>
 <157a408b.15d70.14cb59a1070.Coremail.zhouje1005@163.com>
Message-ID: <CAHbON5qHmXmVx+ER+m+G1BXEKrc9iJmpQSffDaM4h1V9W8qMqQ@mail.gmail.com>

On Mon, Apr 13, 2015 at 6:45 PM, 周二 <zhouje1005 at 163.com> wrote:
> Thank you so much, that solve our problem.
>
> And do you know why we need to create a qos first?  What is the relationship
> between qos and queue.
Have you read the sections on qos and queue in 'man
ovs-vswitchd.conf.db' ? That should provide some details. I think OVS
design tries to follow the corresponding Linux tc implementation.
There is a parent class and a bunch of sub classes there. I see qos
table as something that defines the type of QoS (e.g: linux-htb,
linux-hfsc) and provides an ability to set a max-rate for all the
underlying queues and acts as a parent. Queue table is used to provide
more fine-grained control for specific type of traffic going through a
port.

>
> Thanks again.
>
>
>
>
>
>
> At 2015-04-14 00:08:40, "Gurucharan Shetty" <shettyg at nicira.com> wrote:
>>You need to remove the reference of the queue from the qos table and
>>destroy the queue in a single transaction.
>>
>>e.g:
>>
>>* Create qos and queue records:
>>ovs-vsctl -- set port p0 qos=@newqos -- --id=@newqos create qos
>>type=linux-htb other-config:max-rate=900000000
>>queues=10=@q0,20=@q1,30=@q2 -- --id=@q0 create queue
>>other-config:min-rate=720000000 other-config:max-rate=900000000 --
>>--id=@q1 create queue other-config:min-rate=0
>>other-config:max-rate=90000000 -- --id=@q2 create queue
>>other-config:min-rate=0 other-config:max-rate=90000000
>>
>>* Look at the record:
>>ovs-vsctl list qos
>>_uuid               : e472fc24-2d9b-4e5d-8283-906b7b9504d5
>>external_ids        : {}
>>other_config        : {max-rate="900000000"}
>>queues              : {10=efe0afff-79db-4712-a85c-5e2e0018dd04,
>>20=680e8ec5-a8d2-4b1b-b6c7-0b648ebf102d,
>>30=ebee7bdf-33ab-46b6-b073-83c5419274bf}
>>type                : linux-htb
>>
>>
>>* Remove queue '10'
>>ovs-vsctl remove qos e472fc24-2d9b-4e5d-8283-906b7b9504d5 queues 10 --
>>destroy queue efe0afff-79db-4712-a85c-5e2e0018dd04
>>
>>On Mon, Apr 13, 2015 at 8:54 AM, zy <laoz103 at 126.com> wrote:
>>> cc discuss
>>>     I am testing OVS version 2.3.1 and have the same problem. Is there
>>> anyone knows about the issue, or I have to disconnect QoS and all queues
>>> first before I destroy one specific queue.
>>> And could you pls explain what's role of QoS in this scenario  (ie：why do
>>> we need to create a qos at a port first and then add queues to qos  rather
>>> than just add queues to port directly )
>>>
>>>
>>> thanks
>>>
>>>
>>>
>>> 发件人:周二 [mailto:zhouje1005 at 163.com]
>>> 发送时间: 2015年4月13日 15:21
>>> 收件人: dev at openvswitch.org
>>> 抄送:张勇
>>> 主题: How to destroy a single queue at the qos?
>>>
>>>
>>>
>>> Hi:
>>>
>>>       We have a problem to destroy a single queue on the qos.
>>>
>>>
>>>
>>>       We first set a qos at a port : ovs-vsctl set port eth0 qos=@newqos
>>> -- --id=@newqos create qos external_ids:qos=eth0 type=linux-htb
>>> other-config:max-rate=1000000000
>>>
>>> Then add two queues to the qos:  ovs-vsctl -- add qos eth0 queue
>>> 123=@queue10M -- --id=@queue10M create queue external_ids:name=1M-for-tap1
>>> other-config:max-rate=10000000
>>>
>>>                                     ovs-vsctl -- add qos eth0 queue
>>> 223=@queue10M -- --id=@queue10M create queue external_ids:name=1M-for-tap2
>>> other-config:max-rate=10000000
>>>
>>>
>>>
>>> Now we want to destroy only queue 123, and we have to disconnect the link
>>> between qos and queues : ovs-vsctl clear qos eth0 queues. This will also
>>> disconnect the link for 223. Would any one help us to destroy queue 123 and
>>> does not influence queue 223?
>>>
>>>
>>>
>>> Thanks for your help!
>>> _______________________________________________
>>> dev mailing list
>>> dev at openvswitch.org
>>> http://openvswitch.org/mailman/listinfo/dev
>
>
>

From joestringer at nicira.com  Tue Apr 14 11:18:25 2015
From: joestringer at nicira.com (Joe Stringer)
Date: Tue, 14 Apr 2015 11:18:25 -0700
Subject: [ovs-discuss] having trouble while trying to install OVS-2.3.1
 in Ubuntu 14.04 LTS 64 bit
In-Reply-To: <CAG=b5B3axnMte88VGemgOR1NhMS+8qcexMpQOWjH4n0+zGzPhw@mail.gmail.com>
References: <CAG=b5B3axnMte88VGemgOR1NhMS+8qcexMpQOWjH4n0+zGzPhw@mail.gmail.com>
Message-ID: <CANr6G5yX2EbHmws94Bu74zCQwdrwWHDc5JfYXb8JCj6h=uwaCg@mail.gmail.com>

I don't know where you're getting /users/peertest/openvswitch-2.3.1
from, your own instructions show that you're extracting OVS to
/work/openvswitch-2.3.1.

On 13 April 2015 at 22:02, Sanghamitra De <sanghamitra.de at gmail.com> wrote:
>
>
> Hi,
> I ran the command sequence as:
>
> sudo mkdir /work
> cd /work
> wget http://openvswitch.org/releases/openvswitch-2.3.1.tar.gz
> tar zxf openvswitch-2.3.1.tar.gz
> cd openvswitch-2.3.1
> ./configure --with-linux=/lib/modules/`uname -r`/build
> make
> make install
> sudo make modules_install
> sudo /sbin/modprobe openvswitch
>
> /sbin/lsmod
> cd /
> sudo rm -rf /work
>
> After that the disc image was used to load into other nodes.
>
> and then from one of the nodes i was going to try the following sequence:
>
> #ovsdb-tool create /usr/local/etc/openvswitch/conf.db
> /users/peertest/openvswitch-2.3.1/vswitchd/vswitch.ovsschema
> # ovsdb-server --remote=punix:/usr/local/var/run/openvswitch/db.sock \
> --remote=db:Open_vSwitch,Open_vSwitch,manager_options \ --pidfile --detach
>
> ovs-vsctl --no-wait init
> sudo ovs-vswitchd --pidfile --detach --log-file
> sudo ovs-vsctl add-br OVSbr1
> sudo ovs-vsctl add-br OVSbr2
> sudo ifconfig eth2 0
> sudo ifconfig eth3 0
> sudo ovs-vsctl add-port OVSbr1 eth2
> sudo ovs-vsctl add-port OVSbr2 eth3
> sudo ovs-vsctl show
>
>
> but on giving the very first command in the sequence it throws an error like
> the one showed in the screenshot attached.
>
> It seems the file openvswitch-2.3.1 is not present inside /users/peertest/
>
> how is this even possible? anywhere wrong in the sequence?
>
>
>
> Thanks
>
> Sanghamitra
>
> On Fri, Apr 10, 2015 at 12:00 PM, Joe Stringer <joestringer at nicira.com>
> wrote:
>>
>> On 9 April 2015 at 23:17, Sanghamitra De <sanghamitra.de at gmail.com> wrote:
>> > Will simply addition of 'make' and 'make install' as per the above
>> > sequence
>> > ensure that i do not get the error from the configuration commands as
>> > given
>> > in red?
>>
>> Yes.
>
>
>

From blp at nicira.com  Tue Apr 14 13:45:18 2015
From: blp at nicira.com (Ben Pfaff)
Date: Tue, 14 Apr 2015 13:45:18 -0700
Subject: [ovs-discuss] change packet flow
In-Reply-To: <48b9eef0.24b70.14cb6b461a1.Coremail.wchunx416@126.com>
References: <48b9eef0.24b70.14cb6b461a1.Coremail.wchunx416@126.com>
Message-ID: <20150414204518.GC3782@nicira.com>

On Tue, Apr 14, 2015 at 02:53:37PM +0800, Fang wrote:
> Hello,
> I have two host installed ovs 2.0.1.Every host has two network card eth1 and eth2.
> Two vms on host1.
> 
> I can ping from vm1 to vm2.Now I want to change the packet flow like the read line
> in picture.
> 
> I had set br0 stp_enable=true.
> 
> on host1:
> ovs-ofctl show br0 | grep addr
>  1(tap1): addr:fa:45:84:29:aa:77
>  2(tap2): addr:0a:65:8e:0b:aa:4d
>  3(eth1): addr:00:81:81:81:81:01
>  4(eth2): addr:00:81:81:81:81:02
>  LOCAL(br0): addr:00:81:81:81:81:01
> 
> I add a flow: output packet from port 1 to port 3.
> ovs-ofctl dump-flows br0
> NXST_FLOW reply (xid=0x4):
>  cookie=0xa, duration=241.229s, table=0, n_packets=243, n_bytes=12422, idle_age=2, priority=10,in_port=1 actions=output:3
>  cookie=0x0, duration=10511.65s, table=0, n_packets=1287759, n_bytes=77663334, idle_age=30, priority=0 actions=NORMAL

STP prevents loops, but you're trying to loop the packet back through
a single bridge on host1.  I think that's the problem.

From blp at nicira.com  Tue Apr 14 14:51:12 2015
From: blp at nicira.com (Ben Pfaff)
Date: Tue, 14 Apr 2015 14:51:12 -0700
Subject: [ovs-discuss] Using popen() or system() calls from inside
 openvswitch source code
In-Reply-To: <CANPUzQ2QpM8_n6Mk8rfvdVELf05Yfc1F4g34ObunJb4iEQ5sSw@mail.gmail.com>
References: <CANPUzQ2QpM8_n6Mk8rfvdVELf05Yfc1F4g34ObunJb4iEQ5sSw@mail.gmail.com>
Message-ID: <20150414215112.GD25449@nicira.com>

On Mon, Apr 13, 2015 at 12:01:25PM +0500, david jhon wrote:
> I want to run a command from inside openvswitch code from
> ofproto/ofproto-dpif-xlate.c. with popen(), openvswitch compiles and runs
> successfully but it does not run command.
> 
> With system(), openvswitch fails to compile with following error:
> 
> blacklisted due to thread safety issues. I tried running system command
> with ovs_mutex lock and unlock routines, but it makes no difference.
> 
> Please let me know what am I doing wrong here. How could a linux command be
> run from openvswitch. Your help/guidance in this regard will be highly
> valuable and appreciated.

It's probably a bad idea to do this.  The error is because POSIX says
that system() need not be thread safe.

There may be a better way to accomplish what you're trying to do.
What are you trying to do?

From zhouje1005 at 163.com  Mon Apr 13 18:45:15 2015
From: zhouje1005 at 163.com (=?GBK?B?1ty2/g==?=)
Date: Tue, 14 Apr 2015 09:45:15 +0800 (CST)
Subject: [ovs-discuss] [ovs-dev] How to destroy a single queue at the
	qos?
In-Reply-To: <CAHbON5pD6W0fid9YHaPVi6f-bMbWfzavTAFV7UKoccVTRdV3EQ@mail.gmail.com>
References: <22d5328c.17813.14cb37d26e4.Coremail.laoz103@126.com>
 <CAHbON5pD6W0fid9YHaPVi6f-bMbWfzavTAFV7UKoccVTRdV3EQ@mail.gmail.com>
Message-ID: <157a408b.15d70.14cb59a1070.Coremail.zhouje1005@163.com>

Thank you so much, that solve our problem. 


And do you know why we need to create a qos first?  What is the relationship between qos and queue. 


Thanks again.


 





At 2015-04-14 00:08:40, "Gurucharan Shetty" <shettyg at nicira.com> wrote:
>You need to remove the reference of the queue from the qos table and
>destroy the queue in a single transaction.
>
>e.g:
>
>* Create qos and queue records:
>ovs-vsctl -- set port p0 qos=@newqos -- --id=@newqos create qos
>type=linux-htb other-config:max-rate=900000000
>queues=10=@q0,20=@q1,30=@q2 -- --id=@q0 create queue
>other-config:min-rate=720000000 other-config:max-rate=900000000 --
>--id=@q1 create queue other-config:min-rate=0
>other-config:max-rate=90000000 -- --id=@q2 create queue
>other-config:min-rate=0 other-config:max-rate=90000000
>
>* Look at the record:
>ovs-vsctl list qos
>_uuid               : e472fc24-2d9b-4e5d-8283-906b7b9504d5
>external_ids        : {}
>other_config        : {max-rate="900000000"}
>queues              : {10=efe0afff-79db-4712-a85c-5e2e0018dd04,
>20=680e8ec5-a8d2-4b1b-b6c7-0b648ebf102d,
>30=ebee7bdf-33ab-46b6-b073-83c5419274bf}
>type                : linux-htb
>
>
>* Remove queue '10'
>ovs-vsctl remove qos e472fc24-2d9b-4e5d-8283-906b7b9504d5 queues 10 --
>destroy queue efe0afff-79db-4712-a85c-5e2e0018dd04
>
>On Mon, Apr 13, 2015 at 8:54 AM, zy <laoz103 at 126.com> wrote:
>> cc discuss
>>     I am testing OVS version 2.3.1 and have the same problem. Is there anyone knows about the issue, or I have to disconnect QoS and all queues first before I destroy one specific queue.
>> And could you pls explain what's role of QoS in this scenario  (ie：why do we need to create a qos at a port first and then add queues to qos  rather than just add queues to port directly )
>>
>>
>> thanks
>>
>>
>>
>> 发件人:周二 [mailto:zhouje1005 at 163.com]
>> 发送时间: 2015年4月13日 15:21
>> 收件人: dev at openvswitch.org
>> 抄送:张勇
>> 主题: How to destroy a single queue at the qos?
>>
>>
>>
>> Hi:
>>
>>       We have a problem to destroy a single queue on the qos.
>>
>>
>>
>>       We first set a qos at a port : ovs-vsctl set port eth0 qos=@newqos -- --id=@newqos create qos external_ids:qos=eth0 type=linux-htb other-config:max-rate=1000000000
>>
>> Then add two queues to the qos:  ovs-vsctl -- add qos eth0 queue 123=@queue10M -- --id=@queue10M create queue external_ids:name=1M-for-tap1 other-config:max-rate=10000000
>>
>>                                     ovs-vsctl -- add qos eth0 queue 223=@queue10M -- --id=@queue10M create queue external_ids:name=1M-for-tap2 other-config:max-rate=10000000
>>
>>
>>
>> Now we want to destroy only queue 123, and we have to disconnect the link between qos and queues : ovs-vsctl clear qos eth0 queues. This will also disconnect the link for 223. Would any one help us to destroy queue 123 and does not influence queue 223?
>>
>>
>>
>> Thanks for your help!
>> _______________________________________________
>> dev mailing list
>> dev at openvswitch.org
>> http://openvswitch.org/mailman/listinfo/dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150414/c309337d/attachment-0001.html>

From sanghamitra.de at gmail.com  Mon Apr 13 22:02:00 2015
From: sanghamitra.de at gmail.com (Sanghamitra De)
Date: Tue, 14 Apr 2015 10:32:00 +0530
Subject: [ovs-discuss] having trouble while trying to install OVS-2.3.1 in
 Ubuntu 14.04 LTS 64 bit
Message-ID: <CAG=b5B3axnMte88VGemgOR1NhMS+8qcexMpQOWjH4n0+zGzPhw@mail.gmail.com>

Hi,
I ran the command sequence as:

sudo mkdir /work
cd /work
wget http://openvswitch.org/releases/openvswitch-2.3.1.tar.gz
tar zxf openvswitch-2.3.1.tar.gz
cd openvswitch-2.3.1
./configure --with-linux=/lib/modules/`uname -r`/build
make
make install
sudo make modules_install
sudo /sbin/modprobe openvswitch

/sbin/lsmod
cd /
sudo rm -rf /work

After that the disc image was used to load into other nodes.

and then from one of the nodes i was going to try the following sequence:

#ovsdb-tool create /usr/local/etc/openvswitch/conf.db
/users/peertest/openvswitch-2.3.1/vswitchd/vswitch.ovsschema
# ovsdb-server --remote=punix:/usr/local/var/run/openvswitch/db.sock \
--remote=db:Open_vSwitch,Open_vSwitch,manager_options \ --pidfile --detach

ovs-vsctl --no-wait init
sudo ovs-vswitchd --pidfile --detach --log-file
sudo ovs-vsctl add-br OVSbr1
sudo ovs-vsctl add-br OVSbr2
sudo ifconfig eth2 0
sudo ifconfig eth3 0
sudo ovs-vsctl add-port OVSbr1 eth2
sudo ovs-vsctl add-port OVSbr2 eth3
sudo ovs-vsctl show


but on giving the very first command in the sequence it throws an error
like the one showed in the screenshot attached.

It seems the file openvswitch-2.3.1 is not present inside /users/peertest/

how is this even possible? anywhere wrong in the sequence?



Thanks

Sanghamitra

On Fri, Apr 10, 2015 at 12:00 PM, Joe Stringer <joestringer at nicira.com>
wrote:

> On 9 April 2015 at 23:17, Sanghamitra De <sanghamitra.de at gmail.com> wrote:
> > Will simply addition of 'make' and 'make install' as per the above
> sequence
> > ensure that i do not get the error from the configuration commands as
> given
> > in red?
>
> Yes.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150414/67b2d7b0/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: er1.jpg
Type: image/jpeg
Size: 91495 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150414/67b2d7b0/attachment-0001.jpg>

From johnson.dantis at hp.com  Tue Apr 14 02:26:26 2015
From: johnson.dantis at hp.com (Dantis, Johnson)
Date: Tue, 14 Apr 2015 09:26:26 +0000
Subject: [ovs-discuss] Looking for OVS image for Windows
In-Reply-To: <CAHbON5qdySDXqCBEdP8gyBEEEd400Hg9E-FC0NO3HudAGPszrA@mail.gmail.com>
References: <3779987BBCA98E469FBB73FAC572E1687C73C8BA@G9W0755.americas.hpqcorp.net>
 <CAHbON5qdySDXqCBEdP8gyBEEEd400Hg9E-FC0NO3HudAGPszrA@mail.gmail.com>
Message-ID: <3779987BBCA98E469FBB73FAC572E1687C74C787@G9W0755.americas.hpqcorp.net>

Hi Gurucharan,

When you think the OVS 2.4 beta release will happen and the installer as well for it to be used officially. Can you let me know or point to downloader link as soon as  OVS 2.4 is released for Hyper-V with installer support.  

Thanks,
Johnson 

-----Original Message-----
From: Gurucharan Shetty [mailto:shettyg at nicira.com] 
Sent: Friday, March 13, 2015 10:15 PM
To: Dantis, Johnson
Cc: discuss at openvswitch.org
Subject: Re: [ovs-discuss] Looking for OVS image for Windows

On Thu, Mar 12, 2015 at 10:21 PM, Dantis, Johnson <johnson.dantis at hp.com> wrote:
> Hi,
>
>
>
> Is there a OVS image for windows with the latest stable update ?  I am 
> looking for a installer for deployment.  Please point me to the link 
> from where I can download it.
Unfortunately, there is no official installer. It is a little embarrassing (I plan to do something about it. Any help is appreciated).
Having said that, we currently have all the components needed to run OVS on Hyper-V (if you read the INSTALL.WIndows.md) only on OVS master. But OVS 2.4 (likely to be released in a month or so) will be a beta release of OVS for Hyper-V.

>
>
>
> Thanks,
>
> Johnson
>
>
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss
>

From pclin at cs.ccu.edu.tw  Tue Apr 14 06:24:14 2015
From: pclin at cs.ccu.edu.tw (Po-Ching Lin)
Date: Tue, 14 Apr 2015 21:24:14 +0800
Subject: [ovs-discuss] [installation problem] Installation of OVS 2.3.1 from
 the tarball on Citrix Xen Server 6.5
In-Reply-To: <552C87E3.7070104@ccu.edu.tw>
References: <552C87E3.7070104@ccu.edu.tw>
Message-ID: <552D14FE.8020209@cs.ccu.edu.tw>

Hello all,

          We recently tried to install OpenvSwitch 2.3.1 on Citrix Xen Server 6.5.
We followed the instructions in INSTALL.XenServer, and the reproduced steps
are as follows. The main problem is that the directory /lib/modules/xen/build is
missing. Please suggest the method to address this issue. Thanks a lot.

[Reproduced steps]
1. According to INSTALL.XenServer from the OVS tarball, put the tarball package to the "/usr/src/redhat/SOURCE/" folder and extract it;
2. Enter the "openvswitch-2.3.1/xenserver/" folder;
3. Add the kernel version in line 70 of the file "openvswitch.spec";
4. Build the RPM package:
  > rpmbuild -bb openvswitch.spec

[Result]
The Building process failed. The error messags is the following:
configure: error: source dir /lib/modules/xen/build doesn't exist

It appeared that the program could not found the folder (please refer to the attached log for the entire building process).

[Environment]
Server : Dell Poweredge R730 13G
Hypervisor: Citrix Xen Server 6.5
Guest VM : DDK VM for Xen server 6.5

By the way, if we start to everything from the tarball instead of using rpmbuild. After (1)./configure, (2) make, and (3) make install,
plus
(4) make modules_install,
(5) copy necessary script files which aren't copied during the installation, and
(6) create a soft link form "/lib/modules/3.10.0+2/kernel/net/openvswitch/openvswitch.ko" to "/lib/modules/3.10.0+2/extra/openvswitch.ko",
we restart the openvswitch service by "service openvswitch restart". However, when the service enables remote OVSDB manager,
importing the ovs.dirs module from ovs-xapi-sync fails because this module is missing. Therefore, the building process also fails if
we build without rpmbuild. Any advice is appreciated.

Po-Ching & Gosen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150414/e9f50910/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: RPMbuild1.log
Type: text/x-log
Size: 8722 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150414/e9f50910/attachment.bin>

From blp at nicira.com  Tue Apr 14 16:10:58 2015
From: blp at nicira.com (Ben Pfaff)
Date: Tue, 14 Apr 2015 16:10:58 -0700
Subject: [ovs-discuss] How to monitor packets being dropped? Sent back a
 packet back to the port where it came from?
In-Reply-To: <CACXMTR_YOAipR=MwY7OJGYXCkqQff2NQJjAEnzEYB9PpA3n11A@mail.gmail.com>
References: <CACXMTR_YOAipR=MwY7OJGYXCkqQff2NQJjAEnzEYB9PpA3n11A@mail.gmail.com>
Message-ID: <20150414231058.GG25449@nicira.com>

On Fri, Apr 10, 2015 at 06:15:18PM +0200, Cl??ment Rault wrote:
> I am trying to develop inband mechanisms for fast reaction to failures
> and I am experiencing a very high packet loss.
> 
> "--- 11.0.0.2 ping statistics ---
> 573 packets transmitted, 13 received, 97% packet loss, time 574650ms
> rtt min/avg/max/mdev = 1.259/2.291/5.683/1.140 ms"
> 
> which is probably due to the fact that some of my packets get in a
> infinite (or not infinite but very long) loop (even though it
> shouldn't happen) but I would like to
> understand why and where they get dropped.
> 
> And therefore I would like to know if there is a way to check if a
> switch (I am using mininet) is dropping packets?
> 
> Because I didn't put any rule to drop them and I am not decrementing
> the ttl so it cannot from that...
> 
> What is the default behaviour/scenario for a OVS switch to decide to
> drop a packet?
> 
> Could it be because sometimes I am sending the packet back to the port
> where the packet came from?

This FAQ entry might be a good start:

### Q: I added a flow to send packets out the ingress port, like this:

       ovs-ofctl add-flow br0 in_port=2,actions=2

   but OVS drops the packets instead.

A: Yes, OpenFlow requires a switch to ignore attempts to send a packet
   out its ingress port.  The rationale is that dropping these packets
   makes it harder to loop the network.  Sometimes this behavior can
   even be convenient, e.g. it is often the desired behavior in a flow
   that forwards a packet to several ports ("floods" the packet).

   Sometimes one really needs to send a packet out its ingress port
   ("hairpin"). In this case, output to OFPP_IN_PORT, which in
   ovs-ofctl syntax is expressed as just "in_port", e.g.:

       ovs-ofctl add-flow br0 in_port=2,actions=in_port

   This also works in some circumstances where the flow doesn't match
   on the input port.  For example, if you know that your switch has
   five ports numbered 2 through 6, then the following will send every
   received packet out every port, even its ingress port:

       ovs-ofctl add-flow br0 actions=2,3,4,5,6,in_port

   or, equivalently:

       ovs-ofctl add-flow br0 actions=all,in_port

   Sometimes, in complicated flow tables with multiple levels of
   "resubmit" actions, a flow needs to output to a particular port
   that may or may not be the ingress port.  It's difficult to take
   advantage of OFPP_IN_PORT in this situation.  To help, Open vSwitch
   provides, as an OpenFlow extension, the ability to modify the
   in_port field.  Whatever value is currently in the in_port field is
   the port to which outputs will be dropped, as well as the
   destination for OFPP_IN_PORT.  This means that the following will
   reliably output to port 2 or to ports 2 through 6, respectively:

       ovs-ofctl add-flow br0 in_port=2,actions=load:0->NXM_OF_IN_PORT[],2
       ovs-ofctl add-flow br0 actions=load:0->NXM_OF_IN_PORT[],2,3,4,5,6

   If the input port is important, then one may save and restore it on
   the stack:

        ovs-ofctl add-flow br0 actions=push:NXM_OF_IN_PORT[],\
                                       load:0->NXM_OF_IN_PORT[],\
                                       2,3,4,5,6,\
                                       pop:NXM_OF_IN_PORT[]

From cvinllen at gmail.com  Tue Apr 14 19:45:59 2015
From: cvinllen at gmail.com (Vinllen Chen)
Date: Wed, 15 Apr 2015 10:45:59 +0800
Subject: [ovs-discuss] Does ovs will forward lldp once receive it
Message-ID: <CAN2QyzYKec+A7YZmoyFuMVEDt_iH0Nd6MCsb-RBaqg+sDY8r7Q@mail.gmail.com>

Hi, Dear all:
    I have three question about the lldp packets:
1. Does the ovs will forward lldp once receive it
2. Does the ovs will send lldp packet to other host or controller or ovs
3. Does the ovs will receive lldp reply after sending it
Great appreciate for anyone's reply.
Best regards,
Vinllen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150415/79ba84fe/attachment.html>

From blp at nicira.com  Tue Apr 14 19:52:48 2015
From: blp at nicira.com (Ben Pfaff)
Date: Tue, 14 Apr 2015 19:52:48 -0700
Subject: [ovs-discuss] [installation problem] Installation of OVS 2.3.1
 from the tarball on Citrix Xen Server 6.5
In-Reply-To: <552D14FE.8020209@cs.ccu.edu.tw>
References: <552C87E3.7070104@ccu.edu.tw>
 <552D14FE.8020209@cs.ccu.edu.tw>
Message-ID: <20150415025248.GE12976@nicira.com>

On Tue, Apr 14, 2015 at 09:24:14PM +0800, Po-Ching Lin wrote:
>          We recently tried to install OpenvSwitch 2.3.1 on Citrix Xen Server 6.5.
> We followed the instructions in INSTALL.XenServer, and the reproduced steps
> are as follows. The main problem is that the directory /lib/modules/xen/build is
> missing. Please suggest the method to address this issue. Thanks a lot.
> 
> [Reproduced steps]
> 1. According to INSTALL.XenServer from the OVS tarball, put the tarball package to the "/usr/src/redhat/SOURCE/" folder and extract it;
> 2. Enter the "openvswitch-2.3.1/xenserver/" folder;
> 3. Add the kernel version in line 70 of the file "openvswitch.spec";

Where did step 3 come from?  It isn't mentioned in INSTALL.XenServer.

The instructions say to use xenserver/openvswitch-xen.spec.  You mention
a different file.

> 4. Build the RPM package:
>  > rpmbuild -bb openvswitch.spec


From blp at nicira.com  Tue Apr 14 20:14:14 2015
From: blp at nicira.com (Ben Pfaff)
Date: Tue, 14 Apr 2015 20:14:14 -0700
Subject: [ovs-discuss] [installation problem] Installation of OVS 2.3.1
 from the tarball on Citrix Xen Server 6.5
In-Reply-To: <552DD78A.7040003@ccu.edu.tw>
References: <552C87E3.7070104@ccu.edu.tw> <552D14FE.8020209@cs.ccu.edu.tw>
 <20150415025248.GE12976@nicira.com> <552DD78A.7040003@ccu.edu.tw>
Message-ID: <20150415031414.GG12976@nicira.com>

On Wed, Apr 15, 2015 at 11:14:18AM +0800, GosenChien-IMAP wrote:
> No.168, Sec. 1, University Rd., Min-Hsiung Township, Chia-yi County 62102, Taiwan
> TEL: (05)272-0411#23134
> E-mail:astgosen at ccu.edu.tw  <mailto:astgosen at ccu.edu.tw>
>        astgosen at novatw.info  <mailto:astgosen at novatw.info>
> 
> Ben Pfaff 於 西元2015年04月15日 10:52 寫道:
> >On Tue, Apr 14, 2015 at 09:24:14PM +0800, Po-Ching Lin wrote:
> >>          We recently tried to install OpenvSwitch 2.3.1 on Citrix Xen Server 6.5.
> >>We followed the instructions in INSTALL.XenServer, and the reproduced steps
> >>are as follows. The main problem is that the directory /lib/modules/xen/build is
> >>missing. Please suggest the method to address this issue. Thanks a lot.
> >>
> >>[Reproduced steps]
> >>1. According to INSTALL.XenServer from the OVS tarball, put the tarball package to the "/usr/src/redhat/SOURCE/" folder and extract it;
> >>2. Enter the "openvswitch-2.3.1/xenserver/" folder;
> >>3. Add the kernel version in line 70 of the file "openvswitch.spec";
> >Where did step 3 come from?  It isn't mentioned in INSTALL.XenServer.
> Yes , it didn't mention in the INSTALL.XenServer.
> However, we found during the building process, the program would tell us
> that it could not found the kernel version so that we modified the file.
> >Requires: kernel-%{kernel_name} = *3.10.41-323.380416**<-- we change this

Did you continue reading in the instructions?  The "Build Parameters"
section has a few details, including some specific to XenServer 6.5 and
above.

From blp at nicira.com  Tue Apr 14 20:15:59 2015
From: blp at nicira.com (Ben Pfaff)
Date: Tue, 14 Apr 2015 20:15:59 -0700
Subject: [ovs-discuss] Does ovs will forward lldp once receive it
In-Reply-To: <CAN2QyzYKec+A7YZmoyFuMVEDt_iH0Nd6MCsb-RBaqg+sDY8r7Q@mail.gmail.com>
References: <CAN2QyzYKec+A7YZmoyFuMVEDt_iH0Nd6MCsb-RBaqg+sDY8r7Q@mail.gmail.com>
Message-ID: <20150415031559.GH12976@nicira.com>

On Wed, Apr 15, 2015 at 10:45:59AM +0800, Vinllen Chen wrote:
>     I have three question about the lldp packets:
> 1. Does the ovs will forward lldp once receive it
> 2. Does the ovs will send lldp packet to other host or controller or ovs
> 3. Does the ovs will receive lldp reply after sending it

It depends on how you configure OVS.  ovs-vswitchd.conf.db(5) says:

       other_config : forward-bpdu: optional string, either true or false
              Controls forwarding of BPDUs and other  network  control  frames
              when  NORMAL  action  is  invoked.  When this option is false or
              unset, frames with reserved Ethernet addresses (see table below)
              will  not  be  forwarded.  When this option is true, such frames
              will not be treated specially.

              The above general rule has the following exceptions:

              ·      If STP is enabled on the bridge (see the stp_enable  col‐
                     umn  in  the  Bridge  table),  the  bridge  processes all
                     received STP packets and never passes them to OpenFlow or
                     forwards  them.   This is true even if STP is disabled on
                     an individual port.

              ·      If LLDP is enabled on an interface (see the  lldp  column
                     in the Interface table), the interface processes received
                     LLDP packets and never passes them to  OpenFlow  or  for‐
                     wards them.

              Set this option to true if the Open vSwitch bridge connects dif‐
              ferent Ethernet networks and is not configured to participate in
              STP.

              This  option  affects packets with the following destination MAC
              addresses:

              01:80:c2:00:00:00
                     IEEE 802.1D Spanning Tree Protocol (STP).

              01:80:c2:00:00:01
                     IEEE Pause frame.

              01:80:c2:00:00:0x
                     Other reserved protocols.

              00:e0:2b:00:00:00
                     Extreme Discovery Protocol (EDP).

              00:e0:2b:00:00:04 and 00:e0:2b:00:00:06
                     Ethernet Automatic Protection Switching (EAPS).

              01:00:0c:cc:cc:cc
                     Cisco Discovery Protocol (CDP),  VLAN  Trunking  Protocol
                     (VTP),  Dynamic Trunking Protocol (DTP), Port Aggregation
                     Protocol (PAgP), and others.

              01:00:0c:cc:cc:cd
                     Cisco Shared Spanning Tree Protocol PVSTP+.

              01:00:0c:cd:cd:cd
                     Cisco STP Uplink Fast.

              01:00:0c:00:00:00
                     Cisco Inter Switch Link.

              01:00:0c:cc:cc:cx
                     Cisco CFM.

From djhon9813 at gmail.com  Tue Apr 14 22:11:39 2015
From: djhon9813 at gmail.com (david jhon)
Date: Wed, 15 Apr 2015 10:11:39 +0500
Subject: [ovs-discuss] Using popen() or system() calls from inside
 openvswitch source code
In-Reply-To: <20150414215112.GD25449@nicira.com>
References: <CANPUzQ2QpM8_n6Mk8rfvdVELf05Yfc1F4g34ObunJb4iEQ5sSw@mail.gmail.com>
 <20150414215112.GD25449@nicira.com>
Message-ID: <CANPUzQ2jonh=+5FbJWyKDfvqStsFjq=LM8EOCa5G+3yD0CLUUA@mail.gmail.com>

Thanks a lot for your reply.

I am trying to add some records in ovsdb table based on upcall handling in
userspace. After digging little more, I came to know that it uses POSIX
message queues for Inter Process Communication and I should better go this
way. Thank you!

On Wed, Apr 15, 2015 at 2:51 AM, Ben Pfaff <blp at nicira.com> wrote:

> On Mon, Apr 13, 2015 at 12:01:25PM +0500, david jhon wrote:
> > I want to run a command from inside openvswitch code from
> > ofproto/ofproto-dpif-xlate.c. with popen(), openvswitch compiles and runs
> > successfully but it does not run command.
> >
> > With system(), openvswitch fails to compile with following error:
> >
> > blacklisted due to thread safety issues. I tried running system command
> > with ovs_mutex lock and unlock routines, but it makes no difference.
> >
> > Please let me know what am I doing wrong here. How could a linux command
> be
> > run from openvswitch. Your help/guidance in this regard will be highly
> > valuable and appreciated.
>
> It's probably a bad idea to do this.  The error is because POSIX says
> that system() need not be thread safe.
>
> There may be a better way to accomplish what you're trying to do.
> What are you trying to do?
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150415/c3ac2d46/attachment-0001.html>

From amal.kammoun at supcom.tn  Wed Apr 15 00:35:36 2015
From: amal.kammoun at supcom.tn (Amal KAMMOUN)
Date: Wed, 15 Apr 2015 07:35:36 +0000
Subject: [ovs-discuss] Flowvisor stops when OVS is connected to it
Message-ID: <1429083333426.38896@supcom.tn>

Hello,


I have 2 virtual machines (ubuntu using virtualbox).

In the firt I installed OpenvSwitch and in the second I installed FlowVisor (I followed this link:  https://github.com/OPENNETWORKINGLAB/flowvisor/wiki/Installation-from-Binary ) .


I run Flowvisor using this command: $ sudo -u flowvisor flowvisor?. But when I connect the switch to the FlowVisor (using set-controller), I get in FlowVisor: startup failed : null.


How can I fix this problem?


Thank you so much?.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150415/c097625d/attachment.html>

From blp at nicira.com  Wed Apr 15 08:15:54 2015
From: blp at nicira.com (Ben Pfaff)
Date: Wed, 15 Apr 2015 08:15:54 -0700
Subject: [ovs-discuss] [installation problem] Installation of OVS 2.3.1
 from the tarball on Citrix Xen Server 6.5
In-Reply-To: <552E0262.4010801@ccu.edu.tw>
References: <552C87E3.7070104@ccu.edu.tw> <552D14FE.8020209@cs.ccu.edu.tw>
 <20150415025248.GE12976@nicira.com> <552DD78A.7040003@ccu.edu.tw>
 <20150415031414.GG12976@nicira.com> <552E0262.4010801@ccu.edu.tw>
Message-ID: <20150415151554.GC7003@nicira.com>

Our internal build scripts just pass openvswitch_version, kernel_name,
kernel_version, and xen_version on the rpmbuild command line, for
XenServer 6.5 and other 64-bit versions of XenServer.

On Wed, Apr 15, 2015 at 02:17:06PM +0800, GosenChien-IMAP wrote:
> Dear Ben :
> >>Did you continue reading in the instructions? The "Build Parameters"
> section has a few details, including some specific to XenServer 6.5 and
> above.
> 
> Yes, I've follow the instruction to add the parameter "rpmbuild -D
> "kernel_version $KERNEL_VERSION"" -bb xenserver/openvswitch-xen.spec
> 
> If you've ever use the parameter to build the package successfully, could
> you share the parameters you use under the Xen DDK VM?
> 
> Many thanks.
> 
> Best Regards,
>             Gosen Chien
> *************************************
> CCU CS Project assistant
> No.168, Sec. 1, University Rd., Min-Hsiung Township, Chia-yi County 62102, Taiwan
> TEL: (05)272-0411#23134
> E-mail:astgosen at ccu.edu.tw  <mailto:astgosen at ccu.edu.tw>
>        astgosen at novatw.info  <mailto:astgosen at novatw.info>
> 
> Ben Pfaff 於 西元2015年04月15日 11:14 寫道:
> >On Wed, Apr 15, 2015 at 11:14:18AM +0800, GosenChien-IMAP wrote:
> >>No.168, Sec. 1, University Rd., Min-Hsiung Township, Chia-yi County 62102, Taiwan
> >>TEL: (05)272-0411#23134
> >>E-mail:astgosen at ccu.edu.tw  <mailto:astgosen at ccu.edu.tw>
> >>        astgosen at novatw.info  <mailto:astgosen at novatw.info>
> >>
> >>Ben Pfaff 於 西元2015年04月15日 10:52 寫道:
> >>>On Tue, Apr 14, 2015 at 09:24:14PM +0800, Po-Ching Lin wrote:
> >>>>          We recently tried to install OpenvSwitch 2.3.1 on Citrix Xen Server 6.5.
> >>>>We followed the instructions in INSTALL.XenServer, and the reproduced steps
> >>>>are as follows. The main problem is that the directory /lib/modules/xen/build is
> >>>>missing. Please suggest the method to address this issue. Thanks a lot.
> >>>>
> >>>>[Reproduced steps]
> >>>>1. According to INSTALL.XenServer from the OVS tarball, put the tarball package to the "/usr/src/redhat/SOURCE/" folder and extract it;
> >>>>2. Enter the "openvswitch-2.3.1/xenserver/" folder;
> >>>>3. Add the kernel version in line 70 of the file "openvswitch.spec";
> >>>Where did step 3 come from?  It isn't mentioned in INSTALL.XenServer.
> >>Yes , it didn't mention in the INSTALL.XenServer.
> >>However, we found during the building process, the program would tell us
> >>that it could not found the kernel version so that we modified the file.
> >>>Requires: kernel-%{kernel_name} = *3.10.41-323.380416**<-- we change this
> 

From devbabopol at gmail.com  Wed Apr 15 09:05:09 2015
From: devbabopol at gmail.com (YoungTae Noh)
Date: Wed, 15 Apr 2015 12:05:09 -0400
Subject: [ovs-discuss] Regarding where function pointers in
 netdev_class/tc_ops hook to their implementations?
Message-ID: <CAJuiNqpUH2tqVzkMCX+VDirdkZb8qad4gdmSHXMmmk0LRk+67w@mail.gmail.com>

Hello,

I would like to implement/manipulate queueing priority (possibly
multiple queues per port in a shared memory) by user-definition.

To this end, I browsed 2.3.1 OVS codebase from adding a port (from
ovsdb or ova-vsctl cmd) as a queue is also allocated by default.

At the end of user-sapce, adding a port is done by
netdev_open(iface_cfg->name, iface_get_type(iface_cfg, br->cfg),
&netdev);

In this function:
Interface allocation: netdev->netdev_class->alloc();
Queue alloction:
/* By default enable one rx queue per netdev. */
                if (netdev->netdev_class->rxq_alloc) {
                    netdev->n_rxq = 1;
                } else {
                    netdev->n_rxq = 0;
                }
                list_init(&netdev->saved_flags_list);
                error = rc->class->construct(netdev);
Construction of Interfade: netdev->netdev_class->construct(netdev);

Here is my question below:

Question) how the function pointer (of
netdev->netdev_class->rxq_alloc) is hooked to actual linux
implementation? I believe all the function pointers in the struct
netdev_class need to be defined later for a specific hardware. I
cannot find the location where hooking is really happening.

I believe this is the same question (correct me if netdev_class and
tc_ops follow different hooking mechanisms). I would like to
understand the hooking mechanism for function pointers in struct
tc_ops (such as class_set for queueID, qdisc_set for QoS type).

Thanks,
YoungTae

From blp at nicira.com  Wed Apr 15 09:04:37 2015
From: blp at nicira.com (Ben Pfaff)
Date: Wed, 15 Apr 2015 09:04:37 -0700
Subject: [ovs-discuss] Regarding where function pointers in
 netdev_class/tc_ops hook to their implementations?
In-Reply-To: <CAJuiNqpUH2tqVzkMCX+VDirdkZb8qad4gdmSHXMmmk0LRk+67w@mail.gmail.com>
References: <CAJuiNqpUH2tqVzkMCX+VDirdkZb8qad4gdmSHXMmmk0LRk+67w@mail.gmail.com>
Message-ID: <20150415160437.GE7003@nicira.com>

On Wed, Apr 15, 2015 at 12:05:09PM -0400, YoungTae Noh wrote:
> Hello,
> 
> I would like to implement/manipulate queueing priority (possibly
> multiple queues per port in a shared memory) by user-definition.
> 
> To this end, I browsed 2.3.1 OVS codebase from adding a port (from
> ovsdb or ova-vsctl cmd) as a queue is also allocated by default.
> 
> At the end of user-sapce, adding a port is done by
> netdev_open(iface_cfg->name, iface_get_type(iface_cfg, br->cfg),
> &netdev);
> 
> In this function:
> Interface allocation: netdev->netdev_class->alloc();
> Queue alloction:
> /* By default enable one rx queue per netdev. */
>                 if (netdev->netdev_class->rxq_alloc) {
>                     netdev->n_rxq = 1;
>                 } else {
>                     netdev->n_rxq = 0;
>                 }
>                 list_init(&netdev->saved_flags_list);
>                 error = rc->class->construct(netdev);
> Construction of Interfade: netdev->netdev_class->construct(netdev);
> 
> Here is my question below:
> 
> Question) how the function pointer (of
> netdev->netdev_class->rxq_alloc) is hooked to actual linux
> implementation? I believe all the function pointers in the struct
> netdev_class need to be defined later for a specific hardware. I
> cannot find the location where hooking is really happening.
> 
> I believe this is the same question (correct me if netdev_class and
> tc_ops follow different hooking mechanisms). I would like to
> understand the hooking mechanism for function pointers in struct
> tc_ops (such as class_set for queueID, qdisc_set for QoS type).

I think that you're looking for the static definitions of
netdev_linux_class, etc., and of tc_ops_htb, etc., in
lib/netdev-linux.c.  They are easy to find; I'm not sure why you don't
see them.

From astgosen at ccu.edu.tw  Tue Apr 14 20:14:18 2015
From: astgosen at ccu.edu.tw (GosenChien-IMAP)
Date: Wed, 15 Apr 2015 11:14:18 +0800
Subject: [ovs-discuss] [installation problem] Installation of OVS 2.3.1
 from the tarball on Citrix Xen Server 6.5
In-Reply-To: <20150415025248.GE12976@nicira.com>
References: <552C87E3.7070104@ccu.edu.tw> <552D14FE.8020209@cs.ccu.edu.tw>
 <20150415025248.GE12976@nicira.com>
Message-ID: <552DD78A.7040003@ccu.edu.tw>

Dear Ben :
Please refer to the enclosed replies in red:

Best Regards,
             Gosen Chien
*************************************
CCU CS Project assistant
No.168, Sec. 1, University Rd., Min-Hsiung Township, Chia-yi County 62102, Taiwan
TEL: (05)272-0411#23134
E-mail:astgosen at ccu.edu.tw  <mailto:astgosen at ccu.edu.tw>
        astgosen at novatw.info  <mailto:astgosen at novatw.info>

Ben Pfaff 於 西元2015年04月15日 10:52 寫道:
> On Tue, Apr 14, 2015 at 09:24:14PM +0800, Po-Ching Lin wrote:
>>           We recently tried to install OpenvSwitch 2.3.1 on Citrix Xen Server 6.5.
>> We followed the instructions in INSTALL.XenServer, and the reproduced steps
>> are as follows. The main problem is that the directory /lib/modules/xen/build is
>> missing. Please suggest the method to address this issue. Thanks a lot.
>>
>> [Reproduced steps]
>> 1. According to INSTALL.XenServer from the OVS tarball, put the tarball package to the "/usr/src/redhat/SOURCE/" folder and extract it;
>> 2. Enter the "openvswitch-2.3.1/xenserver/" folder;
>> 3. Add the kernel version in line 70 of the file "openvswitch.spec";
> Where did step 3 come from?  It isn't mentioned in INSTALL.XenServer.
Yes , it didn't mention in the INSTALL.XenServer.
However, we found during the building process, the program would tell us 
that it could not found the kernel version so that we modified the file.
 >Requires: kernel-%{kernel_name} = *3.10.41-323.380416**<-- we change this
*
>
> The instructions say to use xenserver/openvswitch-xen.spec.  You mention
> a different file.
We actually use the same file but are forced to modified the file to 
meet the requirement.
>> 4. Build the RPM package:
>>   > rpmbuild -bb openvswitch.spec
>
Is there any better way to avoid modifying the 
xenserver/openvswitch-xen.spec ?
Any suggestion is welcome. Many thanks.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150415/c1652174/attachment-0001.html>

From astgosen at ccu.edu.tw  Tue Apr 14 23:17:06 2015
From: astgosen at ccu.edu.tw (GosenChien-IMAP)
Date: Wed, 15 Apr 2015 14:17:06 +0800
Subject: [ovs-discuss] [installation problem] Installation of OVS 2.3.1
 from the tarball on Citrix Xen Server 6.5
In-Reply-To: <20150415031414.GG12976@nicira.com>
References: <552C87E3.7070104@ccu.edu.tw> <552D14FE.8020209@cs.ccu.edu.tw>
 <20150415025248.GE12976@nicira.com> <552DD78A.7040003@ccu.edu.tw>
 <20150415031414.GG12976@nicira.com>
Message-ID: <552E0262.4010801@ccu.edu.tw>

Dear Ben :
 >>Did you continue reading in the instructions? The "Build Parameters" 
section has a few details, including some specific to XenServer 6.5 and 
above.

Yes, I've follow the instruction to add the parameter "rpmbuild -D 
"kernel_version $KERNEL_VERSION"" -bb xenserver/openvswitch-xen.spec

If you've ever use the parameter to build the package successfully, 
could you share the parameters you use under the Xen DDK VM?

Many thanks.

Best Regards,
             Gosen Chien
*************************************
CCU CS Project assistant
No.168, Sec. 1, University Rd., Min-Hsiung Township, Chia-yi County 62102, Taiwan
TEL: (05)272-0411#23134
E-mail:astgosen at ccu.edu.tw  <mailto:astgosen at ccu.edu.tw>
        astgosen at novatw.info  <mailto:astgosen at novatw.info>

Ben Pfaff 於 西元2015年04月15日 11:14 寫道:
> On Wed, Apr 15, 2015 at 11:14:18AM +0800, GosenChien-IMAP wrote:
>> No.168, Sec. 1, University Rd., Min-Hsiung Township, Chia-yi County 62102, Taiwan
>> TEL: (05)272-0411#23134
>> E-mail:astgosen at ccu.edu.tw  <mailto:astgosen at ccu.edu.tw>
>>         astgosen at novatw.info  <mailto:astgosen at novatw.info>
>>
>> Ben Pfaff 於 西元2015年04月15日 10:52 寫道:
>>> On Tue, Apr 14, 2015 at 09:24:14PM +0800, Po-Ching Lin wrote:
>>>>           We recently tried to install OpenvSwitch 2.3.1 on Citrix Xen Server 6.5.
>>>> We followed the instructions in INSTALL.XenServer, and the reproduced steps
>>>> are as follows. The main problem is that the directory /lib/modules/xen/build is
>>>> missing. Please suggest the method to address this issue. Thanks a lot.
>>>>
>>>> [Reproduced steps]
>>>> 1. According to INSTALL.XenServer from the OVS tarball, put the tarball package to the "/usr/src/redhat/SOURCE/" folder and extract it;
>>>> 2. Enter the "openvswitch-2.3.1/xenserver/" folder;
>>>> 3. Add the kernel version in line 70 of the file "openvswitch.spec";
>>> Where did step 3 come from?  It isn't mentioned in INSTALL.XenServer.
>> Yes , it didn't mention in the INSTALL.XenServer.
>> However, we found during the building process, the program would tell us
>> that it could not found the kernel version so that we modified the file.
>>> Requires: kernel-%{kernel_name} = *3.10.41-323.380416**<-- we change this

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150415/f350fb8b/attachment.html>

From sanghamitra.de at gmail.com  Wed Apr 15 01:49:32 2015
From: sanghamitra.de at gmail.com (Sanghamitra De)
Date: Wed, 15 Apr 2015 14:19:32 +0530
Subject: [ovs-discuss] having trouble while trying to install OVS-2.3.1
 in Ubuntu 14.04 LTS 64 bit
In-Reply-To: <CANr6G5yX2EbHmws94Bu74zCQwdrwWHDc5JfYXb8JCj6h=uwaCg@mail.gmail.com>
References: <CAG=b5B3axnMte88VGemgOR1NhMS+8qcexMpQOWjH4n0+zGzPhw@mail.gmail.com>
 <CANr6G5yX2EbHmws94Bu74zCQwdrwWHDc5JfYXb8JCj6h=uwaCg@mail.gmail.com>
Message-ID: <CAG=b5B0_T1_X0iZN7QtiNiH2u0DXMm2rj7hbd13eprYOK9ijJA@mail.gmail.com>

When i did sudo rm -rf /work i guess i removed the source package along
with /work

I tried the following from:
https://github.com/openvswitch/ovs/blob/master/INSTALL.md#startup

% mkdir -p /usr/local/etc/openvswitch
% ovsdb-tool create /usr/local/etc/openvswitch/conf.db
vswitchd/vswitch.ovsschema

and it gives an error saying=>
ovsdb-tool: failed to read schema: "vswitchd/vswitch.ovsschema" could not be
read as JSON (error opening "vswitchd/vswitch.ovsschema" : No such file or
directory)

I recalled that  the "vswitchd/vswitch.ovsschema" file is found in the OVS
source tree.  So, either i need to issue the "ovsdb-tool" command from the
root directory of my  OVS source tree, or name the file via an absolute
filename.

So i tried it with:

#ovsdb-tool create /usr/local/etc/openvswitch/conf.db
/users/peertest/openvswitch-2.3.1/vswitchd/vswitch.ovsschema

but that too didin't work... Isn't the source tree or the absolute pathname
supposed to be :
/users/peertest/openvswitch-2.3.1/vswitchd/vswitch.ovsschema

what to do now since the /work/openvswitch-2.3.1.has been removed by sudo
rm -rf /work


Do i do it again , this time keeping intact the /work folder so that the
source tree of the package stays?

Will that work it out?



On Tue, Apr 14, 2015 at 11:48 PM, Joe Stringer <joestringer at nicira.com>
wrote:

> I don't know where you're getting /users/peertest/openvswitch-2.3.1
> from, your own instructions show that you're extracting OVS to
> /work/openvswitch-2.3.1.
>
> On 13 April 2015 at 22:02, Sanghamitra De <sanghamitra.de at gmail.com>
> wrote:
> >
> >
> > Hi,
> > I ran the command sequence as:
> >
> > sudo mkdir /work
> > cd /work
> > wget http://openvswitch.org/releases/openvswitch-2.3.1.tar.gz
> > tar zxf openvswitch-2.3.1.tar.gz
> > cd openvswitch-2.3.1
> > ./configure --with-linux=/lib/modules/`uname -r`/build
> > make
> > make install
> > sudo make modules_install
> > sudo /sbin/modprobe openvswitch
> >
> > /sbin/lsmod
> > cd /
> > sudo rm -rf /work
> >
> > After that the disc image was used to load into other nodes.
> >
> > and then from one of the nodes i was going to try the following sequence:
> >
> > #ovsdb-tool create /usr/local/etc/openvswitch/conf.db
> > /users/peertest/openvswitch-2.3.1/vswitchd/vswitch.ovsschema
> > # ovsdb-server --remote=punix:/usr/local/var/run/openvswitch/db.sock \
> > --remote=db:Open_vSwitch,Open_vSwitch,manager_options \ --pidfile
> --detach
> >
> > ovs-vsctl --no-wait init
> > sudo ovs-vswitchd --pidfile --detach --log-file
> > sudo ovs-vsctl add-br OVSbr1
> > sudo ovs-vsctl add-br OVSbr2
> > sudo ifconfig eth2 0
> > sudo ifconfig eth3 0
> > sudo ovs-vsctl add-port OVSbr1 eth2
> > sudo ovs-vsctl add-port OVSbr2 eth3
> > sudo ovs-vsctl show
> >
> >
> > but on giving the very first command in the sequence it throws an error
> like
> > the one showed in the screenshot attached.
> >
> > It seems the file openvswitch-2.3.1 is not present inside
> /users/peertest/
> >
> > how is this even possible? anywhere wrong in the sequence?
> >
> >
> >
> > Thanks
> >
> > Sanghamitra
> >
> > On Fri, Apr 10, 2015 at 12:00 PM, Joe Stringer <joestringer at nicira.com>
> > wrote:
> >>
> >> On 9 April 2015 at 23:17, Sanghamitra De <sanghamitra.de at gmail.com>
> wrote:
> >> > Will simply addition of 'make' and 'make install' as per the above
> >> > sequence
> >> > ensure that i do not get the error from the configuration commands as
> >> > given
> >> > in red?
> >>
> >> Yes.
> >
> >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150415/4109e509/attachment.html>

From blp at nicira.com  Wed Apr 15 09:19:58 2015
From: blp at nicira.com (Ben Pfaff)
Date: Wed, 15 Apr 2015 09:19:58 -0700
Subject: [ovs-discuss] Flowvisor stops when OVS is connected to it
In-Reply-To: <1429083333426.38896@supcom.tn>
References: <1429083333426.38896@supcom.tn>
Message-ID: <20150415161958.GG7003@nicira.com>

On Wed, Apr 15, 2015 at 07:35:36AM +0000, Amal KAMMOUN wrote:
> I have 2 virtual machines (ubuntu using virtualbox).
> 
> In the firt I installed OpenvSwitch and in the second I installed FlowVisor (I followed this link:  https://github.com/OPENNETWORKINGLAB/flowvisor/wiki/Installation-from-Binary ) .
> 
> 
> I run Flowvisor using this command: $ sudo -u flowvisor flowvisor?. But when I connect the switch to the FlowVisor (using set-controller), I get in FlowVisor: startup failed : null.
> 
> 
> How can I fix this problem?

This sounds much more like a FlowVisor question than an OVS question, so
I'd recommend asking about it on a FlowVisor mailing list, where you're
more likely to find knowledgeable people.

From blp at nicira.com  Wed Apr 15 11:23:32 2015
From: blp at nicira.com (Ben Pfaff)
Date: Wed, 15 Apr 2015 11:23:32 -0700
Subject: [ovs-discuss] Using popen() or system() calls from inside
 openvswitch source code
In-Reply-To: <CANPUzQ2jonh=+5FbJWyKDfvqStsFjq=LM8EOCa5G+3yD0CLUUA@mail.gmail.com>
References: <CANPUzQ2QpM8_n6Mk8rfvdVELf05Yfc1F4g34ObunJb4iEQ5sSw@mail.gmail.com>
 <20150414215112.GD25449@nicira.com>
 <CANPUzQ2jonh=+5FbJWyKDfvqStsFjq=LM8EOCa5G+3yD0CLUUA@mail.gmail.com>
Message-ID: <20150415182332.GC25514@nicira.com>

It's probably best to just use the existing code in ovs-vswitchd to
access the database.

On Wed, Apr 15, 2015 at 10:11:39AM +0500, david jhon wrote:
> Thanks a lot for your reply.
> 
> I am trying to add some records in ovsdb table based on upcall handling in
> userspace. After digging little more, I came to know that it uses POSIX
> message queues for Inter Process Communication and I should better go this
> way. Thank you!
> 
> On Wed, Apr 15, 2015 at 2:51 AM, Ben Pfaff <blp at nicira.com> wrote:
> 
> > On Mon, Apr 13, 2015 at 12:01:25PM +0500, david jhon wrote:
> > > I want to run a command from inside openvswitch code from
> > > ofproto/ofproto-dpif-xlate.c. with popen(), openvswitch compiles and runs
> > > successfully but it does not run command.
> > >
> > > With system(), openvswitch fails to compile with following error:
> > >
> > > blacklisted due to thread safety issues. I tried running system command
> > > with ovs_mutex lock and unlock routines, but it makes no difference.
> > >
> > > Please let me know what am I doing wrong here. How could a linux command
> > be
> > > run from openvswitch. Your help/guidance in this regard will be highly
> > > valuable and appreciated.
> >
> > It's probably a bad idea to do this.  The error is because POSIX says
> > that system() need not be thread safe.
> >
> > There may be a better way to accomplish what you're trying to do.
> > What are you trying to do?
> >

From devbabopol at gmail.com  Wed Apr 15 18:26:29 2015
From: devbabopol at gmail.com (YoungTae Noh)
Date: Wed, 15 Apr 2015 21:26:29 -0400
Subject: [ovs-discuss] Regarding where function pointers in
 netdev_class/tc_ops hook to their implementations?
In-Reply-To: <20150415160437.GE7003@nicira.com>
References: <CAJuiNqpUH2tqVzkMCX+VDirdkZb8qad4gdmSHXMmmk0LRk+67w@mail.gmail.com>
 <20150415160437.GE7003@nicira.com>
Message-ID: <CAJuiNqqnGdfr-szSz_crtAi0A3F-xD6TBXRpx_4296cP7-5ofg@mail.gmail.com>

Hi Ben and all,

Thank you for the quick turnaround. I believe my previous explanation
was not very clear.

Here is my objective:
>> I would like to implement/manipulate queueing priority (possibly multiple queues per port in a shared memory) by user-definition.

Please correct me if my understanding/approach is wrong.
To realize this - control this type of queue from OVS cmd (or controller),
1. I need add expression for this type of queue in ovs-vsctl cmd (or
ovsdb client)
2. add an option field (for this type of queue) in ovsdb
3. ovs-vswitdhd dispatches it to  ofproto->netdev(lib)->netdev-linux
4. extending netdev-linux to allocate&construct this queue in linux
kernel implementation ==> I believe I am standing here with the
question! (also not sure hooking is correct term here)
5. extend queue & its management implementation (socket buffer in linux kernel)

Here is a very specific example:
struct netdev_rxq *(*rxq_alloc)(void);

This will allocate a queue for an interface (netdev) in user-sapce. I
believe this rxq_alloc will actually allocate a queue (FIFO) to a
physical/virtual port in linux kernel (socket buffer). I would like to
know which function is actually executed in kernel space and how they
are interacting each other.

Thanks in advance.
YoungTae




On Wed, Apr 15, 2015 at 12:04 PM, Ben Pfaff <blp at nicira.com> wrote:
> On Wed, Apr 15, 2015 at 12:05:09PM -0400, YoungTae Noh wrote:
>> Hello,
>>
>> I would like to implement/manipulate queueing priority (possibly
>> multiple queues per port in a shared memory) by user-definition.
>>
>> To this end, I browsed 2.3.1 OVS codebase from adding a port (from
>> ovsdb or ova-vsctl cmd) as a queue is also allocated by default.
>>
>> At the end of user-sapce, adding a port is done by
>> netdev_open(iface_cfg->name, iface_get_type(iface_cfg, br->cfg),
>> &netdev);
>>
>> In this function:
>> Interface allocation: netdev->netdev_class->alloc();
>> Queue alloction:
>> /* By default enable one rx queue per netdev. */
>>                 if (netdev->netdev_class->rxq_alloc) {
>>                     netdev->n_rxq = 1;
>>                 } else {
>>                     netdev->n_rxq = 0;
>>                 }
>>                 list_init(&netdev->saved_flags_list);
>>                 error = rc->class->construct(netdev);
>> Construction of Interfade: netdev->netdev_class->construct(netdev);
>>
>> Here is my question below:
>>
>> Question) how the function pointer (of
>> netdev->netdev_class->rxq_alloc) is hooked to actual linux
>> implementation? I believe all the function pointers in the struct
>> netdev_class need to be defined later for a specific hardware. I
>> cannot find the location where hooking is really happening.
>>
>> I believe this is the same question (correct me if netdev_class and
>> tc_ops follow different hooking mechanisms). I would like to
>> understand the hooking mechanism for function pointers in struct
>> tc_ops (such as class_set for queueID, qdisc_set for QoS type).
>
> I think that you're looking for the static definitions of
> netdev_linux_class, etc., and of tc_ops_htb, etc., in
> lib/netdev-linux.c.  They are easy to find; I'm not sure why you don't
> see them.

From amal.kammoun at supcom.tn  Thu Apr 16 06:30:52 2015
From: amal.kammoun at supcom.tn (Amal KAMMOUN)
Date: Thu, 16 Apr 2015 13:30:52 +0000
Subject: [ovs-discuss] Flowvisor stops when OVS is connected to it
In-Reply-To: <20150415161958.GG7003@nicira.com>
References: <1429083333426.38896@supcom.tn>, <20150415161958.GG7003@nicira.com>
Message-ID: <1429191050507.27770@supcom.tn>

Hello,

When I tried flowvisor with mininet it works fine, but when I connect another switch to the same flowvisor it stops.

I think that the problem could be with ports in openvswitch, but I can't find how to solve the problem.

Thank you.

________________________________________
From: Ben Pfaff <blp at nicira.com>
Sent: Wednesday, April 15, 2015 4:19 PM
To: Amal KAMMOUN
Cc: discuss at openvswitch.org
Subject: Re: [ovs-discuss] Flowvisor stops when OVS is connected to it

On Wed, Apr 15, 2015 at 07:35:36AM +0000, Amal KAMMOUN wrote:
> I have 2 virtual machines (ubuntu using virtualbox).
>
> In the firt I installed OpenvSwitch and in the second I installed FlowVisor (I followed this link:  https://github.com/OPENNETWORKINGLAB/flowvisor/wiki/Installation-from-Binary ) .
>
>
> I run Flowvisor using this command: $ sudo -u flowvisor flowvisor?. But when I connect the switch to the FlowVisor (using set-controller), I get in FlowVisor: startup failed : null.
>
>
> How can I fix this problem?

This sounds much more like a FlowVisor question than an OVS question, so
I'd recommend asking about it on a FlowVisor mailing list, where you're
more likely to find knowledgeable people.

From raorn at raorn.name  Thu Apr 16 07:34:24 2015
From: raorn at raorn.name (Alexey I. Froloff)
Date: Thu, 16 Apr 2015 17:34:24 +0300
Subject: [ovs-discuss] Current status of in-kernel openvswitch module (as of
	3.18)
Message-ID: <20150416143424.GA30354@raorn.name>

Is it safe to use in-kernel openvswitch module?  I was always
sceptical about it, because OVS's datapath module always was more
up to date.  On the other hand, latest OVS (2.3.1) doesn't work
with 3.18 kernel, which we are trying to use.

So, how stable is combination of OVS 2.3.1, kernel 3.18 and
in-kernel openvswitch module?  As I can see from the code, it
even supports GRE/VxLAN tunnels, which is good.  Our primary use
for Open vSwitch is OpenStack, if that matters.

-- 
Regards,    --
Sir Raorn.   --- https://plus.google.com/+AlexeyFroloff
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 473 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150416/13da8673/attachment.sig>

From blp at nicira.com  Thu Apr 16 08:06:19 2015
From: blp at nicira.com (Ben Pfaff)
Date: Thu, 16 Apr 2015 08:06:19 -0700
Subject: [ovs-discuss] Current status of in-kernel openvswitch module
 (as of 3.18)
In-Reply-To: <20150416143424.GA30354@raorn.name>
References: <20150416143424.GA30354@raorn.name>
Message-ID: <20150416150619.GA6941@nicira.com>

On Thu, Apr 16, 2015 at 05:34:24PM +0300, Alexey I. Froloff wrote:
> Is it safe to use in-kernel openvswitch module?  I was always
> sceptical about it, because OVS's datapath module always was more
> up to date.  On the other hand, latest OVS (2.3.1) doesn't work
> with 3.18 kernel, which we are trying to use.

It should work.  Please report a bug.

> So, how stable is combination of OVS 2.3.1, kernel 3.18 and
> in-kernel openvswitch module?  As I can see from the code, it
> even supports GRE/VxLAN tunnels, which is good.  Our primary use
> for Open vSwitch is OpenStack, if that matters.

It should be stable, but you say it doesn't work, so probably we have to
fix some bug.

From blp at nicira.com  Thu Apr 16 08:09:18 2015
From: blp at nicira.com (Ben Pfaff)
Date: Thu, 16 Apr 2015 08:09:18 -0700
Subject: [ovs-discuss] [installation problem] Installation of OVS 2.3.1
 from the tarball on Citrix Xen Server 6.5
In-Reply-To: <552F2C73.70305@ccu.edu.tw>
References: <552C87E3.7070104@ccu.edu.tw> <552D14FE.8020209@cs.ccu.edu.tw>
 <20150415025248.GE12976@nicira.com> <552DD78A.7040003@ccu.edu.tw>
 <20150415031414.GG12976@nicira.com> <552E0262.4010801@ccu.edu.tw>
 <20150415151554.GC7003@nicira.com> <552F2C73.70305@ccu.edu.tw>
Message-ID: <20150416150918.GB6941@nicira.com>

On Thu, Apr 16, 2015 at 11:28:51AM +0800, GosenChien-IMAP wrote:
> We tried to follow the instruction you mention :
> 
> *rpmbuild -bb openvswitch-xen.spec -D "openvswitch_version 2.3.1" -D
> "kernel_name kernel" -D "kernel_version 3.10.0+2" -D "kernel_flavor xen"
> --without check
> *

Here's what we use for XenServer 6.5 and other 64-bit versions of
XenServer:

                kernel_name = 'xen'
                cmd = "rpm -qa | grep kernel-devel"
                output = self.get_output_from_command(cmd)
                kernel_version = re.sub('.*-devel-', '', output)
                # Get the build symlink in /lib/modules from
                # kernel-devel file list for xen_version
                cmd = "rpm -ql kernel-devel | grep 'lib/modules' | head -1"
                output = self.get_output_from_command(cmd)
                xen_version = re.sub('/lib/modules/', '',
                                     re.sub('/build', '', output))

                ovsver = "-D \"openvswitch_version %s.%s\"" % (version,
                                                               buildnum)
                kname = "-D \"kernel_name %s\"" % kernel_name
                kver = "-D \"kernel_version %s\"" % kernel_version
                xver = "-D \"xen_version %s\"" % xen_version
                spec = "-bb %s/SPECS/%s" % (rpmbuilddir, ovs_spec)
                spec_opts = "%s %s %s %s %s" % (ovsver, kname, kver,
                                                xver, spec)

                cmd = "%s rpmbuild %s" % (setarch, spec_opts)
                self.run_command(cmd, halt_on_failure=True)

From blp at nicira.com  Thu Apr 16 08:34:52 2015
From: blp at nicira.com (Ben Pfaff)
Date: Thu, 16 Apr 2015 08:34:52 -0700
Subject: [ovs-discuss] Regarding where function pointers in
 netdev_class/tc_ops hook to their implementations?
In-Reply-To: <CAJuiNqqnGdfr-szSz_crtAi0A3F-xD6TBXRpx_4296cP7-5ofg@mail.gmail.com>
References: <CAJuiNqpUH2tqVzkMCX+VDirdkZb8qad4gdmSHXMmmk0LRk+67w@mail.gmail.com>
 <20150415160437.GE7003@nicira.com>
 <CAJuiNqqnGdfr-szSz_crtAi0A3F-xD6TBXRpx_4296cP7-5ofg@mail.gmail.com>
Message-ID: <20150416153452.GF6941@nicira.com>

On Wed, Apr 15, 2015 at 09:26:29PM -0400, YoungTae Noh wrote:
> Hi Ben and all,
> 
> Thank you for the quick turnaround. I believe my previous explanation
> was not very clear.
> 
> Here is my objective:
> >> I would like to implement/manipulate queueing priority (possibly multiple queues per port in a shared memory) by user-definition.
> 
> Please correct me if my understanding/approach is wrong.
> To realize this - control this type of queue from OVS cmd (or controller),
> 1. I need add expression for this type of queue in ovs-vsctl cmd (or
> ovsdb client)
> 2. add an option field (for this type of queue) in ovsdb
> 3. ovs-vswitdhd dispatches it to  ofproto->netdev(lib)->netdev-linux
> 4. extending netdev-linux to allocate&construct this queue in linux
> kernel implementation ==> I believe I am standing here with the
> question! (also not sure hooking is correct term here)
> 5. extend queue & its management implementation (socket buffer in linux kernel)
> 
> Here is a very specific example:
> struct netdev_rxq *(*rxq_alloc)(void);
> 
> This will allocate a queue for an interface (netdev) in user-sapce. I
> believe this rxq_alloc will actually allocate a queue (FIFO) to a
> physical/virtual port in linux kernel (socket buffer). I would like to
> know which function is actually executed in kernel space and how they
> are interacting each other.

I think that you need to identify the Linux qdisc that implements the
queuing priority that you want (or implement one, if none exists), then
add support for that qdisc to netdev_linux.c, as a tc_ops.

From raorn at raorn.name  Thu Apr 16 08:40:12 2015
From: raorn at raorn.name (Alexey I. Froloff)
Date: Thu, 16 Apr 2015 18:40:12 +0300
Subject: [ovs-discuss] Current status of in-kernel openvswitch module
 (as of 3.18)
In-Reply-To: <20150416150619.GA6941@nicira.com>
References: <20150416143424.GA30354@raorn.name>
 <20150416150619.GA6941@nicira.com>
Message-ID: <20150416154012.GB30354@raorn.name>

On Thu, Apr 16, 2015 at 08:06:19AM -0700, Ben Pfaff wrote:
> > On the other hand, latest OVS (2.3.1) doesn't work with 3.18
> > kernel, which we are trying to use.
> It should work.  Please report a bug.
I mean, 3.18 kernel is not supported by 2.3.1.  Datapath module
refuses to compile, saying it needs kernel 3.14 or less.

> > So, how stable is combination of OVS 2.3.1, kernel 3.18 and
> > in-kernel openvswitch module?  As I can see from the code, it
> > even supports GRE/VxLAN tunnels, which is good.  Our primary use
> > for Open vSwitch is OpenStack, if that matters.
> It should be stable,
OK, thank you.

-- 
Regards,    --
Sir Raorn.   --- https://plus.google.com/+AlexeyFroloff
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 473 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150416/ebe97f9f/attachment.sig>

From blp at nicira.com  Thu Apr 16 08:44:30 2015
From: blp at nicira.com (Ben Pfaff)
Date: Thu, 16 Apr 2015 08:44:30 -0700
Subject: [ovs-discuss] Current status of in-kernel openvswitch module
 (as of 3.18)
In-Reply-To: <20150416154012.GB30354@raorn.name>
References: <20150416143424.GA30354@raorn.name>
 <20150416150619.GA6941@nicira.com>
 <20150416154012.GB30354@raorn.name>
Message-ID: <20150416154430.GH6941@nicira.com>

On Thu, Apr 16, 2015 at 06:40:12PM +0300, Alexey I. Froloff wrote:
> On Thu, Apr 16, 2015 at 08:06:19AM -0700, Ben Pfaff wrote:
> > > On the other hand, latest OVS (2.3.1) doesn't work with 3.18
> > > kernel, which we are trying to use.
> > It should work.  Please report a bug.
> I mean, 3.18 kernel is not supported by 2.3.1.  Datapath module
> refuses to compile, saying it needs kernel 3.14 or less.

You can either build the module included in 3.18 or build a module from
master.  Either should work OK.

From davidjoshuaevans at gmail.com  Thu Apr 16 08:46:44 2015
From: davidjoshuaevans at gmail.com (David Evans)
Date: Thu, 16 Apr 2015 10:46:44 -0500
Subject: [ovs-discuss] ovsdb idl seq no updates during port add.
Message-ID: <D1554394.277EA%davidjoshuaevans@gmail.com>

Hi OVS wizards.

When adding multiple dpdk ports to a bridge where after adding one or two,
I get a bridge_reconfigure caused by the  if (ovsdb_idl_get_seqno(idl) !=
idl_seqno at line 2956 of bridge.c which in turn makes the datapath id to
be unregistered.
Then the bridge automatically assigns a new data path id and sends out a
message to it¹s open flow controller (Ryu)

Trouble is, later the data path id¹s for those ports added before the
reconfigure are now out of date so my data path id¹s for the ports will
now be invalid
This trouble cascades further if I am still in the middle of adding ports
and flows ­ after the unregister happens via open flow, the data path
cannot be located so I have to throw some exceptions..
And then eventually we get a new data path id registration arrive over
open flow.

How do I :
A) Stop the reconfigure from happening
Or
B) Get new data path id¹s for the ports previously attached so when I add
flows via open flow commands they apply to known new data path id.
Or
C) handle the un-register / re register action gracefully via open flow
controller


Now there is mention in bridge.c of OFP_PORT_ACTION_WINDOW which is
defined, but never used and I think was intended to help with just my
scenario sounds a bit unfinished in this regard

I am using head revision ovs
I am using a Ryu app as a controller.  With it¹s vsctl module for adding
bridges and ports via ovsdb,
and OpenFlow 1.3 protocol for openFlow controller for adding flows and
collecting data.

Cheers,
Dave.



From blp at nicira.com  Thu Apr 16 08:50:58 2015
From: blp at nicira.com (Ben Pfaff)
Date: Thu, 16 Apr 2015 08:50:58 -0700
Subject: [ovs-discuss] [installation problem] Installation of OVS 2.3.1
 from the tarball on Citrix Xen Server 6.5
In-Reply-To: <552FD8B0.2070104@cs.ccu.edu.tw>
References: <552C87E3.7070104@ccu.edu.tw> <552D14FE.8020209@cs.ccu.edu.tw>
 <20150415025248.GE12976@nicira.com> <552DD78A.7040003@ccu.edu.tw>
 <20150415031414.GG12976@nicira.com> <552E0262.4010801@ccu.edu.tw>
 <20150415151554.GC7003@nicira.com> <552F2C73.70305@ccu.edu.tw>
 <20150416150918.GB6941@nicira.com> <552FD8B0.2070104@cs.ccu.edu.tw>
Message-ID: <20150416155058.GI6941@nicira.com>

I don't think the complete program would be helpful; it's part of a
largish internal build system.

There is no particular "buildnum"; we use an incrementing build number
internally to identify particular builds.  You can omit it.

On Thu, Apr 16, 2015 at 11:43:44PM +0800, Po-Ching Lin wrote:
> Dear Ben,
> 
>         Thank you very much for the information.
> 
>         The following piece of code seems to be part of a Python program. Would you
> mind providing us the complete program? Although we can "run" the program in our
> minds, the values of some variables are still missing, such as ovs_spec,rpmbuilddir
> and setarch. By the way, where can we find the buildnum for the stable openvswitch-2.3.1
> tarball? Sorry for more questions. Any help will be greatly appreciated.
> 
> Best regards,
> Po-Ching
> 
> Ben Pfaff On 2015/4/16 下午 11:09 wrote:
> >Here's what we use for XenServer 6.5 and other 64-bit versions of
> >XenServer:
> >
> >                 kernel_name = 'xen'
> >                 cmd = "rpm -qa | grep kernel-devel"
> >                 output = self.get_output_from_command(cmd)
> >                 kernel_version = re.sub('.*-devel-', '', output)
> >                 # Get the build symlink in /lib/modules from
> >                 # kernel-devel file list for xen_version
> >                 cmd = "rpm -ql kernel-devel | grep 'lib/modules' | head -1"
> >                 output = self.get_output_from_command(cmd)
> >                 xen_version = re.sub('/lib/modules/', '',
> >                                      re.sub('/build', '', output))
> >
> >                 ovsver = "-D \"openvswitch_version %s.%s\"" % (version,
> >                                                                buildnum)
> >                 kname = "-D \"kernel_name %s\"" % kernel_name
> >                 kver = "-D \"kernel_version %s\"" % kernel_version
> >                 xver = "-D \"xen_version %s\"" % xen_version
> >                 spec = "-bb %s/SPECS/%s" % (rpmbuilddir, ovs_spec)
> >                 spec_opts = "%s %s %s %s %s" % (ovsver, kname, kver,
> >                                                 xver, spec)
> >
> >                 cmd = "%s rpmbuild %s" % (setarch, spec_opts)
> >                 self.run_command(cmd, halt_on_failure=True)
> >
> 

From raorn at raorn.name  Thu Apr 16 08:53:16 2015
From: raorn at raorn.name (Alexey I. Froloff)
Date: Thu, 16 Apr 2015 18:53:16 +0300
Subject: [ovs-discuss] Current status of in-kernel openvswitch module
 (as of 3.18)
In-Reply-To: <20150416154430.GH6941@nicira.com>
References: <20150416143424.GA30354@raorn.name>
 <20150416150619.GA6941@nicira.com>
 <20150416154012.GB30354@raorn.name>
 <20150416154430.GH6941@nicira.com>
Message-ID: <20150416155316.GA31393@raorn.name>

On Thu, Apr 16, 2015 at 08:44:30AM -0700, Ben Pfaff wrote:
> > I mean, 3.18 kernel is not supported by 2.3.1.  Datapath module
> > refuses to compile, saying it needs kernel 3.14 or less.
> You can either build the module included in 3.18 or build a module from
> master.  Either should work OK.
Great!  Thank you very much!

-- 
Regards,    --
Sir Raorn.   --- https://plus.google.com/+AlexeyFroloff
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 473 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150416/d5a76f5f/attachment-0001.sig>

From blp at nicira.com  Thu Apr 16 09:00:29 2015
From: blp at nicira.com (Ben Pfaff)
Date: Thu, 16 Apr 2015 09:00:29 -0700
Subject: [ovs-discuss] ovsdb idl seq no updates during port add.
In-Reply-To: <D1554394.277EA%davidjoshuaevans@gmail.com>
References: <D1554394.277EA%davidjoshuaevans@gmail.com>
Message-ID: <20150416160029.GA31713@nicira.com>

On Thu, Apr 16, 2015 at 10:46:44AM -0500, David Evans wrote:
> I get a bridge_reconfigure caused by the  if (ovsdb_idl_get_seqno(idl) !=
> idl_seqno at line 2956 of bridge.c which in turn makes the datapath id to
> be unregistered.
> Then the bridge automatically assigns a new data path id and sends out a
> message to it¹s open flow controller (Ryu)
> 
> Trouble is, later the data path id¹s for those ports added before the
> reconfigure are now out of date so my data path id¹s for the ports will
> now be invalid
> This trouble cascades further if I am still in the middle of adding ports
> and flows ­ after the unregister happens via open flow, the data path
> cannot be located so I have to throw some exceptions..
> And then eventually we get a new data path id registration arrive over
> open flow.
> 
> How do I :
> A) Stop the reconfigure from happening
> Or
> B) Get new data path id¹s for the ports previously attached so when I add
> flows via open flow commands they apply to known new data path id.
> Or
> C) handle the un-register / re register action gracefully via open flow
> controller

It sounds like the problem here is that OVS by default uses the smallest
MAC address of any port on the bridge as the datapath-id.  The easy way
to keep the datapath-id from changing would be to set your own datapath
id using other-config:datapath-id in the Bridge table.

From davidjoshuaevans at gmail.com  Thu Apr 16 09:02:16 2015
From: davidjoshuaevans at gmail.com (David Evans)
Date: Thu, 16 Apr 2015 11:02:16 -0500
Subject: [ovs-discuss] ovsdb idl seq no updates during port add.
In-Reply-To: <20150416160029.GA31713@nicira.com>
References: <D1554394.277EA%davidjoshuaevans@gmail.com>
 <20150416160029.GA31713@nicira.com>
Message-ID: <D15546FD.277F0%davidjoshuaevans@gmail.com>

Sweet. I��ll give it a try.
Thanks.

Dave.

On 4/16/15, 11:00 AM, "Ben Pfaff" <blp at nicira.com> wrote:

>On Thu, Apr 16, 2015 at 10:46:44AM -0500, David Evans wrote:
>> I get a bridge_reconfigure caused by the  if (ovsdb_idl_get_seqno(idl)
>>!=
>> idl_seqno� at line 2956 of bridge.c which in turn makes the datapath id
>>to
>> be unregistered.
>> Then the bridge automatically assigns a new data path id and sends out a
>> message to it��s open flow controller (Ryu)
>> 
>> Trouble is, later the data path id��s for those ports added before the
>> reconfigure are now out of date so my data path id��s for the ports will
>> now be invalid
>> This trouble cascades further if I am still in the middle of adding
>>ports
>> and flows �� after the unregister happens via open flow, the data path
>> cannot be located so I have to throw some exceptions..
>> And then eventually we get a new data path id registration arrive over
>> open flow.
>> 
>> How do I :
>> A) Stop the reconfigure from happening
>> Or
>> B) Get new data path id��s for the ports previously attached so when I
>>add
>> flows via open flow commands they apply to known new data path id.
>> Or
>> C) handle the un-register / re register action gracefully via open flow
>> controller
>
>It sounds like the problem here is that OVS by default uses the smallest
>MAC address of any port on the bridge as the datapath-id.  The easy way
>to keep the datapath-id from changing would be to set your own datapath
>id using other-config:datapath-id in the Bridge table.



From blp at nicira.com  Thu Apr 16 09:02:25 2015
From: blp at nicira.com (Ben Pfaff)
Date: Thu, 16 Apr 2015 09:02:25 -0700
Subject: [ovs-discuss] ovsdb idl seq no updates during port add.
In-Reply-To: <D1554394.277EA%davidjoshuaevans@gmail.com>
References: <D1554394.277EA%davidjoshuaevans@gmail.com>
Message-ID: <20150416160225.GB31713@nicira.com>

On Thu, Apr 16, 2015 at 10:46:44AM -0500, David Evans wrote:
> Now there is mention in bridge.c of OFP_PORT_ACTION_WINDOW which is
> defined, but never used and I think was intended to help with just my
> scenario sounds a bit unfinished in this regard

That's a relic of old code that is no longer needed.  I sent out a patch
to remove it and credited you as the bug reporter, thanks!

From astgosen at ccu.edu.tw  Wed Apr 15 20:28:51 2015
From: astgosen at ccu.edu.tw (GosenChien-IMAP)
Date: Thu, 16 Apr 2015 11:28:51 +0800
Subject: [ovs-discuss] [installation problem] Installation of OVS 2.3.1
 from the tarball on Citrix Xen Server 6.5
In-Reply-To: <20150415151554.GC7003@nicira.com>
References: <552C87E3.7070104@ccu.edu.tw> <552D14FE.8020209@cs.ccu.edu.tw>
 <20150415025248.GE12976@nicira.com> <552DD78A.7040003@ccu.edu.tw>
 <20150415031414.GG12976@nicira.com> <552E0262.4010801@ccu.edu.tw>
 <20150415151554.GC7003@nicira.com>
Message-ID: <552F2C73.70305@ccu.edu.tw>

Dear Ben :


We tried to follow the instruction you mention :

*rpmbuild -bb openvswitch-xen.spec -D "openvswitch_version 2.3.1" -D 
"kernel_name kernel" -D "kernel_version 3.10.0+2" -D "kernel_flavor xen" 
--without check
*
Below is the message during building the RPM :

Executing (%prep)：/bin/sh -e /var/tmp/rpm-tmp.57436
Executing (%build)：/bin/sh -e /var/tmp/rpm-tmp.57436
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... /bin/mkdir -p
checking for gawk... gawk
checking whether make sets $(MAKE)... yes
checking for gcc... gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables...
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ISO C89... none needed
checking for style of include used by make... GNU
checking dependency style of gcc... gcc3
checking whether gcc and cc understand -c and -o together... yes
checking how to run the C preprocessor... gcc -E
checking for grep that handles long lines and -e... /bin/grep
checking for fgrep... /bin/grep -F
checking for egrep... /bin/grep -E
checking for perl... /usr/bin/perl
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking minix/config.h usability... no
checking minix/config.h presence... no
checking for minix/config.h... no
checking whether it is safe to define __EXTENSIONS__... yes
checking whether byte ordering is bigendian... no
checking for special C compiler options needed for large files... no
checking for _FILE_OFFSET_BITS value needed for large files... no
checking build system type... x86_64-unknown-linux-gnu
checking host system type... x86_64-unknown-linux-gnu
checking how to print strings... printf
checking for a sed that does not truncate output... /bin/sed
checking for ld used by gcc... /usr/bin/ld
checking if the linker (/usr/bin/ld) is GNU ld... yes
checking for BSD- or MS-compatible name lister (nm)... /usr/bin/nm -B
checking the name lister (/usr/bin/nm -B) interface... BSD nm
checking whether ln -s works... yes
checking the maximum length of command line arguments... 98304
checking whether the shell understands some XSI constructs... yes
checking whether the shell understands "+="... yes
checking how to convert x86_64-unknown-linux-gnu file names to 
x86_64-unknown-linux-gnu format... func_convert_file_noop
checking how to convert x86_64-unknown-linux-gnu file names to toolchain 
format... func_convert_file_noop
checking for /usr/bin/ld option to reload object files... -r
checking for objdump... objdump
checking how to recognize dependent libraries... pass_all
checking for dlltool... no
checking how to associate runtime and link libraries... printf %s\n
checking for ar... ar
checking for archiver @FILE support... @
checking for strip... strip
checking for ranlib... ranlib
checking command to parse /usr/bin/nm -B output from gcc object... ok
checking for sysroot... no
checking for mt... no
checking if : is a manifest tool... no
checking for dlfcn.h... yes
checking for objdir... .libs
checking if gcc supports -fno-rtti -fno-exceptions... no
checking for gcc option to produce PIC... -fPIC -DPIC
checking if gcc PIC flag -fPIC -DPIC works... yes
checking if gcc static flag -static works... yes
checking if gcc supports -c -o file.o... yes
checking if gcc supports -c -o file.o... (cached) yes
checking whether the gcc linker (/usr/bin/ld -m elf_x86_64) supports 
shared libraries... yes
checking dynamic linker characteristics... GNU/Linux ld.so
checking how to hardcode library paths into programs... immediate
checking whether stripping libraries is possible... yes
checking if libtool supports shared libraries... yes
checking whether to build shared libraries... no
checking whether to build static libraries... yes
checking for library containing pow... -lm
checking for library containing clock_gettime... -lrt
checking for library containing timer_create... none required
checking for library containing pthread_sigmask... none required
checking whether strerror_r is declared... yes
checking for strerror_r... yes
checking whether strerror_r returns char *... yes
checking vmware.h usability... no
checking vmware.h presence... no
checking for vmware.h... no
checking windows.h usability... no
checking windows.h presence... no
checking for windows.h... no
checking for linux/netlink.h... yes
checking for pkg-config... /usr/bin/pkg-config
checking whether compiling and linking against OpenSSL works... yes
checking for Python 2.x for x >= 4... /usr/bin/python
checking for uuid Python module... no
checking whether to add python/compat to PYTHONPATH... yes
checking for dot... no
checking net/if_packet.h usability... yes
checking net/if_packet.h presence... yes
checking for net/if_packet.h... yes
checking net/if_dl.h usability... no
checking net/if_dl.h presence... no
checking for net/if_dl.h... no
checking whether strtok_r macro segfaults on some inputs... yes
checking whether sys_siglist is declared... yes
checking for struct stat.st_mtim.tv_nsec... yes
checking for struct stat.st_mtimensec... no
checking for struct ifreq.ifr_flagshigh... no
checking for mlockall... yes
checking for strnlen... yes
checking for getloadavg... yes
checking for statvfs... yes
checking for getmntent_r... yes
checking mntent.h usability... yes
checking mntent.h presence... yes
checking for mntent.h... yes
checking sys/statvfs.h usability... yes
checking sys/statvfs.h presence... yes
checking for sys/statvfs.h... yes
checking linux/types.h usability... yes
checking linux/types.h presence... yes
checking for linux/types.h... yes
checking linux/if_ether.h usability... yes
checking linux/if_ether.h presence... yes
checking for linux/if_ether.h... yes
checking stdatomic.h usability... no
checking stdatomic.h presence... no
checking for stdatomic.h... no
checking for net/if_mib.h... no
checking for library containing backtrace... none required
checking whether libc supports hooks for malloc and related functions... yes
checking valgrind/valgrind.h usability... no
checking valgrind/valgrind.h presence... no
checking for valgrind/valgrind.h... no
checking for connect in -lsocket... no
checking for library containing gethostbyname... none required
checking XenServer release... 6.5.0
checking for groff... yes
checking whether make is GNU make... yes
checking whether gcc has <threads.h> that supports thread_local... no
checking whether gcc supports __thread... yes
checking for library containing __atomic_load_8... no
checking whether gcc supports GCC 4.0+ atomic built-ins... yes
checking value of __atomic_always_lock_free(1)... unsupported
checking value of __atomic_always_lock_free(2)... unsupported
checking value of __atomic_always_lock_free(4)... unsupported
checking value of __atomic_always_lock_free(8)... unsupported
checking for library containing aio_write... none required
checking for pthread_set_name_np... no
checking for pthread_setname_np() variant... none
checking whether __linux__ is defined... true
checking for working posix_memalign... yes
checking whether the preprocessor supports include_next... yes
checking whether system header files limit the line length... no
checking for stdio.h... yes
checking for string.h... (cached) yes
checking whether gcc accepts -Werror... yes
checking whether gcc accepts -Wall... yes
checking whether gcc accepts -Wextra... yes
checking whether gcc accepts -Wno-sign-compare... yes
checking whether gcc accepts -Wpointer-arith... yes
checking whether gcc accepts -Wdeclaration-after-statement... yes
checking whether gcc accepts -Wformat-security... no
checking whether gcc accepts -Wno-format-zero-length... yes
checking whether gcc accepts -Wswitch-enum... yes
checking whether gcc accepts -Wunused-parameter... yes
checking whether gcc accepts -Wstrict-aliasing... yes
checking whether gcc accepts -Wbad-function-cast... yes
checking whether gcc accepts -Wcast-align... yes
checking whether gcc accepts -Wstrict-prototypes... no
checking whether gcc accepts -Wold-style-definition... no
checking whether gcc accepts -Wmissing-prototypes... yes
checking whether gcc accepts -Wmissing-field-initializers... yes
checking whether gcc accepts -Wthread-safety... no
checking whether gcc accepts -Wno-unused... yes
checking whether gcc accepts -Wno-unused-parameter... yes
checking target hint for cgcc... x86_64
checking whether make has GNU make $(if) extension... yes
checking for Linux build directory... no
*configure: error: source dir /lib/modules/3.10.0+2xen/build doesn't exist*

1.It looks strange that in the DDK VM, this folder never exist, nor 
*/lib/modules/3.10.0+2/xen/build*. Should we create one since the 
instruction doesn't mention this.


2.    >Our internal build scripts just pass openvswitch_version, 
kernel_name, kernel_version, and xen_version on the rpmbuild command 
line, for             XenServer 6.5 and other 64-bit versions of XenServer.

   Did your team also build the RPM packages under the DDK VM for Xen 
Server 6.5? Since there's no rpm-build tools in the  hypervisor itself.

BTW, we found there's only kernel-related package in the hypervisor (Xen 
Server) and the DDK VM, bu no "kernel-xen" related packages.

Thanks.

Best Regards,
             Gosen Chien
*************************************
CCU CS Project assistant
No.168, Sec. 1, University Rd., Min-Hsiung Township, Chia-yi County 62102, Taiwan
TEL: (05)272-0411#23134
E-mail:astgosen at ccu.edu.tw  <mailto:astgosen at ccu.edu.tw>
        astgosen at novatw.info  <mailto:astgosen at novatw.info>

Ben Pfaff 於 西元2015年04月15日 23:15 寫道:
> Our internal build scripts just pass openvswitch_version, kernel_name,
> kernel_version, and xen_version on the rpmbuild command line, for
> XenServer 6.5 and other 64-bit versions of XenServer.
>
> On Wed, Apr 15, 2015 at 02:17:06PM +0800, GosenChien-IMAP wrote:
>> Dear Ben :
>>>> Did you continue reading in the instructions? The "Build Parameters"
>> section has a few details, including some specific to XenServer 6.5 and
>> above.
>>
>> Yes, I've follow the instruction to add the parameter "rpmbuild -D
>> "kernel_version $KERNEL_VERSION"" -bb xenserver/openvswitch-xen.spec
>>
>> If you've ever use the parameter to build the package successfully, could
>> you share the parameters you use under the Xen DDK VM?
>>
>> Many thanks.
>>
>> Best Regards,
>>              Gosen Chien
>> *************************************
>> CCU CS Project assistant
>> No.168, Sec. 1, University Rd., Min-Hsiung Township, Chia-yi County 62102, Taiwan
>> TEL: (05)272-0411#23134
>> E-mail:astgosen at ccu.edu.tw  <mailto:astgosen at ccu.edu.tw>
>>         astgosen at novatw.info  <mailto:astgosen at novatw.info>
>>
>> Ben Pfaff 於 西元2015年04月15日 11:14 寫道:
>>> On Wed, Apr 15, 2015 at 11:14:18AM +0800, GosenChien-IMAP wrote:
>>>> No.168, Sec. 1, University Rd., Min-Hsiung Township, Chia-yi County 62102, Taiwan
>>>> TEL: (05)272-0411#23134
>>>> E-mail:astgosen at ccu.edu.tw  <mailto:astgosen at ccu.edu.tw>
>>>>         astgosen at novatw.info  <mailto:astgosen at novatw.info>
>>>>
>>>> Ben Pfaff 於 西元2015年04月15日 10:52 寫道:
>>>>> On Tue, Apr 14, 2015 at 09:24:14PM +0800, Po-Ching Lin wrote:
>>>>>>           We recently tried to install OpenvSwitch 2.3.1 on Citrix Xen Server 6.5.
>>>>>> We followed the instructions in INSTALL.XenServer, and the reproduced steps
>>>>>> are as follows. The main problem is that the directory /lib/modules/xen/build is
>>>>>> missing. Please suggest the method to address this issue. Thanks a lot.
>>>>>>
>>>>>> [Reproduced steps]
>>>>>> 1. According to INSTALL.XenServer from the OVS tarball, put the tarball package to the "/usr/src/redhat/SOURCE/" folder and extract it;
>>>>>> 2. Enter the "openvswitch-2.3.1/xenserver/" folder;
>>>>>> 3. Add the kernel version in line 70 of the file "openvswitch.spec";
>>>>> Where did step 3 come from?  It isn't mentioned in INSTALL.XenServer.
>>>> Yes , it didn't mention in the INSTALL.XenServer.
>>>> However, we found during the building process, the program would tell us
>>>> that it could not found the kernel version so that we modified the file.
>>>>> Requires: kernel-%{kernel_name} = *3.10.41-323.380416**<-- we change this

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150416/4dccc865/attachment-0001.html>

From ashujain9727 at gmail.com  Thu Apr 16 06:01:31 2015
From: ashujain9727 at gmail.com (abhishek jain)
Date: Thu, 16 Apr 2015 18:31:31 +0530
Subject: [ovs-discuss] configure OVS remotely
Message-ID: <CA+9-LvuJyDVg8a76p8XTOH6NsE+bvpqqAp2F-m6CJppH-7n5jg@mail.gmail.com>

Hi

I need to configure QOS queues on  Openvswitch from remote system.The OVS
is connected to SDN controller.Please help me regarding this.

Thanks
Abhsihek Jain
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150416/25543ca2/attachment.html>

From pclin at cs.ccu.edu.tw  Thu Apr 16 08:43:44 2015
From: pclin at cs.ccu.edu.tw (Po-Ching Lin)
Date: Thu, 16 Apr 2015 23:43:44 +0800
Subject: [ovs-discuss] [installation problem] Installation of OVS 2.3.1
 from the tarball on Citrix Xen Server 6.5
In-Reply-To: <20150416150918.GB6941@nicira.com>
References: <552C87E3.7070104@ccu.edu.tw> <552D14FE.8020209@cs.ccu.edu.tw>
 <20150415025248.GE12976@nicira.com> <552DD78A.7040003@ccu.edu.tw>
 <20150415031414.GG12976@nicira.com> <552E0262.4010801@ccu.edu.tw>
 <20150415151554.GC7003@nicira.com> <552F2C73.70305@ccu.edu.tw>
 <20150416150918.GB6941@nicira.com>
Message-ID: <552FD8B0.2070104@cs.ccu.edu.tw>

Dear Ben,

         Thank you very much for the information.

         The following piece of code seems to be part of a Python program. Would you
mind providing us the complete program? Although we can "run" the program in our
minds, the values of some variables are still missing, such as ovs_spec,rpmbuilddir
and setarch. By the way, where can we find the buildnum for the stable openvswitch-2.3.1
tarball? Sorry for more questions. Any help will be greatly appreciated.

Best regards,
Po-Ching

Ben Pfaff On 2015/4/16 下午 11:09 wrote:
> Here's what we use for XenServer 6.5 and other 64-bit versions of
> XenServer:
>
>                  kernel_name = 'xen'
>                  cmd = "rpm -qa | grep kernel-devel"
>                  output = self.get_output_from_command(cmd)
>                  kernel_version = re.sub('.*-devel-', '', output)
>                  # Get the build symlink in /lib/modules from
>                  # kernel-devel file list for xen_version
>                  cmd = "rpm -ql kernel-devel | grep 'lib/modules' | head -1"
>                  output = self.get_output_from_command(cmd)
>                  xen_version = re.sub('/lib/modules/', '',
>                                       re.sub('/build', '', output))
>
>                  ovsver = "-D \"openvswitch_version %s.%s\"" % (version,
>                                                                 buildnum)
>                  kname = "-D \"kernel_name %s\"" % kernel_name
>                  kver = "-D \"kernel_version %s\"" % kernel_version
>                  xver = "-D \"xen_version %s\"" % xen_version
>                  spec = "-bb %s/SPECS/%s" % (rpmbuilddir, ovs_spec)
>                  spec_opts = "%s %s %s %s %s" % (ovsver, kname, kver,
>                                                  xver, spec)
>
>                  cmd = "%s rpmbuild %s" % (setarch, spec_opts)
>                  self.run_command(cmd, halt_on_failure=True)
>


From marco at nuvula.ch  Thu Apr 16 13:13:57 2015
From: marco at nuvula.ch (Marco Kuendig)
Date: Thu, 16 Apr 2015 22:13:57 +0200
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <55241FD8.1040704@ubuntu.com>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <CANr6G5yB6jiYD+fwYhtPDh3bxams3PNTZLqd25DVcyU1hxmquw@mail.gmail.com>
 <B32CB78D-2CF9-4F47-9515-C8A206C090A2@nuvula.ch>
 <alpine.OSX.1.10.1503311245160.389@sabyasg-mbp-02>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
 <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
 <3E5B9556-CB9F-4D5B-8A6D-A615C099BAD7@nuvula.ch>
 <3FE189EC-49E0-47CC-BD59-2F6E7B04B9A4@ubuntu.com>
 <8CE70C04-9A31-4499-938A-85EC4D13E0BB@nuvula.ch>
 <C222441F-23C1-470A-987E-123B00879EA9@ubuntu.com>
 <117DA076-BD34-4C01-94AE-22949AEF0E42@nuvula.ch> <55241FD8.1040704@ubuntu.com>
Message-ID: <A00A93E9-6A58-458C-8E8B-C8542176ADDA@nuvula.ch>

Hi James

bad news. Had another crash today on 3.16 kernel.

Below the backtrace. This is Kernel 3.16, ovs 2.0.2 with optimisations disabled.

Any other troubleshooting steps we can do ?

Thanks
marco



root at nuv-vir-kvm-server-2 ~ # gdb /usr/sbin/ovs-vswitchd /var/crash/ovs1/CoreDump -ex bt -ex quit --quiet
Reading symbols from /usr/sbin/ovs-vswitchd...Reading symbols from /usr/lib/debug//usr/sbin/ovs-vswitchd...done.
done.
[New LWP 4360]
[New LWP 4361]
[New LWP 4366]
[New LWP 4365]
[New LWP 4364]
[New LWP 4362]
[New LWP 4363]
[New LWP 4367]
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
Core was generated by `ovs-vswitchd unix:/var/run/openvswitch/db.sock -vconsole:emer -vsyslog:err -vfi'.
Program terminated with signal SIGSEGV, Segmentation fault.
#0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
506	../lib/netlink.c: No such file or directory.
#0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506
#1  0x0000000000460473 in format_generic_odp_key (a=a at entry=0x0, ds=ds at entry=0x7ffc6c10bd10) at ../lib/odp-util.c:767
#2  0x0000000000460cd2 in format_odp_key_attr (a=a at entry=0x19798d4, ma=ma at entry=0x0, ds=ds at entry=0x7ffc6c10bd10, verbose=verbose at entry=true) at ../lib/odp-util.c:1332
#3  0x00000000004609d7 in odp_flow_format (key=<optimized out>, key_len=40, mask=0x0, mask_len=0, ds=0x7ffc6c10bd10, verbose=true) at ../lib/odp-util.c:1402
#4  0x0000000000460fc4 in format_odp_key_attr (a=a at entry=0x19798b0, ma=ma at entry=0x0, ds=ds at entry=0x7ffc6c10bd10, verbose=verbose at entry=true) at ../lib/odp-util.c:987
#5  0x00000000004609d7 in odp_flow_format (key=key at entry=0x1979850, key_len=key_len at entry=140, mask=mask at entry=0x0, mask_len=mask_len at entry=0, ds=ds at entry=0x7ffc6c10bd10,
    verbose=verbose at entry=true) at ../lib/odp-util.c:1402
#6  0x00000000004450f3 in log_flow_message (error=error at entry=2, operation=operation at entry=0x4d0e73 "flow_del", key=0x1979850, key_len=140, mask=mask at entry=0x0, mask_len=mask_len at entry=0,
    stats=0x0, actions=actions at entry=0x0, actions_len=actions_len at entry=0, dpif=<optimized out>) at ../lib/dpif.c:1354
#7  0x00000000004453c9 in log_flow_del_message (dpif=dpif at entry=0x1964f10, del=del at entry=0x7ffc6c10bdc0, error=error at entry=2) at ../lib/dpif.c:1397
#8  0x0000000000445433 in log_flow_del_message (error=2, del=0x7ffc6c10bdc0, dpif=0x1964f10) at ../lib/dpif.c:1396
#9  dpif_flow_del__ (dpif=0x1964f10, del=del at entry=0x7ffc6c10bdc0) at ../lib/dpif.c:945
#10 0x00000000004455ca in dpif_flow_del (dpif=<optimized out>, key=<optimized out>, key_len=<optimized out>, stats=stats at entry=0x7ffc6c10bdf0) at ../lib/dpif.c:965
#11 0x000000000041b423 in subfacet_uninstall (subfacet=0x18f0ed0) at ../ofproto/ofproto-dpif.c:4686
#12 0x0000000000420f18 in facet_remove (facet=facet at entry=0x18f0ad0) at ../ofproto/ofproto-dpif.c:4014
#13 0x0000000000422f52 in facet_revalidate (facet=facet at entry=0x18f0ad0) at ../ofproto/ofproto-dpif.c:4321
#14 0x0000000000424b5a in facet_lookup_valid (flow=0x7f26400177d8, ofproto=0x19509d0) at ../ofproto/ofproto-dpif.c:4203
#15 handle_flow_miss (n_ops=<synthetic pointer>, ops=0x7ffc6c10c4c0, miss=0x7f26400177c0) at ../ofproto/ofproto-dpif.c:3339
#16 handle_flow_misses (fmb=fmb at entry=0x7f2640016a30, backer=<optimized out>) at ../ofproto/ofproto-dpif.c:3410
#17 0x0000000000425196 in handle_upcalls (backer=<optimized out>) at ../ofproto/ofproto-dpif.c:3565
#18 dpif_backer_run_fast (backer=<optimized out>) at ../ofproto/ofproto-dpif.c:1007
#19 type_run_fast (type=<optimized out>) at ../ofproto/ofproto-dpif.c:1024
#20 0x00000000004122cf in ofproto_type_run_fast (datapath_type=<optimized out>, datapath_type at entry=0x199f790 "system") at ../ofproto/ofproto.c:1326
#21 0x00000000004081a5 in bridge_run_fast () at ../vswitchd/bridge.c:2318
#22 0x00000000004059b6 in main (argc=<optimized out>, argv=<optimized out>) at ../vswitchd/ovs-vswitchd.c:117
root at nuv-vir-kvm-server-2 ~ # uname -a
Linux nuv-vir-kvm-server-2 3.16.0-34-generic #47~14.04.1-Ubuntu SMP Fri Apr 10 17:49:16 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux



 <http://www.nuvula.ch/>
Marco Kuendig / CEO / Founder 
marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71

Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
Nuvula AG - Hybrid Clouds 
Weierbachstrasse 7b 8193 Eglisau Switzerland 
http://www.nuvula.ch <http://www.nuvula.ch/>
> On 07 Apr 2015, at 20:20, James Page <james.page at ubuntu.com> wrote:
> 
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA256
> 
> Hi Marco
> 
> On 07/04/15 10:33, Marco Kuendig wrote:
>> got another crash today with the optimisation disabled package:
>> 
>> here the backtrace (at the end is the one with the debug symbols)
> 
> Hmm - looks like the same backtrace to me; so maybe this not an
> optimizer problem after all.
> 
> Would you be willing to try to reproduce on the newer 3.16 HWE kernel
> on 14.04 (linux-image-hwe-generic-trusty)? I have a hypothesis on what
> might be causing this issue, but I've not been able to prove it yet
> and the 3.16 kernel has the required fix in the openvswitch module.
> 
> [...]
>> #0  nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506 
>> 506../lib/netlink.c: No such file or directory. (gdb) bt #0
>> nl_attr_get_size (nla=nla at entry=0x0) at ../lib/netlink.c:506 #1
>> 0x0000000000460473 in format_generic_odp_key (a=a at entry=0x0, 
>> ds=ds at entry=0x7fff228e0520) at ../lib/odp-util.c:767 #2
>> 0x0000000000460cd2 in format_odp_key_attr (a=a at entry=0x1b8cdb4, 
>> ma=ma at entry=0x0, ds=ds at entry=0x7fff228e0520,
>> verbose=verbose at entry=true) at ../lib/odp-util.c:1332 #3
>> 0x00000000004609d7 in odp_flow_format (key=<optimized out>, 
>> key_len=40, mask=0x0, mask_len=0, ds=0x7fff228e0520, verbose=true)
>> at ../lib/odp-util.c:1402 #4  0x0000000000460fc4 in
>> format_odp_key_attr (a=a at entry=0x1b8cd90, ma=ma at entry=0x0,
>> ds=ds at entry=0x7fff228e0520, verbose=verbose at entry=true) at
>> ../lib/odp-util.c:987 #5  0x00000000004609d7 in odp_flow_format
>> (key=key at entry=0x1b8cd30, key_len=key_len at entry=140,
>> mask=mask at entry=0x0, mask_len=mask_len at entry=0, 
>> ds=ds at entry=0x7fff228e0520, verbose=verbose at entry=true) at 
>> ../lib/odp-util.c:1402 #6  0x00000000004450f3 in log_flow_message
>> (error=error at entry=2, operation=operation at entry=0x4d0e73
>> "flow_del", key=0x1b8cd30, key_len=140, mask=mask at entry=0x0, 
>> mask_len=mask_len at entry=0, stats=0x0, actions=actions at entry=0x0, 
>> actions_len=actions_len at entry=0, dpif=<optimized out>) at
>> ../lib/dpif.c:1354 #7  0x00000000004453c9 in log_flow_del_message 
>> (dpif=dpif at entry=0x1b5d4c0, del=del at entry=0x7fff228e05d0, 
>> error=error at entry=2) at ../lib/dpif.c:1397 #8  0x0000000000445433
>> in log_flow_del_message (error=2, del=0x7fff228e05d0,
>> dpif=0x1b5d4c0) at ../lib/dpif.c:1396 #9  dpif_flow_del__
>> (dpif=0x1b5d4c0, del=del at entry=0x7fff228e05d0) at 
>> ../lib/dpif.c:945 #10 0x00000000004455ca in dpif_flow_del
>> (dpif=<optimized out>, key=<optimized out>, key_len=<optimized
>> out>, stats=stats at entry=0x7fff228e0600) at ../lib/dpif.c:965 #11
>> 0x000000000041b423 in subfacet_uninstall (subfacet=0x1b38af0) at 
>> ../ofproto/ofproto-dpif.c:4686 #12 0x0000000000420f18 in
>> facet_remove (facet=facet at entry=0x1b386f0) at 
>> ../ofproto/ofproto-dpif.c:4014 #13 0x0000000000422f52 in
>> facet_revalidate (facet=facet at entry=0x1b386f0) at
>> ../ofproto/ofproto-dpif.c:4321 #14 0x0000000000424b5a in
>> facet_lookup_valid (flow=0x7fabe8000c68, ofproto=0x1b69e50) at
>> ../ofproto/ofproto-dpif.c:4203 #15 handle_flow_miss
>> (n_ops=<synthetic pointer>, ops=0x7fff228e0cd0, 
>> miss=0x7fabe8000c50) at ../ofproto/ofproto-dpif.c:3339 #16
>> handle_flow_misses (fmb=fmb at entry=0x7fabe80008e0,
>> backer=<optimized out>) at ../ofproto/ofproto-dpif.c:3410 #17
>> 0x0000000000425196 in handle_upcalls (backer=<optimized out>) at 
>> ../ofproto/ofproto-dpif.c:3565 #18 dpif_backer_run_fast
>> (backer=<optimized out>) at ../ofproto/ofproto-dpif.c:1007 #19
>> type_run_fast (type=<optimized out>) at
>> ../ofproto/ofproto-dpif.c:1024 #20 0x00000000004122cf in
>> ofproto_type_run_fast (datapath_type=<optimized out>,
>> datapath_type at entry=0x1ad7540 "system") at
>> ../ofproto/ofproto.c:1326 #21 0x00000000004081a5 in bridge_run_fast
>> () at ../vswitchd/bridge.c:2318 #22 0x00000000004059b6 in main
>> (argc=<optimized out>, argv=<optimized out>) at
>> ../vswitchd/ovs-vswitchd.c:117 (gdb) quit
> 
> 
> - -- 
> James Page
> Ubuntu and Debian Developer
> james.page at ubuntu.com
> jamespage at debian.org
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v2
> 
> iQIcBAEBCAAGBQJVJB/YAAoJEL/srsug59jDAs8P/3Vy774c1CoyomZAaMnXdlb8
> kQm1zYTAWJEJk0Ms3SfaI8roihnhBUB/JS34Ns3FkJXHHTqHpQH2sL+wnRj4jVYZ
> TLB8V4t2zezVvl6gFyKdYqMBz+/RGp7yFWG32b3eczMsZDUJCgvGoHdr8dW5sbVm
> uFNMZLv5on670NZn8QP/Th8iAHX0dB7Q9QX+QNSNeAg43PHXOoPiy2f8zIbczU+Q
> mBUGY5NBWnnJkQStyecP8cII81adXyS/NZwJvf4LaGIZ8q9MW9/dc8C6t/DaYd/a
> GZ4jcYBnDMOQd1adPqi3oDx8UtEsK+Z8XOJzueU7mLvzxkRYScNLhv5lmiGP3/Gv
> Lr7D0IWFe6pEV1BxGgBZGU51Nle9LiLC2ERmPX5a0g7YZZ6pKdPNmwj93KWvvY4b
> sJDBSF7ynQxbDbaDct7ZE2WqEdurkZ1wcFu6c2j6+vf2UKRHZ/J53GpAnYsGS5eL
> u8PVqZv4896Vs1nvLZddhN6MrHc4Qu0vSIRA1PcvI350LYcBi8y5wN514H0H8/vr
> jy6WBqLRBpXBjReJTHxORKAH6vTIub7IzrIFEM0eQQyhqc0p6Szw2U2p+FQNrD/T
> MUY5Sl9hAZTzGGpDkjQfxnyv1NNuozrUXqAs+0SHXw2hsIazKwlN+rJ3nENJPPXo
> qjXPMYZeGI4IjXJuvfsZ
> =8H5s
> -----END PGP SIGNATURE-----

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150416/2a227f35/attachment-0001.html>

From joestringer at nicira.com  Thu Apr 16 14:44:30 2015
From: joestringer at nicira.com (Joe Stringer)
Date: Thu, 16 Apr 2015 14:44:30 -0700
Subject: [ovs-discuss] Potential OVS+OpenStack Kilo issue
Message-ID: <CANr6G5zCPw+KK_MkxqsdWfZqumsqEQY5mBoQY7qTAQSEgVVaiw@mail.gmail.com>

I had a lengthy discussion with someone in IRC last night who observed
some odd behaviour in OVS-2.3 userspace + module from Linux-3.16. It
seems like if OVS >= 2.3 is paired with OVS module from Linux <= 3.16,
then only one handler thread will handle traffic even if multiple such
threads exist. This limits the performance of OVS particularly under
high load.

Prior to OVS-2.3 we had a dispatcher thread which distributed the
misses to multiple handler threads, but in 2.3 we shifted the
equivalent logic into the kernel. I understand that the requisite
patch for this functionality was merged in Linux-3.17:
https://github.com/torvalds/linux/commit/5cd667b0a4567048bb555927d6ee564f4e5620a9

For the most part, I don't think this is an issue because major
distros haven't shipped OVS-2.3 yet. Hopefully by the time they do
they will have recent kernels or will recommend dkms module. For
instance, Ubuntu 15.04 looks like it will have Linux-3.19. Using the
OVS module from this version should not exhibit this problem.

My main concern is whether this issue has been raised in OpenStack, as
it appears that the Kilo release (imminent) is expected to run against
Ubuntu 14.04, but there is no updated kernel or newer OVS kernel
module in Ubuntu Cloud Archive (launchpad summary of packages below).
If Ubuntu 14.04.3 hardware enablement stack is required then this
issue should not be present [as it would presumably use the 15.04
kernel]. If an openvswitch-datapath-dkms package for OVS-2.3 is
distributed with the Ubuntu Cloud Archive, then users can be
recommended to use the dkms module. If users run on a single-core
machine, there'll be no problem ;-)

https://launchpad.net/~ubuntu-cloud-archive/+archive/ubuntu/kilo-staging

I reproduced this today using Ubuntu Cloud Archive paired with Ubuntu
14.10, but it is equally applicable to Ubuntu 14.04 LTS.

Steps to reproduce:
- Install Ubuntu 14.04.2
- Add ubuntu cloud archive for OpenStack Kilo[url below]
- Install openvswitch-switch
- Add bridge, interface
- ovs-vsctl set Open_vSwitch . n-handler-threads 3
- ovs-appctl upcall/disable-megaflows (To produce lots of misses)
- hping3 --flood
- Observe that only one handler thread handles misses

http://lists.openstack.org/pipermail/openstack-dev/2015-January/054820.html

Are there some OpenStack people out there that could clarify whether
this is a problem and if it's being addressed?

From james.page at ubuntu.com  Thu Apr 16 14:57:28 2015
From: james.page at ubuntu.com (James Page)
Date: Thu, 16 Apr 2015 22:57:28 +0100
Subject: [ovs-discuss] Potential OVS+OpenStack Kilo issue
In-Reply-To: <CANr6G5zCPw+KK_MkxqsdWfZqumsqEQY5mBoQY7qTAQSEgVVaiw@mail.gmail.com>
References: <CANr6G5zCPw+KK_MkxqsdWfZqumsqEQY5mBoQY7qTAQSEgVVaiw@mail.gmail.com>
Message-ID: <55303048.4040303@ubuntu.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Hi Joe

On 16/04/15 22:44, Joe Stringer wrote:
> I had a lengthy discussion with someone in IRC last night who
> observed some odd behaviour in OVS-2.3 userspace + module from
> Linux-3.16. It seems like if OVS >= 2.3 is paired with OVS module
> from Linux <= 3.16, then only one handler thread will handle
> traffic even if multiple such threads exist. This limits the
> performance of OVS particularly under high load.
> 
> Prior to OVS-2.3 we had a dispatcher thread which distributed the 
> misses to multiple handler threads, but in 2.3 we shifted the 
> equivalent logic into the kernel. I understand that the requisite 
> patch for this functionality was merged in Linux-3.17: 
> https://github.com/torvalds/linux/commit/5cd667b0a4567048bb555927d6ee5
64f4e5620a9
>
>  For the most part, I don't think this is an issue because major 
> distros haven't shipped OVS-2.3 yet. Hopefully by the time they do 
> they will have recent kernels or will recommend dkms module. For 
> instance, Ubuntu 15.04 looks like it will have Linux-3.19. Using
> the OVS module from this version should not exhibit this problem.

Well that's good news....

> My main concern is whether this issue has been raised in OpenStack,
> as it appears that the Kilo release (imminent) is expected to run
> against Ubuntu 14.04, but there is no updated kernel or newer OVS
> kernel module in Ubuntu Cloud Archive (launchpad summary of
> packages below). If Ubuntu 14.04.3 hardware enablement stack is
> required then this issue should not be present [as it would
> presumably use the 15.04 kernel]. If an openvswitch-datapath-dkms
> package for OVS-2.3 is distributed with the Ubuntu Cloud Archive,
> then users can be recommended to use the dkms module. If users run
> on a single-core machine, there'll be no problem ;-)

Obviously not such good news; the 3.19 kernel will be made available
on 14.04 - but not for a few weeks yet - and we intentionally dropped
the dkms package in 2.3.x of ovs in Ubuntu - and we're backporting
2.3.1 as part of the OpenStack kilo cloud archive.

> https://launchpad.net/~ubuntu-cloud-archive/+archive/ubuntu/kilo-stagi
ng
>
>  I reproduced this today using Ubuntu Cloud Archive paired with
> Ubuntu 14.10, but it is equally applicable to Ubuntu 14.04 LTS.
> 
> Steps to reproduce: - Install Ubuntu 14.04.2 - Add ubuntu cloud
> archive for OpenStack Kilo[url below] - Install openvswitch-switch 
> - Add bridge, interface - ovs-vsctl set Open_vSwitch .
> n-handler-threads 3 - ovs-appctl upcall/disable-megaflows (To
> produce lots of misses) - hping3 --flood - Observe that only one
> handler thread handles misses
> 
> http://lists.openstack.org/pipermail/openstack-dev/2015-January/054820
.html
>
>  Are there some OpenStack people out there that could clarify
> whether this is a problem and if it's being addressed?

Thanks for raising this potential issue; there is not a huge amount I
can do between now and release of the Kilo Cloud Archive (Final Freeze
is today), but if this does present a problem we can look into some
potential stable updates to help resolve any performance impacts.

Regards

James

- -- 
James Page
Ubuntu and Debian Developer
james.page at ubuntu.com
jamespage at debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQIcBAEBCAAGBQJVMDBIAAoJEL/srsug59jDG+8QAJAbefCIOEGGbwlxax+Fm2cg
hNZTvQ8gMoIddxYB+GHsqjE4SpLuTghkq2dP9OJ1qkdOTCbZyU2+j2Qy/o0YBLps
2FWGoJhPCjk6P/1x946PqkLrp739Roe3ztoeit2dx2pb1fbNObInSQroyU+O/0AW
6TobFM6iJgTXC1aHE1Gww+WzSreL2mfiiPlsgBdqJ49ojDprDMV24U82iGonpWJ6
297/1anqPTSVG950JyYifV2zD5FrZjYLBHIOMfhAVjGQaZUzIZUYP3ay1ZSSj7LN
2HoTStXZ2cQIuCvxRe9DHdmqiCuYBbDSusxEduERZsggQ7VzRQCuft/BPLtyDqaQ
qS25rnYvk2BHFLwhjEjKjQrO2CT7z2P9FGKA4ZESnIaa0HR49m7ZIIjfOqmB5Oms
D/dO/cQr4Y66/wyyTNSL8gJqGWqCUL7cvd5HJo5fFDHWKoTy2G0pQcX5M5ql8ZFu
k/CYd7YHdY5ABEJeki3Jbv6K7fqFijFWyDdKFiYu+xAsX248IJKZKmTwb7+mw/Rw
lpSnAjoF/AN3kKRGWGA5hKqEVxq7lUsGe9jKsSmo6V3l/bUAPZh3v9yzMRbZlg8v
1pyn6xNv4kIzkYiJ/Xq29z68AaQJgsrHdUrKMHBWs5LCPKZ+K+mkAB+kNPebQzEa
spfidrhOIEUT2HQ5I/YT
=0FqP
-----END PGP SIGNATURE-----

From blp at nicira.com  Thu Apr 16 16:28:06 2015
From: blp at nicira.com (Ben Pfaff)
Date: Thu, 16 Apr 2015 16:28:06 -0700
Subject: [ovs-discuss] configure OVS remotely
In-Reply-To: <CA+9-LvuJyDVg8a76p8XTOH6NsE+bvpqqAp2F-m6CJppH-7n5jg@mail.gmail.com>
References: <CA+9-LvuJyDVg8a76p8XTOH6NsE+bvpqqAp2F-m6CJppH-7n5jg@mail.gmail.com>
Message-ID: <20150416232806.GA16575@nicira.com>

On Thu, Apr 16, 2015 at 06:31:31PM +0530, abhishek jain wrote:
> I need to configure QOS queues on  Openvswitch from remote system.The OVS
> is connected to SDN controller.Please help me regarding this.

Configure the ovsdb-server to talk to your remote system.

From kh.baek at kt.com  Thu Apr 16 23:51:06 2015
From: kh.baek at kt.com (=?ks_c_5601-1987?B?uemxpMf2KEZyYXVkLUNhbGwgQ29udHJvbCBQcm9qZWMp?=)
Date: Fri, 17 Apr 2015 06:51:06 +0000
Subject: [ovs-discuss] Do you support Q-in-Q(802.1ad) or have any plans?
Message-ID: <488A2AA1A414284E972CE78B9336B48102BE0C3B@MAIL-MBX-04>

Hello,

Do you support Q-in-Q(802.1ad) or have any plans?
I saw the mails that he was working on a patch for Q-in-Q by Thomas F Herbert on 21 Aug 2014.
(https://www.mail-archive.com/discuss at openvswitch.org/msg10722.html)
(https://www.mail-archive.com/discuss at openvswitch.org/msg10722.html)

I also saw the mail that Thomas said “You can try our patch for 802.1ad but you will have to build OVS from source.”
and “As is the case with 802.1ad, openflow spec supports 802.1ah (PBB) but OVS doesn't support it as yet.”
(https://www.mail-archive.com/discuss%40openvswitch.org/msg12009.html)

I don’t understand what Thomas means
Is Q-in-Q(802.1ad) support or not?
If you support that, how can I apply that?
The other, would you please tell me the plan to support Q-in-Q?

Regards
Baek


이 메일은 지정된 수취인만을 위해 작성되었으며, 중요한 정보나 저작권을 포함하고 있을 수 있습니다. 어떠한 권한 없이, 본 문서에 포함된 정보의 전부 또는 일부를 무단으로 제3자에게 공개, 배포, 복사 또는 사용하는 것을 엄격히 금지합니다. 만약, 본 메일이 잘못 전송된 경우, 발신인 또는 당사에 알려주시고, 본 메일을 즉시 삭제하여 주시기 바랍니다.
This E-mail may contain confidential information and/or copyright material. This email is intended for the use of the addressee only. If you receive this email by mistake, please either delete it without reproducing, distributing or retaining copies thereof or notify the sender immediately.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150417/ca604086/attachment-0001.html>

From amal.kammoun at supcom.tn  Fri Apr 17 03:54:36 2015
From: amal.kammoun at supcom.tn (Amal KAMMOUN)
Date: Fri, 17 Apr 2015 10:54:36 +0000
Subject: [ovs-discuss] Flowvisor stops when OVS is connected to it
In-Reply-To: <20150415161958.GG7003@nicira.com>
References: <1429083333426.38896@supcom.tn>, <20150415161958.GG7003@nicira.com>
Message-ID: <1429268072879.79506@supcom.tn>

Hello!
When I installed Open vSwitch version 2.0.2 instead of 2.3.1 version I got the OVS works with flowvisor.

What do you think the problem is? 

Thank you!
________________________________________
From: Ben Pfaff <blp at nicira.com>
Sent: Wednesday, April 15, 2015 4:19 PM
To: Amal KAMMOUN
Cc: discuss at openvswitch.org
Subject: Re: [ovs-discuss] Flowvisor stops when OVS is connected to it

On Wed, Apr 15, 2015 at 07:35:36AM +0000, Amal KAMMOUN wrote:
> I have 2 virtual machines (ubuntu using virtualbox).
>
> In the firt I installed OpenvSwitch and in the second I installed FlowVisor (I followed this link:  https://github.com/OPENNETWORKINGLAB/flowvisor/wiki/Installation-from-Binary ) .
>
>
> I run Flowvisor using this command: $ sudo -u flowvisor flowvisor?. But when I connect the switch to the FlowVisor (using set-controller), I get in FlowVisor: startup failed : null.
>
>
> How can I fix this problem?

This sounds much more like a FlowVisor question than an OVS question, so
I'd recommend asking about it on a FlowVisor mailing list, where you're
more likely to find knowledgeable people.

From devbabopol at gmail.com  Fri Apr 17 07:05:59 2015
From: devbabopol at gmail.com (YoungTae Noh)
Date: Fri, 17 Apr 2015 10:05:59 -0400
Subject: [ovs-discuss] Regarding where function pointers in
 netdev_class/tc_ops hook to their implementations?
In-Reply-To: <20150416153452.GF6941@nicira.com>
References: <CAJuiNqpUH2tqVzkMCX+VDirdkZb8qad4gdmSHXMmmk0LRk+67w@mail.gmail.com>
 <20150415160437.GE7003@nicira.com>
 <CAJuiNqqnGdfr-szSz_crtAi0A3F-xD6TBXRpx_4296cP7-5ofg@mail.gmail.com>
 <20150416153452.GF6941@nicira.com>
Message-ID: <CAJuiNqqbmjvV=kxZ8c9Boj5jHEVB6P2vh5_FtQZgeG+6oj+SMQ@mail.gmail.com>

Hi Ben and all,

Again many thanks for the prompt and sincere response.

Ben, I agree with your point that I need to add my qdics (queuing
discipline) below:

static const struct tc_ops *const tcs[] = {
    &tc_ops_htb,                /* Hierarchy token bucket (see tc-htb(8)). */
    &tc_ops_hfsc,               /* Hierarchical fair service curve. */
    &tc_ops_default,            /* Default qdisc (see tc-pfifo_fast(8)). */
    &tc_ops_other,              /* Some other qdisc. */
    [adding here],
    NULL
};

Then, add implementation "net/sched/sch_my_queue.c"  and attach it as
"sch_my_queue.ko" for fast path support. (out of scope for this
mailing list)

I also confirmed that communications between netdev-linux and linux
kernel (e.g., Ubuntu qdisc in my setting) are done by socket
communications (i.e., sendmsg & recvmsg) as a/multiple transactions
(e.g., nl_sock_transact_multiple__ in lib/netlink-socket.c file) I
think this suffice my original query. Please feel free to add your
thoughts/comments.

Thank you again and have a nice weekend!
YoungTae



On Thu, Apr 16, 2015 at 11:34 AM, Ben Pfaff <blp at nicira.com> wrote:
> On Wed, Apr 15, 2015 at 09:26:29PM -0400, YoungTae Noh wrote:
>> Hi Ben and all,
>>
>> Thank you for the quick turnaround. I believe my previous explanation
>> was not very clear.
>>
>> Here is my objective:
>> >> I would like to implement/manipulate queueing priority (possibly multiple queues per port in a shared memory) by user-definition.
>>
>> Please correct me if my understanding/approach is wrong.
>> To realize this - control this type of queue from OVS cmd (or controller),
>> 1. I need add expression for this type of queue in ovs-vsctl cmd (or
>> ovsdb client)
>> 2. add an option field (for this type of queue) in ovsdb
>> 3. ovs-vswitdhd dispatches it to  ofproto->netdev(lib)->netdev-linux
>> 4. extending netdev-linux to allocate&construct this queue in linux
>> kernel implementation ==> I believe I am standing here with the
>> question! (also not sure hooking is correct term here)
>> 5. extend queue & its management implementation (socket buffer in linux kernel)
>>
>> Here is a very specific example:
>> struct netdev_rxq *(*rxq_alloc)(void);
>>
>> This will allocate a queue for an interface (netdev) in user-sapce. I
>> believe this rxq_alloc will actually allocate a queue (FIFO) to a
>> physical/virtual port in linux kernel (socket buffer). I would like to
>> know which function is actually executed in kernel space and how they
>> are interacting each other.
>
> I think that you need to identify the Linux qdisc that implements the
> queuing priority that you want (or implement one, if none exists), then
> add support for that qdisc to netdev_linux.c, as a tc_ops.

From blp at nicira.com  Fri Apr 17 07:40:07 2015
From: blp at nicira.com (Ben Pfaff)
Date: Fri, 17 Apr 2015 07:40:07 -0700
Subject: [ovs-discuss] Flowvisor stops when OVS is connected to it
In-Reply-To: <1429268072879.79506@supcom.tn>
References: <1429083333426.38896@supcom.tn> <20150415161958.GG7003@nicira.com>
 <1429268072879.79506@supcom.tn>
Message-ID: <20150417144007.GC13444@nicira.com>

On Fri, Apr 17, 2015 at 10:54:36AM +0000, Amal KAMMOUN wrote:
> When I installed Open vSwitch version 2.0.2 instead of 2.3.1 version I got the OVS works with flowvisor.
> 
> What do you think the problem is? 

One significant difference is that 2.3.x enables OpenFlow 1.3 by
default.

Other than that, I don't have any idea.  You will have to debug it.

From blp at nicira.com  Fri Apr 17 07:42:59 2015
From: blp at nicira.com (Ben Pfaff)
Date: Fri, 17 Apr 2015 07:42:59 -0700
Subject: [ovs-discuss] Do you support Q-in-Q(802.1ad) or have any plans?
In-Reply-To: <488A2AA1A414284E972CE78B9336B48102BE0C3B@MAIL-MBX-04>
References: <488A2AA1A414284E972CE78B9336B48102BE0C3B@MAIL-MBX-04>
Message-ID: <20150417144259.GE13444@nicira.com>

On Fri, Apr 17, 2015 at 06:51:06AM +0000, �鱤��(Fraud-Call Control Projec) wrote:
> Do you support Q-in-Q(802.1ad) or have any plans?

No.  Patches were once submitted but I haven't seen any revisions.

From thomasfherbert at gmail.com  Fri Apr 17 08:29:07 2015
From: thomasfherbert at gmail.com (Thomas F Herbert)
Date: Fri, 17 Apr 2015 11:29:07 -0400
Subject: [ovs-discuss] Do you support Q-in-Q(802.1ad) or have any plans?
In-Reply-To: <20150417144259.GE13444@nicira.com>
References: <488A2AA1A414284E972CE78B9336B48102BE0C3B@MAIL-MBX-04>
 <20150417144259.GE13444@nicira.com>
Message-ID: <553126C3.7080608@gmail.com>

I expect to have V8 of the 802.1ad patch submitted within a few days.

--Tom

On 4/17/15 10:42 AM, Ben Pfaff wrote:
> On Fri, Apr 17, 2015 at 06:51:06AM +0000, �鱤��(Fraud-Call Control Projec) wrote:
>> Do you support Q-in-Q(802.1ad) or have any plans?
> No.  Patches were once submitted but I haven't seen any revisions.
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss


-- 
Thomas F. Herbert


From astgosen at ccu.edu.tw  Thu Apr 16 19:41:49 2015
From: astgosen at ccu.edu.tw (GosenChien-IMAP)
Date: Fri, 17 Apr 2015 10:41:49 +0800
Subject: [ovs-discuss] [installation problem] Installation of OVS 2.3.1
 from the tarball on Citrix Xen Server 6.5
In-Reply-To: <20150416155058.GI6941@nicira.com>
References: <552C87E3.7070104@ccu.edu.tw> <552D14FE.8020209@cs.ccu.edu.tw>
 <20150415025248.GE12976@nicira.com> <552DD78A.7040003@ccu.edu.tw>
 <20150415031414.GG12976@nicira.com> <552E0262.4010801@ccu.edu.tw>
 <20150415151554.GC7003@nicira.com> <552F2C73.70305@ccu.edu.tw>
 <20150416150918.GB6941@nicira.com> <552FD8B0.2070104@cs.ccu.edu.tw>
 <20150416155058.GI6941@nicira.com>
Message-ID: <553072ED.40201@ccu.edu.tw>

All :

Below is the output log after using the instruction to build the RPM 
packages:

--------------------------------------------------------------------------
[Steps]
1. Left the openvswitch-xen.spec without any changes;
2. Enter <ovs folder>/xenserver/ directory;
3. Issue the command of rpmbuild :
  > *rpmbuild -bb openvswitch-xen.spec -D "openvswitch_version 2.3.1" -D 
"kernel_name xen" -D "kernel_version 3.10.0+2" -D "xen_version 
4.4.1-1.9.0.459.28798*

[Result]
1. Output--
Executing (%prep)：/bin/sh -e /var/tmp/rpm-tmp.34945
Executing (%build)：/bin/sh -e /var/tmp/rpm-tmp.16395
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... /bin/mkdir -p
checking for gawk... gawk
checking whether make sets $(MAKE)... yes
checking for gcc... gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables...
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ISO C89... none needed
checking for style of include used by make... GNU
checking dependency style of gcc... gcc3
checking whether gcc and cc understand -c and -o together... yes
checking how to run the C preprocessor... gcc -E
checking for grep that handles long lines and -e... /bin/grep
checking for fgrep... /bin/grep -F
checking for egrep... /bin/grep -E
checking for perl... /usr/bin/perl
checking for ANSI C header files... yes
checking for sys/types.h... yes
checking for sys/stat.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for memory.h... yes
checking for strings.h... yes
checking for inttypes.h... yes
checking for stdint.h... yes
checking for unistd.h... yes
checking minix/config.h usability... no
checking minix/config.h presence... no
checking for minix/config.h... no
checking whether it is safe to define __EXTENSIONS__... yes
checking whether byte ordering is bigendian... no
checking for special C compiler options needed for large files... no
checking for _FILE_OFFSET_BITS value needed for large files... no
checking build system type... x86_64-unknown-linux-gnu
checking host system type... x86_64-unknown-linux-gnu
checking how to print strings... printf
checking for a sed that does not truncate output... /bin/sed
checking for ld used by gcc... /usr/bin/ld
checking if the linker (/usr/bin/ld) is GNU ld... yes
checking for BSD- or MS-compatible name lister (nm)... /usr/bin/nm -B
checking the name lister (/usr/bin/nm -B) interface... BSD nm
checking whether ln -s works... yes
checking the maximum length of command line arguments... 98304
checking whether the shell understands some XSI constructs... yes
checking whether the shell understands "+="... yes
checking how to convert x86_64-unknown-linux-gnu file names to 
x86_64-unknown-linux-gnu format... func_convert_file_noop
checking how to convert x86_64-unknown-linux-gnu file names to toolchain 
format... func_convert_file_noop
checking for /usr/bin/ld option to reload object files... -r
checking for objdump... objdump
checking how to recognize dependent libraries... pass_all
checking for dlltool... no
checking how to associate runtime and link libraries... printf %s\n
checking for ar... ar
checking for archiver @FILE support... @
checking for strip... strip
checking for ranlib... ranlib
checking command to parse /usr/bin/nm -B output from gcc object... ok
checking for sysroot... no
checking for mt... no
checking if : is a manifest tool... no
checking for dlfcn.h... yes
checking for objdir... .libs
checking if gcc supports -fno-rtti -fno-exceptions... no
checking for gcc option to produce PIC... -fPIC -DPIC
checking if gcc PIC flag -fPIC -DPIC works... yes
checking if gcc static flag -static works... yes
checking if gcc supports -c -o file.o... yes
checking if gcc supports -c -o file.o... (cached) yes
checking whether the gcc linker (/usr/bin/ld -m elf_x86_64) supports 
shared libraries... yes
checking dynamic linker characteristics... GNU/Linux ld.so
checking how to hardcode library paths into programs... immediate
checking whether stripping libraries is possible... yes
checking if libtool supports shared libraries... yes
checking whether to build shared libraries... no
checking whether to build static libraries... yes
checking for library containing pow... -lm
checking for library containing clock_gettime... -lrt
checking for library containing timer_create... none required
checking for library containing pthread_sigmask... none required
checking whether strerror_r is declared... yes
checking for strerror_r... yes
checking whether strerror_r returns char *... yes
checking vmware.h usability... no
checking vmware.h presence... no
checking for vmware.h... no
checking windows.h usability... no
checking windows.h presence... no
checking for windows.h... no
checking for linux/netlink.h... yes
checking for pkg-config... /usr/bin/pkg-config
checking whether compiling and linking against OpenSSL works... yes
checking for Python 2.x for x >= 4... /usr/bin/python
checking for uuid Python module... no
checking whether to add python/compat to PYTHONPATH... yes
checking for dot... no
checking net/if_packet.h usability... yes
checking net/if_packet.h presence... yes
checking for net/if_packet.h... yes
checking net/if_dl.h usability... no
checking net/if_dl.h presence... no
checking for net/if_dl.h... no
checking whether strtok_r macro segfaults on some inputs... yes
checking whether sys_siglist is declared... yes
checking for struct stat.st_mtim.tv_nsec... yes
checking for struct stat.st_mtimensec... no
checking for struct ifreq.ifr_flagshigh... no
checking for mlockall... yes
checking for strnlen... yes
checking for getloadavg... yes
checking for statvfs... yes
checking for getmntent_r... yes
checking mntent.h usability... yes
checking mntent.h presence... yes
checking for mntent.h... yes
checking sys/statvfs.h usability... yes
checking sys/statvfs.h presence... yes
checking for sys/statvfs.h... yes
checking linux/types.h usability... yes
checking linux/types.h presence... yes
checking for linux/types.h... yes
checking linux/if_ether.h usability... yes
checking linux/if_ether.h presence... yes
checking for linux/if_ether.h... yes
checking stdatomic.h usability... no
checking stdatomic.h presence... no
checking for stdatomic.h... no
checking for net/if_mib.h... no
checking for library containing backtrace... none required
checking whether libc supports hooks for malloc and related functions... yes
checking valgrind/valgrind.h usability... no
checking valgrind/valgrind.h presence... no
checking for valgrind/valgrind.h... no
checking for connect in -lsocket... no
checking for library containing gethostbyname... none required
checking XenServer release... 6.5.0
checking for groff... yes
checking whether make is GNU make... yes
checking whether gcc has <threads.h> that supports thread_local... no
checking whether gcc supports __thread... yes
checking for library containing __atomic_load_8... no
checking whether gcc supports GCC 4.0+ atomic built-ins... yes
checking value of __atomic_always_lock_free(1)... unsupported
checking value of __atomic_always_lock_free(2)... unsupported
checking value of __atomic_always_lock_free(4)... unsupported
checking value of __atomic_always_lock_free(8)... unsupported
checking for library containing aio_write... none required
checking for pthread_set_name_np... no
checking for pthread_setname_np() variant... none
checking whether __linux__ is defined... true
checking for working posix_memalign... yes
checking whether the preprocessor supports include_next... yes
checking whether system header files limit the line length... no
checking for stdio.h... yes
checking for string.h... (cached) yes
checking whether gcc accepts -Werror... yes
checking whether gcc accepts -Wall... yes
checking whether gcc accepts -Wextra... yes
checking whether gcc accepts -Wno-sign-compare... yes
checking whether gcc accepts -Wpointer-arith... yes
checking whether gcc accepts -Wdeclaration-after-statement... yes
checking whether gcc accepts -Wformat-security... no
checking whether gcc accepts -Wno-format-zero-length... yes
checking whether gcc accepts -Wswitch-enum... yes
checking whether gcc accepts -Wunused-parameter... yes
checking whether gcc accepts -Wstrict-aliasing... yes
checking whether gcc accepts -Wbad-function-cast... yes
checking whether gcc accepts -Wcast-align... yes
checking whether gcc accepts -Wstrict-prototypes... no
checking whether gcc accepts -Wold-style-definition... no
checking whether gcc accepts -Wmissing-prototypes... yes
checking whether gcc accepts -Wmissing-field-initializers... yes
checking whether gcc accepts -Wthread-safety... no
checking whether gcc accepts -Wno-unused... yes
checking whether gcc accepts -Wno-unused-parameter... yes
checking target hint for cgcc... x86_64
checking whether make has GNU make $(if) extension... yes
checking for Linux build directory... no
*configure: error: source dir 
/lib/modules/3.10.0+2%{kernel_flavor}/build doesn't exist*

2. We found that the program still couldn't find the target folder : 
/lib/modules/*3.10.0+2%{kernel_flavor}*/build

--------------------------------------------------------------------------

It seems that the main problem is still the same.
Any suggestion is welcome. :-)

Best Regards,
             Gosen Chien
*************************************
CCU CS Project assistant
No.168, Sec. 1, University Rd., Min-Hsiung Township, Chia-yi County 62102, Taiwan
TEL: (05)272-0411#23134
E-mail:astgosen at ccu.edu.tw  <mailto:astgosen at ccu.edu.tw>
        astgosen at novatw.info  <mailto:astgosen at novatw.info>

Ben Pfaff 於 西元2015年04月16日 23:50 寫道:
> I don't think the complete program would be helpful; it's part of a
> largish internal build system.
>
> There is no particular "buildnum"; we use an incrementing build number
> internally to identify particular builds.  You can omit it.
>
> On Thu, Apr 16, 2015 at 11:43:44PM +0800, Po-Ching Lin wrote:
>> Dear Ben,
>>
>>          Thank you very much for the information.
>>
>>          The following piece of code seems to be part of a Python program. Would you
>> mind providing us the complete program? Although we can "run" the program in our
>> minds, the values of some variables are still missing, such as ovs_spec,rpmbuilddir
>> and setarch. By the way, where can we find the buildnum for the stable openvswitch-2.3.1
>> tarball? Sorry for more questions. Any help will be greatly appreciated.
>>
>> Best regards,
>> Po-Ching
>>
>> Ben Pfaff On 2015/4/16 下午 11:09 wrote:
>>> Here's what we use for XenServer 6.5 and other 64-bit versions of
>>> XenServer:
>>>
>>>                  kernel_name = 'xen'
>>>                  cmd = "rpm -qa | grep kernel-devel"
>>>                  output = self.get_output_from_command(cmd)
>>>                  kernel_version = re.sub('.*-devel-', '', output)
>>>                  # Get the build symlink in /lib/modules from
>>>                  # kernel-devel file list for xen_version
>>>                  cmd = "rpm -ql kernel-devel | grep 'lib/modules' | head -1"
>>>                  output = self.get_output_from_command(cmd)
>>>                  xen_version = re.sub('/lib/modules/', '',
>>>                                       re.sub('/build', '', output))
>>>
>>>                  ovsver = "-D \"openvswitch_version %s.%s\"" % (version,
>>>                                                                 buildnum)
>>>                  kname = "-D \"kernel_name %s\"" % kernel_name
>>>                  kver = "-D \"kernel_version %s\"" % kernel_version
>>>                  xver = "-D \"xen_version %s\"" % xen_version
>>>                  spec = "-bb %s/SPECS/%s" % (rpmbuilddir, ovs_spec)
>>>                  spec_opts = "%s %s %s %s %s" % (ovsver, kname, kver,
>>>                                                  xver, spec)
>>>
>>>                  cmd = "%s rpmbuild %s" % (setarch, spec_opts)
>>>                  self.run_command(cmd, halt_on_failure=True)
>>>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150417/c47b5eb3/attachment-0001.html>

From ashujain9727 at gmail.com  Thu Apr 16 21:25:11 2015
From: ashujain9727 at gmail.com (abhishek jain)
Date: Fri, 17 Apr 2015 09:55:11 +0530
Subject: [ovs-discuss] configure OVS remotely
In-Reply-To: <20150416232806.GA16575@nicira.com>
References: <CA+9-LvuJyDVg8a76p8XTOH6NsE+bvpqqAp2F-m6CJppH-7n5jg@mail.gmail.com>
 <20150416232806.GA16575@nicira.com>
Message-ID: <CA+9-LvsShe_YUuSE+LR5ztSsx+7j7vmLLW=hqcuDDQXtqeu_mg@mail.gmail.com>

Thanks Ben.I'll  try this and let you know.

On Fri, Apr 17, 2015 at 4:58 AM, Ben Pfaff <blp at nicira.com> wrote:

> On Thu, Apr 16, 2015 at 06:31:31PM +0530, abhishek jain wrote:
> > I need to configure QOS queues on  Openvswitch from remote system.The OVS
> > is connected to SDN controller.Please help me regarding this.
>
> Configure the ovsdb-server to talk to your remote system.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150417/d0a963d6/attachment-0001.html>

From pclin at cs.ccu.edu.tw  Fri Apr 17 07:24:33 2015
From: pclin at cs.ccu.edu.tw (Po-Ching Lin)
Date: Fri, 17 Apr 2015 22:24:33 +0800
Subject: [ovs-discuss] [installation problem] Installation of OVS 2.3.1
 from the tarball on Citrix Xen Server 6.5
In-Reply-To: <553072ED.40201@ccu.edu.tw>
References: <552C87E3.7070104@ccu.edu.tw> <552D14FE.8020209@cs.ccu.edu.tw>
 <20150415025248.GE12976@nicira.com> <552DD78A.7040003@ccu.edu.tw>
 <20150415031414.GG12976@nicira.com> <552E0262.4010801@ccu.edu.tw>
 <20150415151554.GC7003@nicira.com> <552F2C73.70305@ccu.edu.tw>
 <20150416150918.GB6941@nicira.com> <552FD8B0.2070104@cs.ccu.edu.tw>
 <20150416155058.GI6941@nicira.com> <553072ED.40201@ccu.edu.tw>
Message-ID: <553117A1.1000107@cs.ccu.edu.tw>

Dear Ben,

       We specified kernel_flavor to be xen before, but rpmbuild simply complained
that source dir /lib/modules/3.10.0+2xen/build doesn't exist. We
don't specify kernel_flavor this time, but it seems that the variable kernel_flavor
is left in the path name. According to INSTALL.XenServer, xen is the choice for
kernel_flavor, but we don't have that directory under /lib/modules, so the error
happened. We run the rpmbuild command on DDK VM. Is that correct, or should we
manully create that directory under /lib/modules? Any suggestions are appreciated.
Thanks.

Po-Ching

GosenChien-IMAP 於 2015/4/17 上午 10:41 寫道:
> All :
>
> Below is the output log after using the instruction to build the RPM packages:
>
> --------------------------------------------------------------------------
> [Steps]
> 1. Left the openvswitch-xen.spec without any changes;
> 2. Enter <ovs folder>/xenserver/ directory;
> 3. Issue the command of rpmbuild :
>  > *rpmbuild -bb openvswitch-xen.spec -D "openvswitch_version 2.3.1" -D "kernel_name xen" -D "kernel_version 3.10.0+2" -D "xen_version 4.4.1-1.9.0.459.28798*
>
> [Result]
> 1. Output--
> Executing (%prep)：/bin/sh -e /var/tmp/rpm-tmp.34945
> Executing (%build)：/bin/sh -e /var/tmp/rpm-tmp.16395
> checking for a BSD-compatible install... /usr/bin/install -c
> checking whether build environment is sane... yes
> checking for a thread-safe mkdir -p... /bin/mkdir -p
> checking for gawk... gawk
> checking whether make sets $(MAKE)... yes
> checking for gcc... gcc
> checking whether the C compiler works... yes
> checking for C compiler default output file name... a.out
> checking for suffix of executables...
> checking whether we are cross compiling... no
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc accepts -g... yes
> checking for gcc option to accept ISO C89... none needed
> checking for style of include used by make... GNU
> checking dependency style of gcc... gcc3
> checking whether gcc and cc understand -c and -o together... yes
> checking how to run the C preprocessor... gcc -E
> checking for grep that handles long lines and -e... /bin/grep
> checking for fgrep... /bin/grep -F
> checking for egrep... /bin/grep -E
> checking for perl... /usr/bin/perl
> checking for ANSI C header files... yes
> checking for sys/types.h... yes
> checking for sys/stat.h... yes
> checking for stdlib.h... yes
> checking for string.h... yes
> checking for memory.h... yes
> checking for strings.h... yes
> checking for inttypes.h... yes
> checking for stdint.h... yes
> checking for unistd.h... yes
> checking minix/config.h usability... no
> checking minix/config.h presence... no
> checking for minix/config.h... no
> checking whether it is safe to define __EXTENSIONS__... yes
> checking whether byte ordering is bigendian... no
> checking for special C compiler options needed for large files... no
> checking for _FILE_OFFSET_BITS value needed for large files... no
> checking build system type... x86_64-unknown-linux-gnu
> checking host system type... x86_64-unknown-linux-gnu
> checking how to print strings... printf
> checking for a sed that does not truncate output... /bin/sed
> checking for ld used by gcc... /usr/bin/ld
> checking if the linker (/usr/bin/ld) is GNU ld... yes
> checking for BSD- or MS-compatible name lister (nm)... /usr/bin/nm -B
> checking the name lister (/usr/bin/nm -B) interface... BSD nm
> checking whether ln -s works... yes
> checking the maximum length of command line arguments... 98304
> checking whether the shell understands some XSI constructs... yes
> checking whether the shell understands "+="... yes
> checking how to convert x86_64-unknown-linux-gnu file names to x86_64-unknown-linux-gnu format... func_convert_file_noop
> checking how to convert x86_64-unknown-linux-gnu file names to toolchain format... func_convert_file_noop
> checking for /usr/bin/ld option to reload object files... -r
> checking for objdump... objdump
> checking how to recognize dependent libraries... pass_all
> checking for dlltool... no
> checking how to associate runtime and link libraries... printf %s\n
> checking for ar... ar
> checking for archiver @FILE support... @
> checking for strip... strip
> checking for ranlib... ranlib
> checking command to parse /usr/bin/nm -B output from gcc object... ok
> checking for sysroot... no
> checking for mt... no
> checking if : is a manifest tool... no
> checking for dlfcn.h... yes
> checking for objdir... .libs
> checking if gcc supports -fno-rtti -fno-exceptions... no
> checking for gcc option to produce PIC... -fPIC -DPIC
> checking if gcc PIC flag -fPIC -DPIC works... yes
> checking if gcc static flag -static works... yes
> checking if gcc supports -c -o file.o... yes
> checking if gcc supports -c -o file.o... (cached) yes
> checking whether the gcc linker (/usr/bin/ld -m elf_x86_64) supports shared libraries... yes
> checking dynamic linker characteristics... GNU/Linux ld.so
> checking how to hardcode library paths into programs... immediate
> checking whether stripping libraries is possible... yes
> checking if libtool supports shared libraries... yes
> checking whether to build shared libraries... no
> checking whether to build static libraries... yes
> checking for library containing pow... -lm
> checking for library containing clock_gettime... -lrt
> checking for library containing timer_create... none required
> checking for library containing pthread_sigmask... none required
> checking whether strerror_r is declared... yes
> checking for strerror_r... yes
> checking whether strerror_r returns char *... yes
> checking vmware.h usability... no
> checking vmware.h presence... no
> checking for vmware.h... no
> checking windows.h usability... no
> checking windows.h presence... no
> checking for windows.h... no
> checking for linux/netlink.h... yes
> checking for pkg-config... /usr/bin/pkg-config
> checking whether compiling and linking against OpenSSL works... yes
> checking for Python 2.x for x >= 4... /usr/bin/python
> checking for uuid Python module... no
> checking whether to add python/compat to PYTHONPATH... yes
> checking for dot... no
> checking net/if_packet.h usability... yes
> checking net/if_packet.h presence... yes
> checking for net/if_packet.h... yes
> checking net/if_dl.h usability... no
> checking net/if_dl.h presence... no
> checking for net/if_dl.h... no
> checking whether strtok_r macro segfaults on some inputs... yes
> checking whether sys_siglist is declared... yes
> checking for struct stat.st_mtim.tv_nsec... yes
> checking for struct stat.st_mtimensec... no
> checking for struct ifreq.ifr_flagshigh... no
> checking for mlockall... yes
> checking for strnlen... yes
> checking for getloadavg... yes
> checking for statvfs... yes
> checking for getmntent_r... yes
> checking mntent.h usability... yes
> checking mntent.h presence... yes
> checking for mntent.h... yes
> checking sys/statvfs.h usability... yes
> checking sys/statvfs.h presence... yes
> checking for sys/statvfs.h... yes
> checking linux/types.h usability... yes
> checking linux/types.h presence... yes
> checking for linux/types.h... yes
> checking linux/if_ether.h usability... yes
> checking linux/if_ether.h presence... yes
> checking for linux/if_ether.h... yes
> checking stdatomic.h usability... no
> checking stdatomic.h presence... no
> checking for stdatomic.h... no
> checking for net/if_mib.h... no
> checking for library containing backtrace... none required
> checking whether libc supports hooks for malloc and related functions... yes
> checking valgrind/valgrind.h usability... no
> checking valgrind/valgrind.h presence... no
> checking for valgrind/valgrind.h... no
> checking for connect in -lsocket... no
> checking for library containing gethostbyname... none required
> checking XenServer release... 6.5.0
> checking for groff... yes
> checking whether make is GNU make... yes
> checking whether gcc has <threads.h> that supports thread_local... no
> checking whether gcc supports __thread... yes
> checking for library containing __atomic_load_8... no
> checking whether gcc supports GCC 4.0+ atomic built-ins... yes
> checking value of __atomic_always_lock_free(1)... unsupported
> checking value of __atomic_always_lock_free(2)... unsupported
> checking value of __atomic_always_lock_free(4)... unsupported
> checking value of __atomic_always_lock_free(8)... unsupported
> checking for library containing aio_write... none required
> checking for pthread_set_name_np... no
> checking for pthread_setname_np() variant... none
> checking whether __linux__ is defined... true
> checking for working posix_memalign... yes
> checking whether the preprocessor supports include_next... yes
> checking whether system header files limit the line length... no
> checking for stdio.h... yes
> checking for string.h... (cached) yes
> checking whether gcc accepts -Werror... yes
> checking whether gcc accepts -Wall... yes
> checking whether gcc accepts -Wextra... yes
> checking whether gcc accepts -Wno-sign-compare... yes
> checking whether gcc accepts -Wpointer-arith... yes
> checking whether gcc accepts -Wdeclaration-after-statement... yes
> checking whether gcc accepts -Wformat-security... no
> checking whether gcc accepts -Wno-format-zero-length... yes
> checking whether gcc accepts -Wswitch-enum... yes
> checking whether gcc accepts -Wunused-parameter... yes
> checking whether gcc accepts -Wstrict-aliasing... yes
> checking whether gcc accepts -Wbad-function-cast... yes
> checking whether gcc accepts -Wcast-align... yes
> checking whether gcc accepts -Wstrict-prototypes... no
> checking whether gcc accepts -Wold-style-definition... no
> checking whether gcc accepts -Wmissing-prototypes... yes
> checking whether gcc accepts -Wmissing-field-initializers... yes
> checking whether gcc accepts -Wthread-safety... no
> checking whether gcc accepts -Wno-unused... yes
> checking whether gcc accepts -Wno-unused-parameter... yes
> checking target hint for cgcc... x86_64
> checking whether make has GNU make $(if) extension... yes
> checking for Linux build directory... no
> *configure: error: source dir /lib/modules/3.10.0+2%{kernel_flavor}/build doesn't exist*
>
> 2. We found that the program still couldn't find the target folder : /lib/modules/*3.10.0+2%{kernel_flavor}*/build
>
> --------------------------------------------------------------------------
>
> It seems that the main problem is still the same.
> Any suggestion is welcome. :-)
>
> Best Regards,
>              Gosen Chien
> *************************************
> CCU CS Project assistant
> No.168, Sec. 1, University Rd., Min-Hsiung Township, Chia-yi County 62102, Taiwan
> TEL: (05)272-0411#23134
> E-mail:astgosen at ccu.edu.tw  <mailto:astgosen at ccu.edu.tw>
>         astgosen at novatw.info  <mailto:astgosen at novatw.info>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150417/241226f7/attachment-0001.html>

From blp at nicira.com  Fri Apr 17 10:17:22 2015
From: blp at nicira.com (Ben Pfaff)
Date: Fri, 17 Apr 2015 10:17:22 -0700
Subject: [ovs-discuss] Flowvisor stops when OVS is connected to it
In-Reply-To: <CADmMkWcts44wS6cnO7T60ZLQShExV82VRP6S=rQW6ENvKxgGdA@mail.gmail.com>
References: <1429083333426.38896@supcom.tn> <20150415161958.GG7003@nicira.com>
 <1429268072879.79506@supcom.tn>
 <CADmMkWcts44wS6cnO7T60ZLQShExV82VRP6S=rQW6ENvKxgGdA@mail.gmail.com>
Message-ID: <20150417171722.GB8247@nicira.com>

On Fri, Apr 17, 2015 at 07:09:51AM -1000, Nicholas Bastin wrote:
> On Fri, Apr 17, 2015 at 12:54 AM, Amal KAMMOUN <amal.kammoun at supcom.tn>
> wrote:
> 
> > When I installed Open vSwitch version 2.0.2 instead of 2.3.1 version I got
> > the OVS works with flowvisor.
> >
> 
> FlowVisor doesn't know anything about OpenFlow versions after 1.0, and will
> crash if it receives a connection request from a non-1.0 datapath.

Amal: In that case the fix is easy.  You just configure OVS to only
use OF1.0.  The FAQ shows how:

### Q: What versions of OpenFlow does Open vSwitch support?

A: The following table lists the versions of OpenFlow supported by
   each version of Open vSwitch:

       Open vSwitch      OF1.0  OF1.1  OF1.2  OF1.3  OF1.4  OF1.5
       ###============   =====  =====  =====  =====  =====  =====
       1.9 and earlier    yes    ---    ---    ---    ---    ---
       1.10               yes    ---    [*]    [*]    ---    ---
       1.11               yes    ---    [*]    [*]    ---    ---
       2.0                yes    [*]    [*]    [*]    ---    ---
       2.1                yes    [*]    [*]    [*]    ---    ---
       2.2                yes    [*]    [*]    [*]    [%]    [*]
       2.3                yes    yes    yes    yes    [*]    [*]

       [*] Supported, with one or more missing features.
       [%] Experimental, unsafe implementation.

   Open vSwitch 2.3 enables OpenFlow 1.0, 1.1, 1.2, and 1.3 by default
   in ovs-vswitchd.  In Open vSwitch 1.10 through 2.2, OpenFlow 1.1,
   1.2, and 1.3 must be enabled manually in ovs-vswitchd.  OpenFlow
   1.4 and 1.5 are also supported, with missing features, in Open
   vSwitch 2.3 and later, but not enabled by default.  In any case,
   the user may override the default:

   - To enable OpenFlow 1.0, 1.1, 1.2, and 1.3 on bridge br0:

     ovs-vsctl set bridge br0 protocols=OpenFlow10,OpenFlow11,OpenFlow12,OpenFlow13

   - To enable OpenFlow 1.0, 1.1, 1.2, 1.3, 1.4, and 1.5 on bridge br0:

     ovs-vsctl set bridge br0 protocols=OpenFlow10,OpenFlow11,OpenFlow12,OpenFlow13,OpenFlow14,OpenFlow15

   - To enable only OpenFlow 1.0 on bridge br0:

     ovs-vsctl set bridge br0 protocols=OpenFlow10

   All current versions of ovs-ofctl enable only OpenFlow 1.0 by
   default.  Use the -O option to enable support for later versions of
   OpenFlow in ovs-ofctl.  For example:

       ovs-ofctl -O OpenFlow13 dump-flows br0

   (Open vSwitch 2.2 had an experimental implementation of OpenFlow
   1.4 that could cause crashes.  We don't recommend enabling it.)

   [OPENFLOW-1.1+.md] in the Open vSwitch source tree tracks support for
   OpenFlow 1.1 and later features.  When support for OpenFlow 1.4 and
   1.5 is solidly implemented, Open vSwitch will enable those version
   by default.  Also, the OpenFlow 1.5 specification is still under
   development and thus subject to change.

From nick.bastin at gmail.com  Fri Apr 17 10:09:51 2015
From: nick.bastin at gmail.com (Nicholas Bastin)
Date: Fri, 17 Apr 2015 07:09:51 -1000
Subject: [ovs-discuss] Flowvisor stops when OVS is connected to it
In-Reply-To: <1429268072879.79506@supcom.tn>
References: <1429083333426.38896@supcom.tn> <20150415161958.GG7003@nicira.com>
 <1429268072879.79506@supcom.tn>
Message-ID: <CADmMkWcts44wS6cnO7T60ZLQShExV82VRP6S=rQW6ENvKxgGdA@mail.gmail.com>

On Fri, Apr 17, 2015 at 12:54 AM, Amal KAMMOUN <amal.kammoun at supcom.tn>
wrote:

> When I installed Open vSwitch version 2.0.2 instead of 2.3.1 version I got
> the OVS works with flowvisor.
>

FlowVisor doesn't know anything about OpenFlow versions after 1.0, and will
crash if it receives a connection request from a non-1.0 datapath.

--
Nick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150417/7624edc7/attachment.html>

From ebiken.g at gmail.com  Fri Apr 17 15:01:46 2015
From: ebiken.g at gmail.com (Kentaro Ebisawa)
Date: Fri, 17 Apr 2015 22:01:46 +0000
Subject: [ovs-discuss] burst_size=port?
Message-ID: <emc12570e7-48cb-48cd-adb4-ae1afd8a80c8@ebiken-desktop>

Hi,

In ovs-ofctl man page, Meter Syntax, there is description 
"burst_size=port".

Are there any reason "port" is used instead of "size" while it will only 
take kilobits or packets ?
Or is it just a typo which should be fixed?

http://openvswitch.org/support/dist-docs/ovs-ofctl.8.txt
https://github.com/openvswitch/ovs/blob/master/utilities/ovs-ofctl.8.in

--
Kentaro Ebisawa <ebiken.g at gmail.com>


From blp at nicira.com  Fri Apr 17 15:27:26 2015
From: blp at nicira.com (Ben Pfaff)
Date: Fri, 17 Apr 2015 15:27:26 -0700
Subject: [ovs-discuss] [installation problem] Installation of OVS 2.3.1
 from the tarball on Citrix Xen Server 6.5
In-Reply-To: <553117A1.1000107@cs.ccu.edu.tw>
References: <552DD78A.7040003@ccu.edu.tw> <20150415031414.GG12976@nicira.com>
 <552E0262.4010801@ccu.edu.tw> <20150415151554.GC7003@nicira.com>
 <552F2C73.70305@ccu.edu.tw> <20150416150918.GB6941@nicira.com>
 <552FD8B0.2070104@cs.ccu.edu.tw> <20150416155058.GI6941@nicira.com>
 <553072ED.40201@ccu.edu.tw> <553117A1.1000107@cs.ccu.edu.tw>
Message-ID: <20150417222726.GE8247@nicira.com>

Really this thread reads as you repeatedly changing things randomly in
the hopes that it will work.  I suggest that a more systematic
approach is more likely to work.  When it does, if the documentation
is wrong or misleading, please explain, and we'll improve it.

On Fri, Apr 17, 2015 at 10:24:33PM +0800, Po-Ching Lin wrote:
> Dear Ben,
> 
>       We specified kernel_flavor to be xen before, but rpmbuild simply complained
> that source dir /lib/modules/3.10.0+2xen/build doesn't exist. We
> don't specify kernel_flavor this time, but it seems that the variable kernel_flavor
> is left in the path name. According to INSTALL.XenServer, xen is the choice for
> kernel_flavor, but we don't have that directory under /lib/modules, so the error
> happened. We run the rpmbuild command on DDK VM. Is that correct, or should we
> manully create that directory under /lib/modules? Any suggestions are appreciated.
> Thanks.
> 
> Po-Ching
> 
> GosenChien-IMAP ??? 2015/4/17 ?????? 10:41 ??????:
> >All :
> >
> >Below is the output log after using the instruction to build the RPM packages:
> >
> >--------------------------------------------------------------------------
> >[Steps]
> >1. Left the openvswitch-xen.spec without any changes;
> >2. Enter <ovs folder>/xenserver/ directory;
> >3. Issue the command of rpmbuild :
> > > *rpmbuild -bb openvswitch-xen.spec -D "openvswitch_version 2.3.1" -D "kernel_name xen" -D "kernel_version 3.10.0+2" -D "xen_version 4.4.1-1.9.0.459.28798*
> >
> >[Result]
> >1. Output--
> >Executing (%prep)???/bin/sh -e /var/tmp/rpm-tmp.34945
> >Executing (%build)???/bin/sh -e /var/tmp/rpm-tmp.16395
> >checking for a BSD-compatible install... /usr/bin/install -c
> >checking whether build environment is sane... yes
> >checking for a thread-safe mkdir -p... /bin/mkdir -p
> >checking for gawk... gawk
> >checking whether make sets $(MAKE)... yes
> >checking for gcc... gcc
> >checking whether the C compiler works... yes
> >checking for C compiler default output file name... a.out
> >checking for suffix of executables...
> >checking whether we are cross compiling... no
> >checking for suffix of object files... o
> >checking whether we are using the GNU C compiler... yes
> >checking whether gcc accepts -g... yes
> >checking for gcc option to accept ISO C89... none needed
> >checking for style of include used by make... GNU
> >checking dependency style of gcc... gcc3
> >checking whether gcc and cc understand -c and -o together... yes
> >checking how to run the C preprocessor... gcc -E
> >checking for grep that handles long lines and -e... /bin/grep
> >checking for fgrep... /bin/grep -F
> >checking for egrep... /bin/grep -E
> >checking for perl... /usr/bin/perl
> >checking for ANSI C header files... yes
> >checking for sys/types.h... yes
> >checking for sys/stat.h... yes
> >checking for stdlib.h... yes
> >checking for string.h... yes
> >checking for memory.h... yes
> >checking for strings.h... yes
> >checking for inttypes.h... yes
> >checking for stdint.h... yes
> >checking for unistd.h... yes
> >checking minix/config.h usability... no
> >checking minix/config.h presence... no
> >checking for minix/config.h... no
> >checking whether it is safe to define __EXTENSIONS__... yes
> >checking whether byte ordering is bigendian... no
> >checking for special C compiler options needed for large files... no
> >checking for _FILE_OFFSET_BITS value needed for large files... no
> >checking build system type... x86_64-unknown-linux-gnu
> >checking host system type... x86_64-unknown-linux-gnu
> >checking how to print strings... printf
> >checking for a sed that does not truncate output... /bin/sed
> >checking for ld used by gcc... /usr/bin/ld
> >checking if the linker (/usr/bin/ld) is GNU ld... yes
> >checking for BSD- or MS-compatible name lister (nm)... /usr/bin/nm -B
> >checking the name lister (/usr/bin/nm -B) interface... BSD nm
> >checking whether ln -s works... yes
> >checking the maximum length of command line arguments... 98304
> >checking whether the shell understands some XSI constructs... yes
> >checking whether the shell understands "+="... yes
> >checking how to convert x86_64-unknown-linux-gnu file names to x86_64-unknown-linux-gnu format... func_convert_file_noop
> >checking how to convert x86_64-unknown-linux-gnu file names to toolchain format... func_convert_file_noop
> >checking for /usr/bin/ld option to reload object files... -r
> >checking for objdump... objdump
> >checking how to recognize dependent libraries... pass_all
> >checking for dlltool... no
> >checking how to associate runtime and link libraries... printf %s\n
> >checking for ar... ar
> >checking for archiver @FILE support... @
> >checking for strip... strip
> >checking for ranlib... ranlib
> >checking command to parse /usr/bin/nm -B output from gcc object... ok
> >checking for sysroot... no
> >checking for mt... no
> >checking if : is a manifest tool... no
> >checking for dlfcn.h... yes
> >checking for objdir... .libs
> >checking if gcc supports -fno-rtti -fno-exceptions... no
> >checking for gcc option to produce PIC... -fPIC -DPIC
> >checking if gcc PIC flag -fPIC -DPIC works... yes
> >checking if gcc static flag -static works... yes
> >checking if gcc supports -c -o file.o... yes
> >checking if gcc supports -c -o file.o... (cached) yes
> >checking whether the gcc linker (/usr/bin/ld -m elf_x86_64) supports shared libraries... yes
> >checking dynamic linker characteristics... GNU/Linux ld.so
> >checking how to hardcode library paths into programs... immediate
> >checking whether stripping libraries is possible... yes
> >checking if libtool supports shared libraries... yes
> >checking whether to build shared libraries... no
> >checking whether to build static libraries... yes
> >checking for library containing pow... -lm
> >checking for library containing clock_gettime... -lrt
> >checking for library containing timer_create... none required
> >checking for library containing pthread_sigmask... none required
> >checking whether strerror_r is declared... yes
> >checking for strerror_r... yes
> >checking whether strerror_r returns char *... yes
> >checking vmware.h usability... no
> >checking vmware.h presence... no
> >checking for vmware.h... no
> >checking windows.h usability... no
> >checking windows.h presence... no
> >checking for windows.h... no
> >checking for linux/netlink.h... yes
> >checking for pkg-config... /usr/bin/pkg-config
> >checking whether compiling and linking against OpenSSL works... yes
> >checking for Python 2.x for x >= 4... /usr/bin/python
> >checking for uuid Python module... no
> >checking whether to add python/compat to PYTHONPATH... yes
> >checking for dot... no
> >checking net/if_packet.h usability... yes
> >checking net/if_packet.h presence... yes
> >checking for net/if_packet.h... yes
> >checking net/if_dl.h usability... no
> >checking net/if_dl.h presence... no
> >checking for net/if_dl.h... no
> >checking whether strtok_r macro segfaults on some inputs... yes
> >checking whether sys_siglist is declared... yes
> >checking for struct stat.st_mtim.tv_nsec... yes
> >checking for struct stat.st_mtimensec... no
> >checking for struct ifreq.ifr_flagshigh... no
> >checking for mlockall... yes
> >checking for strnlen... yes
> >checking for getloadavg... yes
> >checking for statvfs... yes
> >checking for getmntent_r... yes
> >checking mntent.h usability... yes
> >checking mntent.h presence... yes
> >checking for mntent.h... yes
> >checking sys/statvfs.h usability... yes
> >checking sys/statvfs.h presence... yes
> >checking for sys/statvfs.h... yes
> >checking linux/types.h usability... yes
> >checking linux/types.h presence... yes
> >checking for linux/types.h... yes
> >checking linux/if_ether.h usability... yes
> >checking linux/if_ether.h presence... yes
> >checking for linux/if_ether.h... yes
> >checking stdatomic.h usability... no
> >checking stdatomic.h presence... no
> >checking for stdatomic.h... no
> >checking for net/if_mib.h... no
> >checking for library containing backtrace... none required
> >checking whether libc supports hooks for malloc and related functions... yes
> >checking valgrind/valgrind.h usability... no
> >checking valgrind/valgrind.h presence... no
> >checking for valgrind/valgrind.h... no
> >checking for connect in -lsocket... no
> >checking for library containing gethostbyname... none required
> >checking XenServer release... 6.5.0
> >checking for groff... yes
> >checking whether make is GNU make... yes
> >checking whether gcc has <threads.h> that supports thread_local... no
> >checking whether gcc supports __thread... yes
> >checking for library containing __atomic_load_8... no
> >checking whether gcc supports GCC 4.0+ atomic built-ins... yes
> >checking value of __atomic_always_lock_free(1)... unsupported
> >checking value of __atomic_always_lock_free(2)... unsupported
> >checking value of __atomic_always_lock_free(4)... unsupported
> >checking value of __atomic_always_lock_free(8)... unsupported
> >checking for library containing aio_write... none required
> >checking for pthread_set_name_np... no
> >checking for pthread_setname_np() variant... none
> >checking whether __linux__ is defined... true
> >checking for working posix_memalign... yes
> >checking whether the preprocessor supports include_next... yes
> >checking whether system header files limit the line length... no
> >checking for stdio.h... yes
> >checking for string.h... (cached) yes
> >checking whether gcc accepts -Werror... yes
> >checking whether gcc accepts -Wall... yes
> >checking whether gcc accepts -Wextra... yes
> >checking whether gcc accepts -Wno-sign-compare... yes
> >checking whether gcc accepts -Wpointer-arith... yes
> >checking whether gcc accepts -Wdeclaration-after-statement... yes
> >checking whether gcc accepts -Wformat-security... no
> >checking whether gcc accepts -Wno-format-zero-length... yes
> >checking whether gcc accepts -Wswitch-enum... yes
> >checking whether gcc accepts -Wunused-parameter... yes
> >checking whether gcc accepts -Wstrict-aliasing... yes
> >checking whether gcc accepts -Wbad-function-cast... yes
> >checking whether gcc accepts -Wcast-align... yes
> >checking whether gcc accepts -Wstrict-prototypes... no
> >checking whether gcc accepts -Wold-style-definition... no
> >checking whether gcc accepts -Wmissing-prototypes... yes
> >checking whether gcc accepts -Wmissing-field-initializers... yes
> >checking whether gcc accepts -Wthread-safety... no
> >checking whether gcc accepts -Wno-unused... yes
> >checking whether gcc accepts -Wno-unused-parameter... yes
> >checking target hint for cgcc... x86_64
> >checking whether make has GNU make $(if) extension... yes
> >checking for Linux build directory... no
> >*configure: error: source dir /lib/modules/3.10.0+2%{kernel_flavor}/build doesn't exist*
> >
> >2. We found that the program still couldn't find the target folder : /lib/modules/*3.10.0+2%{kernel_flavor}*/build
> >
> >--------------------------------------------------------------------------
> >
> >It seems that the main problem is still the same.
> >Any suggestion is welcome. :-)
> >
> >Best Regards,
> >             Gosen Chien
> >*************************************
> >CCU CS Project assistant
> >No.168, Sec. 1, University Rd., Min-Hsiung Township, Chia-yi County 62102, Taiwan
> >TEL: (05)272-0411#23134
> >E-mail:astgosen at ccu.edu.tw  <mailto:astgosen at ccu.edu.tw>
> >        astgosen at novatw.info  <mailto:astgosen at novatw.info>

From mk.lavanya at gmail.com  Sun Apr 19 00:45:08 2015
From: mk.lavanya at gmail.com (Lavanya M.K)
Date: Sun, 19 Apr 2015 00:45:08 -0700
Subject: [ovs-discuss] ECMP configuration on openvswitch
In-Reply-To: <E9AB7308-9026-4DC6-8C29-B01AD443E9D4@inmon.com>
References: <CAH01gJ7ypw3r7=Qgqq0YnyAWt9mqKFRe3nr6ntHQh9oW9mfGTA@mail.gmail.com>
 <091C3AC0-3675-4752-A2DC-3F3137197A82@inmon.com>
 <CAH01gJ7+v0EwJCoBeoj2SXOCFWLx-rWrB=_FB8=kBt6majyBNQ@mail.gmail.com>
 <E9AB7308-9026-4DC6-8C29-B01AD443E9D4@inmon.com>
Message-ID: <CAH01gJ7J7iV0LiDL0aicEg6ePh6LMkmGsBAFNFUGh39kdSUoeg@mail.gmail.com>

Hello Peter,

I am using the leafandspine.py script to set up ECMP on Mininet. The
controller used is OpenDayLight. When i run the script, the topology is
incorrect in OpenDayLight GUI. Some of the links are missing. The flow
rules are installed correctly on the switches, but the topology information
gets messed up in the controller. Any idea why the script would work in
such a way?
The switch no longer forwards any packet to the controller for routing.
Would this mean that the controller is unable to get the topology
information from switch? I presumed that the default rule for sending
packets to controller is only for data packet and not control packets.
Kindly correct me if i am wrong.

OpenDayLight version used is Hydrogen.

Thanks,
Lavanya

On Wed, Mar 18, 2015 at 4:12 PM, Peter Phaal <peter.phaal at inmon.com> wrote:

> OpenDaylight deletes all the rules when OVS connects. You have to find a
> way to prevent OpenDaylight from deleting rules.
>
>
> On Mar 18, 2015, at 3:41 PM, Lavanya M.K <mk.lavanya at gmail.com> wrote:
>
> Thanks Peter for the suggestion.
> I tried the script, but what i am noticing is that the flow rules that the
> script adds gets deleted very quickly. I tried adding idle_timeout=0
> hard_timeout=0 to the flowrules to ensure that it never gets deleted. But
> its not of use. How do i make a permanent flow entry in the flow table?
>
> This is an example of flow rule additions from the leafandspine.py script:
>
>  call(['ovs-vsctl', 'set', 'bridge', switch,
> 'protocols=OpenFlow10,OpenFlow13'])
>         call(['ovs-ofctl', '-O', 'OpenFlow13', 'add-flow', switch,
> 'table=0 priority=100 idle_timeout=0 hard_timeout=0 actions=goto_table:1
> '])
>
> Thanks,
> Lavanya
>
>
> On Sun, Mar 15, 2015 at 9:17 AM, Peter Phaal <peter.phaal at inmon.com>
> wrote:
>
>> The leafandspine.py script described in the following article provides an
>> example that you could modify for your OpenDaylight setup.
>>
>> http://blog.sflow.com/2014/04/mininet-integrated-hybrid-openflow.htm
>>
>> You need to find a way to prevent the controller from flushing openflow
>> rules on startup for this approach to work. There are efforts to support
>> hybrid openflow in OpenDaylight
>>
>> http://blog.sflow.com/2014/09/hp-proposes-hybrid-openflow-discussion.html
>>
>> Peter Phaal
>> InMon Corp.
>>
>> > On Mar 14, 2015, at 11:42 PM, Lavanya M.K <mk.lavanya at gmail.com> wrote:
>> >
>> > Hi All,
>> >
>> > I want to have static ECMP configuration in openvswitches used in a fat
>> tree topology DCN(simulated in Mininet). The first packet should not be
>> sent to the controller. Can i do this by ovs commands to install flow rules
>> into group table?
>> > The controller version i am using is OpenDayLight Hydrogen, which does
>> not support writing into group table.
>> >
>> > Thanks,
>> > Lavanya
>> > _______________________________________________
>> > discuss mailing list
>> > discuss at openvswitch.org
>> > http://openvswitch.org/mailman/listinfo/discuss
>>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150419/6843d2e2/attachment.html>

From peter.phaal at inmon.com  Sun Apr 19 09:01:04 2015
From: peter.phaal at inmon.com (Peter Phaal)
Date: Sun, 19 Apr 2015 09:01:04 -0700
Subject: [ovs-discuss] ECMP configuration on openvswitch
In-Reply-To: <CAH01gJ7J7iV0LiDL0aicEg6ePh6LMkmGsBAFNFUGh39kdSUoeg@mail.gmail.com>
References: <CAH01gJ7ypw3r7=Qgqq0YnyAWt9mqKFRe3nr6ntHQh9oW9mfGTA@mail.gmail.com>
 <091C3AC0-3675-4752-A2DC-3F3137197A82@inmon.com>
 <CAH01gJ7+v0EwJCoBeoj2SXOCFWLx-rWrB=_FB8=kBt6majyBNQ@mail.gmail.com>
 <E9AB7308-9026-4DC6-8C29-B01AD443E9D4@inmon.com>
 <CAH01gJ7J7iV0LiDL0aicEg6ePh6LMkmGsBAFNFUGh39kdSUoeg@mail.gmail.com>
Message-ID: <155142FA-9E37-4EA3-86AC-0361D73DA70B@inmon.com>

The script configures the Mininet to simulate a leaf and spine network of switches using hybrid OpenFlow. The script creates the ECMP forwarding rules that the switches would normally learn via BGP/OSPF. Since the switches have fully populated forwarding tables, packet_in events are never sent to the controller.

The script stores the topology as a JSON file that can be imported into an SDN controller. This again corresponds to the reality with ECMP fabrics. The cabling plan is highly structured and known a priori. The automation system doesn’t need to discover the topology, just verify that it is correct.

It’s not surprising that OpenDaylight doesn’t work well with this setup, it doesn’t currently support hybrid OpenFlow forwarding and expects to see OpenFlow packet_in events to drive activities like topology discovery.

Peter

> On Apr 19, 2015, at 12:45 AM, Lavanya M.K <mk.lavanya at gmail.com> wrote:
> 
> Hello Peter,
> 
> I am using the leafandspine.py script to set up ECMP on Mininet. The controller used is OpenDayLight. When i run the script, the topology is incorrect in OpenDayLight GUI. Some of the links are missing. The flow rules are installed correctly on the switches, but the topology information gets messed up in the controller. Any idea why the script would work in such a way?
> The switch no longer forwards any packet to the controller for routing. Would this mean that the controller is unable to get the topology information from switch? I presumed that the default rule for sending packets to controller is only for data packet and not control packets. Kindly correct me if i am wrong.
> 
> OpenDayLight version used is Hydrogen.
> 
> Thanks,
> Lavanya
> 
> On Wed, Mar 18, 2015 at 4:12 PM, Peter Phaal <peter.phaal at inmon.com <mailto:peter.phaal at inmon.com>> wrote:
> OpenDaylight deletes all the rules when OVS connects. You have to find a way to prevent OpenDaylight from deleting rules.
> 
> 
>> On Mar 18, 2015, at 3:41 PM, Lavanya M.K <mk.lavanya at gmail.com <mailto:mk.lavanya at gmail.com>> wrote:
>> 
>> Thanks Peter for the suggestion.
>> I tried the script, but what i am noticing is that the flow rules that the script adds gets deleted very quickly. I tried adding idle_timeout=0 hard_timeout=0 to the flowrules to ensure that it never gets deleted. But its not of use. How do i make a permanent flow entry in the flow table?
>> 
>> This is an example of flow rule additions from the leafandspine.py script:
>> 
>>  call(['ovs-vsctl', 'set', 'bridge', switch, 'protocols=OpenFlow10,OpenFlow13'])
>>         call(['ovs-ofctl', '-O', 'OpenFlow13', 'add-flow', switch, 'table=0 priority=100 idle_timeout=0 hard_timeout=0 actions=goto_table:1 '])  
>> 
>> Thanks,
>> Lavanya
>> 
>> 
>> On Sun, Mar 15, 2015 at 9:17 AM, Peter Phaal <peter.phaal at inmon.com <mailto:peter.phaal at inmon.com>> wrote:
>> The leafandspine.py script described in the following article provides an example that you could modify for your OpenDaylight setup.
>> 
>> http://blog.sflow.com/2014/04/mininet-integrated-hybrid-openflow.htm <http://blog.sflow.com/2014/04/mininet-integrated-hybrid-openflow.htm>
>> 
>> You need to find a way to prevent the controller from flushing openflow rules on startup for this approach to work. There are efforts to support hybrid openflow in OpenDaylight
>> 
>> http://blog.sflow.com/2014/09/hp-proposes-hybrid-openflow-discussion.html <http://blog.sflow.com/2014/09/hp-proposes-hybrid-openflow-discussion.html>
>> 
>> Peter Phaal
>> InMon Corp.
>> 
>> > On Mar 14, 2015, at 11:42 PM, Lavanya M.K <mk.lavanya at gmail.com <mailto:mk.lavanya at gmail.com>> wrote:
>> >
>> > Hi All,
>> >
>> > I want to have static ECMP configuration in openvswitches used in a fat tree topology DCN(simulated in Mininet). The first packet should not be sent to the controller. Can i do this by ovs commands to install flow rules into group table?
>> > The controller version i am using is OpenDayLight Hydrogen, which does not support writing into group table.
>> >
>> > Thanks,
>> > Lavanya
>> > _______________________________________________
>> > discuss mailing list
>> > discuss at openvswitch.org <mailto:discuss at openvswitch.org>
>> > http://openvswitch.org/mailman/listinfo/discuss <http://openvswitch.org/mailman/listinfo/discuss>
>> 
> 
> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150419/bcbf3f18/attachment.html>

From zhangchen9211 at 126.com  Sat Apr 18 01:39:41 2015
From: zhangchen9211 at 126.com (=?GBK?B?1cWzvw==?=)
Date: Sat, 18 Apr 2015 16:39:41 +0800 (CST)
Subject: [ovs-discuss] questions about the in-band mode
Message-ID: <5b40e24a.18697.14ccbaeedca.Coremail.zhangchen9211@126.com>

hello.dear all!
i am researching on the in-band networking of ovs. i have my controller c0 with ip 1.0.0.10, which is connected to s1-eth1 as a host, and the internal interface s1 with manually assigned ip 1.0.0.1. In this case, my controller tells me that s1 is connected successfully.
and then, i connect s2-eth1 with s1-eth2, and the internal interface of s2 is manually assigned 1.0.0.2, but this time, s2 failed to connect the controller, because s1 doesn't know how to handle the arp request from s2 to c0(i found an of-packetin from s1 to c0), which is received on s1-eth2.


what does this design mean? i just thought that the in-band mode support all the switches could connect to the dataplane-lied controller.


i would be rather thx for your reply!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150418/97c34054/attachment.html>

From nick.bastin at gmail.com  Sun Apr 19 20:21:51 2015
From: nick.bastin at gmail.com (Nicholas Bastin)
Date: Sun, 19 Apr 2015 17:21:51 -1000
Subject: [ovs-discuss] questions about the in-band mode
In-Reply-To: <5b40e24a.18697.14ccbaeedca.Coremail.zhangchen9211@126.com>
References: <5b40e24a.18697.14ccbaeedca.Coremail.zhangchen9211@126.com>
Message-ID: <CADmMkWceAeWpBX7H9h2H+06h5Fb5qHqc4HXo50xSNhO_HAOkOQ@mail.gmail.com>

On Fri, Apr 17, 2015 at 10:39 PM, 张晨 <zhangchen9211 at 126.com> wrote:

> what does this design mean? i just thought that the in-band mode support
> all the switches could connect to the dataplane-lied controller.
>

In-band control networks have to expand their level of control in steps,
building a tree as they go.  When s1 connects to the controller (which
should be possible given that it's directly connected), then it can send a
packet-in to the controller from the arp from s2 when it tries to connect.
(or the controller needs to proactively install the arp and IP paths for
itself).  If s2 gives up arp-ing for the controller before s1 establishes a
connection to the controller (handshake and all), then you have a problem.

In general OVS does not have this issue (given that the host OS in this
case is Linux, which is really controlling this behaviour), so I suspect
you have some other problem with your controller.

--
Nick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150419/e28d894a/attachment.html>

From amal.kammoun at supcom.tn  Mon Apr 20 02:52:46 2015
From: amal.kammoun at supcom.tn (Amal KAMMOUN)
Date: Mon, 20 Apr 2015 09:52:46 +0000
Subject: [ovs-discuss] Flowvisor stops when OVS is connected to it
In-Reply-To: <20150417171722.GB8247@nicira.com>
References: <1429083333426.38896@supcom.tn> <20150415161958.GG7003@nicira.com>
 <1429268072879.79506@supcom.tn>
 <CADmMkWcts44wS6cnO7T60ZLQShExV82VRP6S=rQW6ENvKxgGdA@mail.gmail.com>,
 <20150417171722.GB8247@nicira.com>
Message-ID: <1429523562079.88488@supcom.tn>


Thank you Ben and Nicholas for your time and your help! 
It works perfectly now.
________________________________________
From: Ben Pfaff <blp at nicira.com>
Sent: Friday, April 17, 2015 5:17 PM
To: Nicholas Bastin
Cc: Amal KAMMOUN; discuss at openvswitch.org
Subject: Re: [ovs-discuss] Flowvisor stops when OVS is connected to it

On Fri, Apr 17, 2015 at 07:09:51AM -1000, Nicholas Bastin wrote:
> On Fri, Apr 17, 2015 at 12:54 AM, Amal KAMMOUN <amal.kammoun at supcom.tn>
> wrote:
>
> > When I installed Open vSwitch version 2.0.2 instead of 2.3.1 version I got
> > the OVS works with flowvisor.
> >
>
> FlowVisor doesn't know anything about OpenFlow versions after 1.0, and will
> crash if it receives a connection request from a non-1.0 datapath.

Amal: In that case the fix is easy.  You just configure OVS to only
use OF1.0.  The FAQ shows how:

### Q: What versions of OpenFlow does Open vSwitch support?

A: The following table lists the versions of OpenFlow supported by
   each version of Open vSwitch:

       Open vSwitch      OF1.0  OF1.1  OF1.2  OF1.3  OF1.4  OF1.5
       ###============   =====  =====  =====  =====  =====  =====
       1.9 and earlier    yes    ---    ---    ---    ---    ---
       1.10               yes    ---    [*]    [*]    ---    ---
       1.11               yes    ---    [*]    [*]    ---    ---
       2.0                yes    [*]    [*]    [*]    ---    ---
       2.1                yes    [*]    [*]    [*]    ---    ---
       2.2                yes    [*]    [*]    [*]    [%]    [*]
       2.3                yes    yes    yes    yes    [*]    [*]

       [*] Supported, with one or more missing features.
       [%] Experimental, unsafe implementation.

   Open vSwitch 2.3 enables OpenFlow 1.0, 1.1, 1.2, and 1.3 by default
   in ovs-vswitchd.  In Open vSwitch 1.10 through 2.2, OpenFlow 1.1,
   1.2, and 1.3 must be enabled manually in ovs-vswitchd.  OpenFlow
   1.4 and 1.5 are also supported, with missing features, in Open
   vSwitch 2.3 and later, but not enabled by default.  In any case,
   the user may override the default:

   - To enable OpenFlow 1.0, 1.1, 1.2, and 1.3 on bridge br0:

     ovs-vsctl set bridge br0 protocols=OpenFlow10,OpenFlow11,OpenFlow12,OpenFlow13

   - To enable OpenFlow 1.0, 1.1, 1.2, 1.3, 1.4, and 1.5 on bridge br0:

     ovs-vsctl set bridge br0 protocols=OpenFlow10,OpenFlow11,OpenFlow12,OpenFlow13,OpenFlow14,OpenFlow15

   - To enable only OpenFlow 1.0 on bridge br0:

     ovs-vsctl set bridge br0 protocols=OpenFlow10

   All current versions of ovs-ofctl enable only OpenFlow 1.0 by
   default.  Use the -O option to enable support for later versions of
   OpenFlow in ovs-ofctl.  For example:

       ovs-ofctl -O OpenFlow13 dump-flows br0

   (Open vSwitch 2.2 had an experimental implementation of OpenFlow
   1.4 that could cause crashes.  We don't recommend enabling it.)

   [OPENFLOW-1.1+.md] in the Open vSwitch source tree tracks support for
   OpenFlow 1.1 and later features.  When support for OpenFlow 1.4 and
   1.5 is solidly implemented, Open vSwitch will enable those version
   by default.  Also, the OpenFlow 1.5 specification is still under
   development and thus subject to change.

From frankzfz at 163.com  Mon Apr 20 03:00:37 2015
From: frankzfz at 163.com (frankzfz)
Date: Mon, 20 Apr 2015 18:00:37 +0800 (CST)
Subject: [ovs-discuss] =?gbk?q?SKB_is_modified_42_bytes__in_ovs_module?=
	=?gbk?b?o6FoZWxwo6E=?=
Message-ID: <7c2c0171.1b0ed.14cd645be62.Coremail.frankzfz@163.com>

Dear：
Test scenario: two KVM guests sitting in different hosts communicate to each other with a GRE tunnel.
       

All interface MTU is default 1500 Bytes, from guest point of view, its skb gso_size could be as bigger as 1448 Bytes, however after guest skb goes through GRE encapuslation, individual segments length of a gso packet could exceed physical NIC MTU 1500, which will be possible modified at recevier side.So Sender have to fragment the IP datagrams that are larger than the interface MTU .

The packets  is modified 42 bytes  in ovs module at receiver side.42 bytes is equal to GRE encapsulation header（Ethernet header（14） + IP Header （20）+ GRE Header（8））.

If interface MTU is modified 1458 Bytes, after guest skb goes through GRE encapsulation, IP fragmentation will not occur at sender side.SKb is good at receiver side. This mistake didn't happen at receiver side.

Why SKB is modified 42 bytes at receiver side through OVS modules for fragmentation packets.

Additional information:

OVS version:2.3.0

Linux kernel version:Linux2.6.32 

Hope to get your help! Thanks.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150420/b832ecad/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ovs.jpg
Type: image/jpeg
Size: 17013 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150420/b832ecad/attachment-0001.jpg>

From james.page at ubuntu.com  Mon Apr 20 08:23:35 2015
From: james.page at ubuntu.com (James Page)
Date: Mon, 20 Apr 2015 16:23:35 +0100
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <A00A93E9-6A58-458C-8E8B-C8542176ADDA@nuvula.ch>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <B32CB78D-2CF9-4F47-9515-C8A206C090A2@nuvula.ch>
 <alpine.OSX.1.10.1503311245160.389@sabyasg-mbp-02>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
 <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
 <3E5B9556-CB9F-4D5B-8A6D-A615C099BAD7@nuvula.ch>
 <3FE189EC-49E0-47CC-BD59-2F6E7B04B9A4@ubuntu.com>
 <8CE70C04-9A31-4499-938A-85EC4D13E0BB@nuvula.ch>
 <C222441F-23C1-470A-987E-123B00879EA9@ubuntu.com>
 <117DA076-BD34-4C01-94AE-22949AEF0E42@nuvula.ch>
 <55241FD8.1040704@ubuntu.com> <A00A93E9-6A58-458C-8E8B-C8542176ADDA@nuvula.ch
 >
Message-ID: <553519F7.3060901@ubuntu.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Hi Marco

Not ignoring you - just a bit busy with Ubuntu 15.04 release at the
moment - so apologies for any lag.

On 16/04/15 21:13, Marco Kuendig wrote:
> #2  0x0000000000460cd2 in format_odp_key_attr
> (a=a at entry=0x19798d4, ma=ma at entry=0x0, ds=ds at entry=0x7ffc6c10bd10,
> verbose=verbose at entry=true) at ../lib/odp-util.c:1332

The thing that has us puzzled is why at this point in the stack is the
automatic variable 'is_exact' not true:

    case OVS_KEY_ATTR_UNSPEC:
    case __OVS_KEY_ATTR_MAX:
    default:
        format_generic_odp_key(a, ds);
        if (!is_exact) {
            ds_put_char(ds, '/');
            format_generic_odp_key(ma, ds);
        }
        break;
    }

As the 'ma' parameter is 0, this should mean that is_exact follows:

    is_exact = ma ? odp_mask_attr_is_exact(ma) : true;

and as ma == 0 then is_exact should == true.  But for some reason its no
t.

As you see this with the un-optimized package, we can't blame the
optimizer - so something else must be happening - maybe an overflow?

That would have to happen in L952->L978 so not a huge amount of scope.

It might be good to see if we can determine whether namebuf is the
culprit.

- -- 
James Page
Ubuntu and Debian Developer
james.page at ubuntu.com
jamespage at debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQIcBAEBCAAGBQJVNRn3AAoJEL/srsug59jDLUoP/2IzusL2HcUNb5cHwq+1wsOh
qLa9BQakyKyQwEx6xQRP2FADRTleTndKcDawjeiegdTqQ3JU8XwZ2UW/smYFuAJv
MKz/sT+56oikojnEqlvogLGYV04dgLsmM0gBdgk61TQPZ0DukH3cvgDFmLGtQKyZ
RTTw4bsf472bp0MLTqz7JYu7Ejj6xMtCbN4jRC8GkAcDVnB5hh08zQ7XUAQHw8NW
RhK0sSfQSfelXfAw/YqqgX6z8RSpZXwEO0fJ6i/aywE6UOMk9M1/aKc+rDKRLxjL
FJEbVqjU2k0fC32ekDywumYsIJJIkPWVAdMELY3eAiIXTGYTXQc+AgOn+4vfpU+w
da1RmOhTSRJbY3WhOaAtbFzADcDeQtZVd5UDo9jOe/8BYoJvZvByafsridh7YEOl
EdGiXpM/BpS+3k36DH4TvAHGxNnXx0+4sPZljI+QdJSzfgZgTChDrugC5zIfsIL2
Br79yaZXFWbvkkGQgYuVdSGNaFoM10kAlw+QjcCvZEWlrt16L0+mjlfwPVYlRina
VIc2Z91mP3nS1nSLnM0rT0jDWF0yOY5G6wbNnzEs2O3/Sx0RMVz9iorUg+SeDhMQ
SBow/KhIbHFjzHhq1dDqGVg3KCtFZLCC9oOqFDBds0If76+wOCDwA1iYewq5YuBT
zUwVdKp0qAPUcez6YgRH
=ql2n
-----END PGP SIGNATURE-----

From blp at nicira.com  Mon Apr 20 08:41:21 2015
From: blp at nicira.com (Ben Pfaff)
Date: Mon, 20 Apr 2015 08:41:21 -0700
Subject: [ovs-discuss] questions about the in-band mode
In-Reply-To: <5b40e24a.18697.14ccbaeedca.Coremail.zhangchen9211@126.com>
References: <5b40e24a.18697.14ccbaeedca.Coremail.zhangchen9211@126.com>
Message-ID: <20150420154121.GA5364@nicira.com>

On Sat, Apr 18, 2015 at 04:39:41PM +0800, 张晨 wrote:
> i am researching on the in-band networking of ovs. i have my controller c0 with ip 1.0.0.10, which is connected to s1-eth1 as a host, and the internal interface s1 with manually assigned ip 1.0.0.1. In this case, my controller tells me that s1 is connected successfully.
> and then, i connect s2-eth1 with s1-eth2, and the internal interface of s2 is manually assigned 1.0.0.2, but this time, s2 failed to connect the controller, because s1 doesn't know how to handle the arp request from s2 to c0(i found an of-packetin from s1 to c0), which is received on s1-eth2.
> 
> 
> what does this design mean? i just thought that the in-band mode support all the switches could connect to the dataplane-lied controller.

The design of OVS in-band control is covered in detail in DESIGN.md in
the OVS source tree.

From blp at nicira.com  Mon Apr 20 08:45:42 2015
From: blp at nicira.com (Ben Pfaff)
Date: Mon, 20 Apr 2015 08:45:42 -0700
Subject: [ovs-discuss] burst_size=port?
In-Reply-To: <emc12570e7-48cb-48cd-adb4-ae1afd8a80c8@ebiken-desktop>
References: <emc12570e7-48cb-48cd-adb4-ae1afd8a80c8@ebiken-desktop>
Message-ID: <20150420154542.GB5364@nicira.com>

On Fri, Apr 17, 2015 at 10:01:46PM +0000, Kentaro Ebisawa wrote:
> In ovs-ofctl man page, Meter Syntax, there is description "burst_size=port".
> 
> Are there any reason "port" is used instead of "size" while it will only
> take kilobits or packets ?
> Or is it just a typo which should be fixed?

It's a typo.  I sent out a fix.

From jesse at nicira.com  Mon Apr 20 12:44:57 2015
From: jesse at nicira.com (Jesse Gross)
Date: Mon, 20 Apr 2015 12:44:57 -0700
Subject: [ovs-discuss] =?utf-8?q?SKB_is_modified_42_bytes_in_ovs_module?=
	=?utf-8?b?77yBaGVscO+8gQ==?=
In-Reply-To: <7c2c0171.1b0ed.14cd645be62.Coremail.frankzfz@163.com>
References: <7c2c0171.1b0ed.14cd645be62.Coremail.frankzfz@163.com>
Message-ID: <CAEP_g=-6_MFznLiHDGdDdGCbS_ZM4t3Ex4NRroE8Q1Fqhod+VQ@mail.gmail.com>

On Mon, Apr 20, 2015 at 3:00 AM, frankzfz <frankzfz at 163.com> wrote:
>
> Dear：
> Test scenario: two KVM guests sitting in different hosts communicate to each other with a GRE tunnel.
>
>
> All interface MTU is default 1500 Bytes, from guest point of view, its skb gso_size could be as bigger as 1448 Bytes, however after guest skb goes through GRE encapuslation, individual segments length of a gso packet could exceed physical NIC MTU 1500, which will be possible modified at recevier side.So Sender have to fragment the IP datagrams that are larger than the interface MTU .
>
> The packets  is modified 42 bytes  in ovs module at receiver side.42 bytes is equal to GRE encapsulation header（Ethernet header（14） + IP Header （20）+ GRE Header（8））.
>
> If interface MTU is modified 1458 Bytes, after guest skb goes through GRE encapsulation, IP fragmentation will not occur at sender side.SKb is good at receiver side. This mistake didn't happen at receiver side.
>
> Why SKB is modified 42 bytes at receiver side through OVS modules for fragmentation packets.

What does it mean that the packet is modified? What specifically happens?

However, as a general rule, Linux does not support fragmentation of
tunnel packets and OVS inherits this behavior.

From marco at nuvula.ch  Tue Apr 21 00:01:20 2015
From: marco at nuvula.ch (Marco Kuendig)
Date: Tue, 21 Apr 2015 09:01:20 +0200
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <553519F7.3060901@ubuntu.com>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <B32CB78D-2CF9-4F47-9515-C8A206C090A2@nuvula.ch>
 <alpine.OSX.1.10.1503311245160.389@sabyasg-mbp-02>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
 <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
 <3E5B9556-CB9F-4D5B-8A6D-A615C099BAD7@nuvula.ch>
 <3FE189EC-49E0-47CC-BD59-2F6E7B04B9A4@ubuntu.com>
 <8CE70C04-9A31-4499-938A-85EC4D13E0BB@nuvula.ch>
 <C222441F-23C1-470A-987E-123B00879EA9@ubuntu.com>
 <117DA076-BD34-4C01-94AE-22949AEF0E42@nuvula.ch> <55241FD8.1040704@ubuntu.com>
 <A00A93E9-6A58-458C-8E8B-C8542176ADDA@nuvula.ch> <553519F7.3060901@ubuntu.com>
Message-ID: <CA907DB2-9B8D-4BEA-A902-8F9E436268A8@nuvula.ch>

thanks James for the answer. No problem. 

Let me know if I can test anything and I will give it a try.

cheers
marco


 <http://www.nuvula.ch/>
Marco Kuendig / CEO / Founder 
marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71

Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
Nuvula AG - Hybrid Clouds 
Weierbachstrasse 7b 8193 Eglisau Switzerland 
http://www.nuvula.ch <http://www.nuvula.ch/>
> On 20 Apr 2015, at 17:23, James Page <james.page at ubuntu.com> wrote:
> 
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA256
> 
> Hi Marco
> 
> Not ignoring you - just a bit busy with Ubuntu 15.04 release at the
> moment - so apologies for any lag.
> 
> On 16/04/15 21:13, Marco Kuendig wrote:
>> #2  0x0000000000460cd2 in format_odp_key_attr
>> (a=a at entry=0x19798d4, ma=ma at entry=0x0, ds=ds at entry=0x7ffc6c10bd10,
>> verbose=verbose at entry=true) at ../lib/odp-util.c:1332
> 
> The thing that has us puzzled is why at this point in the stack is the
> automatic variable 'is_exact' not true:
> 
>    case OVS_KEY_ATTR_UNSPEC:
>    case __OVS_KEY_ATTR_MAX:
>    default:
>        format_generic_odp_key(a, ds);
>        if (!is_exact) {
>            ds_put_char(ds, '/');
>            format_generic_odp_key(ma, ds);
>        }
>        break;
>    }
> 
> As the 'ma' parameter is 0, this should mean that is_exact follows:
> 
>    is_exact = ma ? odp_mask_attr_is_exact(ma) : true;
> 
> and as ma == 0 then is_exact should == true.  But for some reason its no
> t.
> 
> As you see this with the un-optimized package, we can't blame the
> optimizer - so something else must be happening - maybe an overflow?
> 
> That would have to happen in L952->L978 so not a huge amount of scope.
> 
> It might be good to see if we can determine whether namebuf is the
> culprit.
> 
> - -- 
> James Page
> Ubuntu and Debian Developer
> james.page at ubuntu.com
> jamespage at debian.org
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v2
> 
> iQIcBAEBCAAGBQJVNRn3AAoJEL/srsug59jDLUoP/2IzusL2HcUNb5cHwq+1wsOh
> qLa9BQakyKyQwEx6xQRP2FADRTleTndKcDawjeiegdTqQ3JU8XwZ2UW/smYFuAJv
> MKz/sT+56oikojnEqlvogLGYV04dgLsmM0gBdgk61TQPZ0DukH3cvgDFmLGtQKyZ
> RTTw4bsf472bp0MLTqz7JYu7Ejj6xMtCbN4jRC8GkAcDVnB5hh08zQ7XUAQHw8NW
> RhK0sSfQSfelXfAw/YqqgX6z8RSpZXwEO0fJ6i/aywE6UOMk9M1/aKc+rDKRLxjL
> FJEbVqjU2k0fC32ekDywumYsIJJIkPWVAdMELY3eAiIXTGYTXQc+AgOn+4vfpU+w
> da1RmOhTSRJbY3WhOaAtbFzADcDeQtZVd5UDo9jOe/8BYoJvZvByafsridh7YEOl
> EdGiXpM/BpS+3k36DH4TvAHGxNnXx0+4sPZljI+QdJSzfgZgTChDrugC5zIfsIL2
> Br79yaZXFWbvkkGQgYuVdSGNaFoM10kAlw+QjcCvZEWlrt16L0+mjlfwPVYlRina
> VIc2Z91mP3nS1nSLnM0rT0jDWF0yOY5G6wbNnzEs2O3/Sx0RMVz9iorUg+SeDhMQ
> SBow/KhIbHFjzHhq1dDqGVg3KCtFZLCC9oOqFDBds0If76+wOCDwA1iYewq5YuBT
> zUwVdKp0qAPUcez6YgRH
> =ql2n
> -----END PGP SIGNATURE-----

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150421/e33d7d68/attachment.html>

From james.page at ubuntu.com  Tue Apr 21 01:35:11 2015
From: james.page at ubuntu.com (James Page)
Date: Tue, 21 Apr 2015 09:35:11 +0100
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <CA907DB2-9B8D-4BEA-A902-8F9E436268A8@nuvula.ch>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
 <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
 <3E5B9556-CB9F-4D5B-8A6D-A615C099BAD7@nuvula.ch>
 <3FE189EC-49E0-47CC-BD59-2F6E7B04B9A4@ubuntu.com>
 <8CE70C04-9A31-4499-938A-85EC4D13E0BB@nuvula.ch>
 <C222441F-23C1-470A-987E-123B00879EA9@ubuntu.com>
 <117DA076-BD34-4C01-94AE-22949AEF0E42@nuvula.ch>
 <55241FD8.1040704@ubuntu.com>
 <A00A93E9-6A58-458C-8E8B-C8542176ADDA@nuvula.ch>
 <553519F7.3060901@ubuntu.com>
 <CA907DB2-9B8D-4BEA-A902-8F9E436268A8@nuvula.ch>
Message-ID: <55360BBF.1030004@ubuntu.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

On 21/04/15 08:01, Marco Kuendig wrote:
> thanks James for the answer. No problem.
> 
> Let me know if I can test anything and I will give it a try.

if you can manage to attach to ovs whilst running and interrogate the
stack frame for #2 during a crash that would be helpful - we could at
least see what namebuf and is_exact are being set to!

> 
> cheers marco
> 
> 
> Nuvula AG <http://www.nuvula.ch/>
> 
> Marco Kuendig / CEO / Founder marco at nuvula.ch
> <mailto:marco at nuvula.ch> / +41 78 751 99 71
> 
> Marco's Google Hangout
> <https://plus.google.com/hangouts/_/nuvula.ch/marco>
> 
> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau
> Switzerland http://www.nuvula.ch <http://www.nuvula.ch/>
> 
> 
>> On 20 Apr 2015, at 17:23, James Page <james.page at ubuntu.com 
>> <mailto:james.page at ubuntu.com>> wrote:
>> 
> Hi Marco
> 
> Not ignoring you - just a bit busy with Ubuntu 15.04 release at
> the moment - so apologies for any lag.
> 
> On 16/04/15 21:13, Marco Kuendig wrote:
>>>> #2  0x0000000000460cd2 in format_odp_key_attr 
>>>> (a=a at entry=0x19798d4, ma=ma at entry=0x0,
>>>> ds=ds at entry=0x7ffc6c10bd10, verbose=verbose at entry=true) at
>>>> ../lib/odp-util.c:1332
> 
> The thing that has us puzzled is why at this point in the stack is
> the automatic variable 'is_exact' not true:
> 
> case OVS_KEY_ATTR_UNSPEC: case __OVS_KEY_ATTR_MAX: default: 
> format_generic_odp_key(a, ds); if (!is_exact) { ds_put_char(ds,
> '/'); format_generic_odp_key(ma, ds); } break; }
> 
> As the 'ma' parameter is 0, this should mean that is_exact
> follows:
> 
> is_exact = ma ? odp_mask_attr_is_exact(ma) : true;
> 
> and as ma == 0 then is_exact should == true.  But for some reason
> its no t.
> 
> As you see this with the un-optimized package, we can't blame the 
> optimizer - so something else must be happening - maybe an
> overflow?
> 
> That would have to happen in L952->L978 so not a huge amount of
> scope.
> 
> It might be good to see if we can determine whether namebuf is the 
> culprit.
> 
> 

- -- 
James Page
Ubuntu and Debian Developer
james.page at ubuntu.com
jamespage at debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQIcBAEBCAAGBQJVNgu/AAoJEL/srsug59jDrS8QAMTXGqNY1j3tOEHniLw5CyUn
Sh4bR2aXdFrsNxvyUh189yz6nIgSnDQ+XWZWRrlk1FfOW+9y4oEIt56pQRW5iOSg
qdReRog9lNqGSvSVe2dtJFP65oVcxrgPu0K6Zg7HcOQmbBlh17WgaVF9Fd9W3SQ9
iolLnuDs/X12/bg6rCQIr8gOiIMrrJFZ0u9bn47pBiVA1EWHQUTOUoKSCrk/hgwK
sM/VGyNEIv1qbGVErBH1DbjFaNpAeO3LJwXpcNsPlV6r6iEDG8RqVWg/4ovDC/mN
DzJbzANgip3yqoy4E4RedkIdfbRPR8NEZb79136nrKIZngBrA9Xvv987+EMilTp9
By3TfwQYu/Z9YzNoXhW8Wc06eo+nf1C3J7IO07vZbL6A6JgI2pLjh0/D1WGGddku
Dqo6Sgy4FhII6kVNQhwn5kLNn8/T2P/0JXMXfsrAzUpY5H1B/YDLXWGc8Xa0aAVP
QMUW+rCeaZJ580HjXIToOAyrG8Jp7n+F8M/k7BYpcdkX5JTUoYOMHj09sgmc3NjW
511FjGDODp7lA3bzN/yHXygJ1iL42+qn0cVm+ytZ7imeGeTPXDEf/SB6DbGf1ysl
vMU6vnaZ7FlllWS4W45w3YK/AvescCN4IABrz9K4VYJTIAFGu6oW/ff+p8GfxUny
1F4w+xg7nFHr8ECC0TcP
=lPF6
-----END PGP SIGNATURE-----

From wenx05124561 at 163.com  Tue Apr 21 19:38:44 2015
From: wenx05124561 at 163.com (wenxu)
Date: Wed, 22 Apr 2015 10:38:44 +0800 (CST)
Subject: [ovs-discuss] =?gbk?q?SKB_is_modified_42_bytes_in_ovs_module?=
 =?gbk?b?o6FoZWxwo6E=?=
In-Reply-To: <CAEP_g=-6_MFznLiHDGdDdGCbS_ZM4t3Ex4NRroE8Q1Fqhod+VQ@mail.gmail.com>
References: <7c2c0171.1b0ed.14cd645be62.Coremail.frankzfz@163.com>
 <CAEP_g=-6_MFznLiHDGdDdGCbS_ZM4t3Ex4NRroE8Q1Fqhod+VQ@mail.gmail.com>
Message-ID: <3874da1.12220.14cdefdeaf8.Coremail.wenx05124561@163.com>



>What does it mean that the packet is modified? What specifically happens?

The VM sends a packet with 1500 bytes and the ovs will encapsulate the packet with gre tunnel and the packet length will larger than 1500. So the packet will be fragment to 2 packets. On the receiver side we find the last 42 bytes(user data) of the second packet was tampered by linux os.

I think it's a matter with ovs and reassembly in linux kernel.  if we set the mtu of VM to 1458, the problem is gone.








At 2015-04-21 03:44:57, "Jesse Gross" <jesse at nicira.com> wrote:
>On Mon, Apr 20, 2015 at 3:00 AM, frankzfz <frankzfz at 163.com> wrote:
>>
>> Dear：
>> Test scenario: two KVM guests sitting in different hosts communicate to each other with a GRE tunnel.
>>
>>
>> All interface MTU is default 1500 Bytes, from guest point of view, its skb gso_size could be as bigger as 1448 Bytes, however after guest skb goes through GRE encapuslation, individual segments length of a gso packet could exceed physical NIC MTU 1500, which will be possible modified at recevier side.So Sender have to fragment the IP datagrams that are larger than the interface MTU .
>>
>> The packets  is modified 42 bytes  in ovs module at receiver side.42 bytes is equal to GRE encapsulation header（Ethernet header（14） + IP Header （20）+ GRE Header（8））.
>>
>> If interface MTU is modified 1458 Bytes, after guest skb goes through GRE encapsulation, IP fragmentation will not occur at sender side.SKb is good at receiver side. This mistake didn't happen at receiver side.
>>
>> Why SKB is modified 42 bytes at receiver side through OVS modules for fragmentation packets.
>
>What does it mean that the packet is modified? What specifically happens?
>
>However, as a general rule, Linux does not support fragmentation of
>tunnel packets and OVS inherits this behavior.
>_______________________________________________
>discuss mailing list
>discuss at openvswitch.org
>http://openvswitch.org/mailman/listinfo/discuss
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150422/b0da0d93/attachment.html>

From jesse at nicira.com  Tue Apr 21 19:53:27 2015
From: jesse at nicira.com (Jesse Gross)
Date: Tue, 21 Apr 2015 19:53:27 -0700
Subject: [ovs-discuss] =?utf-8?q?SKB_is_modified_42_bytes_in_ovs_module?=
	=?utf-8?b?77yBaGVscO+8gQ==?=
In-Reply-To: <3874da1.12220.14cdefdeaf8.Coremail.wenx05124561@163.com>
References: <7c2c0171.1b0ed.14cd645be62.Coremail.frankzfz@163.com>
 <CAEP_g=-6_MFznLiHDGdDdGCbS_ZM4t3Ex4NRroE8Q1Fqhod+VQ@mail.gmail.com>
 <3874da1.12220.14cdefdeaf8.Coremail.wenx05124561@163.com>
Message-ID: <CAEP_g=86o3g8odFa4jOUmiutzdLanBOH-WBNGYSaMJqXZjCW6Q@mail.gmail.com>

On Tue, Apr 21, 2015 at 7:38 PM, wenxu <wenx05124561 at 163.com> wrote:
>
>>What does it mean that the packet is modified? What specifically happens?
>
> The VM sends a packet with 1500 bytes and the ovs will encapsulate the
> packet with gre tunnel and the packet length will larger than 1500. So the
> packet will be fragment to 2 packets. On the receiver side we find the last
> 42 bytes(user data) of the second packet was tampered by linux os.
>
> I think it's a matter with ovs and reassembly in linux kernel.  if we set
> the mtu of VM to 1458, the problem is gone.

You'll need to be specific about what happens to the second fragment.
Otherwise, there is no way for people to know where to start looking.
It would also be helpful if you look at the fragments on the wire to
see if anything unusual is happening (same IP IDs?).

From djhon9813 at gmail.com  Tue Apr 21 23:30:55 2015
From: djhon9813 at gmail.com (david jhon)
Date: Wed, 22 Apr 2015 11:30:55 +0500
Subject: [ovs-discuss] Using popen() or system() calls from inside
 openvswitch source code
In-Reply-To: <20150415182332.GC25514@nicira.com>
References: <CANPUzQ2QpM8_n6Mk8rfvdVELf05Yfc1F4g34ObunJb4iEQ5sSw@mail.gmail.com>
 <20150414215112.GD25449@nicira.com>
 <CANPUzQ2jonh=+5FbJWyKDfvqStsFjq=LM8EOCa5G+3yD0CLUUA@mail.gmail.com>
 <20150415182332.GC25514@nicira.com>
Message-ID: <CANPUzQ1WwC338ZKh=Rrq900zqhtqyK0=dOFXTPZfxXjU9UD_ow@mail.gmail.com>

Thanks a lot Ben,

Right now I am stuck in another issue, I am marking certain flows with tos
bits in sw_flow_key struct while sending upcall to userspace. I can see
modified value of tos bits when dpif_recv() is called from recv_upcalls()
(basically when dpif_print_packet() method is called) method in
ofproto-dpif-upcall.c but as soon as the upcall structure is passed to
process_upcall() and upcall_xlate(), modified value of tos field is
replaced by 0. I just want to process whole upcall with the modified value
of tos.
I'll be really grateful to you if you could please let me know how is it
possible to achieve this with openvswitch userspace code.


On Wed, Apr 15, 2015 at 11:23 PM, Ben Pfaff <blp at nicira.com> wrote:

> It's probably best to just use the existing code in ovs-vswitchd to
> access the database.
>
> On Wed, Apr 15, 2015 at 10:11:39AM +0500, david jhon wrote:
> > Thanks a lot for your reply.
> >
> > I am trying to add some records in ovsdb table based on upcall handling
> in
> > userspace. After digging little more, I came to know that it uses POSIX
> > message queues for Inter Process Communication and I should better go
> this
> > way. Thank you!
> >
> > On Wed, Apr 15, 2015 at 2:51 AM, Ben Pfaff <blp at nicira.com> wrote:
> >
> > > On Mon, Apr 13, 2015 at 12:01:25PM +0500, david jhon wrote:
> > > > I want to run a command from inside openvswitch code from
> > > > ofproto/ofproto-dpif-xlate.c. with popen(), openvswitch compiles and
> runs
> > > > successfully but it does not run command.
> > > >
> > > > With system(), openvswitch fails to compile with following error:
> > > >
> > > > blacklisted due to thread safety issues. I tried running system
> command
> > > > with ovs_mutex lock and unlock routines, but it makes no difference.
> > > >
> > > > Please let me know what am I doing wrong here. How could a linux
> command
> > > be
> > > > run from openvswitch. Your help/guidance in this regard will be
> highly
> > > > valuable and appreciated.
> > >
> > > It's probably a bad idea to do this.  The error is because POSIX says
> > > that system() need not be thread safe.
> > >
> > > There may be a better way to accomplish what you're trying to do.
> > > What are you trying to do?
> > >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150422/9156181b/attachment.html>

From harshjain32 at gmail.com  Wed Apr 22 00:46:34 2015
From: harshjain32 at gmail.com (harsh jain)
Date: Wed, 22 Apr 2015 13:16:34 +0530
Subject: [ovs-discuss] Sflow packet samples in Openstack environment on OVS
	bridge
Message-ID: <CAKuL1XSsm-bMUPLbZCDajhQQXdia-QQ7SnqEDk9WVwWb67qrYw@mail.gmail.com>

Hi,

I tried to collect sflow packet on OVS switch in Openstack. But captured
paackets contain only traffic coming out from the VM i.e samples contain
Raw Packet of VM to external network direction only.following command is
used to enable

export COLLECTOR_IP=10.3.5.112
export COLLECTOR_PORT=6343
export AGENT_IP=eth1
export HEADER_BYTES=256
export SAMPLING_N=1
export POLLING_SECS=10

ovs-vsctl -- --id=@sflow create sflow agent=${AGENT_IP}
target=\"${COLLECTOR_IP}:${COLLECTOR_PORT}\" header=${HEADER_BYTES}
sampling=${SAMPLING_N} polling=${POLLING_SECS} -- set bridge br-int
sflow=@sflow

Connection is
VM ->tap device->br-int(sflow enabled)-----veth-pair----->br-data-eth.

Why packets are colected for 1 direction only?


Thanks & Regards
Harsh Jain
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150422/af328eeb/attachment-0001.html>

From james.page at ubuntu.com  Wed Apr 22 00:59:48 2015
From: james.page at ubuntu.com (James Page)
Date: Wed, 22 Apr 2015 08:59:48 +0100
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <CA907DB2-9B8D-4BEA-A902-8F9E436268A8@nuvula.ch>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
 <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
 <3E5B9556-CB9F-4D5B-8A6D-A615C099BAD7@nuvula.ch>
 <3FE189EC-49E0-47CC-BD59-2F6E7B04B9A4@ubuntu.com>
 <8CE70C04-9A31-4499-938A-85EC4D13E0BB@nuvula.ch>
 <C222441F-23C1-470A-987E-123B00879EA9@ubuntu.com>
 <117DA076-BD34-4C01-94AE-22949AEF0E42@nuvula.ch>
 <55241FD8.1040704@ubuntu.com>
 <A00A93E9-6A58-458C-8E8B-C8542176ADDA@nuvula.ch>
 <553519F7.3060901@ubuntu.com>
 <CA907DB2-9B8D-4BEA-A902-8F9E436268A8@nuvula.ch>
Message-ID: <553754F4.6020802@ubuntu.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Marco

On 21/04/15 08:01, Marco Kuendig wrote:
> thanks James for the answer. No problem.
> 
> Let me know if I can test anything and I will give it a try.

If you could print out the values for is_exact and namebuf in stack
frame #2 that would be really helpful - normally is_exact is optimized
out - but if you're running the unoptimized package, it should be
visible still.


> 
> cheers marco
> 
> 
> Nuvula AG <http://www.nuvula.ch/>
> 
> Marco Kuendig / CEO / Founder marco at nuvula.ch
> <mailto:marco at nuvula.ch> / +41 78 751 99 71
> 
> Marco's Google Hangout
> <https://plus.google.com/hangouts/_/nuvula.ch/marco>
> 
> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau
> Switzerland http://www.nuvula.ch <http://www.nuvula.ch/>
> 
> 
>> On 20 Apr 2015, at 17:23, James Page <james.page at ubuntu.com 
>> <mailto:james.page at ubuntu.com>> wrote:
>> 
> Hi Marco
> 
> Not ignoring you - just a bit busy with Ubuntu 15.04 release at
> the moment - so apologies for any lag.
> 
> On 16/04/15 21:13, Marco Kuendig wrote:
>>>> #2  0x0000000000460cd2 in format_odp_key_attr 
>>>> (a=a at entry=0x19798d4, ma=ma at entry=0x0,
>>>> ds=ds at entry=0x7ffc6c10bd10, verbose=verbose at entry=true) at
>>>> ../lib/odp-util.c:1332
> 
> The thing that has us puzzled is why at this point in the stack is
> the automatic variable 'is_exact' not true:
> 
> case OVS_KEY_ATTR_UNSPEC: case __OVS_KEY_ATTR_MAX: default: 
> format_generic_odp_key(a, ds); if (!is_exact) { ds_put_char(ds,
> '/'); format_generic_odp_key(ma, ds); } break; }
> 
> As the 'ma' parameter is 0, this should mean that is_exact
> follows:
> 
> is_exact = ma ? odp_mask_attr_is_exact(ma) : true;
> 
> and as ma == 0 then is_exact should == true.  But for some reason
> its no t.
> 
> As you see this with the un-optimized package, we can't blame the 
> optimizer - so something else must be happening - maybe an
> overflow?
> 
> That would have to happen in L952->L978 so not a huge amount of
> scope.
> 
> It might be good to see if we can determine whether namebuf is the 
> culprit.
> 
> 

- -- 
James Page
Ubuntu and Debian Developer
james.page at ubuntu.com
jamespage at debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQIcBAEBCAAGBQJVN1T0AAoJEL/srsug59jDLd4QAM9QyLsjYH6m7W7g8DC/k/Qk
/5K/XlnNFZaRgmrILnkF7xB6bXPrffSlwmz0Jda97ADMCe0YI2VOFMbdaQ9AlwR+
F+GnwC/PjMYJwrsPUJDMrR4okS+LHib/oOfgHM2cj/OvUuY2A30R09AVsL2/02S2
Yz7YAK9gNBmbMJzlszfMRG7F55nm4fWRzoeK1zA8yh958ojVgcYigt5CWxU83DwS
LE5uczs3hg50YlDiN6iGXTwzyDolJF6Dz3pgNYVyiWXLCHm3VUAquOvF9jyr2/kn
uMwBeYNp8r8HqWoUfgk2/46lrKnZ6ywhVsn7pBpF0jeM2WqO4RVw4C6/iHKCiNu7
yy0nSd7zv0sag8p90HywVXDw04kxL+PwvJ0qDPoOBD2DDMiKvwCMGRX7EZfy+x0j
0QGrTHJ5XL8iqCDfS/7kUgUM5n5uQJIajj/SR23PH4LnmDpVuEHPFyXXfey7iAEA
guG1u3tWLOoKfqfNudmqUUmx9EbZhwjcWPb2kuR1agzKALfofQwgZ9mqhAXn5fYh
rENKeujGdfBWKehLsPwSN6jrcBXpnocd0XeGVqGXLbplFGV/1kBfXz2MgeXaIc07
Ozocl5eFSKknqNrt99kt54ipI9i1zDCx7oVwHe8T/j/Onhde8oY0YEQAqDjpqcim
Z8PJvN78vK4d5X6wJyKx
=+DTh
-----END PGP SIGNATURE-----

From james.page at canonical.com  Wed Apr 22 01:09:54 2015
From: james.page at canonical.com (James Page)
Date: Wed, 22 Apr 2015 09:09:54 +0100
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <553754F4.6020802@ubuntu.com>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
 <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
 <3E5B9556-CB9F-4D5B-8A6D-A615C099BAD7@nuvula.ch>
 <3FE189EC-49E0-47CC-BD59-2F6E7B04B9A4@ubuntu.com>
 <8CE70C04-9A31-4499-938A-85EC4D13E0BB@nuvula.ch>
 <C222441F-23C1-470A-987E-123B00879EA9@ubuntu.com>
 <117DA076-BD34-4C01-94AE-22949AEF0E42@nuvula.ch>
 <55241FD8.1040704@ubuntu.com>
 <A00A93E9-6A58-458C-8E8B-C8542176ADDA@nuvula.ch>
 <553519F7.3060901@ubuntu.com>
 <CA907DB2-9B8D-4BEA-A902-8F9E436268A8@nuvula.ch>
 <553754F4.6020802@ubuntu.com>
Message-ID: <55375752.7060901@canonical.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Actually don't bother for now; I've just dug into the unoptimized
packages again to find that they are still optimized - fixing that now.

On 22/04/15 08:59, James Page wrote:
> Marco
> 
> On 21/04/15 08:01, Marco Kuendig wrote:
>> thanks James for the answer. No problem.
> 
>> Let me know if I can test anything and I will give it a try.
> 
> If you could print out the values for is_exact and namebuf in
> stack frame #2 that would be really helpful - normally is_exact is
> optimized out - but if you're running the unoptimized package, it
> should be visible still.
> 
> 
> 
>> cheers marco
> 
> 
>> Nuvula AG <http://www.nuvula.ch/>
> 
>> Marco Kuendig / CEO / Founder marco at nuvula.ch 
>> <mailto:marco at nuvula.ch> / +41 78 751 99 71
> 
>> Marco's Google Hangout 
>> <https://plus.google.com/hangouts/_/nuvula.ch/marco>
> 
>> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau 
>> Switzerland http://www.nuvula.ch <http://www.nuvula.ch/>
> 
> 
>>> On 20 Apr 2015, at 17:23, James Page <james.page at ubuntu.com 
>>> <mailto:james.page at ubuntu.com>> wrote:
>>> 
>> Hi Marco
> 
>> Not ignoring you - just a bit busy with Ubuntu 15.04 release at 
>> the moment - so apologies for any lag.
> 
>> On 16/04/15 21:13, Marco Kuendig wrote:
>>>>> #2  0x0000000000460cd2 in format_odp_key_attr 
>>>>> (a=a at entry=0x19798d4, ma=ma at entry=0x0, 
>>>>> ds=ds at entry=0x7ffc6c10bd10, verbose=verbose at entry=true) at 
>>>>> ../lib/odp-util.c:1332
> 
>> The thing that has us puzzled is why at this point in the stack
>> is the automatic variable 'is_exact' not true:
> 
>> case OVS_KEY_ATTR_UNSPEC: case __OVS_KEY_ATTR_MAX: default: 
>> format_generic_odp_key(a, ds); if (!is_exact) { ds_put_char(ds, 
>> '/'); format_generic_odp_key(ma, ds); } break; }
> 
>> As the 'ma' parameter is 0, this should mean that is_exact 
>> follows:
> 
>> is_exact = ma ? odp_mask_attr_is_exact(ma) : true;
> 
>> and as ma == 0 then is_exact should == true.  But for some
>> reason its no t.
> 
>> As you see this with the un-optimized package, we can't blame the
>>  optimizer - so something else must be happening - maybe an 
>> overflow?
> 
>> That would have to happen in L952->L978 so not a huge amount of 
>> scope.
> 
>> It might be good to see if we can determine whether namebuf is
>> the culprit.
> 
> 
> 
> 

- -- 
James Page
Technical Architect
OpenStack Engineering Team
james.page at canonical.com
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQIcBAEBCAAGBQJVN1dSAAoJEL/srsug59jDyJgP/RAYvlsoPy4U0RD14IIAbI6v
5o+Jv+BezWWupk4pUA5VudfYnhqCcSqknGXL43clLN5Xrx8N6G0kSwM8QyCHIIWD
84uSgrPjmT/6UhuccFlN2AQi6ygx6n2kXRiSIVZPkNwXpJXASws7063adSAkjX3x
bYLwD+DWb0MRG0NFJdLYQeM1cCjizlddWkW7tyVyRDwYzoTWDha2cn1b6KvZGJRJ
PLFp4JsoHrxX2PbtN3vyfbaPLP3vJOcVz7YMIdX4RiALxIhLFebjFlImwdJGUJGH
omlYyDuB1Aq1zE6VpV/gSxuWOK233u52zN1XM6qY6UWKjZK5QTDfeVGM5hrnSJUX
812f6WqISfTRybmItD4K7iO0ES41c1wPU/dkA1aFsVGxRBDo/BPrBWtNYQJokkUQ
GlviTvZ43LJHuWRHpRW4xDIRDX/Z2Rark9N9jrG4rhTb23IMKM25q1n2AIGF6C6w
ZJxZF9IGSyeZoToifIqgB0Oy3eJvGYcOsyC2zuzHetvZ9yBZTMCcrL6zltHDxcuM
htgBrbFvALfpnAsfzQzg0Y486o7k1qPssrVA2p6J5XLnlWCzYTlpcYYErV/N0sQ8
IhEPGiOlMgpWT5tLWVlDlfNJwib4ozw6QHAeKD5FNsS6/5hpP/pqE9wE7x9uV7v7
3vPfvi9LO4YCmKhdPVLJ
=qkm/
-----END PGP SIGNATURE-----

From james.page at ubuntu.com  Wed Apr 22 01:52:11 2015
From: james.page at ubuntu.com (James Page)
Date: Wed, 22 Apr 2015 09:52:11 +0100
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <CA907DB2-9B8D-4BEA-A902-8F9E436268A8@nuvula.ch>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
 <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
 <3E5B9556-CB9F-4D5B-8A6D-A615C099BAD7@nuvula.ch>
 <3FE189EC-49E0-47CC-BD59-2F6E7B04B9A4@ubuntu.com>
 <8CE70C04-9A31-4499-938A-85EC4D13E0BB@nuvula.ch>
 <C222441F-23C1-470A-987E-123B00879EA9@ubuntu.com>
 <117DA076-BD34-4C01-94AE-22949AEF0E42@nuvula.ch>
 <55241FD8.1040704@ubuntu.com>
 <A00A93E9-6A58-458C-8E8B-C8542176ADDA@nuvula.ch>
 <553519F7.3060901@ubuntu.com>
 <CA907DB2-9B8D-4BEA-A902-8F9E436268A8@nuvula.ch>
Message-ID: <5537613B.5070804@ubuntu.com>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Marco

Apologies for my foobar in not managing to provide un-optimized
binaries when I thought I had - apparently the ovs packaging
outsmarted me.

I've push a verified -O0 build to ppa:james-page/openvswitch

If you could retry with the latest packages from that PPA that would
be great - then we can really figure out whether this is an optimizer
issue or not...

Regards

James

On 21/04/15 08:01, Marco Kuendig wrote:
> thanks James for the answer. No problem.
> 
> Let me know if I can test anything and I will give it a try.
> 
> cheers marco
> 
> 
> Nuvula AG <http://www.nuvula.ch/>
> 
> Marco Kuendig / CEO / Founder marco at nuvula.ch
> <mailto:marco at nuvula.ch> / +41 78 751 99 71
> 
> Marco's Google Hangout
> <https://plus.google.com/hangouts/_/nuvula.ch/marco>
> 
> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau
> Switzerland http://www.nuvula.ch <http://www.nuvula.ch/>
> 
> 
>> On 20 Apr 2015, at 17:23, James Page <james.page at ubuntu.com 
>> <mailto:james.page at ubuntu.com>> wrote:
>> 
> Hi Marco
> 
> Not ignoring you - just a bit busy with Ubuntu 15.04 release at
> the moment - so apologies for any lag.
> 
> On 16/04/15 21:13, Marco Kuendig wrote:
>>>> #2  0x0000000000460cd2 in format_odp_key_attr 
>>>> (a=a at entry=0x19798d4, ma=ma at entry=0x0,
>>>> ds=ds at entry=0x7ffc6c10bd10, verbose=verbose at entry=true) at
>>>> ../lib/odp-util.c:1332
> 
> The thing that has us puzzled is why at this point in the stack is
> the automatic variable 'is_exact' not true:
> 
> case OVS_KEY_ATTR_UNSPEC: case __OVS_KEY_ATTR_MAX: default: 
> format_generic_odp_key(a, ds); if (!is_exact) { ds_put_char(ds,
> '/'); format_generic_odp_key(ma, ds); } break; }
> 
> As the 'ma' parameter is 0, this should mean that is_exact
> follows:
> 
> is_exact = ma ? odp_mask_attr_is_exact(ma) : true;
> 
> and as ma == 0 then is_exact should == true.  But for some reason
> its no t.
> 
> As you see this with the un-optimized package, we can't blame the 
> optimizer - so something else must be happening - maybe an
> overflow?
> 
> That would have to happen in L952->L978 so not a huge amount of
> scope.
> 
> It might be good to see if we can determine whether namebuf is the 
> culprit.
> 
> 

- -- 
James Page
Ubuntu and Debian Developer
james.page at ubuntu.com
jamespage at debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQIcBAEBCAAGBQJVN2E7AAoJEL/srsug59jDLJcQAKKzaKdfp7YvrEcasIaLKffh
mO0KO6MbVWp+42gaW/1XuT3wa2nZuVgjGaytb5NC/EJy1O3viQVQMWJIJosBoK5f
xbxC1z+3IRhnF8r27elql8nE/bxLVGpj4jUXySV7Ad1ede/3P3T30TcnhCkXNaKi
2CcOE9MUAj+2sp4C3VUXwRxdTZio1dJ+A6lDoA65p7brWroKNhY1Y0g1ct97tVE+
YLaZK3oOuVt6++CX5KPE7hR1XBk5ojKxMUtIDP5T/az7zDSokVk2GR3CYJHg57kh
SfvGw4r0PbkKn0W3E4u3HSCimlizy40Ior9qUuvNC8F4kDq7LWW3WE6ggb+X34N0
5AetDHEgRB7eFBTWlLmC4Gop7mrQP/wBqmDJJoMr+jxEJC8HoSpRYoFixAPi+6w7
O3SqOPCMpND0EHqCF60fn5zUFyXWEqWgrunEauhqPJ6swo1Uzyu52ONSZQ+V27UY
bqnDBjq5JAU5QbSTAY52ugAsW+GGobykdduxuL0Uz8cppZ/Vlkm/wh8XtAfN3nTh
GbYItkp9xRNesq6Q+beL0tFVLJWuvQNDv4LsFBzgAGRE/9Aw91A1T2GtOvLbLACa
SmM2FMt4NBVV7ANqKUP1F8mACyKtbhepPVO2Oidx/ytogO+oZYtNaRNK+UwQvj/0
lFtr4VM3A0nI8s0zFeyP
=mulJ
-----END PGP SIGNATURE-----

From djhon9813 at gmail.com  Wed Apr 22 04:24:49 2015
From: djhon9813 at gmail.com (david jhon)
Date: Wed, 22 Apr 2015 16:24:49 +0500
Subject: [ovs-discuss] Split a char *string based on a specified delimiter
 in openvswitch (strtok() is blacklisted)
Message-ID: <CANPUzQ3qM+SQ9p5D9rrewdjAdv7JDxGnsDoTZ9G7EntA9Sdi1A@mail.gmail.com>

hi everyone,

I tried to use strtok() method to split up a string based on a delimiter
such as ',' which worked pretty good for me, but after adding my piece of
code in openvswitch util.h/c it failed to compile because this method is
blacklisted for thread safety issues. I'll be really grateful if anybody
here could suggest me a workaround for this.

Thanks a lot!

Kind Regards,
David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150422/7d04bba4/attachment.html>

From djhon9813 at gmail.com  Wed Apr 22 04:38:38 2015
From: djhon9813 at gmail.com (david jhon)
Date: Wed, 22 Apr 2015 16:38:38 +0500
Subject: [ovs-discuss] Split a char *string based on a specified
 delimiter in openvswitch (strtok() is blacklisted)
In-Reply-To: <CANPUzQ3qM+SQ9p5D9rrewdjAdv7JDxGnsDoTZ9G7EntA9Sdi1A@mail.gmail.com>
References: <CANPUzQ3qM+SQ9p5D9rrewdjAdv7JDxGnsDoTZ9G7EntA9Sdi1A@mail.gmail.com>
Message-ID: <CANPUzQ0RMn0L_F5t6i5Tyr8O36h-qY1-UMr81TTm8iKWeF8vTw@mail.gmail.com>

Please ignore this email, issue has been resolved. Thank you!

On Wed, Apr 22, 2015 at 4:24 PM, david jhon <djhon9813 at gmail.com> wrote:

> hi everyone,
>
> I tried to use strtok() method to split up a string based on a delimiter
> such as ',' which worked pretty good for me, but after adding my piece of
> code in openvswitch util.h/c it failed to compile because this method is
> blacklisted for thread safety issues. I'll be really grateful if anybody
> here could suggest me a workaround for this.
>
> Thanks a lot!
>
> Kind Regards,
> David
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150422/6dbe3ba7/attachment-0001.html>

From felix_zw at 126.com  Wed Apr 22 06:09:45 2015
From: felix_zw at 126.com (ZY)
Date: Wed, 22 Apr 2015 21:09:45 +0800 (CST)
Subject: [ovs-discuss] =?gbk?q?Could_OVS_store__flow_entries_in_DB=A3=BF?=
Message-ID: <dde5530.27215.14ce13f9e9a.Coremail.felix_zw@126.com>

hi 
     I have a problem when using ovs-ofctl to add flowentry, do the following:  
    1: ovs-ofctl add-flow br-int ip,nw_src=20.1.1.99,priority=99,actions=normal
    2: /usr/share/openvswitch/scripts/ovs-ctl stop
    3: /usr/share/openvswitch/scripts/ovs-ctl start
    4.  ovs-ofctl dump-flows br-int


    The flowentry which added in step1 is missing,  Dose OVS store all the flow entries in memory?  How can i make OVS store flow entries persistence in DB, because i want it can reload the flow entries when machine reboot.


   Thank you 


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150422/df16da07/attachment.html>

From shettyg at nicira.com  Wed Apr 22 06:14:58 2015
From: shettyg at nicira.com (Gurucharan Shetty)
Date: Wed, 22 Apr 2015 06:14:58 -0700
Subject: [ovs-discuss] =?utf-8?q?Could_OVS_store_flow_entries_in_DB?=
	=?utf-8?b?77yf?=
In-Reply-To: <dde5530.27215.14ce13f9e9a.Coremail.felix_zw@126.com>
References: <dde5530.27215.14ce13f9e9a.Coremail.felix_zw@126.com>
Message-ID: <CAHbON5o24XbBa1-9PFKzr1oi_H0Uffxxw6gXWJ1zwuFMasAsdg@mail.gmail.com>

On Wed, Apr 22, 2015 at 6:09 AM, ZY <felix_zw at 126.com> wrote:
> hi
>      I have a problem when using ovs-ofctl to add flowentry, do the
> following:
>     1: ovs-ofctl add-flow br-int
> ip,nw_src=20.1.1.99,priority=99,actions=normal
>     2: /usr/share/openvswitch/scripts/ovs-ctl stop
>     3: /usr/share/openvswitch/scripts/ovs-ctl start
"/usr/share/openvswitch/scripts/ovs-ctl  restart" should save the flows.

>     4.  ovs-ofctl dump-flows br-int



>
>     The flowentry which added in step1 is missing,  Dose OVS store all the
> flow entries in memory?
Yes.

>How can i make OVS store flow entries persistence
> in DB, because i want it can reload the flow entries when machine reboot.
After a machine restart, you will need a mechanism outside openvswitch
to add the flows back. Usually the controllers do this.

>
>    Thank you
>
>
>
>
>
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss
>

From felix_zw at 126.com  Wed Apr 22 06:24:27 2015
From: felix_zw at 126.com (ZY)
Date: Wed, 22 Apr 2015 21:24:27 +0800 (CST)
Subject: [ovs-discuss] =?gbk?q?Could_OVS_store_flow_entries_in_DB=A3=BF?=
In-Reply-To: <CAHbON5o24XbBa1-9PFKzr1oi_H0Uffxxw6gXWJ1zwuFMasAsdg@mail.gmail.com>
References: <dde5530.27215.14ce13f9e9a.Coremail.felix_zw@126.com>
 <CAHbON5o24XbBa1-9PFKzr1oi_H0Uffxxw6gXWJ1zwuFMasAsdg@mail.gmail.com>
Message-ID: <26fbc20.274ee.14ce14d1325.Coremail.felix_zw@126.com>

Thanks for your quick response , I will try the controllers







At 2015-04-22 21:14:58, "Gurucharan Shetty" <shettyg at nicira.com> wrote:
>On Wed, Apr 22, 2015 at 6:09 AM, ZY <felix_zw at 126.com> wrote:
>> hi
>>      I have a problem when using ovs-ofctl to add flowentry, do the
>> following:
>>     1: ovs-ofctl add-flow br-int
>> ip,nw_src=20.1.1.99,priority=99,actions=normal
>>     2: /usr/share/openvswitch/scripts/ovs-ctl stop
>>     3: /usr/share/openvswitch/scripts/ovs-ctl start
>"/usr/share/openvswitch/scripts/ovs-ctl  restart" should save the flows.
>
>>     4.  ovs-ofctl dump-flows br-int
>
>
>
>>
>>     The flowentry which added in step1 is missing,  Dose OVS store all the
>> flow entries in memory?
>Yes.
>
>>How can i make OVS store flow entries persistence
>> in DB, because i want it can reload the flow entries when machine reboot.
>After a machine restart, you will need a mechanism outside openvswitch
>to add the flows back. Usually the controllers do this.
>
>>
>>    Thank you
>>
>>
>>
>>
>>
>> _______________________________________________
>> discuss mailing list
>> discuss at openvswitch.org
>> http://openvswitch.org/mailman/listinfo/discuss
>>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150422/e0bebfbc/attachment.html>

From rault.clement at gmail.com  Wed Apr 22 06:54:30 2015
From: rault.clement at gmail.com (=?UTF-8?Q?Cl=C3=A9ment_Rault?=)
Date: Wed, 22 Apr 2015 15:54:30 +0200
Subject: [ovs-discuss] How to monitor packets being dropped? Sent back a
 packet back to the port where it came from?
In-Reply-To: <20150414231058.GG25449@nicira.com>
References: <CACXMTR_YOAipR=MwY7OJGYXCkqQff2NQJjAEnzEYB9PpA3n11A@mail.gmail.com>
 <20150414231058.GG25449@nicira.com>
Message-ID: <CACXMTR_w=q=Bf4t+Mzq6FaPDLh+N7S9Q1HGX+HyCVE5n9Z0QVQ@mail.gmail.com>

Hi,

Thanks for your answer!

Could you point to me where in the openvswitch code this check (inport
== outport) is done?

Best,
Clément

On 15 April 2015 at 01:10, Ben Pfaff <blp at nicira.com> wrote:
> On Fri, Apr 10, 2015 at 06:15:18PM +0200, Cl??ment Rault wrote:
>> I am trying to develop inband mechanisms for fast reaction to failures
>> and I am experiencing a very high packet loss.
>>
>> "--- 11.0.0.2 ping statistics ---
>> 573 packets transmitted, 13 received, 97% packet loss, time 574650ms
>> rtt min/avg/max/mdev = 1.259/2.291/5.683/1.140 ms"
>>
>> which is probably due to the fact that some of my packets get in a
>> infinite (or not infinite but very long) loop (even though it
>> shouldn't happen) but I would like to
>> understand why and where they get dropped.
>>
>> And therefore I would like to know if there is a way to check if a
>> switch (I am using mininet) is dropping packets?
>>
>> Because I didn't put any rule to drop them and I am not decrementing
>> the ttl so it cannot from that...
>>
>> What is the default behaviour/scenario for a OVS switch to decide to
>> drop a packet?
>>
>> Could it be because sometimes I am sending the packet back to the port
>> where the packet came from?
>
> This FAQ entry might be a good start:
>
> ### Q: I added a flow to send packets out the ingress port, like this:
>
>        ovs-ofctl add-flow br0 in_port=2,actions=2
>
>    but OVS drops the packets instead.
>
> A: Yes, OpenFlow requires a switch to ignore attempts to send a packet
>    out its ingress port.  The rationale is that dropping these packets
>    makes it harder to loop the network.  Sometimes this behavior can
>    even be convenient, e.g. it is often the desired behavior in a flow
>    that forwards a packet to several ports ("floods" the packet).
>
>    Sometimes one really needs to send a packet out its ingress port
>    ("hairpin"). In this case, output to OFPP_IN_PORT, which in
>    ovs-ofctl syntax is expressed as just "in_port", e.g.:
>
>        ovs-ofctl add-flow br0 in_port=2,actions=in_port
>
>    This also works in some circumstances where the flow doesn't match
>    on the input port.  For example, if you know that your switch has
>    five ports numbered 2 through 6, then the following will send every
>    received packet out every port, even its ingress port:
>
>        ovs-ofctl add-flow br0 actions=2,3,4,5,6,in_port
>
>    or, equivalently:
>
>        ovs-ofctl add-flow br0 actions=all,in_port
>
>    Sometimes, in complicated flow tables with multiple levels of
>    "resubmit" actions, a flow needs to output to a particular port
>    that may or may not be the ingress port.  It's difficult to take
>    advantage of OFPP_IN_PORT in this situation.  To help, Open vSwitch
>    provides, as an OpenFlow extension, the ability to modify the
>    in_port field.  Whatever value is currently in the in_port field is
>    the port to which outputs will be dropped, as well as the
>    destination for OFPP_IN_PORT.  This means that the following will
>    reliably output to port 2 or to ports 2 through 6, respectively:
>
>        ovs-ofctl add-flow br0 in_port=2,actions=load:0->NXM_OF_IN_PORT[],2
>        ovs-ofctl add-flow br0 actions=load:0->NXM_OF_IN_PORT[],2,3,4,5,6
>
>    If the input port is important, then one may save and restore it on
>    the stack:
>
>         ovs-ofctl add-flow br0 actions=push:NXM_OF_IN_PORT[],\
>                                        load:0->NXM_OF_IN_PORT[],\
>                                        2,3,4,5,6,\
>                                        pop:NXM_OF_IN_PORT[]

From peter.phaal at inmon.com  Wed Apr 22 07:30:41 2015
From: peter.phaal at inmon.com (Peter Phaal)
Date: Wed, 22 Apr 2015 07:30:41 -0700
Subject: [ovs-discuss] Sflow packet samples in Openstack environment on
	OVS bridge
In-Reply-To: <CAKuL1XSsm-bMUPLbZCDajhQQXdia-QQ7SnqEDk9WVwWb67qrYw@mail.gmail.com>
References: <CAKuL1XSsm-bMUPLbZCDajhQQXdia-QQ7SnqEDk9WVwWb67qrYw@mail.gmail.com>
Message-ID: <D7466569-AA84-4C1F-903E-37F7B2242C16@inmon.com>

The sFlow implementation in OVS applies ingress sampling. To get full coverage into all traffic paths you need to enable sFlow on all bridges. For OpenStack, enabling sFlow on br-ex should give you visibility into the traffic destined to VMs.

You may also want to take a look at the Host sFlow agent (http://host-sflow.sourceforge.net/ <http://host-sflow.sourceforge.net/>). It can automatically manage the OVS sFlow settings and will also export hypervisor and VM CPU, memory, disk and network IO stats.

> On Apr 22, 2015, at 12:46 AM, harsh jain <harshjain32 at gmail.com> wrote:
> 
> Hi,
> 
> I tried to collect sflow packet on OVS switch in Openstack. But captured paackets contain only traffic coming out from the VM i.e samples contain Raw Packet of VM to external network direction only.following command is used to enable 
> 
> export COLLECTOR_IP=10.3.5.112
> export COLLECTOR_PORT=6343
> export AGENT_IP=eth1
> export HEADER_BYTES=256
> export SAMPLING_N=1
> export POLLING_SECS=10
> 
> ovs-vsctl -- --id=@sflow create sflow agent=${AGENT_IP} target=\"${COLLECTOR_IP}:${COLLECTOR_PORT}\" header=${HEADER_BYTES} sampling=${SAMPLING_N} polling=${POLLING_SECS} -- set bridge br-int sflow=@sflow
> 
> Connection is 
> VM ->tap device->br-int(sflow enabled)-----veth-pair----->br-data-eth.
> 
> Why packets are colected for 1 direction only?
> 
> 
> Thanks & Regards
> Harsh Jain
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150422/5b6eeab0/attachment-0001.html>

From shanmugam.s at bizruntime.com  Wed Apr 22 07:55:47 2015
From: shanmugam.s at bizruntime.com (Shanmugam Sundaram)
Date: Wed, 22 Apr 2015 20:25:47 +0530
Subject: [ovs-discuss] Connecting across NameSpaces using OVS Patch Ports -
	Docker
Message-ID: <CANb-gXSYiB9S4RCspk6q5kE4kD==FUyhWUjRqVCeAqfO-20iKw@mail.gmail.com>

Hi Team,

I'm using linux veth pairs to connect across network namespaces. Especially
in Dockers.
Is it possible to use Open vSwitch Patch ports to connect two OVS Bridges,
that are in two different namespaces.
Say, I have bridge 'ovs-docker' inside docker and 'ovs-host' in the host
machine, can we connect these two bridges using OVS Patch ports

-- 
regards,
*Shan*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150422/04e7ddf2/attachment.html>

From amal.kammoun at supcom.tn  Wed Apr 22 08:11:53 2015
From: amal.kammoun at supcom.tn (Amal KAMMOUN)
Date: Wed, 22 Apr 2015 15:11:53 +0000
Subject: [ovs-discuss] how to know and configure the number of ports in OVS?
Message-ID: <1429715494622.78064@supcom.tn>

Hello!


In my use case I have this architecture:


                           OVS2

                            /        \

     Host2           /           \        Host3

               \         /              \      /

           P?   \ P? /                  \   /

Host1---- OVS1             OVS4----Host4

                    \                    /

                      \                /

                       \             /

                         \         /

                           \      /

                            OVS3


All the Hosts and OVS are virtuals machines.

I connected my OVS using gre tunnels.


I want to create slices of this network using flowvisor.


My problem is when I want to create flowspaces in flowvisor I don't know how to figure out the number of the port that connects Host 1 or 2 to OVS1 or how to configure the ports between 2 OVS?


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150422/c52f4358/attachment.html>

From shettyg at nicira.com  Wed Apr 22 08:18:31 2015
From: shettyg at nicira.com (Gurucharan Shetty)
Date: Wed, 22 Apr 2015 08:18:31 -0700
Subject: [ovs-discuss] Connecting across NameSpaces using OVS Patch
 Ports - Docker
In-Reply-To: <CANb-gXSYiB9S4RCspk6q5kE4kD==FUyhWUjRqVCeAqfO-20iKw@mail.gmail.com>
References: <CANb-gXSYiB9S4RCspk6q5kE4kD==FUyhWUjRqVCeAqfO-20iKw@mail.gmail.com>
Message-ID: <CAHbON5q9X715U=Vsgrmjf1cDDgoMmO5B2va52VD5qV_haU__sw@mail.gmail.com>

On Wed, Apr 22, 2015 at 7:55 AM, Shanmugam Sundaram
<shanmugam.s at bizruntime.com> wrote:
> Hi Team,
>
> I'm using linux veth pairs to connect across network namespaces. Especially
> in Dockers.
> Is it possible to use Open vSwitch Patch ports to connect two OVS Bridges,
> that are in two different namespaces.
> Say, I have bridge 'ovs-docker' inside docker and 'ovs-host' in the host
> machine, can we connect these two bridges using OVS Patch ports
I don't think it is possible. A patch port is visible only to the
userspace process. So patch ports will only work if you have a single
ovs-vswitchd daemon that can see both the bridges.

>
> --
> regards,
> Shan
>
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss
>

From shettyg at nicira.com  Wed Apr 22 08:37:53 2015
From: shettyg at nicira.com (Gurucharan Shetty)
Date: Wed, 22 Apr 2015 08:37:53 -0700
Subject: [ovs-discuss] Connecting across NameSpaces using OVS Patch
 Ports - Docker
In-Reply-To: <CANb-gXRDcDrMyCManafX7V25b32VqQ5FJ4kDM9ObcGB4MafpEQ@mail.gmail.com>
References: <CANb-gXSYiB9S4RCspk6q5kE4kD==FUyhWUjRqVCeAqfO-20iKw@mail.gmail.com>
 <CAHbON5q9X715U=Vsgrmjf1cDDgoMmO5B2va52VD5qV_haU__sw@mail.gmail.com>
 <CANb-gXRDcDrMyCManafX7V25b32VqQ5FJ4kDM9ObcGB4MafpEQ@mail.gmail.com>
Message-ID: <CAHbON5oEko4NEfwM1+3dTFLPk8+QHT4MzkN4MfdVnCpgi3GrZA@mail.gmail.com>

On Wed, Apr 22, 2015 at 8:33 AM, Shanmugam Sundaram
<shanmugam.s at bizruntime.com> wrote:
> Thanks Gurucharan,
>
> I'm using Open vSwitch with Dockers along with VLAN.
>
> Docker (IP: 172.16.10.11/24  VLAN: 10) ----veth pair on ovs-bridge----->
> Host Machine (IP: 192.168.1.10/24 Gateway: 192.168.1.1 ).
>
> I'm currently using pipework script to achieve this. But I'm unable to
> connect to internet. I'm not sure how to achieve it, in the above setup.
Looks like you have a VLAN connection to the OVS bridge. Unless your
underlay knows how to re-direct packets with VLAN 10 to the correct
destination, it won't go anywhere.

>
> And also, is it possible to limit inbound connections to the docker using
> flow tables.
>
> Please help me on this with some directions, links
A VM connected to a OVS bridge can do all of the above. So there is no
reason on why it won't work with Docker.


>
> Thank You..
>
> regards,
> Shan
>
>
>
>
> On Wed, Apr 22, 2015 at 8:48 PM, Gurucharan Shetty <shettyg at nicira.com>
> wrote:
>>
>> On Wed, Apr 22, 2015 at 7:55 AM, Shanmugam Sundaram
>> <shanmugam.s at bizruntime.com> wrote:
>> > Hi Team,
>> >
>> > I'm using linux veth pairs to connect across network namespaces.
>> > Especially
>> > in Dockers.
>> > Is it possible to use Open vSwitch Patch ports to connect two OVS
>> > Bridges,
>> > that are in two different namespaces.
>> > Say, I have bridge 'ovs-docker' inside docker and 'ovs-host' in the host
>> > machine, can we connect these two bridges using OVS Patch ports
>> I don't think it is possible. A patch port is visible only to the
>> userspace process. So patch ports will only work if you have a single
>> ovs-vswitchd daemon that can see both the bridges.
>>
>> >
>> > --
>> > regards,
>> > Shan
>> >
>> > _______________________________________________
>> > discuss mailing list
>> > discuss at openvswitch.org
>> > http://openvswitch.org/mailman/listinfo/discuss
>> >
>
>
>
>
> --
> regards,
> Shan

From zhangchen9211 at 126.com  Sun Apr 19 23:29:58 2015
From: zhangchen9211 at 126.com (=?UTF-8?B?5byg5pmo?=)
Date: Mon, 20 Apr 2015 14:29:58 +0800 (CST)
Subject: [ovs-discuss] questions about the in-band mode
In-Reply-To: <CADmMkWceAeWpBX7H9h2H+06h5Fb5qHqc4HXo50xSNhO_HAOkOQ@mail.gmail.com>
References: <5b40e24a.18697.14ccbaeedca.Coremail.zhangchen9211@126.com>
 <CADmMkWceAeWpBX7H9h2H+06h5Fb5qHqc4HXo50xSNhO_HAOkOQ@mail.gmail.com>
Message-ID: <307b60e0.12493.14cd584e30f.Coremail.zhangchen9211@126.com>

OK， i have made it, thanks for your kind answer~

在 2015-04-20 11:21:51，"Nicholas Bastin" <nick.bastin at gmail.com> 写道：

On Fri, Apr 17, 2015 at 10:39 PM, 张晨 <zhangchen9211 at 126.com> wrote:

what does this design mean? i just thought that the in-band mode support all the switches could connect to the dataplane-lied controller.


In-band control networks have to expand their level of control in steps, building a tree as they go.  When s1 connects to the controller (which should be possible given that it's directly connected), then it can send a packet-in to the controller from the arp from s2 when it tries to connect. (or the controller needs to proactively install the arp and IP paths for itself).  If s2 gives up arp-ing for the controller before s1 establishes a connection to the controller (handshake and all), then you have a problem.


In general OVS does not have this issue (given that the host OS in this case is Linux, which is really controlling this behaviour), so I suspect you have some other problem with your controller.


--
Nick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150420/f8cf4173/attachment-0001.html>

From actionmystique at gmail.com  Tue Apr 21 02:50:23 2015
From: actionmystique at gmail.com (jean-christophe manciot)
Date: Tue, 21 Apr 2015 11:50:23 +0200
Subject: [ovs-discuss] [Ubuntu 14.10] Compilation Error with OVS 2.3.1
Message-ID: <CAKcFC3bbku00mKazAdN=bqGuAOx-UcT4hNNR2mb-AnvjMcf-Kg@mail.gmail.com>

./configure CONFIG_TUN=Yes
make
...
"libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
-Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
-Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
-Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
-Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
ofproto/ofproto_libofproto_la-bundles.lo -MD -MP -MF
ofproto/.deps/ofproto_libofproto_la-bundles.Tpo -c ofproto/bundles.c -o
ofproto/ofproto_libofproto_la-bundles.o
mv -f ofproto/.deps/ofproto_libofproto_la-bundles.Tpo
ofproto/.deps/ofproto_libofproto_la-bundles.Plo
/bin/bash ./libtool  --tag=CC   --mode=link gcc -Wstrict-prototypes -Wall
-Wextra -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
-Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
-Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
-Wmissing-field-initializers  -g -O2 -release 2.3.1  -o ofproto/
libofproto.la -rpath /usr/local/lib ofproto/ofproto_libofproto_la-bond.lo
ofproto/ofproto_libofproto_la-collectors.lo
ofproto/ofproto_libofproto_la-connmgr.lo
ofproto/ofproto_libofproto_la-fail-open.lo
ofproto/ofproto_libofproto_la-in-band.lo
ofproto/ofproto_libofproto_la-names.lo
ofproto/ofproto_libofproto_la-netflow.lo
ofproto/ofproto_libofproto_la-ofproto.lo
ofproto/ofproto_libofproto_la-ofproto-dpif.lo
ofproto/ofproto_libofproto_la-ofproto-dpif-ipfix.lo
ofproto/ofproto_libofproto_la-ofproto-dpif-mirror.lo
ofproto/ofproto_libofproto_la-ofproto-dpif-monitor.lo
ofproto/ofproto_libofproto_la-ofproto-dpif-rid.lo
ofproto/ofproto_libofproto_la-ofproto-dpif-sflow.lo
ofproto/ofproto_libofproto_la-ofproto-dpif-upcall.lo
ofproto/ofproto_libofproto_la-ofproto-dpif-xlate.lo
ofproto/ofproto_libofproto_la-pktbuf.lo
ofproto/ofproto_libofproto_la-pinsched.lo
ofproto/ofproto_libofproto_la-tunnel.lo
ofproto/ofproto_libofproto_la-bundles.lo lib/libsflow.la  -latomic
-lpthread -lrt -lm
libtool: link: ar cru ofproto/.libs/libofproto.a
 ofproto/ofproto_libofproto_la-bond.o
ofproto/ofproto_libofproto_la-collectors.o
ofproto/ofproto_libofproto_la-connmgr.o
ofproto/ofproto_libofproto_la-fail-open.o
ofproto/ofproto_libofproto_la-in-band.o
ofproto/ofproto_libofproto_la-names.o
ofproto/ofproto_libofproto_la-netflow.o
ofproto/ofproto_libofproto_la-ofproto.o
ofproto/ofproto_libofproto_la-ofproto-dpif.o
ofproto/ofproto_libofproto_la-ofproto-dpif-ipfix.o
ofproto/ofproto_libofproto_la-ofproto-dpif-mirror.o
ofproto/ofproto_libofproto_la-ofproto-dpif-monitor.o
ofproto/ofproto_libofproto_la-ofproto-dpif-rid.o
ofproto/ofproto_libofproto_la-ofproto-dpif-sflow.o
ofproto/ofproto_libofproto_la-ofproto-dpif-upcall.o
ofproto/ofproto_libofproto_la-ofproto-dpif-xlate.o
ofproto/ofproto_libofproto_la-pktbuf.o
ofproto/ofproto_libofproto_la-pinsched.o
ofproto/ofproto_libofproto_la-tunnel.o
ofproto/ofproto_libofproto_la-bundles.o
libtool: link: ranlib ofproto/.libs/libofproto.a
/bin/sed: can't read vSwitch/openvswitch-2.3.1/lib/libsflow.la: No such
file or directory
libtool: link: `vSwitch/openvswitch-2.3.1/lib/libsflow.la' is not a valid
libtool archive
Makefile:2084: recipe for target 'ofproto/libofproto.la' failed
make[2]: *** [ofproto/libofproto.la] Error 1
make[2]: Leaving directory '/home/actionmystique/Program-Files/Ubuntu/Open
vSwitch/openvswitch-2.3.1'
Makefile:3775: recipe for target 'all-recursive' failed
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory '/home/actionmystique/Program-Files/Ubuntu/Open
vSwitch/openvswitch-2.3.1'
Makefile:1776: recipe for target 'all' failed
make: *** [all] Error 2"


Please keep me in the loop.
Regards.
-- 
Jean-Christophe Manciot
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150421/a66bc6e6/attachment.html>

From blp at nicira.com  Wed Apr 22 10:26:24 2015
From: blp at nicira.com (Ben Pfaff)
Date: Wed, 22 Apr 2015 10:26:24 -0700
Subject: [ovs-discuss] [Ubuntu 14.10] Compilation Error with OVS 2.3.1
In-Reply-To: <CAKcFC3bbku00mKazAdN=bqGuAOx-UcT4hNNR2mb-AnvjMcf-Kg@mail.gmail.com>
References: <CAKcFC3bbku00mKazAdN=bqGuAOx-UcT4hNNR2mb-AnvjMcf-Kg@mail.gmail.com>
Message-ID: <CACjuMbwCAJPwJj1zO6O0qkQFsHAb+PcWBKz1zZ_Jscbwxzj=-A@mail.gmail.com>

On Tue, Apr 21, 2015 at 2:50 AM, jean-christophe manciot
<actionmystique at gmail.com> wrote:
> ./configure CONFIG_TUN=Yes

You can't enable Linux kernel configuration items through configure.
You have to
use the Linux kernel configuration process.

> make
> ...
> "libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-bundles.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-bundles.Tpo -c ofproto/bundles.c -o
> ofproto/ofproto_libofproto_la-bundles.o
> mv -f ofproto/.deps/ofproto_libofproto_la-bundles.Tpo
> ofproto/.deps/ofproto_libofproto_la-bundles.Plo
> /bin/bash ./libtool  --tag=CC   --mode=link gcc -Wstrict-prototypes -Wall
> -Wextra -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -release 2.3.1  -o
> ofproto/libofproto.la -rpath /usr/local/lib
> ofproto/ofproto_libofproto_la-bond.lo
> ofproto/ofproto_libofproto_la-collectors.lo
> ofproto/ofproto_libofproto_la-connmgr.lo
> ofproto/ofproto_libofproto_la-fail-open.lo
> ofproto/ofproto_libofproto_la-in-band.lo
> ofproto/ofproto_libofproto_la-names.lo
> ofproto/ofproto_libofproto_la-netflow.lo
> ofproto/ofproto_libofproto_la-ofproto.lo
> ofproto/ofproto_libofproto_la-ofproto-dpif.lo
> ofproto/ofproto_libofproto_la-ofproto-dpif-ipfix.lo
> ofproto/ofproto_libofproto_la-ofproto-dpif-mirror.lo
> ofproto/ofproto_libofproto_la-ofproto-dpif-monitor.lo
> ofproto/ofproto_libofproto_la-ofproto-dpif-rid.lo
> ofproto/ofproto_libofproto_la-ofproto-dpif-sflow.lo
> ofproto/ofproto_libofproto_la-ofproto-dpif-upcall.lo
> ofproto/ofproto_libofproto_la-ofproto-dpif-xlate.lo
> ofproto/ofproto_libofproto_la-pktbuf.lo
> ofproto/ofproto_libofproto_la-pinsched.lo
> ofproto/ofproto_libofproto_la-tunnel.lo
> ofproto/ofproto_libofproto_la-bundles.lo lib/libsflow.la  -latomic -lpthread
> -lrt -lm
> libtool: link: ar cru ofproto/.libs/libofproto.a
> ofproto/ofproto_libofproto_la-bond.o
> ofproto/ofproto_libofproto_la-collectors.o
> ofproto/ofproto_libofproto_la-connmgr.o
> ofproto/ofproto_libofproto_la-fail-open.o
> ofproto/ofproto_libofproto_la-in-band.o
> ofproto/ofproto_libofproto_la-names.o
> ofproto/ofproto_libofproto_la-netflow.o
> ofproto/ofproto_libofproto_la-ofproto.o
> ofproto/ofproto_libofproto_la-ofproto-dpif.o
> ofproto/ofproto_libofproto_la-ofproto-dpif-ipfix.o
> ofproto/ofproto_libofproto_la-ofproto-dpif-mirror.o
> ofproto/ofproto_libofproto_la-ofproto-dpif-monitor.o
> ofproto/ofproto_libofproto_la-ofproto-dpif-rid.o
> ofproto/ofproto_libofproto_la-ofproto-dpif-sflow.o
> ofproto/ofproto_libofproto_la-ofproto-dpif-upcall.o
> ofproto/ofproto_libofproto_la-ofproto-dpif-xlate.o
> ofproto/ofproto_libofproto_la-pktbuf.o
> ofproto/ofproto_libofproto_la-pinsched.o
> ofproto/ofproto_libofproto_la-tunnel.o
> ofproto/ofproto_libofproto_la-bundles.o
> libtool: link: ranlib ofproto/.libs/libofproto.a
> /bin/sed: can't read vSwitch/openvswitch-2.3.1/lib/libsflow.la: No such file
> or directory
> libtool: link: `vSwitch/openvswitch-2.3.1/lib/libsflow.la' is not a valid
> libtool archive

This probably indicates some kind of local problem.  Please provide the
whole compilation log instead of just the last few lines.
-- 
"I don't normally do acked-by's.  I think it's my way of avoiding
getting blamed when it all blows up."               Andrew Morton

From jpettit at nicira.com  Wed Apr 22 12:37:55 2015
From: jpettit at nicira.com (Justin Pettit)
Date: Wed, 22 Apr 2015 12:37:55 -0700
Subject: [ovs-discuss] how to know and configure the number of ports in
	OVS?
In-Reply-To: <1429715494622.78064@supcom.tn>
References: <1429715494622.78064@supcom.tn>
Message-ID: <D356283C-E8D0-47AB-A94A-CA41567A7ED2@nicira.com>

This seems like a question that would likely get a better answer on a FlowVisor mailing list.

--Justin


> On Apr 22, 2015, at 8:11 AM, Amal KAMMOUN <amal.kammoun at supcom.tn> wrote:
> 
> Hello!
> 
> In my use case I have this architecture:
> 
>                            OVS2
>                             /        \
>      Host2           /           \        Host3
>                \         /              \      /
>            P?   \ P? /                  \   /
> Host1---- OVS1             OVS4----Host4
>                     \                    /
>                       \                /
>                        \             /
>                          \         /
>                            \      /
>                             OVS3
> 
> All the Hosts and OVS are virtuals machines.
> I connected my OVS using gre tunnels. 
> 
> I want to create slices of this network using flowvisor. 
> 
> My problem is when I want to create flowspaces in flowvisor I don't know how to figure out the number of the port that connects Host 1 or 2 to OVS1 or how to configure the ports between 2 OVS?
> 
> 
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss


From harshjain32 at gmail.com  Wed Apr 22 22:31:01 2015
From: harshjain32 at gmail.com (harsh jain)
Date: Thu, 23 Apr 2015 11:01:01 +0530
Subject: [ovs-discuss] Sflow packet samples in Openstack environment on
 OVS bridge
In-Reply-To: <D7466569-AA84-4C1F-903E-37F7B2242C16@inmon.com>
References: <CAKuL1XSsm-bMUPLbZCDajhQQXdia-QQ7SnqEDk9WVwWb67qrYw@mail.gmail.com>
 <D7466569-AA84-4C1F-903E-37F7B2242C16@inmon.com>
Message-ID: <CAKuL1XTLUSMBJR33a1O2_eLLonicq00PQQdTXkCGmCHQZ4m78A@mail.gmail.com>

Hi Peter,

Thanks for reply.

What is the difference in vSwitch configuration in Openstack environment
 and in standalone use. if i try to enable sflow on OVS-bridge having
following setup. It captures packet in both direction. I think I am not
able to understand exactly what ingress means.

In PC
eth0--> br0-->tap0 (mktun command) --> Passed the tap device to qemu to
launch VM.

In compute node
VM-->tap-->Linux Bridge --veth pair-->br-int(sflow enabled)-veth
pair->br-tun


Actually We can not use br-ex to enable flow because sflow sample contain
GRE header.


Thanks & Regards
Harsh Jain



On Wed, Apr 22, 2015 at 8:00 PM, Peter Phaal <peter.phaal at inmon.com> wrote:

> The sFlow implementation in OVS applies ingress sampling. To get full
> coverage into all traffic paths you need to enable sFlow on all bridges.
> For OpenStack, enabling sFlow on br-ex should give you visibility into the
> traffic destined to VMs.
>
> You may also want to take a look at the Host sFlow agent (
> http://host-sflow.sourceforge.net/). It can automatically manage the OVS
> sFlow settings and will also export hypervisor and VM CPU, memory, disk and
> network IO stats.
>
> On Apr 22, 2015, at 12:46 AM, harsh jain <harshjain32 at gmail.com> wrote:
>
> Hi,
>
> I tried to collect sflow packet on OVS switch in Openstack. But captured
> paackets contain only traffic coming out from the VM i.e samples contain
> Raw Packet of VM to external network direction only.following command is
> used to enable
>
> export COLLECTOR_IP=10.3.5.112
> export COLLECTOR_PORT=6343
> export AGENT_IP=eth1
> export HEADER_BYTES=256
> export SAMPLING_N=1
> export POLLING_SECS=10
>
> ovs-vsctl -- --id=@sflow create sflow agent=${AGENT_IP}
> target=\"${COLLECTOR_IP}:${COLLECTOR_PORT}\" header=${HEADER_BYTES}
> sampling=${SAMPLING_N} polling=${POLLING_SECS} -- set bridge br-int
> sflow=@sflow
>
> Connection is
> VM ->tap device->br-int(sflow enabled)-----veth-pair----->br-data-eth.
>
> Why packets are colected for 1 direction only?
>
>
> Thanks & Regards
> Harsh Jain
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150423/30b542e3/attachment.html>

From peter.phaal at inmon.com  Wed Apr 22 22:56:42 2015
From: peter.phaal at inmon.com (Peter Phaal)
Date: Wed, 22 Apr 2015 22:56:42 -0700
Subject: [ovs-discuss] Sflow packet samples in Openstack environment on
	OVS bridge
In-Reply-To: <CAKuL1XTLUSMBJR33a1O2_eLLonicq00PQQdTXkCGmCHQZ4m78A@mail.gmail.com>
References: <CAKuL1XSsm-bMUPLbZCDajhQQXdia-QQ7SnqEDk9WVwWb67qrYw@mail.gmail.com>
 <D7466569-AA84-4C1F-903E-37F7B2242C16@inmon.com>
 <CAKuL1XTLUSMBJR33a1O2_eLLonicq00PQQdTXkCGmCHQZ4m78A@mail.gmail.com>
Message-ID: <608655D8-652B-4ABA-8BF8-2D16A9EB680B@inmon.com>

Ingress means that packets are captured as they are received on a physical or virtual bridge ports. Patch ports are ignored.

In stand alone mode you typically define a single bridge. However, OpenStack defines a pair of bridges (br-in and br-ex) and to get full coverage, you need to enable sFlow on both bridges.

Why is it a problem that the sFlow sample contains the GRE header? An sFlow analyzer should be able to decode tenant packet encapsulated by GRE. There is currently work underway to add support for the sFlow tunnel spec to OVS which should further improve visibility into underlay / overlay in virtual networks:

http://sflow.org/sflow_tunnels.txt <http://sflow.org/sflow_tunnels.txt>

Peter

> On Apr 22, 2015, at 10:31 PM, harsh jain <harshjain32 at gmail.com> wrote:
> 
> Hi Peter,
> 
> Thanks for reply.
> 
> What is the difference in vSwitch configuration in Openstack environment  and in standalone use. if i try to enable sflow on OVS-bridge having following setup. It captures packet in both direction. I think I am not able to understand exactly what ingress means.
> 
> In PC
> eth0--> br0-->tap0 (mktun command) --> Passed the tap device to qemu to launch VM.
> 
> In compute node
> VM-->tap-->Linux Bridge --veth pair-->br-int(sflow enabled)-veth pair->br-tun
> 
> 
> Actually We can not use br-ex to enable flow because sflow sample contain GRE header.
> 
> 
> Thanks & Regards
> Harsh Jain
> 
> 
> 
> On Wed, Apr 22, 2015 at 8:00 PM, Peter Phaal <peter.phaal at inmon.com <mailto:peter.phaal at inmon.com>> wrote:
> The sFlow implementation in OVS applies ingress sampling. To get full coverage into all traffic paths you need to enable sFlow on all bridges. For OpenStack, enabling sFlow on br-ex should give you visibility into the traffic destined to VMs.
> 
> You may also want to take a look at the Host sFlow agent (http://host-sflow.sourceforge.net/ <http://host-sflow.sourceforge.net/>). It can automatically manage the OVS sFlow settings and will also export hypervisor and VM CPU, memory, disk and network IO stats.
> 
>> On Apr 22, 2015, at 12:46 AM, harsh jain <harshjain32 at gmail.com <mailto:harshjain32 at gmail.com>> wrote:
>> 
>> Hi,
>> 
>> I tried to collect sflow packet on OVS switch in Openstack. But captured paackets contain only traffic coming out from the VM i.e samples contain Raw Packet of VM to external network direction only.following command is used to enable 
>> 
>> export COLLECTOR_IP=10.3.5.112
>> export COLLECTOR_PORT=6343
>> export AGENT_IP=eth1
>> export HEADER_BYTES=256
>> export SAMPLING_N=1
>> export POLLING_SECS=10
>> 
>> ovs-vsctl -- --id=@sflow create sflow agent=${AGENT_IP} target=\"${COLLECTOR_IP}:${COLLECTOR_PORT}\" header=${HEADER_BYTES} sampling=${SAMPLING_N} polling=${POLLING_SECS} -- set bridge br-int sflow=@sflow
>> 
>> Connection is 
>> VM ->tap device->br-int(sflow enabled)-----veth-pair----->br-data-eth.
>> 
>> Why packets are colected for 1 direction only?
>> 
>> 
>> Thanks & Regards
>> Harsh Jain
>> _______________________________________________
>> discuss mailing list
>> discuss at openvswitch.org <mailto:discuss at openvswitch.org>
>> http://openvswitch.org/mailman/listinfo/discuss <http://openvswitch.org/mailman/listinfo/discuss>
> 
> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150422/1ba3a116/attachment-0001.html>

From amal.kammoun at supcom.tn  Thu Apr 23 01:06:05 2015
From: amal.kammoun at supcom.tn (Amal KAMMOUN)
Date: Thu, 23 Apr 2015 08:06:05 +0000
Subject: [ovs-discuss] how to know and configure the number of ports in
 OVS?
In-Reply-To: <D356283C-E8D0-47AB-A94A-CA41567A7ED2@nicira.com>
References: <1429715494622.78064@supcom.tn>,
 <D356283C-E8D0-47AB-A94A-CA41567A7ED2@nicira.com>
Message-ID: <1429776077674.38880@supcom.tn>

Yes you have right, but how can we connect a host on port 1 for example of an OVS? 

Host1----------(port1)OVS
                                (port2)                                   
                                    |
                                    |
                                    |
                                    Host2
________________________________________
From: Justin Pettit <jpettit at nicira.com>
Sent: Wednesday, April 22, 2015 7:37 PM
To: Amal KAMMOUN
Cc: discuss at openvswitch.org
Subject: Re: [ovs-discuss] how to know and configure the number of ports in OVS?

This seems like a question that would likely get a better answer on a FlowVisor mailing list.

--Justin


> On Apr 22, 2015, at 8:11 AM, Amal KAMMOUN <amal.kammoun at supcom.tn> wrote:
>
> Hello!
>
> In my use case I have this architecture:
>
>                            OVS2
>                             /        \
>      Host2           /           \        Host3
>                \         /              \      /
>            P?   \ P? /                  \   /
> Host1---- OVS1             OVS4----Host4
>                     \                    /
>                       \                /
>                        \             /
>                          \         /
>                            \      /
>                             OVS3
>
> All the Hosts and OVS are virtuals machines.
> I connected my OVS using gre tunnels.
>
> I want to create slices of this network using flowvisor.
>
> My problem is when I want to create flowspaces in flowvisor I don't know how to figure out the number of the port that connects Host 1 or 2 to OVS1 or how to configure the ports between 2 OVS?
>
>
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss


From mark.clarkson at smorg.co.uk  Thu Apr 23 01:28:47 2015
From: mark.clarkson at smorg.co.uk (Mark Clarkson)
Date: Thu, 23 Apr 2015 09:28:47 +0100
Subject: [ovs-discuss] Temporary loss of network connection during addition
 of a port to bridge
Message-ID: <5538AD3F.3030908@smorg.co.uk>

Hi,
This has been asked before on this list but with no reply.

I have three ovs bridges on three physical hosts connected by ovs gre 
tunnels. STP is enabled.

Linux containers are added to the bridge using 'ovs-vsctl add-port br0 
vethXXX'.

When 'add-port' is used the bridge loses connectivity for 15-20 seconds 
- I presume it enters a learning state and the bridge goes into blocking 
mode.

This is terrible for the system as connectivity is lost to all machines 
connected to the bridge, and linux containers are added and deleted 
frequently - they are transient build nodes with a short lifespan.

Is there any way to stop from losing connection?

I have tried:
     ovs-vsctl set bridge br0 other_config:stp-forward-delay=4
, which seemed to have no effect.

Would rstp help me?

Thanks in advance
Mark.

From ian.stokes at intel.com  Thu Apr 23 02:53:33 2015
From: ian.stokes at intel.com (Stokes, Ian)
Date: Thu, 23 Apr 2015 09:53:33 +0000
Subject: [ovs-discuss] Skip testsuite.patch application during compilation
Message-ID: <CD7C01071941AC429549C17338DB8A52698B714C@IRSMSX101.ger.corp.intel.com>

Hi all,

I'm attempting to compile OVS with DPDK on CentOS 6.6 and I am hitting an issue with testsuite.patch failing to apply during the last stages of compilation. I can see that the structure of the code in ovs/tests/testsuite itself is very different to what testsuite.patch expects (hence why it fails).

Looking at first few lines of code below from testsuite.patch it seems this patch is only relevant if running in a windows environment 

elif test $at_jobs -ne 1 &&
     test "$IS_WIN32" = "yes"; then

Is this a correct assumption?

If I remove the contents of testsuite.patch and essentially apply an empty patch then compilation of OVS completes as normal. Functionality is as expected and all unit tests (make check, make dist check, make all) pass.

If the assumption above is correct and the patch is not relevant to the environment I'm running OVS in then is there a way to skip its application? i.e. a flag that can be set to skip the patch step all together. This would be better than manually altering the patch.

Would this have a negative affect that I'm not aware of?

Appreciate any feedback.

Thanks
Ian Stokes

From marzouguahoussem at gmail.com  Thu Apr 23 04:36:10 2015
From: marzouguahoussem at gmail.com (Houssem Marzougua)
Date: Thu, 23 Apr 2015 13:36:10 +0200
Subject: [ovs-discuss] Is my configuration is OK?
Message-ID: <CAKL9ifzv3nL6tvHa4BQoiZd8TVoW9OsoVJYLe6vAOjC+ZqwGOA@mail.gmail.com>

Hello all!

I'm trying to reproduce what mininet makes but with my own switches.
for that I'm trying to make a linear topology:
H1-----Switch1-----Switch2----H2
I have 2 virtual machines each one is running an openvswitch.

to make the link between the 2 openvswicth I m using gre tunnel.

and to add a host to a switch I'm using veth peer.

Am I right? is there any other configuration much better?

I'm really new in openvswitch and mininet so thank you.

Regards!

Houssem.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150423/2b3ae443/attachment.html>

From shettyg at nicira.com  Thu Apr 23 07:05:27 2015
From: shettyg at nicira.com (Gurucharan Shetty)
Date: Thu, 23 Apr 2015 07:05:27 -0700
Subject: [ovs-discuss] Skip testsuite.patch application during
	compilation
In-Reply-To: <CD7C01071941AC429549C17338DB8A52698B714C@IRSMSX101.ger.corp.intel.com>
References: <CD7C01071941AC429549C17338DB8A52698B714C@IRSMSX101.ger.corp.intel.com>
Message-ID: <CAHbON5p9Y1dLXV9OFc_bic6OFDcPi-monFshEyZMUyC9SQULXA@mail.gmail.com>

On Thu, Apr 23, 2015 at 2:53 AM, Stokes, Ian <ian.stokes at intel.com> wrote:
> Hi all,
>
> I'm attempting to compile OVS with DPDK on CentOS 6.6 and I am hitting an issue with testsuite.patch failing to apply during the last stages of compilation. I can see that the structure of the code in ovs/tests/testsuite itself is very different to what testsuite.patch expects (hence why it fails).

Do you see the same problem while compiling OVS without dpdk on
Centos6.6? The patch was added a couple of months ago and I have not
seen any build failures because of that either in Windows or Linux.
The patch was added thinking that the build does not fail anywhere.
But it looks like it does and I wonder whether it is because of a
different autoconf version or something along those lines? Do see the
failures on Ubuntu?

>
> Looking at first few lines of code below from testsuite.patch it seems this patch is only relevant if running in a windows environment
That is true.

From shettyg at nicira.com  Thu Apr 23 07:51:59 2015
From: shettyg at nicira.com (Gurucharan Shetty)
Date: Thu, 23 Apr 2015 07:51:59 -0700
Subject: [ovs-discuss] Skip testsuite.patch application during
	compilation
In-Reply-To: <CAHbON5p9Y1dLXV9OFc_bic6OFDcPi-monFshEyZMUyC9SQULXA@mail.gmail.com>
References: <CD7C01071941AC429549C17338DB8A52698B714C@IRSMSX101.ger.corp.intel.com>
 <CAHbON5p9Y1dLXV9OFc_bic6OFDcPi-monFshEyZMUyC9SQULXA@mail.gmail.com>
Message-ID: <CAHbON5qg4XKmaQ1ruDQp=dVhOf86z2g_9ODmgDVJCtNoGQgstg@mail.gmail.com>

fwiw, I was able to reproduce the problem on Centos 6 with autoconf
2.63. I think it makes sense that we do the patching only on Windows.
I will try to come up with a patch.

On Thu, Apr 23, 2015 at 7:05 AM, Gurucharan Shetty <shettyg at nicira.com> wrote:
> On Thu, Apr 23, 2015 at 2:53 AM, Stokes, Ian <ian.stokes at intel.com> wrote:
>> Hi all,
>>
>> I'm attempting to compile OVS with DPDK on CentOS 6.6 and I am hitting an issue with testsuite.patch failing to apply during the last stages of compilation. I can see that the structure of the code in ovs/tests/testsuite itself is very different to what testsuite.patch expects (hence why it fails).
>
> Do you see the same problem while compiling OVS without dpdk on
> Centos6.6? The patch was added a couple of months ago and I have not
> seen any build failures because of that either in Windows or Linux.
> The patch was added thinking that the build does not fail anywhere.
> But it looks like it does and I wonder whether it is because of a
> different autoconf version or something along those lines? Do see the
> failures on Ubuntu?
>
>>
>> Looking at first few lines of code below from testsuite.patch it seems this patch is only relevant if running in a windows environment
> That is true.

From blp at nicira.com  Thu Apr 23 11:13:39 2015
From: blp at nicira.com (Ben Pfaff)
Date: Thu, 23 Apr 2015 11:13:39 -0700
Subject: [ovs-discuss] [Ubuntu 14.10] Compilation Error with OVS 2.3.1
In-Reply-To: <CAKcFC3aysS3Xvag_uRjsB1T5ogx6br=XGs_GHmpBysYxCEHVdQ@mail.gmail.com>
References: <CAKcFC3bbku00mKazAdN=bqGuAOx-UcT4hNNR2mb-AnvjMcf-Kg@mail.gmail.com>
 <CACjuMbwCAJPwJj1zO6O0qkQFsHAb+PcWBKz1zZ_Jscbwxzj=-A@mail.gmail.com>
 <CAKcFC3aysS3Xvag_uRjsB1T5ogx6br=XGs_GHmpBysYxCEHVdQ@mail.gmail.com>
Message-ID: <20150423181339.GB30938@nicira.com>

Please don't drop the mailing list.

The build log looks OK to me up to the point of failure.  I think that
you will have to figure out why libsflow.la does not exist.  Clearly it
was created earlier in the build.

On Thu, Apr 23, 2015 at 08:56:37AM +0200, jean-christophe manciot wrote:
> The error is not related to the configure option:
> 
> root at KVM-Ubuntu-14-1:/home/actionmystique/Program-Files/Ubuntu/Open
> vSwitch/openvswitch-2.3.1# ./configure
> checking for a BSD-compatible install... /usr/bin/install -c
> checking whether build environment is sane... yes
> checking for a thread-safe mkdir -p... /bin/mkdir -p
> checking for gawk... gawk
> checking whether make sets $(MAKE)... yes
> checking for gcc... gcc
> checking whether the C compiler works... yes
> checking for C compiler default output file name... a.out
> checking for suffix of executables...
> checking whether we are cross compiling... no
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc accepts -g... yes
> checking for gcc option to accept ISO C89... none needed
> checking for style of include used by make... GNU
> checking dependency style of gcc... gcc3
> checking whether gcc and cc understand -c and -o together... yes
> checking how to run the C preprocessor... gcc -E
> checking for grep that handles long lines and -e... /bin/grep
> checking for fgrep... /bin/grep -F
> checking for egrep... /bin/grep -E
> checking for perl... /usr/bin/perl
> checking for ANSI C header files... yes
> checking for sys/types.h... yes
> checking for sys/stat.h... yes
> checking for stdlib.h... yes
> checking for string.h... yes
> checking for memory.h... yes
> checking for strings.h... yes
> checking for inttypes.h... yes
> checking for stdint.h... yes
> checking for unistd.h... yes
> checking minix/config.h usability... no
> checking minix/config.h presence... no
> checking for minix/config.h... no
> checking whether it is safe to define __EXTENSIONS__... yes
> checking whether byte ordering is bigendian... no
> checking for special C compiler options needed for large files... no
> checking for _FILE_OFFSET_BITS value needed for large files... no
> configure: WARNING: Libtool does not cope well with whitespace in `pwd`
> checking build system type... x86_64-unknown-linux-gnu
> checking host system type... x86_64-unknown-linux-gnu
> checking how to print strings... printf
> checking for a sed that does not truncate output... /bin/sed
> checking for ld used by gcc... /usr/bin/ld
> checking if the linker (/usr/bin/ld) is GNU ld... yes
> checking for BSD- or MS-compatible name lister (nm)... /usr/bin/nm -B
> checking the name lister (/usr/bin/nm -B) interface... BSD nm
> checking whether ln -s works... yes
> checking the maximum length of command line arguments... 1572864
> checking whether the shell understands some XSI constructs... yes
> checking whether the shell understands "+="... yes
> checking how to convert x86_64-unknown-linux-gnu file names to
> x86_64-unknown-linux-gnu format... func_convert_file_noop
> checking how to convert x86_64-unknown-linux-gnu file names to toolchain
> format... func_convert_file_noop
> checking for /usr/bin/ld option to reload object files... -r
> checking for objdump... objdump
> checking how to recognize dependent libraries... pass_all
> checking for dlltool... no
> checking how to associate runtime and link libraries... printf %s\n
> checking for ar... ar
> checking for archiver @FILE support... @
> checking for strip... strip
> checking for ranlib... ranlib
> checking command to parse /usr/bin/nm -B output from gcc object... ok
> checking for sysroot... no
> checking for mt... mt
> checking if mt is a manifest tool... no
> checking for dlfcn.h... yes
> checking for objdir... .libs
> checking if gcc supports -fno-rtti -fno-exceptions... no
> checking for gcc option to produce PIC... -fPIC -DPIC
> checking if gcc PIC flag -fPIC -DPIC works... yes
> checking if gcc static flag -static works... yes
> checking if gcc supports -c -o file.o... yes
> checking if gcc supports -c -o file.o... (cached) yes
> checking whether the gcc linker (/usr/bin/ld -m elf_x86_64) supports shared
> libraries... yes
> checking dynamic linker characteristics... GNU/Linux ld.so
> checking how to hardcode library paths into programs... immediate
> checking whether stripping libraries is possible... yes
> checking if libtool supports shared libraries... yes
> checking whether to build shared libraries... no
> checking whether to build static libraries... yes
> checking for library containing pow... -lm
> checking for library containing clock_gettime... none required
> checking for library containing timer_create... -lrt
> checking for library containing pthread_sigmask... -lpthread
> checking whether strerror_r is declared... yes
> checking for strerror_r... yes
> checking whether strerror_r returns char *... yes
> checking vmware.h usability... no
> checking vmware.h presence... no
> checking for vmware.h... no
> checking windows.h usability... no
> checking windows.h presence... no
> checking for windows.h... no
> checking for linux/netlink.h... yes
> checking for pkg-config... /usr/bin/pkg-config
> checking whether compiling and linking against OpenSSL works... yes
> checking for Python 2.x for x >= 4... /usr/bin/python
> checking for uuid Python module... yes
> checking whether to add python/compat to PYTHONPATH... no
> checking for dot... no
> checking net/if_packet.h usability... yes
> checking net/if_packet.h presence... yes
> checking for net/if_packet.h... yes
> checking net/if_dl.h usability... no
> checking net/if_dl.h presence... no
> checking for net/if_dl.h... no
> checking whether strtok_r macro segfaults on some inputs... no
> checking whether sys_siglist is declared... yes
> checking for struct stat.st_mtim.tv_nsec... yes
> checking for struct stat.st_mtimensec... no
> checking for struct ifreq.ifr_flagshigh... no
> checking for mlockall... yes
> checking for strnlen... yes
> checking for getloadavg... yes
> checking for statvfs... yes
> checking for getmntent_r... yes
> checking mntent.h usability... yes
> checking mntent.h presence... yes
> checking for mntent.h... yes
> checking sys/statvfs.h usability... yes
> checking sys/statvfs.h presence... yes
> checking for sys/statvfs.h... yes
> checking linux/types.h usability... yes
> checking linux/types.h presence... yes
> checking for linux/types.h... yes
> checking linux/if_ether.h usability... yes
> checking linux/if_ether.h presence... yes
> checking for linux/if_ether.h... yes
> checking stdatomic.h usability... yes
> checking stdatomic.h presence... yes
> checking for stdatomic.h... yes
> checking for net/if_mib.h... no
> checking for library containing backtrace... none required
> checking whether libc supports hooks for malloc and related functions... yes
> checking valgrind/valgrind.h usability... no
> checking valgrind/valgrind.h presence... no
> checking for valgrind/valgrind.h... no
> checking for connect in -lsocket... no
> checking for library containing gethostbyname... none required
> checking XenServer release... none
> checking for groff... yes
> checking whether make is GNU make... yes
> checking whether gcc has <threads.h> that supports thread_local... no
> checking whether gcc supports __thread... yes
> checking for library containing __atomic_load_8... -latomic
> checking whether gcc supports GCC 4.0+ atomic built-ins... yes
> checking value of __atomic_always_lock_free(1)... 1
> checking value of __atomic_always_lock_free(2)... 1
> checking value of __atomic_always_lock_free(4)... 1
> checking value of __atomic_always_lock_free(8)... 1
> checking for library containing aio_write... none required
> checking for pthread_set_name_np... no
> checking for pthread_setname_np() variant... glibc
> checking whether __linux__ is defined... true
> checking for working posix_memalign... yes
> checking whether the preprocessor supports include_next... yes
> checking whether system header files limit the line length... no
> checking for stdio.h... yes
> checking for string.h... (cached) yes
> checking whether gcc accepts -Werror... yes
> checking whether gcc accepts -Wall... yes
> checking whether gcc accepts -Wextra... yes
> checking whether gcc accepts -Wno-sign-compare... yes
> checking whether gcc accepts -Wpointer-arith... yes
> checking whether gcc accepts -Wdeclaration-after-statement... yes
> checking whether gcc accepts -Wformat-security... yes
> checking whether gcc accepts -Wno-format-zero-length... yes
> checking whether gcc accepts -Wswitch-enum... yes
> checking whether gcc accepts -Wunused-parameter... yes
> checking whether gcc accepts -Wstrict-aliasing... yes
> checking whether gcc accepts -Wbad-function-cast... yes
> checking whether gcc accepts -Wcast-align... yes
> checking whether gcc accepts -Wstrict-prototypes... no
> checking whether gcc accepts -Wold-style-definition... no
> checking whether gcc accepts -Wmissing-prototypes... yes
> checking whether gcc accepts -Wmissing-field-initializers... yes
> checking whether gcc accepts -Wthread-safety... no
> checking whether gcc accepts -Wno-unused... yes
> checking whether gcc accepts -Wno-unused-parameter... yes
> checking target hint for cgcc... x86_64
> checking whether make has GNU make $(if) extension... yes
> configure: creating ./config.status
> config.status: creating lib/stdio.h
> config.status: creating lib/string.h
> config.status: creating Makefile
> config.status: creating datapath/Makefile
> config.status: creating datapath/linux/Kbuild
> config.status: creating datapath/linux/Makefile
> config.status: creating datapath/linux/Makefile.main
> config.status: creating tests/atlocal
> config.status: creating config.h
> config.status: config.h is unchanged
> config.status: executing tests/atconfig commands
> config.status: executing depfiles commands
> config.status: executing libtool commands
> config.status: executing include/openflow/openflow.h.stamp commands
> config.status: executing utilities/bugtool/dummy commands
> root at KVM-Ubuntu-14-1:/home/actionmystique/Program-Files/Ubuntu/Open
> vSwitch/openvswitch-2.3.1# make
> make  all-recursive
> make[1]: Entering directory '/home/actionmystique/Program-Files/Ubuntu/Open
> vSwitch/openvswitch-2.3.1'
> Making all in datapath
> make[2]: Entering directory '/home/actionmystique/Program-Files/Ubuntu/Open
> vSwitch/openvswitch-2.3.1/datapath'
> make[3]: Entering directory '/home/actionmystique/Program-Files/Ubuntu/Open
> vSwitch/openvswitch-2.3.1/datapath'
> make[3]: Nothing to be done for 'all-am'.
> make[3]: Leaving directory '/home/actionmystique/Program-Files/Ubuntu/Open
> vSwitch/openvswitch-2.3.1/datapath'
> make[2]: Leaving directory '/home/actionmystique/Program-Files/Ubuntu/Open
> vSwitch/openvswitch-2.3.1/datapath'
> make[2]: Entering directory '/home/actionmystique/Program-Files/Ubuntu/Open
> vSwitch/openvswitch-2.3.1'
> depbase=`echo lib/aes128.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/aes128.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/aes128.lo lib/aes128.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/aes128.lo -MD -MP -MF lib/.deps/aes128.Tpo -c lib/aes128.c -o
> lib/aes128.o
> depbase=`echo lib/backtrace.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/backtrace.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/backtrace.lo lib/backtrace.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/backtrace.lo -MD -MP -MF lib/.deps/backtrace.Tpo -c lib/backtrace.c -o
> lib/backtrace.o
> depbase=`echo lib/bfd.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/bfd.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/bfd.lo lib/bfd.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/bfd.lo -MD -MP -MF lib/.deps/bfd.Tpo -c lib/bfd.c -o lib/bfd.o
> depbase=`echo lib/bitmap.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/bitmap.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/bitmap.lo lib/bitmap.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/bitmap.lo -MD -MP -MF lib/.deps/bitmap.Tpo -c lib/bitmap.c -o
> lib/bitmap.o
> depbase=`echo lib/bundle.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/bundle.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/bundle.lo lib/bundle.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/bundle.lo -MD -MP -MF lib/.deps/bundle.Tpo -c lib/bundle.c -o
> lib/bundle.o
> depbase=`echo lib/byteq.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/byteq.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/byteq.lo lib/byteq.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/byteq.lo -MD -MP -MF lib/.deps/byteq.Tpo -c lib/byteq.c -o lib/byteq.o
> depbase=`echo lib/cfm.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/cfm.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/cfm.lo lib/cfm.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/cfm.lo -MD -MP -MF lib/.deps/cfm.Tpo -c lib/cfm.c -o lib/cfm.o
> depbase=`echo lib/classifier.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/classifier.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/classifier.lo lib/classifier.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/classifier.lo -MD -MP -MF lib/.deps/classifier.Tpo -c lib/classifier.c
> -o lib/classifier.o
> depbase=`echo lib/command-line.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/command-line.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/command-line.lo lib/command-line.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/command-line.lo -MD -MP -MF lib/.deps/command-line.Tpo -c
> lib/command-line.c -o lib/command-line.o
> depbase=`echo lib/connectivity.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/connectivity.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/connectivity.lo lib/connectivity.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/connectivity.lo -MD -MP -MF lib/.deps/connectivity.Tpo -c
> lib/connectivity.c -o lib/connectivity.o
> depbase=`echo lib/coverage.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/coverage.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/coverage.lo lib/coverage.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/coverage.lo -MD -MP -MF lib/.deps/coverage.Tpo -c lib/coverage.c -o
> lib/coverage.o
> depbase=`echo lib/csum.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/csum.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/csum.lo lib/csum.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/csum.lo -MD -MP -MF lib/.deps/csum.Tpo -c lib/csum.c -o lib/csum.o
> depbase=`echo lib/daemon.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/daemon.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/daemon.lo lib/daemon.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/daemon.lo -MD -MP -MF lib/.deps/daemon.Tpo -c lib/daemon.c -o
> lib/daemon.o
> depbase=`echo lib/dpif-netdev.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/dpif-netdev.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/dpif-netdev.lo lib/dpif-netdev.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/dpif-netdev.lo -MD -MP -MF lib/.deps/dpif-netdev.Tpo -c
> lib/dpif-netdev.c -o lib/dpif-netdev.o
> depbase=`echo lib/dpif.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/dpif.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/dpif.lo lib/dpif.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/dpif.lo -MD -MP -MF lib/.deps/dpif.Tpo -c lib/dpif.c -o lib/dpif.o
> depbase=`echo lib/heap.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/heap.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/heap.lo lib/heap.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/heap.lo -MD -MP -MF lib/.deps/heap.Tpo -c lib/heap.c -o lib/heap.o
> depbase=`echo lib/dynamic-string.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/dynamic-string.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/dynamic-string.lo lib/dynamic-string.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/dynamic-string.lo -MD -MP -MF lib/.deps/dynamic-string.Tpo -c
> lib/dynamic-string.c -o lib/dynamic-string.o
> depbase=`echo lib/entropy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/entropy.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/entropy.lo lib/entropy.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/entropy.lo -MD -MP -MF lib/.deps/entropy.Tpo -c lib/entropy.c -o
> lib/entropy.o
> depbase=`echo lib/fat-rwlock.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/fat-rwlock.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/fat-rwlock.lo lib/fat-rwlock.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/fat-rwlock.lo -MD -MP -MF lib/.deps/fat-rwlock.Tpo -c lib/fat-rwlock.c
> -o lib/fat-rwlock.o
> depbase=`echo lib/fatal-signal.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/fatal-signal.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/fatal-signal.lo lib/fatal-signal.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/fatal-signal.lo -MD -MP -MF lib/.deps/fatal-signal.Tpo -c
> lib/fatal-signal.c -o lib/fatal-signal.o
> depbase=`echo lib/flow.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/flow.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/flow.lo lib/flow.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/flow.lo -MD -MP -MF lib/.deps/flow.Tpo -c lib/flow.c -o lib/flow.o
> depbase=`echo lib/guarded-list.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/guarded-list.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/guarded-list.lo lib/guarded-list.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/guarded-list.lo -MD -MP -MF lib/.deps/guarded-list.Tpo -c
> lib/guarded-list.c -o lib/guarded-list.o
> depbase=`echo lib/hash.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/hash.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/hash.lo lib/hash.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/hash.lo -MD -MP -MF lib/.deps/hash.Tpo -c lib/hash.c -o lib/hash.o
> depbase=`echo lib/hindex.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/hindex.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/hindex.lo lib/hindex.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/hindex.lo -MD -MP -MF lib/.deps/hindex.Tpo -c lib/hindex.c -o
> lib/hindex.o
> depbase=`echo lib/hmap.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/hmap.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/hmap.lo lib/hmap.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/hmap.lo -MD -MP -MF lib/.deps/hmap.Tpo -c lib/hmap.c -o lib/hmap.o
> depbase=`echo lib/hmapx.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/hmapx.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/hmapx.lo lib/hmapx.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/hmapx.lo -MD -MP -MF lib/.deps/hmapx.Tpo -c lib/hmapx.c -o lib/hmapx.o
> depbase=`echo lib/jhash.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/jhash.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/jhash.lo lib/jhash.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/jhash.lo -MD -MP -MF lib/.deps/jhash.Tpo -c lib/jhash.c -o lib/jhash.o
> depbase=`echo lib/json.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/json.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/json.lo lib/json.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/json.lo -MD -MP -MF lib/.deps/json.Tpo -c lib/json.c -o lib/json.o
> depbase=`echo lib/jsonrpc.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/jsonrpc.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/jsonrpc.lo lib/jsonrpc.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/jsonrpc.lo -MD -MP -MF lib/.deps/jsonrpc.Tpo -c lib/jsonrpc.c -o
> lib/jsonrpc.o
> depbase=`echo lib/lacp.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/lacp.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/lacp.lo lib/lacp.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/lacp.lo -MD -MP -MF lib/.deps/lacp.Tpo -c lib/lacp.c -o lib/lacp.o
> depbase=`echo lib/learn.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/learn.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/learn.lo lib/learn.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/learn.lo -MD -MP -MF lib/.deps/learn.Tpo -c lib/learn.c -o lib/learn.o
> depbase=`echo lib/learning-switch.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/learning-switch.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/learning-switch.lo lib/learning-switch.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/learning-switch.lo -MD -MP -MF lib/.deps/learning-switch.Tpo -c
> lib/learning-switch.c -o lib/learning-switch.o
> depbase=`echo lib/list.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/list.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/list.lo lib/list.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/list.lo -MD -MP -MF lib/.deps/list.Tpo -c lib/list.c -o lib/list.o
> depbase=`echo lib/lockfile.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/lockfile.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/lockfile.lo lib/lockfile.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/lockfile.lo -MD -MP -MF lib/.deps/lockfile.Tpo -c lib/lockfile.c -o
> lib/lockfile.o
> depbase=`echo lib/mac-learning.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/mac-learning.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/mac-learning.lo lib/mac-learning.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/mac-learning.lo -MD -MP -MF lib/.deps/mac-learning.Tpo -c
> lib/mac-learning.c -o lib/mac-learning.o
> depbase=`echo lib/match.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/match.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/match.lo lib/match.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/match.lo -MD -MP -MF lib/.deps/match.Tpo -c lib/match.c -o lib/match.o
> depbase=`echo lib/memory.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/memory.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/memory.lo lib/memory.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/memory.lo -MD -MP -MF lib/.deps/memory.Tpo -c lib/memory.c -o
> lib/memory.o
> depbase=`echo lib/meta-flow.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/meta-flow.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/meta-flow.lo lib/meta-flow.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/meta-flow.lo -MD -MP -MF lib/.deps/meta-flow.Tpo -c lib/meta-flow.c -o
> lib/meta-flow.o
> depbase=`echo lib/multipath.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/multipath.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/multipath.lo lib/multipath.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/multipath.lo -MD -MP -MF lib/.deps/multipath.Tpo -c lib/multipath.c -o
> lib/multipath.o
> depbase=`echo lib/netdev-dummy.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/netdev-dummy.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/netdev-dummy.lo lib/netdev-dummy.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/netdev-dummy.lo -MD -MP -MF lib/.deps/netdev-dummy.Tpo -c
> lib/netdev-dummy.c -o lib/netdev-dummy.o
> depbase=`echo lib/netdev-vport.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/netdev-vport.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/netdev-vport.lo lib/netdev-vport.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/netdev-vport.lo -MD -MP -MF lib/.deps/netdev-vport.Tpo -c
> lib/netdev-vport.c -o lib/netdev-vport.o
> depbase=`echo lib/netdev.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/netdev.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/netdev.lo lib/netdev.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/netdev.lo -MD -MP -MF lib/.deps/netdev.Tpo -c lib/netdev.c -o
> lib/netdev.o
> depbase=`echo lib/netlink.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/netlink.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/netlink.lo lib/netlink.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/netlink.lo -MD -MP -MF lib/.deps/netlink.Tpo -c lib/netlink.c -o
> lib/netlink.o
> depbase=`echo lib/nx-match.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/nx-match.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/nx-match.lo lib/nx-match.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/nx-match.lo -MD -MP -MF lib/.deps/nx-match.Tpo -c lib/nx-match.c -o
> lib/nx-match.o
> depbase=`echo lib/odp-execute.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/odp-execute.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/odp-execute.lo lib/odp-execute.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/odp-execute.lo -MD -MP -MF lib/.deps/odp-execute.Tpo -c
> lib/odp-execute.c -o lib/odp-execute.o
> depbase=`echo lib/odp-util.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/odp-util.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/odp-util.lo lib/odp-util.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/odp-util.lo -MD -MP -MF lib/.deps/odp-util.Tpo -c lib/odp-util.c -o
> lib/odp-util.o
> depbase=`echo lib/ofp-actions.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/ofp-actions.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/ofp-actions.lo lib/ofp-actions.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/ofp-actions.lo -MD -MP -MF lib/.deps/ofp-actions.Tpo -c
> lib/ofp-actions.c -o lib/ofp-actions.o
> depbase=`echo lib/ofp-errors.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/ofp-errors.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/ofp-errors.lo lib/ofp-errors.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/ofp-errors.lo -MD -MP -MF lib/.deps/ofp-errors.Tpo -c lib/ofp-errors.c
> -o lib/ofp-errors.o
> depbase=`echo lib/ofp-msgs.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/ofp-msgs.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/ofp-msgs.lo lib/ofp-msgs.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/ofp-msgs.lo -MD -MP -MF lib/.deps/ofp-msgs.Tpo -c lib/ofp-msgs.c -o
> lib/ofp-msgs.o
> depbase=`echo lib/ofp-parse.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/ofp-parse.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/ofp-parse.lo lib/ofp-parse.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/ofp-parse.lo -MD -MP -MF lib/.deps/ofp-parse.Tpo -c lib/ofp-parse.c -o
> lib/ofp-parse.o
> depbase=`echo lib/ofp-print.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/ofp-print.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/ofp-print.lo lib/ofp-print.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/ofp-print.lo -MD -MP -MF lib/.deps/ofp-print.Tpo -c lib/ofp-print.c -o
> lib/ofp-print.o
> depbase=`echo lib/ofp-util.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/ofp-util.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/ofp-util.lo lib/ofp-util.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/ofp-util.lo -MD -MP -MF lib/.deps/ofp-util.Tpo -c lib/ofp-util.c -o
> lib/ofp-util.o
> depbase=`echo lib/ofp-version-opt.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/ofp-version-opt.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/ofp-version-opt.lo lib/ofp-version-opt.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/ofp-version-opt.lo -MD -MP -MF lib/.deps/ofp-version-opt.Tpo -c
> lib/ofp-version-opt.c -o lib/ofp-version-opt.o
> depbase=`echo lib/ofpbuf.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/ofpbuf.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/ofpbuf.lo lib/ofpbuf.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/ofpbuf.lo -MD -MP -MF lib/.deps/ofpbuf.Tpo -c lib/ofpbuf.c -o
> lib/ofpbuf.o
> depbase=`echo lib/ovs-atomic-locked.lo | sed
> 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/ovs-atomic-locked.lo -MD -MP
> -MF $depbase.Tpo -c -o lib/ovs-atomic-locked.lo lib/ovs-atomic-locked.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/ovs-atomic-locked.lo -MD -MP -MF lib/.deps/ovs-atomic-locked.Tpo -c
> lib/ovs-atomic-locked.c -o lib/ovs-atomic-locked.o
> depbase=`echo lib/ovs-rcu.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/ovs-rcu.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/ovs-rcu.lo lib/ovs-rcu.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/ovs-rcu.lo -MD -MP -MF lib/.deps/ovs-rcu.Tpo -c lib/ovs-rcu.c -o
> lib/ovs-rcu.o
> depbase=`echo lib/ovs-thread.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/ovs-thread.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/ovs-thread.lo lib/ovs-thread.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/ovs-thread.lo -MD -MP -MF lib/.deps/ovs-thread.Tpo -c lib/ovs-thread.c
> -o lib/ovs-thread.o
> depbase=`echo lib/ovsdb-data.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/ovsdb-data.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/ovsdb-data.lo lib/ovsdb-data.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/ovsdb-data.lo -MD -MP -MF lib/.deps/ovsdb-data.Tpo -c lib/ovsdb-data.c
> -o lib/ovsdb-data.o
> depbase=`echo lib/ovsdb-error.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/ovsdb-error.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/ovsdb-error.lo lib/ovsdb-error.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/ovsdb-error.lo -MD -MP -MF lib/.deps/ovsdb-error.Tpo -c
> lib/ovsdb-error.c -o lib/ovsdb-error.o
> depbase=`echo lib/ovsdb-idl.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/ovsdb-idl.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/ovsdb-idl.lo lib/ovsdb-idl.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/ovsdb-idl.lo -MD -MP -MF lib/.deps/ovsdb-idl.Tpo -c lib/ovsdb-idl.c -o
> lib/ovsdb-idl.o
> depbase=`echo lib/ovsdb-parser.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/ovsdb-parser.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/ovsdb-parser.lo lib/ovsdb-parser.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/ovsdb-parser.lo -MD -MP -MF lib/.deps/ovsdb-parser.Tpo -c
> lib/ovsdb-parser.c -o lib/ovsdb-parser.o
> depbase=`echo lib/ovsdb-types.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/ovsdb-types.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/ovsdb-types.lo lib/ovsdb-types.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/ovsdb-types.lo -MD -MP -MF lib/.deps/ovsdb-types.Tpo -c
> lib/ovsdb-types.c -o lib/ovsdb-types.o
> depbase=`echo lib/packets.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/packets.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/packets.lo lib/packets.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/packets.lo -MD -MP -MF lib/.deps/packets.Tpo -c lib/packets.c -o
> lib/packets.o
> depbase=`echo lib/pcap-file.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/pcap-file.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/pcap-file.lo lib/pcap-file.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/pcap-file.lo -MD -MP -MF lib/.deps/pcap-file.Tpo -c lib/pcap-file.c -o
> lib/pcap-file.o
> depbase=`echo lib/poll-loop.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/poll-loop.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/poll-loop.lo lib/poll-loop.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/poll-loop.lo -MD -MP -MF lib/.deps/poll-loop.Tpo -c lib/poll-loop.c -o
> lib/poll-loop.o
> depbase=`echo lib/process.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/process.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/process.lo lib/process.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/process.lo -MD -MP -MF lib/.deps/process.Tpo -c lib/process.c -o
> lib/process.o
> depbase=`echo lib/random.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/random.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/random.lo lib/random.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/random.lo -MD -MP -MF lib/.deps/random.Tpo -c lib/random.c -o
> lib/random.o
> depbase=`echo lib/rconn.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/rconn.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/rconn.lo lib/rconn.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/rconn.lo -MD -MP -MF lib/.deps/rconn.Tpo -c lib/rconn.c -o lib/rconn.o
> depbase=`echo lib/reconnect.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/reconnect.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/reconnect.lo lib/reconnect.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/reconnect.lo -MD -MP -MF lib/.deps/reconnect.Tpo -c lib/reconnect.c -o
> lib/reconnect.o
> depbase=`echo lib/seq.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/seq.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/seq.lo lib/seq.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/seq.lo -MD -MP -MF lib/.deps/seq.Tpo -c lib/seq.c -o lib/seq.o
> depbase=`echo lib/sha1.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/sha1.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/sha1.lo lib/sha1.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/sha1.lo -MD -MP -MF lib/.deps/sha1.Tpo -c lib/sha1.c -o lib/sha1.o
> depbase=`echo lib/shash.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/shash.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/shash.lo lib/shash.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/shash.lo -MD -MP -MF lib/.deps/shash.Tpo -c lib/shash.c -o lib/shash.o
> depbase=`echo lib/simap.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/simap.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/simap.lo lib/simap.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/simap.lo -MD -MP -MF lib/.deps/simap.Tpo -c lib/simap.c -o lib/simap.o
> depbase=`echo lib/smap.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/smap.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/smap.lo lib/smap.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/smap.lo -MD -MP -MF lib/.deps/smap.Tpo -c lib/smap.c -o lib/smap.o
> depbase=`echo lib/socket-util.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/socket-util.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/socket-util.lo lib/socket-util.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/socket-util.lo -MD -MP -MF lib/.deps/socket-util.Tpo -c
> lib/socket-util.c -o lib/socket-util.o
> depbase=`echo lib/sset.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/sset.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/sset.lo lib/sset.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/sset.lo -MD -MP -MF lib/.deps/sset.Tpo -c lib/sset.c -o lib/sset.o
> depbase=`echo lib/stp.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/stp.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/stp.lo lib/stp.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/stp.lo -MD -MP -MF lib/.deps/stp.Tpo -c lib/stp.c -o lib/stp.o
> depbase=`echo lib/stream-tcp.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/stream-tcp.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/stream-tcp.lo lib/stream-tcp.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/stream-tcp.lo -MD -MP -MF lib/.deps/stream-tcp.Tpo -c lib/stream-tcp.c
> -o lib/stream-tcp.o
> depbase=`echo lib/stream.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/stream.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/stream.lo lib/stream.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/stream.lo -MD -MP -MF lib/.deps/stream.Tpo -c lib/stream.c -o
> lib/stream.o
> depbase=`echo lib/stdio.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/stdio.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/stdio.lo lib/stdio.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/stdio.lo -MD -MP -MF lib/.deps/stdio.Tpo -c lib/stdio.c -o lib/stdio.o
> depbase=`echo lib/string.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/string.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/string.lo lib/string.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/string.lo -MD -MP -MF lib/.deps/string.Tpo -c lib/string.c -o
> lib/string.o
> depbase=`echo lib/svec.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/svec.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/svec.lo lib/svec.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/svec.lo -MD -MP -MF lib/.deps/svec.Tpo -c lib/svec.c -o lib/svec.o
> depbase=`echo lib/table.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/table.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/table.lo lib/table.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/table.lo -MD -MP -MF lib/.deps/table.Tpo -c lib/table.c -o lib/table.o
> depbase=`echo lib/tag.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/tag.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/tag.lo lib/tag.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/tag.lo -MD -MP -MF lib/.deps/tag.Tpo -c lib/tag.c -o lib/tag.o
> depbase=`echo lib/timer.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/timer.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/timer.lo lib/timer.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/timer.lo -MD -MP -MF lib/.deps/timer.Tpo -c lib/timer.c -o lib/timer.o
> depbase=`echo lib/timeval.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/timeval.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/timeval.lo lib/timeval.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/timeval.lo -MD -MP -MF lib/.deps/timeval.Tpo -c lib/timeval.c -o
> lib/timeval.o
> depbase=`echo lib/token-bucket.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/token-bucket.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/token-bucket.lo lib/token-bucket.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/token-bucket.lo -MD -MP -MF lib/.deps/token-bucket.Tpo -c
> lib/token-bucket.c -o lib/token-bucket.o
> depbase=`echo lib/unicode.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/unicode.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/unicode.lo lib/unicode.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/unicode.lo -MD -MP -MF lib/.deps/unicode.Tpo -c lib/unicode.c -o
> lib/unicode.o
> depbase=`echo lib/unixctl.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/unixctl.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/unixctl.lo lib/unixctl.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/unixctl.lo -MD -MP -MF lib/.deps/unixctl.Tpo -c lib/unixctl.c -o
> lib/unixctl.o
> depbase=`echo lib/util.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/util.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/util.lo lib/util.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/util.lo -MD -MP -MF lib/.deps/util.Tpo -c lib/util.c -o lib/util.o
> depbase=`echo lib/uuid.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/uuid.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/uuid.lo lib/uuid.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/uuid.lo -MD -MP -MF lib/.deps/uuid.Tpo -c lib/uuid.c -o lib/uuid.o
> depbase=`echo lib/vconn-stream.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/vconn-stream.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/vconn-stream.lo lib/vconn-stream.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/vconn-stream.lo -MD -MP -MF lib/.deps/vconn-stream.Tpo -c
> lib/vconn-stream.c -o lib/vconn-stream.o
> depbase=`echo lib/vconn.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/vconn.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/vconn.lo lib/vconn.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/vconn.lo -MD -MP -MF lib/.deps/vconn.Tpo -c lib/vconn.c -o lib/vconn.o
> depbase=`echo lib/vlan-bitmap.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/vlan-bitmap.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/vlan-bitmap.lo lib/vlan-bitmap.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/vlan-bitmap.lo -MD -MP -MF lib/.deps/vlan-bitmap.Tpo -c
> lib/vlan-bitmap.c -o lib/vlan-bitmap.o
> depbase=`echo lib/vlandev.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/vlandev.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/vlandev.lo lib/vlandev.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/vlandev.lo -MD -MP -MF lib/.deps/vlandev.Tpo -c lib/vlandev.c -o
> lib/vlandev.o
> depbase=`echo lib/vlog.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/vlog.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/vlog.lo lib/vlog.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/vlog.lo -MD -MP -MF lib/.deps/vlog.Tpo -c lib/vlog.c -o lib/vlog.o
> depbase=`echo lib/vswitch-idl.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/vswitch-idl.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/vswitch-idl.lo lib/vswitch-idl.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/vswitch-idl.lo -MD -MP -MF lib/.deps/vswitch-idl.Tpo -c
> lib/vswitch-idl.c -o lib/vswitch-idl.o
> depbase=`echo lib/vtep-idl.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/vtep-idl.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/vtep-idl.lo lib/vtep-idl.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/vtep-idl.lo -MD -MP -MF lib/.deps/vtep-idl.Tpo -c lib/vtep-idl.c -o
> lib/vtep-idl.o
> depbase=`echo lib/daemon-unix.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/daemon-unix.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/daemon-unix.lo lib/daemon-unix.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/daemon-unix.lo -MD -MP -MF lib/.deps/daemon-unix.Tpo -c
> lib/daemon-unix.c -o lib/daemon-unix.o
> depbase=`echo lib/latch-unix.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/latch-unix.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/latch-unix.lo lib/latch-unix.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/latch-unix.lo -MD -MP -MF lib/.deps/latch-unix.Tpo -c lib/latch-unix.c
> -o lib/latch-unix.o
> depbase=`echo lib/signals.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/signals.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/signals.lo lib/signals.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/signals.lo -MD -MP -MF lib/.deps/signals.Tpo -c lib/signals.c -o
> lib/signals.o
> depbase=`echo lib/stream-fd-unix.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/stream-fd-unix.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/stream-fd-unix.lo lib/stream-fd-unix.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/stream-fd-unix.lo -MD -MP -MF lib/.deps/stream-fd-unix.Tpo -c
> lib/stream-fd-unix.c -o lib/stream-fd-unix.o
> depbase=`echo lib/stream-unix.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/stream-unix.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/stream-unix.lo lib/stream-unix.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/stream-unix.lo -MD -MP -MF lib/.deps/stream-unix.Tpo -c
> lib/stream-unix.c -o lib/stream-unix.o
> depbase=`echo lib/dpif-linux.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/dpif-linux.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/dpif-linux.lo lib/dpif-linux.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/dpif-linux.lo -MD -MP -MF lib/.deps/dpif-linux.Tpo -c lib/dpif-linux.c
> -o lib/dpif-linux.o
> depbase=`echo lib/netdev-linux.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/netdev-linux.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/netdev-linux.lo lib/netdev-linux.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/netdev-linux.lo -MD -MP -MF lib/.deps/netdev-linux.Tpo -c
> lib/netdev-linux.c -o lib/netdev-linux.o
> depbase=`echo lib/netlink-notifier.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/netlink-notifier.lo -MD -MP
> -MF $depbase.Tpo -c -o lib/netlink-notifier.lo lib/netlink-notifier.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/netlink-notifier.lo -MD -MP -MF lib/.deps/netlink-notifier.Tpo -c
> lib/netlink-notifier.c -o lib/netlink-notifier.o
> depbase=`echo lib/netlink-socket.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/netlink-socket.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/netlink-socket.lo lib/netlink-socket.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/netlink-socket.lo -MD -MP -MF lib/.deps/netlink-socket.Tpo -c
> lib/netlink-socket.c -o lib/netlink-socket.o
> depbase=`echo lib/rtnetlink-link.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/rtnetlink-link.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/rtnetlink-link.lo lib/rtnetlink-link.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/rtnetlink-link.lo -MD -MP -MF lib/.deps/rtnetlink-link.Tpo -c
> lib/rtnetlink-link.c -o lib/rtnetlink-link.o
> depbase=`echo lib/route-table.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/route-table.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/route-table.lo lib/route-table.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/route-table.lo -MD -MP -MF lib/.deps/route-table.Tpo -c
> lib/route-table.c -o lib/route-table.o
> depbase=`echo lib/async-append-aio.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/async-append-aio.lo -MD -MP
> -MF $depbase.Tpo -c -o lib/async-append-aio.lo lib/async-append-aio.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/async-append-aio.lo -MD -MP -MF lib/.deps/async-append-aio.Tpo -c
> lib/async-append-aio.c -o lib/async-append-aio.o
> depbase=`echo lib/stream-ssl.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/stream-ssl.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/stream-ssl.lo lib/stream-ssl.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/stream-ssl.lo -MD -MP -MF lib/.deps/stream-ssl.Tpo -c lib/stream-ssl.c
> -o lib/stream-ssl.o
> (echo '/* -*- mode: c; buffer-read-only: t -*- */' && sed < ./lib/dirs.c.in
> \
> -e 's,[@]srcdir[@],.,g' \
> -e 's,[@]LOGDIR[@],"/usr/local/var/log/openvswitch",g' \
> -e 's,[@]RUNDIR[@],"/usr/local/var/run/openvswitch",g' \
> -e 's,[@]DBDIR[@],"/usr/local/etc/openvswitch",g' \
> -e 's,[@]bindir[@],"/usr/local/bin",g' \
> -e 's,[@]sysconfdir[@],"/usr/local/etc",g' \
> -e 's,[@]pkgdatadir[@],"/usr/local/share/openvswitch",g') \
>      > lib/dirs.c.tmp
> mv lib/dirs.c.tmp lib/dirs.c
> depbase=`echo lib/dirs.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/dirs.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/dirs.lo lib/dirs.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/dirs.lo -MD -MP -MF lib/.deps/dirs.Tpo -c lib/dirs.c -o lib/dirs.o
> depbase=`echo lib/dhparams.lo | sed 's|[^/]*$|.deps/&|;s|\.lo$||'`;\
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT lib/dhparams.lo -MD -MP -MF
> $depbase.Tpo -c -o lib/dhparams.lo lib/dhparams.c &&\
> mv -f $depbase.Tpo $depbase.Plo
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> lib/dhparams.lo -MD -MP -MF lib/.deps/dhparams.Tpo -c lib/dhparams.c -o
> lib/dhparams.o
> /bin/bash ./libtool  --tag=CC   --mode=link gcc -Wstrict-prototypes -Wall
> -Wextra -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -release 2.3.1  -o lib/
> libopenvswitch.la -rpath /usr/local/lib lib/aes128.lo lib/backtrace.lo
> lib/bfd.lo lib/bitmap.lo lib/bundle.lo lib/byteq.lo lib/cfm.lo
> lib/classifier.lo lib/command-line.lo lib/connectivity.lo lib/coverage.lo
> lib/crc32c.lo lib/csum.lo lib/daemon.lo lib/dummy.lo lib/dpif-netdev.lo
> lib/dpif.lo lib/heap.lo lib/dynamic-string.lo lib/entropy.lo
> lib/fat-rwlock.lo lib/fatal-signal.lo lib/flow.lo lib/guarded-list.lo
> lib/hash.lo lib/hindex.lo lib/hmap.lo lib/hmapx.lo lib/jhash.lo lib/json.lo
> lib/jsonrpc.lo lib/lacp.lo lib/learn.lo lib/learning-switch.lo lib/list.lo
> lib/lockfile.lo lib/mac-learning.lo lib/match.lo lib/memory.lo
> lib/meta-flow.lo lib/multipath.lo lib/netdev-dummy.lo lib/netdev-vport.lo
> lib/netdev.lo lib/netlink.lo lib/nx-match.lo lib/odp-execute.lo
> lib/odp-util.lo lib/ofp-actions.lo lib/ofp-errors.lo lib/ofp-msgs.lo
> lib/ofp-parse.lo lib/ofp-print.lo lib/ofp-util.lo lib/ofp-version-opt.lo
> lib/ofpbuf.lo lib/ovs-atomic-locked.lo lib/ovs-rcu.lo lib/ovs-thread.lo
> lib/ovsdb-data.lo lib/ovsdb-error.lo lib/ovsdb-idl.lo lib/ovsdb-parser.lo
> lib/ovsdb-types.lo lib/packets.lo lib/pcap-file.lo lib/poll-loop.lo
> lib/process.lo lib/random.lo lib/rconn.lo lib/reconnect.lo lib/seq.lo
> lib/sha1.lo lib/shash.lo lib/simap.lo lib/smap.lo lib/socket-util.lo
> lib/sort.lo lib/sset.lo lib/stp.lo lib/stream-tcp.lo lib/stream.lo
> lib/stdio.lo lib/string.lo lib/svec.lo lib/table.lo lib/tag.lo lib/timer.lo
> lib/timeval.lo lib/token-bucket.lo lib/unicode.lo lib/unixctl.lo
> lib/util.lo lib/uuid.lo lib/vconn-stream.lo lib/vconn.lo lib/vlan-bitmap.lo
> lib/vlandev.lo lib/vlog.lo lib/vswitch-idl.lo lib/vtep-idl.lo
>  lib/daemon-unix.lo lib/latch-unix.lo lib/signals.lo lib/stream-fd-unix.lo
> lib/stream-unix.lo lib/dpif-linux.lo lib/netdev-linux.lo
> lib/netlink-notifier.lo lib/netlink-socket.lo lib/rtnetlink-link.lo
> lib/route-table.lo  lib/async-append-aio.lo    lib/stream-ssl.lo
>  lib/dirs.lo lib/dhparams.lo -lssl -lcrypto   -latomic -lpthread -lrt -lm
> libtool: link: rm -fr  lib/.libs/libopenvswitch.a lib/.libs/
> libopenvswitch.la lib/.libs/libopenvswitch.lai
> libtool: link: ar cru lib/.libs/libopenvswitch.a  lib/aes128.o
> lib/backtrace.o lib/bfd.o lib/bitmap.o lib/bundle.o lib/byteq.o lib/cfm.o
> lib/classifier.o lib/command-line.o lib/connectivity.o lib/coverage.o
> lib/crc32c.o lib/csum.o lib/daemon.o lib/dummy.o lib/dpif-netdev.o
> lib/dpif.o lib/heap.o lib/dynamic-string.o lib/entropy.o lib/fat-rwlock.o
> lib/fatal-signal.o lib/flow.o lib/guarded-list.o lib/hash.o lib/hindex.o
> lib/hmap.o lib/hmapx.o lib/jhash.o lib/json.o lib/jsonrpc.o lib/lacp.o
> lib/learn.o lib/learning-switch.o lib/list.o lib/lockfile.o
> lib/mac-learning.o lib/match.o lib/memory.o lib/meta-flow.o lib/multipath.o
> lib/netdev-dummy.o lib/netdev-vport.o lib/netdev.o lib/netlink.o
> lib/nx-match.o lib/odp-execute.o lib/odp-util.o lib/ofp-actions.o
> lib/ofp-errors.o lib/ofp-msgs.o lib/ofp-parse.o lib/ofp-print.o
> lib/ofp-util.o lib/ofp-version-opt.o lib/ofpbuf.o lib/ovs-atomic-locked.o
> lib/ovs-rcu.o lib/ovs-thread.o lib/ovsdb-data.o lib/ovsdb-error.o
> lib/ovsdb-idl.o lib/ovsdb-parser.o lib/ovsdb-types.o lib/packets.o
> lib/pcap-file.o lib/poll-loop.o lib/process.o lib/random.o lib/rconn.o
> lib/reconnect.o lib/seq.o lib/sha1.o lib/shash.o lib/simap.o lib/smap.o
> lib/socket-util.o lib/sort.o lib/sset.o lib/stp.o lib/stream-tcp.o
> lib/stream.o lib/stdio.o lib/string.o lib/svec.o lib/table.o lib/tag.o
> lib/timer.o lib/timeval.o lib/token-bucket.o lib/unicode.o lib/unixctl.o
> lib/util.o lib/uuid.o lib/vconn-stream.o lib/vconn.o lib/vlan-bitmap.o
> lib/vlandev.o lib/vlog.o lib/vswitch-idl.o lib/vtep-idl.o lib/daemon-unix.o
> lib/latch-unix.o lib/signals.o lib/stream-fd-unix.o lib/stream-unix.o
> lib/dpif-linux.o lib/netdev-linux.o lib/netlink-notifier.o
> lib/netlink-socket.o lib/rtnetlink-link.o lib/route-table.o
> lib/async-append-aio.o lib/stream-ssl.o lib/dirs.o lib/dhparams.o
> libtool: link: ranlib lib/.libs/libopenvswitch.a
> libtool: link: ( cd "lib/.libs" && rm -f "libopenvswitch.la" && ln -s "../
> libopenvswitch.la" "libopenvswitch.la" )
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -Wno-unused -Wno-unused-parameter -g -O2 -MT
> lib/lib_libsflow_la-sflow_agent.lo -MD -MP -MF
> lib/.deps/lib_libsflow_la-sflow_agent.Tpo -c -o
> lib/lib_libsflow_la-sflow_agent.lo `test -f 'lib/sflow_agent.c' || echo
> './'`lib/sflow_agent.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -Wno-unused
> -Wno-unused-parameter -g -O2 -MT lib/lib_libsflow_la-sflow_agent.lo -MD -MP
> -MF lib/.deps/lib_libsflow_la-sflow_agent.Tpo -c lib/sflow_agent.c -o
> lib/lib_libsflow_la-sflow_agent.o
> mv -f lib/.deps/lib_libsflow_la-sflow_agent.Tpo
> lib/.deps/lib_libsflow_la-sflow_agent.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -Wno-unused -Wno-unused-parameter -g -O2 -MT
> lib/lib_libsflow_la-sflow_sampler.lo -MD -MP -MF
> lib/.deps/lib_libsflow_la-sflow_sampler.Tpo -c -o
> lib/lib_libsflow_la-sflow_sampler.lo `test -f 'lib/sflow_sampler.c' || echo
> './'`lib/sflow_sampler.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -Wno-unused
> -Wno-unused-parameter -g -O2 -MT lib/lib_libsflow_la-sflow_sampler.lo -MD
> -MP -MF lib/.deps/lib_libsflow_la-sflow_sampler.Tpo -c lib/sflow_sampler.c
> -o lib/lib_libsflow_la-sflow_sampler.o
> mv -f lib/.deps/lib_libsflow_la-sflow_sampler.Tpo
> lib/.deps/lib_libsflow_la-sflow_sampler.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -Wno-unused -Wno-unused-parameter -g -O2 -MT
> lib/lib_libsflow_la-sflow_poller.lo -MD -MP -MF
> lib/.deps/lib_libsflow_la-sflow_poller.Tpo -c -o
> lib/lib_libsflow_la-sflow_poller.lo `test -f 'lib/sflow_poller.c' || echo
> './'`lib/sflow_poller.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -Wno-unused
> -Wno-unused-parameter -g -O2 -MT lib/lib_libsflow_la-sflow_poller.lo -MD
> -MP -MF lib/.deps/lib_libsflow_la-sflow_poller.Tpo -c lib/sflow_poller.c -o
> lib/lib_libsflow_la-sflow_poller.o
> mv -f lib/.deps/lib_libsflow_la-sflow_poller.Tpo
> lib/.deps/lib_libsflow_la-sflow_poller.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -Wno-unused -Wno-unused-parameter -g -O2 -MT
> lib/lib_libsflow_la-sflow_receiver.lo -MD -MP -MF
> lib/.deps/lib_libsflow_la-sflow_receiver.Tpo -c -o
> lib/lib_libsflow_la-sflow_receiver.lo `test -f 'lib/sflow_receiver.c' ||
> echo './'`lib/sflow_receiver.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -Wno-unused
> -Wno-unused-parameter -g -O2 -MT lib/lib_libsflow_la-sflow_receiver.lo -MD
> -MP -MF lib/.deps/lib_libsflow_la-sflow_receiver.Tpo -c
> lib/sflow_receiver.c -o lib/lib_libsflow_la-sflow_receiver.o
> mv -f lib/.deps/lib_libsflow_la-sflow_receiver.Tpo
> lib/.deps/lib_libsflow_la-sflow_receiver.Plo
> /bin/bash ./libtool  --tag=CC   --mode=link gcc -Wstrict-prototypes -Wall
> -Wextra -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -Wno-unused -Wno-unused-parameter -g -O2
> -release 2.3.1  -o lib/libsflow.la -rpath /usr/local/lib
> lib/lib_libsflow_la-sflow_agent.lo lib/lib_libsflow_la-sflow_sampler.lo
> lib/lib_libsflow_la-sflow_poller.lo lib/lib_libsflow_la-sflow_receiver.lo
>  -latomic -lpthread -lrt -lm
> libtool: link: rm -fr  lib/.libs/libsflow.a lib/.libs/libsflow.la
> lib/.libs/libsflow.lai
> libtool: link: ar cru lib/.libs/libsflow.a
>  lib/lib_libsflow_la-sflow_agent.o lib/lib_libsflow_la-sflow_sampler.o
> lib/lib_libsflow_la-sflow_poller.o lib/lib_libsflow_la-sflow_receiver.o
> libtool: link: ranlib lib/.libs/libsflow.a
> libtool: link: ( cd "lib/.libs" && rm -f "libsflow.la" && ln -s "../
> libsflow.la" "libsflow.la" )
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-bond.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-bond.Tpo -c -o
> ofproto/ofproto_libofproto_la-bond.lo `test -f 'ofproto/bond.c' || echo
> './'`ofproto/bond.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-bond.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-bond.Tpo -c ofproto/bond.c -o
> ofproto/ofproto_libofproto_la-bond.o
> mv -f ofproto/.deps/ofproto_libofproto_la-bond.Tpo
> ofproto/.deps/ofproto_libofproto_la-bond.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-collectors.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-collectors.Tpo -c -o
> ofproto/ofproto_libofproto_la-collectors.lo `test -f 'ofproto/collectors.c'
> || echo './'`ofproto/collectors.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-collectors.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-collectors.Tpo -c ofproto/collectors.c
> -o ofproto/ofproto_libofproto_la-collectors.o
> mv -f ofproto/.deps/ofproto_libofproto_la-collectors.Tpo
> ofproto/.deps/ofproto_libofproto_la-collectors.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-connmgr.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-connmgr.Tpo -c -o
> ofproto/ofproto_libofproto_la-connmgr.lo `test -f 'ofproto/connmgr.c' ||
> echo './'`ofproto/connmgr.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-connmgr.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-connmgr.Tpo -c ofproto/connmgr.c -o
> ofproto/ofproto_libofproto_la-connmgr.o
> mv -f ofproto/.deps/ofproto_libofproto_la-connmgr.Tpo
> ofproto/.deps/ofproto_libofproto_la-connmgr.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-fail-open.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-fail-open.Tpo -c -o
> ofproto/ofproto_libofproto_la-fail-open.lo `test -f 'ofproto/fail-open.c'
> || echo './'`ofproto/fail-open.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-fail-open.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-fail-open.Tpo -c ofproto/fail-open.c -o
> ofproto/ofproto_libofproto_la-fail-open.o
> mv -f ofproto/.deps/ofproto_libofproto_la-fail-open.Tpo
> ofproto/.deps/ofproto_libofproto_la-fail-open.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-in-band.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-in-band.Tpo -c -o
> ofproto/ofproto_libofproto_la-in-band.lo `test -f 'ofproto/in-band.c' ||
> echo './'`ofproto/in-band.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-in-band.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-in-band.Tpo -c ofproto/in-band.c -o
> ofproto/ofproto_libofproto_la-in-band.o
> mv -f ofproto/.deps/ofproto_libofproto_la-in-band.Tpo
> ofproto/.deps/ofproto_libofproto_la-in-band.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-names.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-names.Tpo -c -o
> ofproto/ofproto_libofproto_la-names.lo `test -f 'ofproto/names.c' || echo
> './'`ofproto/names.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-names.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-names.Tpo -c ofproto/names.c -o
> ofproto/ofproto_libofproto_la-names.o
> mv -f ofproto/.deps/ofproto_libofproto_la-names.Tpo
> ofproto/.deps/ofproto_libofproto_la-names.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-netflow.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-netflow.Tpo -c -o
> ofproto/ofproto_libofproto_la-netflow.lo `test -f 'ofproto/netflow.c' ||
> echo './'`ofproto/netflow.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-netflow.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-netflow.Tpo -c ofproto/netflow.c -o
> ofproto/ofproto_libofproto_la-netflow.o
> mv -f ofproto/.deps/ofproto_libofproto_la-netflow.Tpo
> ofproto/.deps/ofproto_libofproto_la-netflow.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-ofproto.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-ofproto.Tpo -c -o
> ofproto/ofproto_libofproto_la-ofproto.lo `test -f 'ofproto/ofproto.c' ||
> echo './'`ofproto/ofproto.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-ofproto.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-ofproto.Tpo -c ofproto/ofproto.c -o
> ofproto/ofproto_libofproto_la-ofproto.o
> mv -f ofproto/.deps/ofproto_libofproto_la-ofproto.Tpo
> ofproto/.deps/ofproto_libofproto_la-ofproto.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-ofproto-dpif.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif.Tpo -c -o
> ofproto/ofproto_libofproto_la-ofproto-dpif.lo `test -f
> 'ofproto/ofproto-dpif.c' || echo './'`ofproto/ofproto-dpif.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-ofproto-dpif.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif.Tpo -c
> ofproto/ofproto-dpif.c -o ofproto/ofproto_libofproto_la-ofproto-dpif.o
> mv -f ofproto/.deps/ofproto_libofproto_la-ofproto-dpif.Tpo
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-ofproto-dpif-ipfix.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-ipfix.Tpo -c -o
> ofproto/ofproto_libofproto_la-ofproto-dpif-ipfix.lo `test -f
> 'ofproto/ofproto-dpif-ipfix.c' || echo './'`ofproto/ofproto-dpif-ipfix.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-ofproto-dpif-ipfix.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-ipfix.Tpo -c
> ofproto/ofproto-dpif-ipfix.c -o
> ofproto/ofproto_libofproto_la-ofproto-dpif-ipfix.o
> mv -f ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-ipfix.Tpo
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-ipfix.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-ofproto-dpif-mirror.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-mirror.Tpo -c -o
> ofproto/ofproto_libofproto_la-ofproto-dpif-mirror.lo `test -f
> 'ofproto/ofproto-dpif-mirror.c' || echo './'`ofproto/ofproto-dpif-mirror.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-ofproto-dpif-mirror.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-mirror.Tpo -c
> ofproto/ofproto-dpif-mirror.c -o
> ofproto/ofproto_libofproto_la-ofproto-dpif-mirror.o
> mv -f ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-mirror.Tpo
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-mirror.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-ofproto-dpif-monitor.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-monitor.Tpo -c -o
> ofproto/ofproto_libofproto_la-ofproto-dpif-monitor.lo `test -f
> 'ofproto/ofproto-dpif-monitor.c' || echo './'`ofproto/ofproto-dpif-monitor.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-ofproto-dpif-monitor.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-monitor.Tpo -c
> ofproto/ofproto-dpif-monitor.c -o
> ofproto/ofproto_libofproto_la-ofproto-dpif-monitor.o
> mv -f ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-monitor.Tpo
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-monitor.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-ofproto-dpif-rid.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-rid.Tpo -c -o
> ofproto/ofproto_libofproto_la-ofproto-dpif-rid.lo `test -f
> 'ofproto/ofproto-dpif-rid.c' || echo './'`ofproto/ofproto-dpif-rid.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-ofproto-dpif-rid.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-rid.Tpo -c
> ofproto/ofproto-dpif-rid.c -o
> ofproto/ofproto_libofproto_la-ofproto-dpif-rid.o
> mv -f ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-rid.Tpo
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-rid.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-ofproto-dpif-sflow.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-sflow.Tpo -c -o
> ofproto/ofproto_libofproto_la-ofproto-dpif-sflow.lo `test -f
> 'ofproto/ofproto-dpif-sflow.c' || echo './'`ofproto/ofproto-dpif-sflow.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-ofproto-dpif-sflow.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-sflow.Tpo -c
> ofproto/ofproto-dpif-sflow.c -o
> ofproto/ofproto_libofproto_la-ofproto-dpif-sflow.o
> mv -f ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-sflow.Tpo
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-sflow.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-ofproto-dpif-upcall.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-upcall.Tpo -c -o
> ofproto/ofproto_libofproto_la-ofproto-dpif-upcall.lo `test -f
> 'ofproto/ofproto-dpif-upcall.c' || echo './'`ofproto/ofproto-dpif-upcall.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-ofproto-dpif-upcall.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-upcall.Tpo -c
> ofproto/ofproto-dpif-upcall.c -o
> ofproto/ofproto_libofproto_la-ofproto-dpif-upcall.o
> mv -f ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-upcall.Tpo
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-upcall.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-ofproto-dpif-xlate.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-xlate.Tpo -c -o
> ofproto/ofproto_libofproto_la-ofproto-dpif-xlate.lo `test -f
> 'ofproto/ofproto-dpif-xlate.c' || echo './'`ofproto/ofproto-dpif-xlate.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-ofproto-dpif-xlate.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-xlate.Tpo -c
> ofproto/ofproto-dpif-xlate.c -o
> ofproto/ofproto_libofproto_la-ofproto-dpif-xlate.o
> mv -f ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-xlate.Tpo
> ofproto/.deps/ofproto_libofproto_la-ofproto-dpif-xlate.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-pktbuf.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-pktbuf.Tpo -c -o
> ofproto/ofproto_libofproto_la-pktbuf.lo `test -f 'ofproto/pktbuf.c' || echo
> './'`ofproto/pktbuf.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-pktbuf.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-pktbuf.Tpo -c ofproto/pktbuf.c -o
> ofproto/ofproto_libofproto_la-pktbuf.o
> mv -f ofproto/.deps/ofproto_libofproto_la-pktbuf.Tpo
> ofproto/.deps/ofproto_libofproto_la-pktbuf.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-pinsched.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-pinsched.Tpo -c -o
> ofproto/ofproto_libofproto_la-pinsched.lo `test -f 'ofproto/pinsched.c' ||
> echo './'`ofproto/pinsched.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-pinsched.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-pinsched.Tpo -c ofproto/pinsched.c -o
> ofproto/ofproto_libofproto_la-pinsched.o
> mv -f ofproto/.deps/ofproto_libofproto_la-pinsched.Tpo
> ofproto/.deps/ofproto_libofproto_la-pinsched.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-tunnel.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-tunnel.Tpo -c -o
> ofproto/ofproto_libofproto_la-tunnel.lo `test -f 'ofproto/tunnel.c' || echo
> './'`ofproto/tunnel.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-tunnel.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-tunnel.Tpo -c ofproto/tunnel.c -o
> ofproto/ofproto_libofproto_la-tunnel.o
> mv -f ofproto/.deps/ofproto_libofproto_la-tunnel.Tpo
> ofproto/.deps/ofproto_libofproto_la-tunnel.Plo
> /bin/bash ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I.
>  -I ./include -I ./lib -I ./lib    -Wstrict-prototypes -Wall -Wextra
> -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -MT
> ofproto/ofproto_libofproto_la-bundles.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-bundles.Tpo -c -o
> ofproto/ofproto_libofproto_la-bundles.lo `test -f 'ofproto/bundles.c' ||
> echo './'`ofproto/bundles.c
> libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I ./lib
> -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> ofproto/ofproto_libofproto_la-bundles.lo -MD -MP -MF
> ofproto/.deps/ofproto_libofproto_la-bundles.Tpo -c ofproto/bundles.c -o
> ofproto/ofproto_libofproto_la-bundles.o
> mv -f ofproto/.deps/ofproto_libofproto_la-bundles.Tpo
> ofproto/.deps/ofproto_libofproto_la-bundles.Plo
> /bin/bash ./libtool  --tag=CC   --mode=link gcc -Wstrict-prototypes -Wall
> -Wextra -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> -Wformat-security -Wno-format-zero-length -Wswitch-enum -Wunused-parameter
> -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> -Wmissing-field-initializers  -g -O2 -release 2.3.1  -o ofproto/
> libofproto.la -rpath /usr/local/lib ofproto/ofproto_libofproto_la-bond.lo
> ofproto/ofproto_libofproto_la-collectors.lo
> ofproto/ofproto_libofproto_la-connmgr.lo
> ofproto/ofproto_libofproto_la-fail-open.lo
> ofproto/ofproto_libofproto_la-in-band.lo
> ofproto/ofproto_libofproto_la-names.lo
> ofproto/ofproto_libofproto_la-netflow.lo
> ofproto/ofproto_libofproto_la-ofproto.lo
> ofproto/ofproto_libofproto_la-ofproto-dpif.lo
> ofproto/ofproto_libofproto_la-ofproto-dpif-ipfix.lo
> ofproto/ofproto_libofproto_la-ofproto-dpif-mirror.lo
> ofproto/ofproto_libofproto_la-ofproto-dpif-monitor.lo
> ofproto/ofproto_libofproto_la-ofproto-dpif-rid.lo
> ofproto/ofproto_libofproto_la-ofproto-dpif-sflow.lo
> ofproto/ofproto_libofproto_la-ofproto-dpif-upcall.lo
> ofproto/ofproto_libofproto_la-ofproto-dpif-xlate.lo
> ofproto/ofproto_libofproto_la-pktbuf.lo
> ofproto/ofproto_libofproto_la-pinsched.lo
> ofproto/ofproto_libofproto_la-tunnel.lo
> ofproto/ofproto_libofproto_la-bundles.lo lib/libsflow.la  -latomic
> -lpthread -lrt -lm
> libtool: link: rm -fr  ofproto/.libs/libofproto.a
> libtool: link: ar cru ofproto/.libs/libofproto.a
>  ofproto/ofproto_libofproto_la-bond.o
> ofproto/ofproto_libofproto_la-collectors.o
> ofproto/ofproto_libofproto_la-connmgr.o
> ofproto/ofproto_libofproto_la-fail-open.o
> ofproto/ofproto_libofproto_la-in-band.o
> ofproto/ofproto_libofproto_la-names.o
> ofproto/ofproto_libofproto_la-netflow.o
> ofproto/ofproto_libofproto_la-ofproto.o
> ofproto/ofproto_libofproto_la-ofproto-dpif.o
> ofproto/ofproto_libofproto_la-ofproto-dpif-ipfix.o
> ofproto/ofproto_libofproto_la-ofproto-dpif-mirror.o
> ofproto/ofproto_libofproto_la-ofproto-dpif-monitor.o
> ofproto/ofproto_libofproto_la-ofproto-dpif-rid.o
> ofproto/ofproto_libofproto_la-ofproto-dpif-sflow.o
> ofproto/ofproto_libofproto_la-ofproto-dpif-upcall.o
> ofproto/ofproto_libofproto_la-ofproto-dpif-xlate.o
> ofproto/ofproto_libofproto_la-pktbuf.o
> ofproto/ofproto_libofproto_la-pinsched.o
> ofproto/ofproto_libofproto_la-tunnel.o
> ofproto/ofproto_libofproto_la-bundles.o
> libtool: link: ranlib ofproto/.libs/libofproto.a
> /bin/sed: can't read vSwitch/openvswitch-2.3.1/lib/libsflow.la: No such
> file or directory
> libtool: link: `vSwitch/openvswitch-2.3.1/lib/libsflow.la' is not a valid
> libtool archive
> Makefile:2084: recipe for target 'ofproto/libofproto.la' failed
> make[2]: *** [ofproto/libofproto.la] Error 1
> make[2]: Leaving directory '/home/actionmystique/Program-Files/Ubuntu/Open
> vSwitch/openvswitch-2.3.1'
> Makefile:3775: recipe for target 'all-recursive' failed
> make[1]: *** [all-recursive] Error 1
> make[1]: Leaving directory '/home/actionmystique/Program-Files/Ubuntu/Open
> vSwitch/openvswitch-2.3.1'
> Makefile:1776: recipe for target 'all' failed
> make: *** [all] Error 2
> 
> 
> On Wed, Apr 22, 2015 at 7:26 PM, Ben Pfaff <blp at nicira.com> wrote:
> 
> > On Tue, Apr 21, 2015 at 2:50 AM, jean-christophe manciot
> > <actionmystique at gmail.com> wrote:
> > > ./configure CONFIG_TUN=Yes
> >
> > You can't enable Linux kernel configuration items through configure.
> > You have to
> > use the Linux kernel configuration process.
> >
> > > make
> > > ...
> > > "libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I ./include -I ./lib -I
> > ./lib
> > > -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith
> > > -Wdeclaration-after-statement -Wformat-security -Wno-format-zero-length
> > > -Wswitch-enum -Wunused-parameter -Wstrict-aliasing -Wbad-function-cast
> > > -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -g -O2 -MT
> > > ofproto/ofproto_libofproto_la-bundles.lo -MD -MP -MF
> > > ofproto/.deps/ofproto_libofproto_la-bundles.Tpo -c ofproto/bundles.c -o
> > > ofproto/ofproto_libofproto_la-bundles.o
> > > mv -f ofproto/.deps/ofproto_libofproto_la-bundles.Tpo
> > > ofproto/.deps/ofproto_libofproto_la-bundles.Plo
> > > /bin/bash ./libtool  --tag=CC   --mode=link gcc -Wstrict-prototypes -Wall
> > > -Wextra -Wno-sign-compare -Wpointer-arith -Wdeclaration-after-statement
> > > -Wformat-security -Wno-format-zero-length -Wswitch-enum
> > -Wunused-parameter
> > > -Wstrict-aliasing -Wbad-function-cast -Wcast-align -Wmissing-prototypes
> > > -Wmissing-field-initializers  -g -O2 -release 2.3.1  -o
> > > ofproto/libofproto.la -rpath /usr/local/lib
> > > ofproto/ofproto_libofproto_la-bond.lo
> > > ofproto/ofproto_libofproto_la-collectors.lo
> > > ofproto/ofproto_libofproto_la-connmgr.lo
> > > ofproto/ofproto_libofproto_la-fail-open.lo
> > > ofproto/ofproto_libofproto_la-in-band.lo
> > > ofproto/ofproto_libofproto_la-names.lo
> > > ofproto/ofproto_libofproto_la-netflow.lo
> > > ofproto/ofproto_libofproto_la-ofproto.lo
> > > ofproto/ofproto_libofproto_la-ofproto-dpif.lo
> > > ofproto/ofproto_libofproto_la-ofproto-dpif-ipfix.lo
> > > ofproto/ofproto_libofproto_la-ofproto-dpif-mirror.lo
> > > ofproto/ofproto_libofproto_la-ofproto-dpif-monitor.lo
> > > ofproto/ofproto_libofproto_la-ofproto-dpif-rid.lo
> > > ofproto/ofproto_libofproto_la-ofproto-dpif-sflow.lo
> > > ofproto/ofproto_libofproto_la-ofproto-dpif-upcall.lo
> > > ofproto/ofproto_libofproto_la-ofproto-dpif-xlate.lo
> > > ofproto/ofproto_libofproto_la-pktbuf.lo
> > > ofproto/ofproto_libofproto_la-pinsched.lo
> > > ofproto/ofproto_libofproto_la-tunnel.lo
> > > ofproto/ofproto_libofproto_la-bundles.lo lib/libsflow.la  -latomic
> > -lpthread
> > > -lrt -lm
> > > libtool: link: ar cru ofproto/.libs/libofproto.a
> > > ofproto/ofproto_libofproto_la-bond.o
> > > ofproto/ofproto_libofproto_la-collectors.o
> > > ofproto/ofproto_libofproto_la-connmgr.o
> > > ofproto/ofproto_libofproto_la-fail-open.o
> > > ofproto/ofproto_libofproto_la-in-band.o
> > > ofproto/ofproto_libofproto_la-names.o
> > > ofproto/ofproto_libofproto_la-netflow.o
> > > ofproto/ofproto_libofproto_la-ofproto.o
> > > ofproto/ofproto_libofproto_la-ofproto-dpif.o
> > > ofproto/ofproto_libofproto_la-ofproto-dpif-ipfix.o
> > > ofproto/ofproto_libofproto_la-ofproto-dpif-mirror.o
> > > ofproto/ofproto_libofproto_la-ofproto-dpif-monitor.o
> > > ofproto/ofproto_libofproto_la-ofproto-dpif-rid.o
> > > ofproto/ofproto_libofproto_la-ofproto-dpif-sflow.o
> > > ofproto/ofproto_libofproto_la-ofproto-dpif-upcall.o
> > > ofproto/ofproto_libofproto_la-ofproto-dpif-xlate.o
> > > ofproto/ofproto_libofproto_la-pktbuf.o
> > > ofproto/ofproto_libofproto_la-pinsched.o
> > > ofproto/ofproto_libofproto_la-tunnel.o
> > > ofproto/ofproto_libofproto_la-bundles.o
> > > libtool: link: ranlib ofproto/.libs/libofproto.a
> > > /bin/sed: can't read vSwitch/openvswitch-2.3.1/lib/libsflow.la: No such
> > file
> > > or directory
> > > libtool: link: `vSwitch/openvswitch-2.3.1/lib/libsflow.la' is not a
> > valid
> > > libtool archive
> >
> > This probably indicates some kind of local problem.  Please provide the
> > whole compilation log instead of just the last few lines.
> > --
> > "I don't normally do acked-by's.  I think it's my way of avoiding
> > getting blamed when it all blows up."               Andrew Morton
> >
> 
> 
> 
> -- 
> Jean-Christophe

From blp at nicira.com  Thu Apr 23 11:18:01 2015
From: blp at nicira.com (Ben Pfaff)
Date: Thu, 23 Apr 2015 11:18:01 -0700
Subject: [ovs-discuss] Temporary loss of network connection during
 addition of a port to bridge
In-Reply-To: <5538AD3F.3030908@smorg.co.uk>
References: <5538AD3F.3030908@smorg.co.uk>
Message-ID: <20150423181801.GC30938@nicira.com>

On Thu, Apr 23, 2015 at 09:28:47AM +0100, Mark Clarkson wrote:
> This has been asked before on this list but with no reply.
> 
> I have three ovs bridges on three physical hosts connected by ovs gre
> tunnels. STP is enabled.
> 
> Linux containers are added to the bridge using 'ovs-vsctl add-port br0
> vethXXX'.
> 
> When 'add-port' is used the bridge loses connectivity for 15-20 seconds - I
> presume it enters a learning state and the bridge goes into blocking mode.
> 
> This is terrible for the system as connectivity is lost to all machines
> connected to the bridge, and linux containers are added and deleted
> frequently - they are transient build nodes with a short lifespan.
> 
> Is there any way to stop from losing connection?

I don't think that the behavior you describe is intentional.  It sounds
like a bug or an unexpected interaction between features.  I think
you'll have to investigate and figure out why it's happening, and then
once we understand that it can be fixed.

From blp at nicira.com  Thu Apr 23 12:30:02 2015
From: blp at nicira.com (Ben Pfaff)
Date: Thu, 23 Apr 2015 12:30:02 -0700
Subject: [ovs-discuss] Skip testsuite.patch application during
	compilation
In-Reply-To: <CAHbON5qg4XKmaQ1ruDQp=dVhOf86z2g_9ODmgDVJCtNoGQgstg@mail.gmail.com>
References: <CD7C01071941AC429549C17338DB8A52698B714C@IRSMSX101.ger.corp.intel.com>
 <CAHbON5p9Y1dLXV9OFc_bic6OFDcPi-monFshEyZMUyC9SQULXA@mail.gmail.com>
 <CAHbON5qg4XKmaQ1ruDQp=dVhOf86z2g_9ODmgDVJCtNoGQgstg@mail.gmail.com>
Message-ID: <20150423193002.GE30938@nicira.com>

The testsuite is a distributed file, so applying it only on Windows
means that wherever you run "make dist" affects its capabilities.  Maybe
that's OK in this case though.

On Thu, Apr 23, 2015 at 07:51:59AM -0700, Gurucharan Shetty wrote:
> fwiw, I was able to reproduce the problem on Centos 6 with autoconf
> 2.63. I think it makes sense that we do the patching only on Windows.
> I will try to come up with a patch.
> 
> On Thu, Apr 23, 2015 at 7:05 AM, Gurucharan Shetty <shettyg at nicira.com> wrote:
> > On Thu, Apr 23, 2015 at 2:53 AM, Stokes, Ian <ian.stokes at intel.com> wrote:
> >> Hi all,
> >>
> >> I'm attempting to compile OVS with DPDK on CentOS 6.6 and I am hitting an issue with testsuite.patch failing to apply during the last stages of compilation. I can see that the structure of the code in ovs/tests/testsuite itself is very different to what testsuite.patch expects (hence why it fails).
> >
> > Do you see the same problem while compiling OVS without dpdk on
> > Centos6.6? The patch was added a couple of months ago and I have not
> > seen any build failures because of that either in Windows or Linux.
> > The patch was added thinking that the build does not fail anywhere.
> > But it looks like it does and I wonder whether it is because of a
> > different autoconf version or something along those lines? Do see the
> > failures on Ubuntu?
> >
> >>
> >> Looking at first few lines of code below from testsuite.patch it seems this patch is only relevant if running in a windows environment
> > That is true.
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss

From vgarg at fortinet.com  Wed Apr 22 12:07:19 2015
From: vgarg at fortinet.com (Vipin Garg)
Date: Wed, 22 Apr 2015 19:07:19 +0000
Subject: [ovs-discuss] undefined reference to `__atomic_load_8'
Message-ID: <82C0CCFDFF96FC49AE329EF02BD579233B7102EE@FGT-EXCH-MBX211.fortinet-us.com>


Hello,

I downloaded openvswitch-ovs-v1.1.0pre2-8269-g186de41.tar and cross-compiling it for PowerPC platform and I am seeing following linking errors -

libtool: link: /fortidev4-ppce500/bin/powerpc-unknown-linux-gnuspe-gcc -std=gnu99 -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare -Wpointer-arith -Wno-format-zero-length -Wswitch-enum -Wunused-parameter -Wbad-function-cast -Wcast-align -Wmissing-prototypes -Wmissing-field-initializers -fno-strict-aliasing -I/fortidev4-ppce500/powerpc-unknown-linux-gnuspe/include/ -I/fortidev4-ppce500/include -o utilities/ovs-testcontroller utilities/ovs-testcontroller.o  lib/.libs/libopenvswitch.a -lpthread -lrt -lm
lib/.libs/libopenvswitch.a(dpif-netdev.o): In function `dpif_netdev_pmd_info':
dpif-netdev.c:(.text+0x24d0): undefined reference to `__atomic_load_8'
dpif-netdev.c:(.text+0x253c): undefined reference to `__atomic_load_8'
lib/.libs/libopenvswitch.a(dpif-netdev.o): In function `non_atomic_ullong_add':
dpif-netdev.c:(.text+0x31e4): undefined reference to `__atomic_load_8'
dpif-netdev.c:(.text+0x3230): undefined reference to `__atomic_store_8'
lib/.libs/libopenvswitch.a(dpif-netdev.o): In function `dpif_netdev_get_stats':
dpif-netdev.c:(.text+0x3350): undefined reference to `__atomic_load_8'
dpif-netdev.c:(.text+0x33a0): undefined reference to `__atomic_load_8'
dpif-netdev.c:(.text+0x33f0): undefined reference to `__atomic_load_8'
dpif-netdev.c:(.text+0x3440): undefined reference to `__atomic_load_8'
lib/.libs/libopenvswitch.a(dpif-netdev.o): In function `get_dpif_flow_stats':
dpif-netdev.c:(.text+0x5a6c): undefined reference to `__atomic_load_8'
lib/.libs/libopenvswitch.a(dpif-netdev.o):dpif-netdev.c:(.text+0x5aa4): more undefined references to `__atomic_load_8' follow
lib/.libs/libopenvswitch.a(dpif-netdev.o): In function `dp_netdev_flow_used':
dpif-netdev.c:(.text+0x8d60): undefined reference to `__atomic_store_8'
collect2: error: ld returned 1 exit status


Please let me know if anyone has any advice on how to fix this.

Thanks
Vipin Garg



***  Please note that this message and any attachments may contain confidential 
and proprietary material and information and are intended only for the use of 
the intended recipient(s). If you are not the intended recipient, you are hereby 
notified that any review, use, disclosure, dissemination, distribution or copying 
of this message and any attachments is strictly prohibited. If you have received 
this email in error, please immediately notify the sender and destroy this e-mail 
and any attachments and all copies, whether electronic or printed.
Please also note that any views, opinions, conclusions or commitments expressed 
in this message are those of the individual sender and do not necessarily reflect 
the views of Fortinet, Inc., its affiliates, and emails are not binding on 
Fortinet and only a writing manually signed by Fortinet's General Counsel can be 
a binding commitment of Fortinet to Fortinet's customers or partners. Thank you. ***
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150422/917fa6f2/attachment-0001.html>

From Tony.vanderPeet at alliedtelesis.co.nz  Wed Apr 22 17:03:08 2015
From: Tony.vanderPeet at alliedtelesis.co.nz (Tony van der Peet)
Date: Thu, 23 Apr 2015 00:03:08 +0000
Subject: [ovs-discuss] IGMP fields added to the flow structure causes
	problem?
Message-ID: <553836BC.4040606@alliedtelesis.co.nz>

I have been investigating some anomalous behaviour in a switch (developed by us, based on OpenVSwitch code). It appears that flows added as a result of receiving IGMP packets are never deleted. Here's one of the flows (this is a switch running a simple MAC learning application, so you don't see the upper level fields).

recirc_id(0),in_port(2),eth(src=38:60:77:8b:d9:0a,dst=01:00:5e:00:00:16),eth_type(0x0800),ipv4(frag=no), packets:26, bytes:2236, used:9.600s, actions:1,6,5,4,3

Here's a log message I'm seeing:

2015 Apr 23 12:33:23 awplus ovs-vswitchd: 02570|dpif(revalidator4)|WARN|system at ovs-system: failed to flow_del (No such file or directory)
 skb_priority(0),skb_mark(0),recirc_id(0),dp_hash(0),in_port(2),eth(src=38:60:77:8b:d9:0a,dst=01:00:5e:00:00:16),eth_type(0x0800),ipv4(src=10.33.22.24,dst=224.0.0.22,proto=2,tos=0xc0,ttl=1,frag=no)

Here's some debugging I added myself (not the same flow as above):

adding flow, hash=-212754412, dmac=01-00-5e-00-00-16, dp_hash=0
  00000000   00000000   00000000   00000000   00000000   00000000   00000000   00000000
  00000000   00000000   00000000   00000000   00000000   00000000   00000000   00000000
  00000000   00000000   00000000   00000002   01005e00   00163860   778bd90a   08000000
  00000000   00000000   00000000   00000000   00000000   00000000   00000000   00000000
  00000000   00000000   00000000   00000000   0a211618   e0000016   00c00102   00000000
  00000000   00000000   00000000   00000000   00000000   00000000   00000000  *00220000*
 *00000001*  00000000
deleting flow, lookup failed, hash=801760725, dmac=01-00-5e-00-00-16, dp_hash=0
  00000000   00000000   00000000   00000000   00000000   00000000   00000000   00000000
  00000000   00000000   00000000   00000000   00000000   00000000   00000000   00000000
  00000000   00000000   00000000   00000002   01005e00   00163860   778bd90a   08000000
  00000000   00000000   00000000   00000000   00000000   00000000   00000000   00000000
  00000000   00000000   00000000   00000000   0a211618   e0000016   00c00102   00000000
  00000000   00000000   00000000   00000000   00000000   00000000   00000000  *00000000*
 *00000000*  00000000

This is showing a hex dump of the relevant flow structures. the highlighted fields are obviously different, and happen to be these:

    ovs_be16 tp_src;            /* TCP/UDP/SCTP source port. */
    ovs_be16 tp_dst;            /* TCP/UDP/SCTP destination port. */
    ovs_be32 igmp_group_ip4;    /* IGMP group IPv4 address */
I have tracked this down (I believe) to the lack of support for these fields (for IGMP packets at least) in odp_flow_key_to_flow__ and odp_flow_key_from_flow__. Looking at some of the conversation around the original commits that added support for IGMP to the flow, I can see that some work may have been deferred, but there is some question as to whether we want this supported anyway. I would like to fix this issue if possible, but have some questions:

1 - is my analysis correct?
2 - is there more to fix than just the routines I mentioned? (I know, I should make the change and try it out, but it appears a bit more extensive than I first thought, including adding to enum ovs_key_attr, which I wouldn't do lightly.)
3 - is there something different I should be doing to fix my issue? (I have the option of not adding the flows in my dpif (a variant of dpif-netdev) which will solve the problem, but would possibly just be papering over this issue).

Note that I updated our OVS from GitHub in Sep/2014. I have checked and there don't appear to be any subsequent commits that would address this.

Thanks
Tony
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150423/fdb95c03/attachment-0001.html>

From b436412 at gmail.com  Thu Apr 23 05:35:54 2015
From: b436412 at gmail.com (Jace Liang)
Date: Thu, 23 Apr 2015 20:35:54 +0800
Subject: [ovs-discuss] ovs-vswitchd error, failed to run.
Message-ID: <CAJHT=fGyn0eOO+exRmaTSgLuKhR9OGyBhxCNTLTPCeiJsgpn0w@mail.gmail.com>

Hello,

I'm using ovs 2.3.0
and if I command "ovs-vswitchd --pidfile --detach --log-file"

there will be an error like this

2015-04-23T12:30:09Z|00002|reconnect|INFO|unix:/usr/local/var/run/openvswitch/db.sock:
connecting...
2015-04-23T12:30:09Z|00003|reconnect|INFO|unix:/usr/local/var/run/openvswitch/db.sock:
connected 2015-04-23T12:30:09Z|00004|netlink_socket|ERR|received invalid
nlmsg (120 bytes < 16)
2015-04-23T12:30:09Z|00005|netlink_socket|ERR|transaction error (Protocol
error) 2015-04-23T12:30:09Z|00006|netlink_socket|ERR|received invalid nlmsg
(120 bytes < 16) 2015-04-23T12:30:09Z|00007|netlink_socket|ERR|transaction
error (Protocol error)



is there any wrong in my ovs?
or any clue to debug?
​

Thank you.
-- 
------------------------------------------------------------------------------------
National Taiwan University Science and Technology
Department of Electronic and Computer Engineering,
Jace Liang , 梁維恩
------------------------------------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150423/6c59bc93/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 11158852_913146095408626_354460827_o.jpg
Type: image/jpeg
Size: 297489 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150423/6c59bc93/attachment-0001.jpg>

From ychetan92 at gmail.com  Thu Apr 23 14:43:12 2015
From: ychetan92 at gmail.com (Chetan R.Y)
Date: Thu, 23 Apr 2015 14:43:12 -0700
Subject: [ovs-discuss] Regarding how to be able to see the discussion groups
Message-ID: <CABszzb=9j2tSZ7sJt_G2zEGcyN3E11ZYYfQbjCCGFrB0hbq7ZQ@mail.gmail.com>

Hi openvswitch,
I am interested in using openvswitch and currently undergoing a project in
it. I would like to gain access to the discussion groups so that i can post
my queries and clear doubts regarding several topics.
Thank you.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150423/baa71344/attachment.html>

From jpettit at nicira.com  Thu Apr 23 15:00:29 2015
From: jpettit at nicira.com (Justin Pettit)
Date: Thu, 23 Apr 2015 15:00:29 -0700
Subject: [ovs-discuss] Regarding how to be able to see the discussion
	groups
In-Reply-To: <CABszzb=9j2tSZ7sJt_G2zEGcyN3E11ZYYfQbjCCGFrB0hbq7ZQ@mail.gmail.com>
References: <CABszzb=9j2tSZ7sJt_G2zEGcyN3E11ZYYfQbjCCGFrB0hbq7ZQ@mail.gmail.com>
Message-ID: <9AB96D25-817D-4CCD-81AA-C2424C1B3C16@nicira.com>

I guess I don't understand the question since you manage to post here.  You can subscribe to the mailing list and see the archives here:

	http://openvswitch.org/mailman/listinfo/discuss

--Justin


> On Apr 23, 2015, at 2:43 PM, Chetan R.Y <ychetan92 at gmail.com> wrote:
> 
> Hi openvswitch,
> I am interested in using openvswitch and currently undergoing a project in it. I would like to gain access to the discussion groups so that i can post my queries and clear doubts regarding several topics.
> Thank you.
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss


From shettyg at nicira.com  Thu Apr 23 15:00:28 2015
From: shettyg at nicira.com (Gurucharan Shetty)
Date: Thu, 23 Apr 2015 15:00:28 -0700
Subject: [ovs-discuss] Regarding how to be able to see the discussion
	groups
In-Reply-To: <CABszzb=9j2tSZ7sJt_G2zEGcyN3E11ZYYfQbjCCGFrB0hbq7ZQ@mail.gmail.com>
References: <CABszzb=9j2tSZ7sJt_G2zEGcyN3E11ZYYfQbjCCGFrB0hbq7ZQ@mail.gmail.com>
Message-ID: <CAHbON5r9zt1TJvRb4qct9EFzaf91hZ0cj0Bxz76YkViHdTSp6Q@mail.gmail.com>

On Thu, Apr 23, 2015 at 2:43 PM, Chetan R.Y <ychetan92 at gmail.com> wrote:
> Hi openvswitch,
> I am interested in using openvswitch and currently undergoing a project in
> it. I would like to gain access to the discussion groups so that i can post
> my queries and clear doubts regarding several topics.
Does the information in the following link help?
http://openvswitch.org/mlists/


> Thank you.
>
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss
>

From shettyg at nicira.com  Thu Apr 23 14:58:23 2015
From: shettyg at nicira.com (Gurucharan Shetty)
Date: Thu, 23 Apr 2015 14:58:23 -0700
Subject: [ovs-discuss] undefined reference to `__atomic_load_8'
In-Reply-To: <82C0CCFDFF96FC49AE329EF02BD579233B7102EE@FGT-EXCH-MBX211.fortinet-us.com>
References: <82C0CCFDFF96FC49AE329EF02BD579233B7102EE@FGT-EXCH-MBX211.fortinet-us.com>
Message-ID: <CAHbON5rF8GuGu1nqEm6Y6YHvYjFuzhaTbaREE55t1krz77XYMQ@mail.gmail.com>

That is weird.


On Wed, Apr 22, 2015 at 12:07 PM, Vipin Garg <vgarg at fortinet.com> wrote:
>
>
> Hello,
>
>
>
> I downloaded openvswitch-ovs-v1.1.0pre2-8269-g186de41.tar and

That version looks odd to me. The code for Windows atomics was added a
lot later. So I wonder whether your source code is not from the OVS
repo but from someone else?

From ychetan92 at gmail.com  Thu Apr 23 16:01:01 2015
From: ychetan92 at gmail.com (Chetan R.Y)
Date: Thu, 23 Apr 2015 16:01:01 -0700
Subject: [ovs-discuss] In regards to subscribe the mailing list.
Message-ID: <CABszzb=Fq1v=DZpGtpx5pNy4-2W8GL-grJ00JvjtrRfqaULO1g@mail.gmail.com>

I have registered and it says "Your subscription request has been received,
and will soon be acted upon. Depending on the configuration of this mailing
list, your subscription request may have to be first confirmed by you via
email, or approved by the list moderator. If confirmation is required, you
will soon get a confirmation email which contains further instructions."

what should i do next?
Thank you.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150423/4549fd95/attachment.html>

From blp at nicira.com  Thu Apr 23 16:08:17 2015
From: blp at nicira.com (Ben Pfaff)
Date: Thu, 23 Apr 2015 16:08:17 -0700
Subject: [ovs-discuss] IGMP fields added to the flow structure causes
 problem?
In-Reply-To: <553836BC.4040606@alliedtelesis.co.nz>
References: <553836BC.4040606@alliedtelesis.co.nz>
Message-ID: <20150423230817.GA1644@nicira.com>

On Thu, Apr 23, 2015 at 12:03:08AM +0000, Tony van der Peet wrote:
> I have been investigating some anomalous behaviour in a switch
> (developed by us, based on OpenVSwitch code). It appears that flows
> added as a result of receiving IGMP packets are never deleted. Here's
> one of the flows (this is a switch running a simple MAC learning
> application, so you don't see the upper level fields).
> 
> recirc_id(0),in_port(2),eth(src=38:60:77:8b:d9:0a,dst=01:00:5e:00:00:16),eth_type(0x0800),ipv4(frag=no), packets:26, bytes:2236, used:9.600s, actions:1,6,5,4,3
> 
> Here's a log message I'm seeing:
> 
> 2015 Apr 23 12:33:23 awplus ovs-vswitchd: 02570|dpif(revalidator4)|WARN|system at ovs-system: failed to flow_del (No such file or directory)
>  skb_priority(0),skb_mark(0),recirc_id(0),dp_hash(0),in_port(2),eth(src=38:60:77:8b:d9:0a,dst=01:00:5e:00:00:16),eth_type(0x0800),ipv4(src=10.33.22.24,dst=224.0.0.22,proto=2,tos=0xc0,ttl=1,frag=no)

Thanks for the report.  I'm a little surprised to hear about this, since
that code is somewhat old (I think you said September 2014) and I don't
remember getting similar reports before.  Can you explain how to
reproduce the problem (with unmodified OVS)?

From mark.clarkson at smorg.co.uk  Thu Apr 23 17:01:07 2015
From: mark.clarkson at smorg.co.uk (Mark Clarkson)
Date: Fri, 24 Apr 2015 01:01:07 +0100
Subject: [ovs-discuss] Temporary loss of network connection during
 addition of a port to bridge
In-Reply-To: <20150423181801.GC30938@nicira.com>
References: <5538AD3F.3030908@smorg.co.uk> <20150423181801.GC30938@nicira.com>
Message-ID: <553987C3.3020908@smorg.co.uk>

On 23/04/15 19:18, Ben Pfaff wrote:
> I don't think that the behavior you describe is intentional.  It sounds
> like a bug or an unexpected interaction between features.  I think
> you'll have to investigate and figure out why it's happening, and then
> once we understand that it can be fixed.
This is also how linux bridge works though, so maybe it is 
intentional(?). Although the linux bridge allows a forwarding delay of 
zero for cases where there's only one bridge.

Doing:

   # ovs-vsctl set bridge br0 other_config:stp-forward-delay=4
   # ovs-vsctl set bridge br0 other_config:stp-max-age=6

, reduces from 15s to 4s delay, but if an existing connection sends data 
during the 'down' time then it receives an RST so the application closes.

I did try to use rstp but openvswitch  replied with an error:

   # ovs-vsctl set bridge br0 rstp_enable=true
   ovs-vsctl: Bridge does not contain a column whose name matches 
"rstp_enable"

rstp_enable is referenced in a man page pdf, 
http://openvswitch.org/ovs-vswitchd.conf.db.5.pdf, so I checked 
http://openvswitch.org/releases/NEWS-2.3.1 but rstp isn't mentioned.

Any idea when rstp will be available?

I have worked around the problem using the standard linux bridge and 
gretap for now, which works surprisingly well, but is there any other 
way to connect ovs bridges (3+ hosts) without the above problems? I 
can't help but think that I'm doing something wrong!


From fbl at sysclose.org  Thu Apr 23 17:17:15 2015
From: fbl at sysclose.org (Flavio Leitner)
Date: Thu, 23 Apr 2015 21:17:15 -0300
Subject: [ovs-discuss] undefined reference to `__atomic_load_8'
In-Reply-To: <82C0CCFDFF96FC49AE329EF02BD579233B7102EE@FGT-EXCH-MBX211.fortinet-us.com>
References: <82C0CCFDFF96FC49AE329EF02BD579233B7102EE@FGT-EXCH-MBX211.fortinet-us.com>
Message-ID: <20150423211715.3ee1ec56@x240.home>

On Wed, 22 Apr 2015 19:07:19 +0000
Vipin Garg <vgarg at fortinet.com> wrote:

> 
> Hello,
> 
> I downloaded openvswitch-ovs-v1.1.0pre2-8269-g186de41.tar and
> cross-compiling it for PowerPC platform and I am seeing following
> linking errors -
> 
> libtool:
> link: /fortidev4-ppce500/bin/powerpc-unknown-linux-gnuspe-gcc
> -std=gnu99 -Wstrict-prototypes -Wall -Wextra -Wno-sign-compare
> -Wpointer-arith -Wno-format-zero-length -Wswitch-enum
> -Wunused-parameter -Wbad-function-cast -Wcast-align
> -Wmissing-prototypes -Wmissing-field-initializers
> -fno-strict-aliasing
> -I/fortidev4-ppce500/powerpc-unknown-linux-gnuspe/include/
> -I/fortidev4-ppce500/include -o utilities/ovs-testcontroller
> utilities/ovs-testcontroller.o  lib/.libs/libopenvswitch.a -lpthread
> -lrt -lm lib/.libs/libopenvswitch.a(dpif-netdev.o): In function
> `dpif_netdev_pmd_info': dpif-netdev.c:(.text+0x24d0): undefined
> reference to `__atomic_load_8' dpif-netdev.c:(.text+0x253c):
> undefined reference to `__atomic_load_8'
> lib/.libs/libopenvswitch.a(dpif-netdev.o): In function
> `non_atomic_ullong_add': dpif-netdev.c:(.text+0x31e4): undefined
> reference to `__atomic_load_8' dpif-netdev.c:(.text+0x3230):
> undefined reference to `__atomic_store_8'
> lib/.libs/libopenvswitch.a(dpif-netdev.o): In function
> `dpif_netdev_get_stats': dpif-netdev.c:(.text+0x3350): undefined
> reference to `__atomic_load_8' dpif-netdev.c:(.text+0x33a0):
> undefined reference to `__atomic_load_8'
> dpif-netdev.c:(.text+0x33f0): undefined reference to
> `__atomic_load_8' dpif-netdev.c:(.text+0x3440): undefined reference
> to `__atomic_load_8' lib/.libs/libopenvswitch.a(dpif-netdev.o): In
> function `get_dpif_flow_stats': dpif-netdev.c:(.text+0x5a6c):
> undefined reference to `__atomic_load_8'
> lib/.libs/libopenvswitch.a(dpif-netdev.o):dpif-netdev.c:(.text+0x5aa4):
> more undefined references to `__atomic_load_8' follow
> lib/.libs/libopenvswitch.a(dpif-netdev.o): In function
> `dp_netdev_flow_used': dpif-netdev.c:(.text+0x8d60): undefined
> reference to `__atomic_store_8' collect2: error: ld returned 1 exit
> status
> 
> 
> Please let me know if anyone has any advice on how to fix this.
> 
> Thanks
> Vipin Garg
> 
> 
> 
> ***  Please note that this message and any attachments may contain
> confidential and proprietary material and information and are
> intended only for the use of the intended recipient(s). If you are
> not the intended recipient, you are hereby notified that any review,
> use, disclosure, dissemination, distribution or copying of this
> message and any attachments is strictly prohibited. If you have
> received this email in error, please immediately notify the sender
> and destroy this e-mail and any attachments and all copies, whether
> electronic or printed. Please also note that any views, opinions,
> conclusions or commitments expressed in this message are those of the
> individual sender and do not necessarily reflect the views of
> Fortinet, Inc., its affiliates, and emails are not binding on
> Fortinet and only a writing manually signed by Fortinet's General
> Counsel can be a binding commitment of Fortinet to Fortinet's
> customers or partners. Thank you. ***

Please remove that from your e-mail as it doesn't fit with the
opensource project goals.

Depending on the GCC version, the atomic functions were moved to
a library, so you need to link to that library too.  Just backport
this commit to your code:
https://github.com/openvswitch/ovs/commit/fd2e50cd333324ca18d8186a5c9211aa03c439cf

fbl




From fbl at sysclose.org  Thu Apr 23 17:25:06 2015
From: fbl at sysclose.org (Flavio Leitner)
Date: Thu, 23 Apr 2015 21:25:06 -0300
Subject: [ovs-discuss] ovs-vswitchd error, failed to run.
In-Reply-To: <CAJHT=fGyn0eOO+exRmaTSgLuKhR9OGyBhxCNTLTPCeiJsgpn0w@mail.gmail.com>
References: <CAJHT=fGyn0eOO+exRmaTSgLuKhR9OGyBhxCNTLTPCeiJsgpn0w@mail.gmail.com>
Message-ID: <20150423212506.6adaf6ae@x240.home>

On Thu, 23 Apr 2015 20:35:54 +0800
Jace Liang <b436412 at gmail.com> wrote:

> Hello,
> 
> I'm using ovs 2.3.0
> and if I command "ovs-vswitchd --pidfile --detach --log-file"
> 
> there will be an error like this
> 
> 2015-04-23T12:30:09Z|00002|reconnect|INFO|unix:/usr/local/var/run/openvswitch/db.sock:
> connecting...
> 2015-04-23T12:30:09Z|00003|reconnect|INFO|unix:/usr/local/var/run/openvswitch/db.sock:
> connected 2015-04-23T12:30:09Z|00004|netlink_socket|ERR|received
> invalid nlmsg (120 bytes < 16)
> 2015-04-23T12:30:09Z|00005|netlink_socket|ERR|transaction error
> (Protocol error)
> 2015-04-23T12:30:09Z|00006|netlink_socket|ERR|received invalid nlmsg
> (120 bytes < 16)
> 2015-04-23T12:30:09Z|00007|netlink_socket|ERR|transaction error
> (Protocol error)
> 
> 
> 
> is there any wrong in my ovs?
> or any clue to debug?

Could you provide more details like kernel version and if the
openvswitch module is the one provided by the kernel or from the
ovs tarball or from third party provider?

fbl


From blp at nicira.com  Thu Apr 23 17:38:26 2015
From: blp at nicira.com (Ben Pfaff)
Date: Thu, 23 Apr 2015 17:38:26 -0700
Subject: [ovs-discuss] Temporary loss of network connection during
 addition of a port to bridge
In-Reply-To: <553987C3.3020908@smorg.co.uk>
References: <5538AD3F.3030908@smorg.co.uk> <20150423181801.GC30938@nicira.com>
 <553987C3.3020908@smorg.co.uk>
Message-ID: <20150424003826.GA12203@nicira.com>

On Fri, Apr 24, 2015 at 01:01:07AM +0100, Mark Clarkson wrote:
> On 23/04/15 19:18, Ben Pfaff wrote:
> >I don't think that the behavior you describe is intentional.  It sounds
> >like a bug or an unexpected interaction between features.  I think
> >you'll have to investigate and figure out why it's happening, and then
> >once we understand that it can be fixed.
> This is also how linux bridge works though, so maybe it is intentional(?).
> Although the linux bridge allows a forwarding delay of zero for cases where
> there's only one bridge.

We could make OVS support a forwarding delay of zero.  Presumably, that
risks loops, but we could argue that it's the sysadmin's choice.

> Doing:
> 
>   # ovs-vsctl set bridge br0 other_config:stp-forward-delay=4
>   # ovs-vsctl set bridge br0 other_config:stp-max-age=6
> 
> , reduces from 15s to 4s delay, but if an existing connection sends data
> during the 'down' time then it receives an RST so the application closes.

I don't understand how that would happen.  A RST implies that there is
connectivity.  Is some system other than the end host sending the RST?

> I did try to use rstp but openvswitch  replied with an error:
> 
>   # ovs-vsctl set bridge br0 rstp_enable=true
>   ovs-vsctl: Bridge does not contain a column whose name matches
> "rstp_enable"
> 
> rstp_enable is referenced in a man page pdf,
> http://openvswitch.org/ovs-vswitchd.conf.db.5.pdf, so I checked
> http://openvswitch.org/releases/NEWS-2.3.1 but rstp isn't mentioned.
> 
> Any idea when rstp will be available?

RSTP is in the "master" version of OVS.  You can build from master, if
you want to try it out.  It will be in 2.4, when it is released, but the
2.4 release has dragged on far too long and I don't want to predict a
date.

> I have worked around the problem using the standard linux bridge and gretap
> for now, which works surprisingly well, but is there any other way to
> connect ovs bridges (3+ hosts) without the above problems? I can't help but
> think that I'm doing something wrong!

One way would be to use a controller (distributed or centralized) to set
up flows to manage traffic forwarding.

From mark.clarkson at smorg.co.uk  Thu Apr 23 18:38:37 2015
From: mark.clarkson at smorg.co.uk (Mark Clarkson)
Date: Fri, 24 Apr 2015 02:38:37 +0100
Subject: [ovs-discuss] Temporary loss of network connection during
 addition of a port to bridge
In-Reply-To: <20150424003826.GA12203@nicira.com>
References: <5538AD3F.3030908@smorg.co.uk> <20150423181801.GC30938@nicira.com>
 <553987C3.3020908@smorg.co.uk> <20150424003826.GA12203@nicira.com>
Message-ID: <55399E9D.9000300@smorg.co.uk>

On 24/04/15 01:38, Ben Pfaff wrote:
> On Fri, Apr 24, 2015 at 01:01:07AM +0100, Mark Clarkson wrote:
>> On 23/04/15 19:18, Ben Pfaff wrote:
>>> I don't think that the behavior you describe is intentional.  It sounds
>>> like a bug or an unexpected interaction between features.  I think
>>> you'll have to investigate and figure out why it's happening, and then
>>> once we understand that it can be fixed.
>> This is also how linux bridge works though, so maybe it is intentional(?).
>> Although the linux bridge allows a forwarding delay of zero for cases where
>> there's only one bridge.
> We could make OVS support a forwarding delay of zero.  Presumably, that
> risks loops, but we could argue that it's the sysadmin's choice.

Not sure I'd be comfortable with that. I used to get the same delays 
with linux bridges but now ping doesn't miss a single beat when an 
interface is added, and I don't understand why. The application quits 
every time on ovs and never with linux bridge. Maybe misconfiguration on 
my part?

For ovs the following is run after the vethXXXX is created:

   ifconfig $5 0.0.0.0 up
   ovs-vsctl add-port br0 $5

I switched to linux bridge and now do:

   ifconfig $5 0.0.0.0 up
   brctl addif br0 $5

For completeness, this is how I set up ovs on each host:

ovs-vsctl add-br br0
ovs-vsctl set bridge br0 stp_enable=true
ovs-vsctl add-port br0 gre0 -- set interface gre0 type=gre 
options:remote_ip=$other1
ovs-vsctl add-port br0 gre1 -- set interface gre1 type=gre 
options:remote_ip=$other2
ovs-vsctl set bridge br0 other_config:stp-forward-delay=4
ovs-vsctl set bridge br0 other_config:stp-max-age=6

Pings work to all three hosts. All hosts are ubuntu trusty 14.04 with 
ubuntu's openvswitch 2.0.2 packages. Kernel 3.16.0-30-generic x86_64.

>> Doing:
>>
>>    # ovs-vsctl set bridge br0 other_config:stp-forward-delay=4
>>    # ovs-vsctl set bridge br0 other_config:stp-max-age=6
>>
>> , reduces from 15s to 4s delay, but if an existing connection sends data
>> during the 'down' time then it receives an RST so the application closes.
> I don't understand how that would happen.  A RST implies that there is
> connectivity.  Is some system other than the end host sending the RST?

I don't think it's the end host either because that loses connection to 
the network.

Web Browser -eth0-> Host A NAT --> Internal Bridge -gre-> HOST A/B/C VMs

I'm guessing that when the ovs bridged interfaces go away, the kernel 
removes the TCP endpoints since they are now invalid. So the kernel 
sends the reset when the Web Browser polls the VM application.

I can't be sure it was an RST as I didn't tcpdump it but that's what it 
looked like.

>> I did try to use rstp but openvswitch  replied with an error:
>>
>>    # ovs-vsctl set bridge br0 rstp_enable=true
>>    ovs-vsctl: Bridge does not contain a column whose name matches
>> "rstp_enable"
>>
>> rstp_enable is referenced in a man page pdf,
>> http://openvswitch.org/ovs-vswitchd.conf.db.5.pdf, so I checked
>> http://openvswitch.org/releases/NEWS-2.3.1 but rstp isn't mentioned.
>>
>> Any idea when rstp will be available?
> RSTP is in the "master" version of OVS.  You can build from master, if
> you want to try it out.  It will be in 2.4, when it is released, but the
> 2.4 release has dragged on far too long and I don't want to predict a
> date.

I'll subscribe to the announce list, and try 2.4, thanks.

>> I have worked around the problem using the standard linux bridge and gretap
>> for now, which works surprisingly well, but is there any other way to
>> connect ovs bridges (3+ hosts) without the above problems? I can't help but
>> think that I'm doing something wrong!
> One way would be to use a controller (distributed or centralized) to set
> up flows to manage traffic forwarding.

Could I do away with gre tunnels by using flows?

Could you recommend any documentation that describes setting up 
controller and flows?



From djhon9813 at gmail.com  Fri Apr 24 00:46:06 2015
From: djhon9813 at gmail.com (david jhon)
Date: Fri, 24 Apr 2015 12:46:06 +0500
Subject: [ovs-discuss] assertion !idl->change_seqno failed in
	ovsdb_idl_get_mode()
Message-ID: <CANPUzQ02o5XOaEaoxXEo9pmxDOipvNs+=qiVugm_6fLqzDtaOA@mail.gmail.com>

Hi,

I am trying to insert records in ovsdb customized table from within
openvswitch but I am facing following issues on calling
ovsdb_idl_add_column function :

ovs|01659|util(handler21)|EMER|../lib/ovsdb-idl.c:451: assertion
!idl->change_seqno failed in ovsdb_idl_get_mode().

I am using same idl struct which is being initialized in bridge_init()
method by vswitchd/bridge.c.
I am using following steps to insert record in ovsdb.

static void test(const char *name, const char *brname)
{
  const struct ovsrec_open_vswitch *cfg = ovsrec_open_vswitch_first(idl);
  const struct ovsrec_bridge *br_cfg;
  if(cfg) {
    ovsdb_idl_add_column(idl, &ovsrec_bridge_col_test);
    ovsdb_idl_add_column(idl, &ovsrec_test_col_agent);
    ovsdb_idl_add_column(idl, &ovsrec_test_col_name);

    struct bridge *br = bridge_lookup(brname);
    if(br) {
       br_cfg = br->cfg;
       cmd_check_test(br_cfg, name, brname);
    }
  }
}
cmd_add_test(const struct ovsrec_bridge *br, const char *agent, const char
*name)
{
    struct ovsrec_test *test;
    struct ovsdb_idl_txn *txn;
    txn = ovsdb_idl_txn_create(idl);
    ovsrec_init();

    if(br)
    {
      elef = ovsrec_test_insert(txn);
      ovsrec_test_set_agent(test, agent);
      ovsrec_test_set_name(test, name);
      bridge_insert_test(br, test);
    }
    ovsdb_idl_txn_commit(txn);
    ovsdb_idl_txn_destroy(txn);
}

I added a new command in ovs-vsctl to test the insertion of record in ovsdb
which works pretty good, but I am facing issues while adding record from
within openvswith code such as ofproto-dpif-xlate.c file.

Moreover, I tried the code while omitting the ovsdb_idl_add_column function
but it throws following bug in syslog:

ovs-vswitchd: ovs|01343|ovsdb_idl(handler20)|ERR|Bug: Attempt to write to a
read/write column (test:agent) when explicitly configured not to.
ovs|01344|ovsdb_idl(handler20)|ERR|Bug: Attempt to write to a read/write
column (test:name) when explicitly configured not to.
ovs|01345|ovsdb_idl(handler20)|ERR|Bug: Attempt to write to a read/write
column (Bridge:test) when explicitly configured not to.

ovs|01346|jsonrpc(handler20)|DBG|unix:/root/root/run/db.sock: send request,
method="transact",
params=["Open_vSwitch",{"lock":"ovs_vswitchd","op":"assert"},{"uuid-name":"rowd5e645e3_5948_4c63_a223_8fefa7f72763","row":{},"op":"insert","table":"test"}],
id=20

I hope someone here could help me resolve this bug or suggest me some
workaround. I'll be really grateful for that. Thanks a lot!


Kind Regards,
David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150424/4d8a9fc1/attachment.html>

From harshjain32 at gmail.com  Fri Apr 24 04:53:56 2015
From: harshjain32 at gmail.com (harsh jain)
Date: Fri, 24 Apr 2015 17:23:56 +0530
Subject: [ovs-discuss] Sflow packet samples in Openstack environment on
 OVS bridge
In-Reply-To: <59ECC15E-FEBD-424C-9C50-DE61027BE551@inmon.com>
References: <CAKuL1XSsm-bMUPLbZCDajhQQXdia-QQ7SnqEDk9WVwWb67qrYw@mail.gmail.com>
 <D7466569-AA84-4C1F-903E-37F7B2242C16@inmon.com>
 <CAKuL1XTLUSMBJR33a1O2_eLLonicq00PQQdTXkCGmCHQZ4m78A@mail.gmail.com>
 <608655D8-652B-4ABA-8BF8-2D16A9EB680B@inmon.com>
 <CAKuL1XQ-q5nm2=T0T7kQN7yqqCsyHivJiK4kKL71gNp+7sDH2g@mail.gmail.com>
 <59ECC15E-FEBD-424C-9C50-DE61027BE551@inmon.com>
Message-ID: <CAKuL1XSepNY-_HAKUSqS2WiQUKH1AXGS+diywe-tQr4kEy2S5w@mail.gmail.com>

Hi Peter,

I tried with sflow enabled on both port and i am able to get samples of
both direction. Thanks.

Openstack uses Linux Bridge to apply iptables security rules.Refer diagram
below

https://ask.openstack.org/en/question/58638/does-neutron-br-int-accepts-nova-instances-sending-vlan-tagged-traffic/


Regards
Harsh Jain



Regards
harsh Jain

On Thu, Apr 23, 2015 at 7:41 PM, Peter Phaal <peter.phaal at inmon.com> wrote:

> I am unfamiliar with this configuration. I wasn’t aware that you could
> create a patch link between the Linux bridge and OVS. I thought patch links
> were internal to OVS. Why are you using the Linux bridge? Why not connect
> VMs directly to OVS?
>
> Normally the traffic from a VM would enter br-int through a veth port and
> be sampled. In the reverse direction traffic enters through a network
> adapter attached to br-tun and would be sampled (provided you enable sFlow
> on br-tun).
>
> On Apr 23, 2015, at 12:54 AM, harsh jain <harshjain32 at gmail.com> wrote:
>
> Hi Peter,
>
> 1 confusion If Patch ports are ignored then How br-int captures the
> samples of outgoing packet from VM br-int as it is connected via patch
> ports on both ends.
>
>
> Linux Bridge-->Patch port --> br-int(Sflow enabled) --> patch-port -->
> br-tun
>
>
> Regards
> Harsh Jain
>
>
>
> On Thu, Apr 23, 2015 at 11:26 AM, Peter Phaal <peter.phaal at inmon.com>
> wrote:
>
>> Ingress means that packets are captured as they are received on a
>> physical or virtual bridge ports. Patch ports are ignored.
>>
>> In stand alone mode you typically define a single bridge. However,
>> OpenStack defines a pair of bridges (br-in and br-ex) and to get full
>> coverage, you need to enable sFlow on both bridges.
>>
>> Why is it a problem that the sFlow sample contains the GRE header? An
>> sFlow analyzer should be able to decode tenant packet encapsulated by GRE.
>> There is currently work underway to add support for the sFlow tunnel spec
>> to OVS which should further improve visibility into underlay / overlay in
>> virtual networks:
>>
>> http://sflow.org/sflow_tunnels.txt
>>
>> Peter
>>
>>
>> On Apr 22, 2015, at 10:31 PM, harsh jain <harshjain32 at gmail.com> wrote:
>>
>> Hi Peter,
>>
>> Thanks for reply.
>>
>> What is the difference in vSwitch configuration in Openstack environment
>>  and in standalone use. if i try to enable sflow on OVS-bridge having
>> following setup. It captures packet in both direction. I think I am not
>> able to understand exactly what ingress means.
>>
>> In PC
>> eth0--> br0-->tap0 (mktun command) --> Passed the tap device to qemu to
>> launch VM.
>>
>> In compute node
>> VM-->tap-->Linux Bridge --veth pair-->br-int(sflow enabled)-veth
>> pair->br-tun
>>
>>
>> Actually We can not use br-ex to enable flow because sflow sample contain
>> GRE header.
>>
>>
>> Thanks & Regards
>> Harsh Jain
>>
>>
>>
>> On Wed, Apr 22, 2015 at 8:00 PM, Peter Phaal <peter.phaal at inmon.com>
>> wrote:
>>
>>> The sFlow implementation in OVS applies ingress sampling. To get full
>>> coverage into all traffic paths you need to enable sFlow on all bridges.
>>> For OpenStack, enabling sFlow on br-ex should give you visibility into the
>>> traffic destined to VMs.
>>>
>>> You may also want to take a look at the Host sFlow agent (
>>> http://host-sflow.sourceforge.net/). It can automatically manage the
>>> OVS sFlow settings and will also export hypervisor and VM CPU, memory, disk
>>> and network IO stats.
>>>
>>> On Apr 22, 2015, at 12:46 AM, harsh jain <harshjain32 at gmail.com> wrote:
>>>
>>> Hi,
>>>
>>> I tried to collect sflow packet on OVS switch in Openstack. But captured
>>> paackets contain only traffic coming out from the VM i.e samples contain
>>> Raw Packet of VM to external network direction only.following command is
>>> used to enable
>>>
>>> export COLLECTOR_IP=10.3.5.112
>>> export COLLECTOR_PORT=6343
>>> export AGENT_IP=eth1
>>> export HEADER_BYTES=256
>>> export SAMPLING_N=1
>>> export POLLING_SECS=10
>>>
>>> ovs-vsctl -- --id=@sflow create sflow agent=${AGENT_IP}
>>> target=\"${COLLECTOR_IP}:${COLLECTOR_PORT}\" header=${HEADER_BYTES}
>>> sampling=${SAMPLING_N} polling=${POLLING_SECS} -- set bridge br-int
>>> sflow=@sflow
>>>
>>> Connection is
>>> VM ->tap device->br-int(sflow enabled)-----veth-pair----->br-data-eth.
>>>
>>> Why packets are colected for 1 direction only?
>>>
>>>
>>> Thanks & Regards
>>> Harsh Jain
>>> _______________________________________________
>>> discuss mailing list
>>> discuss at openvswitch.org
>>> http://openvswitch.org/mailman/listinfo/discuss
>>>
>>>
>>>
>>
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150424/95faed5f/attachment.html>

From rault.clement at gmail.com  Fri Apr 24 07:20:24 2015
From: rault.clement at gmail.com (=?UTF-8?Q?Cl=C3=A9ment_Rault?=)
Date: Fri, 24 Apr 2015 16:20:24 +0200
Subject: [ovs-discuss] ICMP packets getting dropped
Message-ID: <CACXMTR9b3T1+MkoH3XdAVt=0fgky9YQvtQhy=g7Q0iMqeEf0xA@mail.gmail.com>

Hi,

I am experiencing a weird behaviour when I test my system with ping.

I installed flow/group tables so that an alternative path can be found
in case of a link failure.

In the test I am breaking the link between s2 and s5 (in mininet) and
I am seing a really weird behaviour in s5: some packets disappear
after arriving in this switch...

What I don't understand is that I didn't put any rule to drop the
packets. And actually ovs-appctl doesn't show me that any packets are
dropped (but they are not being forwarded anywhere...):

$ sudo ovs-appctl bridge/dump-flows s5
duration=360s, n_packets=11, n_bytes=1078,
priority=1,ip,nw_dst=11.0.0.1,actions=group:1
duration=360s, n_packets=3, n_bytes=294,
priority=2,ip,nw_dst=11.0.0.2,actions=group:2
duration=360s, n_packets=5, n_bytes=510,
priority=9,ip,in_port=4,dl_vlan=1,nw_dst=11.0.0.1,actions=group:6
duration=360s, n_packets=0, n_bytes=0,
priority=3,ip,in_port=1,dl_vlan=1,nw_dst=11.0.0.1,actions=group:3
duration=360s, n_packets=1, n_bytes=102,
priority=7,ip,in_port=3,dl_vlan=1,nw_dst=11.0.0.1,actions=group:5
duration=360s, n_packets=9, n_bytes=910,
priority=6,ip,in_port=2,dl_vlan=1,nw_dst=11.0.0.2,actions=group:4
duration=360s, n_packets=1, n_bytes=102,
priority=5,ip,in_port=2,dl_vlan=1,nw_dst=11.0.0.1,actions=group:4
duration=360s, n_packets=2, n_bytes=204,
priority=8,ip,in_port=3,dl_vlan=1,nw_dst=11.0.0.2,actions=group:5
duration=360s, n_packets=0, n_bytes=0,
priority=10,ip,in_port=4,dl_vlan=1,nw_dst=11.0.0.2,actions=group:6
duration=360s, n_packets=0, n_bytes=0,
priority=4,ip,in_port=1,dl_vlan=1,nw_dst=11.0.0.2,actions=group:3
table_id=254, duration=527s, n_packets=0, n_bytes=0, priority=1,actions=drop
table_id=254, duration=527s, n_packets=0, n_bytes=0,
priority=0,reg0=0x3,actions=drop
table_id=254, duration=527s, n_packets=0, n_bytes=0,
priority=0,reg0=0x1,actions=controller(reason=no_match)
table_id=254, duration=527s, n_packets=12, n_bytes=900,
priority=0,reg0=0x2,actions=drop
table_id=254, duration=527s, n_packets=0, n_bytes=0,
priority=2,recirc_id=0,actions=resubmit(,0)

Is there a policy for an ovs switch to drop a icmp packet? Because in
Wireshark I am seeing packet 1 then 2 then 3 etc even though sometimes
I am expecting to see both packets traversing the network at the same
time. So I am assuming that maybe the icmp implementation in ovs is
time sensitive?

Or could it come from the fact that there is a port that is changing?
Here is what I see in my controller (ryu):

EVENT ofp_event->dpset EventOFPPortStatus
DPSET: A port was modified.(datapath id = 0000000000000005, port number = 1)
EVENT ofp_event->dpset EventOFPPortStatus
DPSET: A port was modified.(datapath id = 0000000000000002, port number = 4)
EVENT ofp_event->dpset EventOFPPortStatus
DPSET: A port was modified.(datapath id = 0000000000000005, port number = 1)

Thanks in advance for you help!

Best,
Clément

From blp at nicira.com  Fri Apr 24 08:13:04 2015
From: blp at nicira.com (Ben Pfaff)
Date: Fri, 24 Apr 2015 08:13:04 -0700
Subject: [ovs-discuss] ICMP packets getting dropped
In-Reply-To: <CACXMTR9b3T1+MkoH3XdAVt=0fgky9YQvtQhy=g7Q0iMqeEf0xA@mail.gmail.com>
References: <CACXMTR9b3T1+MkoH3XdAVt=0fgky9YQvtQhy=g7Q0iMqeEf0xA@mail.gmail.com>
Message-ID: <20150424151304.GA5371@nicira.com>

On Fri, Apr 24, 2015 at 04:20:24PM +0200, Clément Rault wrote:
> I am experiencing a weird behaviour when I test my system with ping.
> 
> I installed flow/group tables so that an alternative path can be found
> in case of a link failure.
> 
> In the test I am breaking the link between s2 and s5 (in mininet) and
> I am seing a really weird behaviour in s5: some packets disappear
> after arriving in this switch...
> 
> What I don't understand is that I didn't put any rule to drop the
> packets. And actually ovs-appctl doesn't show me that any packets are
> dropped (but they are not being forwarded anywhere...):

I'd recommend using the "ovs-appctl ofproto/trace" command to figure out
what's happening to your ICMP packets.  It's documented, see
ovs-vswitchd(8).

From blp at nicira.com  Fri Apr 24 08:15:04 2015
From: blp at nicira.com (Ben Pfaff)
Date: Fri, 24 Apr 2015 08:15:04 -0700
Subject: [ovs-discuss] assertion !idl->change_seqno failed in
 ovsdb_idl_get_mode()
In-Reply-To: <CANPUzQ02o5XOaEaoxXEo9pmxDOipvNs+=qiVugm_6fLqzDtaOA@mail.gmail.com>
References: <CANPUzQ02o5XOaEaoxXEo9pmxDOipvNs+=qiVugm_6fLqzDtaOA@mail.gmail.com>
Message-ID: <20150424151504.GB5371@nicira.com>

On Fri, Apr 24, 2015 at 12:46:06PM +0500, david jhon wrote:
> I am trying to insert records in ovsdb customized table from within
> openvswitch but I am facing following issues on calling
> ovsdb_idl_add_column function :
> 
> ovs|01659|util(handler21)|EMER|../lib/ovsdb-idl.c:451: assertion
> !idl->change_seqno failed in ovsdb_idl_get_mode().
> 
> I am using same idl struct which is being initialized in bridge_init()
> method by vswitchd/bridge.c.
> I am using following steps to insert record in ovsdb.
> 
> static void test(const char *name, const char *brname)
> {
>   const struct ovsrec_open_vswitch *cfg = ovsrec_open_vswitch_first(idl);
>   const struct ovsrec_bridge *br_cfg;
>   if(cfg) {
>     ovsdb_idl_add_column(idl, &ovsrec_bridge_col_test);
>     ovsdb_idl_add_column(idl, &ovsrec_test_col_agent);
>     ovsdb_idl_add_column(idl, &ovsrec_test_col_name);

You have to add columns before starting to work with the database.  Put
these with the other ovsdb_idl_add_column() invocations in
bridge_init().

From daniel.dehennin at baby-gnu.org  Fri Apr 24 13:31:14 2015
From: daniel.dehennin at baby-gnu.org (Daniel Dehennin)
Date: Fri, 24 Apr 2015 22:31:14 +0200
Subject: [ovs-discuss] Network issue with spanning-tree
Message-ID: <87lhhh5kvh.fsf@hati.baby-gnu.org>

Hello,

We are experimenting network issues each time we start a new VM.

The other VMs have their network blocked until I see “a topology change
is detected” in Open vSwitch logs.

Do you have any advice for such configuration?

Here is our setup:

We are using Open vSwitch for networking in our OpenNebula setup[1]:

- 4 physical servers (corosync+pacemaker+GFS2 => STONITH)

- Ubuntu Trusty Tahr 14.04.2 (Open vSwitch 2.0.2-0ubuntu0.14.04.1)

- internal bridges “in-br” connected between nodes with vxlan tunnels,
  with a loop and spanning tree

- User VM on their own VLAN (1 VLAN per user)

- OpenNebula manages flows with ovs-ofctl, here are the logs when
  starting a VM:
  #+begin_src text
  Sat Mar  7 15:21:37 2015 [Z0][DiM][I]: New VM state is ACTIVE.
  Sat Mar  7 15:21:37 2015 [Z0][LCM][I]: New VM state is PROLOG.
  Sat Mar  7 15:21:37 2015 [Z0][LCM][I]: New VM state is BOOT
  Sat Mar  7 15:21:37 2015 [Z0][VMM][I]: Generating deployment file: /var/lib/one/vms/14/deployment.0
  Sat Mar  7 15:21:37 2015 [Z0][VMM][I]: ExitCode: 0
  Sat Mar  7 15:21:37 2015 [Z0][VMM][I]: Successfully execute network driver operation: pre.
  Sat Mar  7 15:21:38 2015 [Z0][VMM][I]: ExitCode: 0
  Sat Mar  7 15:21:38 2015 [Z0][VMM][I]: Successfully execute virtualization driver operation: deploy.
  Sat Mar  7 15:21:38 2015 [Z0][VMM][I]: post: Executed "sudo ovs-vsctl set Port vnet18 tag=20".
  Sat Mar  7 15:21:38 2015 [Z0][VMM][I]: post: Executed "sudo ovs-ofctl add-flow in-br in_port=17,dl_src=02:03:00:00:00:00,priority=40000,actions=normal".
  Sat Mar  7 15:21:38 2015 [Z0][VMM][I]: post: Executed "sudo ovs-ofctl add-flow in-br in_port=17,priority=39000,actions=drop".
  Sat Mar  7 15:21:38 2015 [Z0][VMM][I]: ExitCode: 0
  Sat Mar  7 15:21:38 2015 [Z0][VMM][I]: Successfully execute network driver operation: post.
  Sat Mar  7 15:21:38 2015 [Z0][LCM][I]: New VM state is RUNNING
  #+end_src

A picture is better than thousand words:

#+begin_src picture
   ------+---------------------+---------------------+---------------------+------- physical network (192.168.1.0/24)
         |.1                   |.2                   |.3                   |.4
  +------+------+       +------+------+       +------+------+       +------+------+
  |      |      |       |      |      |       |      |      |       |      |      |
  | +----+----+ |       | +----+----+ |       | +----+----+ |       | +----+----+ |
  | |         | |       | |         | |       | |         | |       | |         | |
  | |  eth0   | |       | |  eth0   | |       | |  eth0   | |       | |  eth0   | |
  | |         | |       | |         | |       | |         | |       | |         | |
  | +---------+ |       | +---------+ |       | +---------+ |       | +---------+ |
  |             |       |             |       |             |       |             |
  |             |       |             |       |             |       |             |
  |             |       |             |       |             |       |             |
  |             |       |             |       |             |       |             |
  | +---------+ |       | +---------+ |       | +---------+ |       | +---------+ |
  | |         | | vxlan | |         | | vxlan | |         | | vxlan | |         | |
  | |  in-br  +-+-------+-+  in-br  +-+-------+-+  in-br  +-+-------+-+  in-br  +-+---+
  | |         | |       | |         | |       | |         | |       | |         | |   |
  | +----+----+ |       | +---------+ |       | +---------+ |       | +---------+ |   |
  |      |      |       |             |       |             |       |             |   |
  +------+------+       +-------------+       +-------------+       +-------------+   |
         |                                                                            |
         |                              vxlan                                         |
         +----------------------------------------------------------------------------+
#+end_src

I setup the isolated bridges and the VXLAN tunnels between hosts simply with:

#+begin_src sh
  #!/bin/bash

  [[ "${DEBUG}" =~ ^[tT]([rR][uU][eE])?$ ]] && DRY=echo
  [[ "${DRY_RUN}" =~ ^[tT]([rR][uU][eE])?$ ]] && DRY=:

  NET=192.168.1
  for hostip in {1..4}
  do
      echo "Creating isolated bridge"
      ${DRY} ssh root@${NET}.${hostip} \
             ovs-vsctl add-br in-br

      # Enable STP first
      echo "Enable spanning tree on node ${hostip}"
      ${DRY} ssh root@${NET}.${hostip} ovs-vsctl set Bridge in-br stp_enable=true

      PREV_NODE_ID=$(( hostip - 1 ))
      # Loop on node4
      [ ${PREV_NODE_ID} -eq 0 ] && PREV_NODE_ID=4

      NEXT_NODE_ID=$(( (hostip+1) % 5 ))
      # Loop on node1
      [ ${NEXT_NODE_ID} -eq 0 ] && NEXT_NODE_ID=1


      INTERFACE_TO_PREV="vx-to-node${PREV_NODE_ID}"
      INTERFACE_TO_NEXT="vx-to-node${NEXT_NODE_ID}"

      # Link to previous node switch
      echo "Connect node ${hostip} to node ${PREV_NODE_ID}"
      ${DRY} ssh root@${NET}.${hostip} \
          ovs-vsctl add-port in-br ${INTERFACE_TO_PREV} -- \
              set interface ${INTERFACE_TO_PREV} type=vxlan \
              options:local_ip=${hostip} \
              remote_ip=${NET}.${PREV_NODE_ID}

      # Link to next node switch
      echo "Connect node ${hostip} to node ${NEXT_NODE_ID}"
      ${DRY} ssh root@${NET}.${hostip} \
          ovs-vsctl add-port in-br ${INTERFACE_TO_NEXT} -- \
              set interface ${INTERFACE_TO_NEXT} type=vxlan \
              options:local_ip=${hostip} \
              options:remote_ip=${NET}.${NEXT_NODE_ID}

      echo
  done
#+end_src

Regards.

Footnotes: 
[1]  http://docs.opennebula.org/4.12/administration/networking/nm.html

-- 
Daniel Dehennin
Récupérer ma clef GPG: gpg --recv-keys 0xCC1E9E5B7A6FE2DF
Fingerprint: 3E69 014E 5C23 50E8 9ED6  2AAD CC1E 9E5B 7A6F E2DF
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 342 bytes
Desc: not available
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150424/8888cff7/attachment.sig>

From kprad1 at yahoo.com  Fri Apr 24 23:12:54 2015
From: kprad1 at yahoo.com (Padmanabhan Krishnan)
Date: Sat, 25 Apr 2015 06:12:54 +0000 (UTC)
Subject: [ovs-discuss] Question on tunnel interfaces
Message-ID: <1036089648.4063399.1429942374890.JavaMail.yahoo@mail.yahoo.com>

Hello,My question is related to the sending (encap) side of the OVS tunnel bridge.
After the tunnel bridge (say br-tun) does the encapsulation (VXLAN or GRE), i assume it uses the host routing table to route the packet. So, when a frame is received by the br-tun from an in_port, after performing the necessary encapsulation does OVS send it over to kernel routing module to forward the frame on the right interface (routing)?
In my example below, the end point 173 subnet is attached to say, eth2. The physical port 'eth2' is _not_ connected to OVS bridge 'br-tun'. But, depending on the 'remote_ip', the frame gets forwarded to the right interface.
I will be obliged, if someone can explain, in terms of flow, as how forwarding happens after the frame gets encapsulated (br-tun)? Does routing of the frame fall under the scope of OVS?Is it a special functionality of the 'set_tunnel' action?
 
Dumping the flow on br-tun using ofctl, i assume the below line is responsible for the encap:"
 cookie=0x0, duration=14723.832s, table=22, n_packets=22, n_bytes=1826, idle_age=14704, dl_vlan=1 actions=strip_vlan,set_tunnel:0x3eb,output:2
"
Port 2 is vxlan-ad24f10f below.
br-tun has:    Bridge br-tun
        Port br-tun
            Interface br-tun
                type: internal
        Port "vxlan-ad24f10f"
            Interface "vxlan-ad24f10f"
                type: vxlan
                options: {df_default="true", in_key=flow, local_ip="173.36.241.17", out_key=flow, remote_ip="173.36.241.15"}
        Port patch-int
            Interface patch-int
                type: patch
                options: {peer=patch-tun}

Thanks,Padmanabhan
  

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150425/df759339/attachment.html>

From Tony.vanderPeet at alliedtelesis.co.nz  Fri Apr 24 12:14:09 2015
From: Tony.vanderPeet at alliedtelesis.co.nz (Tony van der Peet)
Date: Fri, 24 Apr 2015 19:14:09 +0000
Subject: [ovs-discuss] IGMP fields added to the flow structure causes
 problem?
In-Reply-To: <20150423230817.GA1644@nicira.com>
References: <553836BC.4040606@alliedtelesis.co.nz>,
 <20150423230817.GA1644@nicira.com>
Message-ID: <a0659fd0e2d4455ba3bbe530ebad0518@svr-chch-ex1.atlnz.lc>

Just to get dates in order:

Jun/2014 - deliveries to master branch that introduce IGMP fields to flow structure
Sep/2014 - we update from tip of master
Apr/2014 - I notice this potential issue

I am running a simple ryu application (using code from https://github.com/samrussell/nss) and connecting my desktop PC to our main LAN. Flows with multicast addresses appear to come and go, but I suspect it's IGMPv3 Membership Reports (type 0x22) that are causing flows to be created that then persist.

In this application at least, matching is done purely on source and destination MAC, so the existence of these flows is probably not that much of a problem since the flows will cover many other packets that aren't Membership reports. It's not really that surprising that this might not be noticed since the switch is behaving perfectly normally and acceptably.

To your point of reproducing on unmodified OpenVSwitch, yes, I will do that, and report further. Time zones and public holidays mean that it won't be until next week.

Tony
________________________________________
From: Ben Pfaff <blp at nicira.com>
Sent: Friday, 24 April 2015 11:08 a.m.
To: Tony van der Peet
Cc: discuss at openvswitch.org
Subject: Re: [ovs-discuss] IGMP fields added to the flow structure causes problem?

On Thu, Apr 23, 2015 at 12:03:08AM +0000, Tony van der Peet wrote:
> I have been investigating some anomalous behaviour in a switch
> (developed by us, based on OpenVSwitch code). It appears that flows
> added as a result of receiving IGMP packets are never deleted. Here's
> one of the flows (this is a switch running a simple MAC learning
> application, so you don't see the upper level fields).
>
> recirc_id(0),in_port(2),eth(src=38:60:77:8b:d9:0a,dst=01:00:5e:00:00:16),eth_type(0x0800),ipv4(frag=no), packets:26, bytes:2236, used:9.600s, actions:1,6,5,4,3
>
> Here's a log message I'm seeing:
>
> 2015 Apr 23 12:33:23 awplus ovs-vswitchd: 02570|dpif(revalidator4)|WARN|system at ovs-system: failed to flow_del (No such file or directory)
>  skb_priority(0),skb_mark(0),recirc_id(0),dp_hash(0),in_port(2),eth(src=38:60:77:8b:d9:0a,dst=01:00:5e:00:00:16),eth_type(0x0800),ipv4(src=10.33.22.24,dst=224.0.0.22,proto=2,tos=0xc0,ttl=1,frag=no)

Thanks for the report.  I'm a little surprised to hear about this, since
that code is somewhat old (I think you said September 2014) and I don't
remember getting similar reports before.  Can you explain how to
reproduce the problem (with unmodified OVS)?

From vgarg at fortinet.com  Fri Apr 24 14:08:20 2015
From: vgarg at fortinet.com (Vipin Garg)
Date: Fri, 24 Apr 2015 21:08:20 +0000
Subject: [ovs-discuss] Error initializing ovsdb-server
Message-ID: <82C0CCFDFF96FC49AE329EF02BD579233B710B7C@FGT-EXCH-MBX211.fortinet-us.com>



Hello,

I am trying to integrate the OpenvSwitch to my PPC based platfrom. I am only interested in OVSBD-Server portion of vswitch so that I can control the switch via Daylight. I have started the ovsdb-server on switch but when I try to initialize the database as suggested by documentation, I get following errors message -

# ./ovs-vsctl --no-wait init
ovs-vsctl: unix:/usr/local/var/run/openvswitch/db.sock: database connection failed (No such file or directory )

Just FYI, I started the ovsdb-server as (as suggeste din the INSTALL.md)  -

ovsdb-server --remote=punix:/usr/local/var/run/openvswitch/db.sock \
                     --private-key=db:Open_vSwitch,SSL,private_key \
                      --certificate=db:Open_vSwitch,SSL,certificate \
                      --bootstrap-ca-cert=db:Open_vSwitch,SSL,ca_cert \
                      --pidfile --detach



(1)    Now, how & when do we create db.soc ?

(2)    Is it OK if I only run ovsdb-server on the switch  as I am not interested in programming the flows on switch. I only want to use OF-CONFIG to manage the switch,

Thanks
Vipin Garg


***  Please note that this message and any attachments may contain confidential 
and proprietary material and information and are intended only for the use of 
the intended recipient(s). If you are not the intended recipient, you are hereby 
notified that any review, use, disclosure, dissemination, distribution or copying 
of this message and any attachments is strictly prohibited. If you have received 
this email in error, please immediately notify the sender and destroy this e-mail 
and any attachments and all copies, whether electronic or printed.
Please also note that any views, opinions, conclusions or commitments expressed 
in this message are those of the individual sender and do not necessarily reflect 
the views of Fortinet, Inc., its affiliates, and emails are not binding on 
Fortinet and only a writing manually signed by Fortinet's General Counsel can be 
a binding commitment of Fortinet to Fortinet's customers or partners. Thank you. ***
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150424/547e2991/attachment.html>

From jesse at nicira.com  Sat Apr 25 16:00:29 2015
From: jesse at nicira.com (Jesse Gross)
Date: Sat, 25 Apr 2015 16:00:29 -0700
Subject: [ovs-discuss] Question on tunnel interfaces
In-Reply-To: <1036089648.4063399.1429942374890.JavaMail.yahoo@mail.yahoo.com>
References: <1036089648.4063399.1429942374890.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <CAEP_g=_tM1r8AE2myV0tT9brUNVGm4MBNuHmHfmDyLncYmCziw@mail.gmail.com>

On Fri, Apr 24, 2015 at 11:12 PM, Padmanabhan Krishnan <kprad1 at yahoo.com> wrote:
> Hello,
> My question is related to the sending (encap) side of the OVS tunnel bridge.
> After the tunnel bridge (say br-tun) does the encapsulation (VXLAN or GRE),
> i assume it uses the host routing table to route the packet. So, when a
> frame is received by the br-tun from an in_port, after performing the
> necessary encapsulation does OVS send it over to kernel routing module to
> forward the frame on the right interface (routing)?

That's correct.

> In my example below, the end point 173 subnet is attached to say, eth2. The
> physical port 'eth2' is _not_ connected to OVS bridge 'br-tun'. But,
> depending on the 'remote_ip', the frame gets forwarded to the right
> interface.
>
> I will be obliged, if someone can explain, in terms of flow, as how
> forwarding happens after the frame gets encapsulated (br-tun)? Does routing
> of the frame fall under the scope of OVS?
> Is it a special functionality of the 'set_tunnel' action?

OVS simply hands the packet over to the kernel IP stack. There aren't
any flows involved at this point beyond the one that got the packet to
the tunnel port. That's why the packet can be output on a port that is
not connected to OVS.

From blp at nicira.com  Sun Apr 26 09:27:08 2015
From: blp at nicira.com (Ben Pfaff)
Date: Sun, 26 Apr 2015 09:27:08 -0700
Subject: [ovs-discuss] Error initializing ovsdb-server
In-Reply-To: <82C0CCFDFF96FC49AE329EF02BD579233B710B7C@FGT-EXCH-MBX211.fortinet-us.com>
References: <82C0CCFDFF96FC49AE329EF02BD579233B710B7C@FGT-EXCH-MBX211.fortinet-us.com>
Message-ID: <20150426162708.GA2783@nicira.com>

On Fri, Apr 24, 2015 at 09:08:20PM +0000, Vipin Garg wrote:
> I am trying to integrate the OpenvSwitch to my PPC based platfrom. I am only interested in OVSBD-Server portion of vswitch so that I can control the switch via Daylight. I have started the ovsdb-server on switch but when I try to initialize the database as suggested by documentation, I get following errors message -
> 
> # ./ovs-vsctl --no-wait init
> ovs-vsctl: unix:/usr/local/var/run/openvswitch/db.sock: database connection failed (No such file or directory )
> 
> Just FYI, I started the ovsdb-server as (as suggeste din the INSTALL.md)  -
> 
> ovsdb-server --remote=punix:/usr/local/var/run/openvswitch/db.sock \
>                      --private-key=db:Open_vSwitch,SSL,private_key \
>                       --certificate=db:Open_vSwitch,SSL,certificate \
>                       --bootstrap-ca-cert=db:Open_vSwitch,SSL,ca_cert \
>                       --pidfile --detach
> 
> 
> 
> (1)    Now, how & when do we create db.soc ?

ovsdb-server creates the socket.

I guess the directory /usr/local/var/run doesn't exist.  You should
either configure to use /var/run or create it.

> (2) Is it OK if I only run ovsdb-server on the switch as I am not
> interested in programming the flows on switch. I only want to use
> OF-CONFIG to manage the switch,

You can run just ovsdb-server if you want, but then there's no switch to
control.

From mir_ali at outlook.com  Sun Apr 26 12:36:52 2015
From: mir_ali at outlook.com (Mir Ali)
Date: Sun, 26 Apr 2015 12:36:52 -0700
Subject: [ovs-discuss] Using the Python IDL library issues
Message-ID: <BAY176-W31A629EA858090F03813CA91EA0@phx.gbl>

Hi,
I am trying out the python idl library to write scripts to talk to the ovsdb-server but I can figure out why the idl database is not being loaded. My setup consists fo the following.

Started the ovsdb-server and switch as 
$ sudo ovsdb-server /usr/local/etc/openvswitch/conf.db --remote=punix:/usr/local/var/run/openvswitch/db.sock --log-file=/tmp/vswitch.log --pidfile --detach
$ sudo ovs-vswitchd --pidfile --detach

This stated the ovsdb-server and listening on port 39779.

Confirmed that they are both running using
$ ps aux | grep ovs
ali       9464  0.0  0.1  54772  6320 pts/13   S+   11:48   0:01 vim test-ovsdb.py
root      9817  0.0  0.0  12824  1396 ?        Ss   12:12   0:00 ovsdb-server /usr/local/etc/openvswitch/conf.db -v --remote=punix:/usr/local/var/run/openvswitch/db.sock --pidfile --detach --log-file --remote=ptcp:0:127.0.0.1
root      9849  0.0  0.1 234908  4148 ?        Ssl  12:14   0:04 ovs-vswitchd --pidfile --detach
ali      11894  0.0  0.0  15940   920 pts/14   S+   14:30   0:00 grep --color=auto ovs


I was hoping idl to load the database on the first idl.run() call but it doesn't seem like it is. The tables are always empty although the current set up is as shown below
(tornado)ali at ali-virtual-machine:ovstests$ sudo ovs-vsctl show
[sudo] password for ali:
e5fee773-c92d-44b9-92f3-98335d4fee6e
    Bridge "br3"
        Port "br3"
            Interface "br3"
                type: internal
    Bridge "br4"
        Port "br4"
            Interface "br4"
                type: internal
    Bridge "br2"
        Port "br2"
            Interface "br2"
                type: internal
    Bridge "br1"
        Port "br1"
            Interface "br1"
                type: internal

My test script looks as shown below. Can someone tell me what is it that I am doing wrong?
import ovs.db.idl
import ovs.db.schema
import ovs.poller
import time

# tried all the three options for 'remote'
remote = 'punix:/usr/local/var/run/openvswitch/db.sock'
#remote = 'ptcp:127.0.0.1:39779'
#remote = 'ptcp:127.0.0.1'
schema_file = '/home/ali/Documents/Projects/OVS/openvswitch-2.3.1/vswitchd/vswitch.ovsschema'
schema_helper = ovs.db.idl.SchemaHelper(schema_file)
schema_helper.register_columns("Bridge", ["name",])
idl = ovs.db.idl.Idl(remote, schema_helper)

seqno = 0
print idl.run()

print idl.tables['Bridge'].to_json()

#for row in idl.tables["Bridge"].rows.itervalues():
#    print type(row.to_json())
for key, value in idl.tables.items():
    print (key, value)
    
while True:
    state = idl.run()
    change_seqno = idl.change_seqno
    print "change_seqno: " + str(change_seqno) + "state: " + str(state)
    poller = ovs.poller.Poller()
    idl.wait(poller)
    poller.block()

Thanks
Mir


 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150426/47f332b4/attachment.html>

From stuie_norris at exemail.com.au  Mon Apr 27 01:36:06 2015
From: stuie_norris at exemail.com.au (stuie_norris at exemail.com.au)
Date: Mon, 27 Apr 2015 18:36:06 +1000
Subject: [ovs-discuss] [Q] LACP / VLANs Openvswitch Ubuntu 14.04
Message-ID: <e0f5b2bc93eb49fcefc0497855dc2e10.squirrel@webmail.exetel.com.au>

Hi Forum,

I am trying to configure openvswitch to use LACP on a bonded interface on
Ubuntu 14.04 with VLANs using Cisco 3850X switches.

I want bond NICs eth2, eth3, eth4 and eth5 together.  On the server I will
have VMs on to VLANs 500 and VLANs 590.

On the Cisco 3850X Switch I have configures ether channel and enabled LACP.

interface Port-channel20
 switchport trunk native vlan 500
 switchport trunk allowed vlan 400-599
 switchport mode trunk

interface GigabitEthernet1/0/11
 description eth2
 switchport trunk native vlan 500
 switchport trunk allowed vlan 400-599
 switchport mode trunk
 channel-protocol lacp
 channel-group 20 mode active
!
interface GigabitEthernet1/0/12
 description eth3
 switchport trunk native vlan 500
 switchport trunk allowed vlan 400-599
 switchport mode trunk
 channel-protocol lacp
 channel-group 20 mode active

interface GigabitEthernet2/0/11
 description stage eth3
 switchport trunk native vlan 500
 switchport trunk allowed vlan 400-599
 switchport mode trunk
 channel-protocol lacp
 channel-group 20 mode active
!
interface GigabitEthernet2/0/12
 description eth4
 switchport trunk native vlan 500
 switchport trunk allowed vlan 400-599
 switchport mode trunk
 channel-protocol lacp
 channel-group 20 mode active

LACP can see the server from the switch.  (MAC shown matches MAC of vmbr0)

#show lacp neighbor
Flags:  S - Device is requesting Slow LACPDUs
        F - Device is requesting Fast LACPDUs
        A - Device is in Active mode       P - Device is in Passive mode

Channel group 20 neighbors

Partner's information:

                  LACP port                        Admin  Oper   Port    Port
Port      Flags   Priority  Dev ID          Age    key    Key    Number 
State
Gi1/0/11  FA      65535     001f.2958.ff36  14s    0x0    0x2    0x4     0x3F
Gi1/0/12  FA      65535     001f.2958.ff36  14s    0x0    0x2    0x5     0x3F
Gi2/0/11  FA      65535     001f.2958.ff36  14s    0x0    0x2    0x2     0x3F
Gi2/0/12  FA      65535     001f.2958.ff36  14s    0x0    0x2    0x1     0x3F


On the HP server I have the default Ubuntu 14.04 server OVS package
installed.
sudo dpkg -l | grep openvswitch
ii  openvswitch-common                  2.0.2-0ubuntu0.14.04.1          
amd64        Open vSwitch common components
ii  openvswitch-switch                  2.0.2-0ubuntu0.14.04.1          
amd64        Open vSwitch switch implementations

I have configured the /etc/network/interfaces to have

#cat /etc/network/interfaces
# This file describes the network interfaces available on your system
# and how to activate them. For more information, see interfaces(5).

# The loopback network interface
auto lo
iface lo inet loopback

# Bond eth2, eth3, eth4, eth5 together
allow-vmbr0 bond0
iface bond0 inet manual
  ovs_bridge vmbr0
  ovs_type OVSBond
  ovs_bonds eth2 eth3 eth4 eth5
  ovs_options bond_mode=balance-tcp lacp=active other_config:lacp-time=fast

auto vmbr0
iface vmbr0 inet manual
  ovs_type OVSBridge
  ovs_ports bond0 vlan500 vlan590

allow-vmbr0 vlan500
iface vlan500 inet static
  ovs_type OVSIntPort
  ovs_bridge vmbr0
  ovs_options tag=500
  ovs_extra set interface ${IFACE} external-ids:iface-id=$(hostname
-s)-${IFACE}-vif
  address 10.3.64.16
  netmask 255.255.255.0

allow-vmbr0 vlan590
iface vlan590 inet static
  ovs_type OVSIntPort
  ovs_bridge vmbr0
  ovs_options tag=590
  ovs_extra set interface ${IFACE} external-ids:iface-id=$(hostname
-s)-${IFACE}-vif
  address 10.3.71.16
  netmask 255.255.255.0

# The primary network interface
auto eth0
iface eth0 inet static
        address 10.3.74.16
        netmask 255.255.255.0
        gateway 10.3.74.1

auto eth1
iface eth1 inet manual

auto eth2
iface eth2 inet manual

auto eth3
iface eth3 inet manual

auto eth4
iface eth4 inet manual

auto eth5
iface eth5 inet manual

After reboot with above configuration

#sudo ovs-vsctl show
5211bfdb-f066-4a95-ae6e-de71acdc9072
    Bridge "vmbr0"
        Port "vlan500"
            tag: 500
            Interface "vlan500"
                type: internal
        Port "vlan590"
            tag: 590
            Interface "vlan590"
                type: internal
        Port "vmbr0"
            Interface "vmbr0"
                type: internal
        Port "bond0"
            Interface "eth5"
            Interface "eth4"
            Interface "eth3"
            Interface "eth2"
    ovs_version: "2.0.2"

The NICs have the following hardware addresses (Note the virbr0 - should
that be there?)

#ifconfig | grep -i HWAddr
bond0     Link encap:Ethernet  HWaddr b6:c5:80:b5:8d:1d
eth0      Link encap:Ethernet  HWaddr 00:1f:29:e2:dc:24
eth1      Link encap:Ethernet  HWaddr 00:1f:29:e2:dc:26
eth2      Link encap:Ethernet  HWaddr 00:1f:29:58:ff:36
eth3      Link encap:Ethernet  HWaddr 00:1f:29:58:ff:37
eth4      Link encap:Ethernet  HWaddr 00:1f:29:5c:1d:b8
eth5      Link encap:Ethernet  HWaddr 00:1f:29:5c:1d:b9
lxcbr0    Link encap:Ethernet  HWaddr aa:28:10:f2:3b:3a
virbr0    Link encap:Ethernet  HWaddr de:94:d0:e0:8d:ba
vlan500   Link encap:Ethernet  HWaddr fe:9a:2b:dd:e3:6f
vlan590   Link encap:Ethernet  HWaddr aa:ed:ab:d4:2a:d2
vmbr0     Link encap:Ethernet  HWaddr 00:1f:29:58:ff:36 (MATCHES what
Switch Sees)


sudo ovs-appctl bond/show bond0
[sudo] password for builder:
---- bond0 ----
bond_mode: balance-tcp
bond-hash-basis: 0
updelay: 0 ms
downdelay: 0 ms
next rebalance: 4808 ms
lacp_status: negotiated

slave eth2: enabled
        active slave
        may_enable: true

slave eth3: enabled
        may_enable: true

slave eth4: enabled
        may_enable: true

slave eth5: enabled
        may_enable: true

I have disabled the firewall on the server.

But I am unable to ping the VLAN 500 or VLAN 590 IPs

Could someone point me towards what I have setup wrong?

Thanks

Stuart


From peterbryz at yahoo.com  Mon Apr 27 03:33:18 2015
From: peterbryz at yahoo.com (Peter Bryzgalov)
Date: Mon, 27 Apr 2015 19:33:18 +0900
Subject: [ovs-discuss] Subsequent packets get lost
Message-ID: <CCBAB4A4-3F55-4D3C-9B70-C2661B1B4F1A@yahoo.com>

Hi,

I have connected two Docker containers on two hosts through an OVS tunnel (tested GRE and VXLAN). I can ping and even login with ssh from one container to another through the tunnel, but I cannot use scp, iperf, etc., because for streams only the first packet reaches destination and all subsequent packets get lost. 

For both servers:

OS: Ubuntu 12.04
Kernel: 3.13.0-49-generic

OVS version:
ovs-vsctl (Open vSwitch) 2.3.1
Compiled Apr 24 2015 19:17:31
DB Schema 7.6.2

ovs-vsctl show (on 172.19.5.5 server):
    Bridge ovs-bridge
        Port "tap10654"
            Interface "tap10654"
                type: internal
        Port ovs_gre
            Interface ovs_gre
                type: gre
                options: {remote_ip="172.19.5.12"}
        Port ovs-bridge
            Interface ovs-bridge
                type: internal

Tap interface is moved inside a Docker container namespace and assigned an IP address (10.0.0.5 on one server and 10.0.0.6 on another). 

I did tcpdump for perf session (fragment):
this packet passed:
16:29:49.454168 IP 172.19.5.5 > 172.19.5.12: GREv0, length 94: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [P.], seq 1:25, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 24
these packets lost:
16:29:49.454238 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 25:1473, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
16:29:49.454246 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 1473:2921, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
16:29:49.454248 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 2921:4369, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
16:29:49.454250 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 4369:5817, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
16:29:49.454253 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 5817:7265, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
16:29:49.454255 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 7265:8713, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
16:29:49.454257 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 8713:10161, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
16:29:49.454259 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 10161:11609, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
16:29:49.454264 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 11609:13057, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448


Regards,
Peter
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150427/b39efab7/attachment-0001.html>

From gowrishankar.m at linux.vnet.ibm.com  Mon Apr 27 03:59:13 2015
From: gowrishankar.m at linux.vnet.ibm.com (gowrishankar)
Date: Mon, 27 Apr 2015 16:29:13 +0530
Subject: [ovs-discuss] Subsequent packets get lost
In-Reply-To: <CCBAB4A4-3F55-4D3C-9B70-C2661B1B4F1A@yahoo.com>
References: <CCBAB4A4-3F55-4D3C-9B70-C2661B1B4F1A@yahoo.com>
Message-ID: <553E1681.1010201@linux.vnet.ibm.com>

On Monday 27 April 2015 04:03 PM, Peter Bryzgalov wrote:
> Hi,
>
> I have connected two Docker containers on two hosts through an OVS 
> tunnel (tested GRE and VXLAN). I can ping and even login with ssh from 
> one container to another through the tunnel, but I cannot use scp, 
> iperf, etc., because for streams only the first packet reaches 
> destination and all subsequent packets get lost.
>

Make sure you have configured right MTU (1462) for docker bridge and 
container interfaces.

Hope this one http://wiredcraft.com/blog/multi-host-docker-network/ 
helps you.

Thx,
Gowrishankar

> For both servers:
>
> OS: Ubuntu 12.04
> Kernel: 3.13.0-49-generic
>
> OVS version:
> ovs-vsctl (Open vSwitch) 2.3.1
> Compiled Apr 24 2015 19:17:31
> DB Schema 7.6.2
>
> ovs-vsctl show (on 172.19.5.5 server):
>     Bridge ovs-bridge
>         Port "tap10654"
>             Interface "tap10654"
>                 type: internal
>         Port ovs_gre
>             Interface ovs_gre
>                 type: gre
>                 options: {remote_ip="172.19.5.12"}
>         Port ovs-bridge
>             Interface ovs-bridge
>                 type: internal
>
> Tap interface is moved inside a Docker container namespace and 
> assigned an IP address (10.0.0.5 on one server and 10.0.0.6 on another).
>
> I did tcpdump for perf session (fragment):
> this packet passed:
> 16:29:49.454168 IP 172.19.5.5 > 172.19.5.12: GREv0, length 94: IP 
> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [P.], seq 1:25, ack 1, win 229, 
> options [nop,nop,TS val 62341003 ecr 212259725], length 24
> these packets lost:
> 16:29:49.454238 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 
> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 25:1473, ack 1, win 
> 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
> 16:29:49.454246 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 
> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 1473:2921, ack 1, win 
> 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
> 16:29:49.454248 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 
> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 2921:4369, ack 1, win 
> 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
> 16:29:49.454250 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 
> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 4369:5817, ack 1, win 
> 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
> 16:29:49.454253 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 
> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 5817:7265, ack 1, win 
> 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
> 16:29:49.454255 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 
> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 7265:8713, ack 1, win 
> 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
> 16:29:49.454257 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 
> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 8713:10161, ack 1, win 
> 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
> 16:29:49.454259 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 
> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 10161:11609, ack 1, win 
> 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
> 16:29:49.454264 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 
> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 11609:13057, ack 1, win 
> 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>
>
> Regards,
> Peter
>
>
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss


-- 
Regards,
Gowrishankar M
Linux Networking

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150427/0839a934/attachment.html>

From cvinllen at gmail.com  Mon Apr 27 04:49:26 2015
From: cvinllen at gmail.com (Vinllen Chen)
Date: Mon, 27 Apr 2015 19:49:26 +0800
Subject: [ovs-discuss] ovsdb error
Message-ID: <CAN2QyzYw4y25CSO5tCZSBxwe2iGNCqBBYfw0X=RW+5hL_XNAYw@mail.gmail.com>

Hi, Dear all:
    My ovs was ok before, but recently, my ovs got an error when i add-port
in bridge:
ovs-vsctl add-br br0
ovs-vsctl add-port br0 port0
ovs-vsctl: Error detected while setting up 'port0'.  See ovs-vswitchd log
for details.

My ovs version is 2.3.90, the problem cannot be resloved even when i
reinstall the ovs. The log in the /var/log/openvswitch/ovs-vswitchd.log
show :

2015-04-27T11:38:15.746Z|00001|vlog|INFO|opened log file
/var/log/openvswitch/ovs-vswitchd.log
2015-04-27T11:38:15.749Z|00002|ovs_numa|INFO|Discovered 4 CPU cores on NUMA
node 0
2015-04-27T11:38:15.749Z|00003|ovs_numa|INFO|Discovered 1 NUMA nodes and 4
CPU cores
2015-04-27T11:38:15.749Z|00004|reconnect|INFO|unix:/var/run/openvswitch/db.sock:
connecting...
2015-04-27T11:38:15.749Z|00005|reconnect|INFO|unix:/var/run/openvswitch/db.sock:
connected
2015-04-27T11:38:15.750Z|00006|ovsdb_idl|WARN|Open_vSwitch database lacks
AutoAttach table (database needs upgrade?)
2015-04-27T11:38:15.750Z|00007|ovsdb_idl|WARN|Bridge table in Open_vSwitch
database lacks auto_attach column (database needs upgrade?)
2015-04-27T11:38:15.750Z|00008|ovsdb_idl|WARN|Bridge table in Open_vSwitch
database lacks datapath_version column (database needs upgrade?)
2015-04-27T11:38:15.750Z|00009|ovsdb_idl|WARN|Bridge table in Open_vSwitch
database lacks mcast_snooping_enable column (database needs upgrade?)
2015-04-27T11:38:15.750Z|00010|ovsdb_idl|WARN|Bridge table in Open_vSwitch
database lacks rstp_enable column (database needs upgrade?)
2015-04-27T11:38:15.750Z|00011|ovsdb_idl|WARN|Bridge table in Open_vSwitch
database lacks rstp_status column (database needs upgrade?)
2015-04-27T11:38:15.750Z|00012|ovsdb_idl|WARN|Flow_Table table in
Open_vSwitch database lacks external_ids column (database needs upgrade?)
2015-04-27T11:38:15.750Z|00013|ovsdb_idl|WARN|Flow_Table table in
Open_vSwitch database lacks prefixes column (database needs upgrade?)
2015-04-27T11:38:15.750Z|00014|ovsdb_idl|WARN|IPFIX table in Open_vSwitch
database lacks other_config column (database needs upgrade?)
2015-04-27T11:38:15.750Z|00015|ovsdb_idl|WARN|Interface table in
Open_vSwitch database lacks cfm_flap_count column (database needs upgrade?)
2015-04-27T11:38:15.750Z|00016|ovsdb_idl|WARN|Interface table in
Open_vSwitch database lacks error column (database needs upgrade?)
2015-04-27T11:38:15.750Z|00017|ovsdb_idl|WARN|Interface table in
Open_vSwitch database lacks lldp column (database needs upgrade?)
2015-04-27T11:38:15.750Z|00018|ovsdb_idl|WARN|Open_vSwitch table in
Open_vSwitch database lacks datapath_types column (database needs upgrade?)
2015-04-27T11:38:15.750Z|00019|ovsdb_idl|WARN|Open_vSwitch table in
Open_vSwitch database lacks iface_types column (database needs upgrade?)
2015-04-27T11:38:15.750Z|00020|ovsdb_idl|WARN|Port table in Open_vSwitch
database lacks bond_active_slave column (database needs upgrade?)
2015-04-27T11:38:15.750Z|00021|ovsdb_idl|WARN|Port table in Open_vSwitch
database lacks rstp_statistics column (database needs upgrade?)
2015-04-27T11:38:15.750Z|00022|ovsdb_idl|WARN|Port table in Open_vSwitch
database lacks rstp_status column (database needs upgrade?)
2015-04-27T11:38:15.751Z|00023|bridge|INFO|ovs-vswitchd (Open vSwitch)
2.3.90
2015-04-27T11:38:27.897Z|00024|memory|INFO|7688 kB peak resident set size
after 12.2 seconds

    Could anyone help me ? Great appreciate for anyone's relpy.
Best Regards,
Vinllen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150427/ce9811ac/attachment-0001.html>

From felix_zw at 126.com  Mon Apr 27 05:02:01 2015
From: felix_zw at 126.com (ZY)
Date: Mon, 27 Apr 2015 20:02:01 +0800 (CST)
Subject: [ovs-discuss] why 'ovs-vsctl add-port br dev' DO NOT check dev is
 really exist or not ?
Message-ID: <25b6bd80.13a42.14cfac16a4b.Coremail.felix_zw@126.com>

Hi,
    I am testing ovs 2.3.1 in openstack; when i reboot machine, the network service in my VMs is not work any more until i restart the ovs service.


    Reproduce
    1.  VM-1 is binding with tap: tape502841a-f4
    2.  when machine reboot,  OVS service is down first and the info of tape502841a-f4  is store in ovs-db
    3.  libvirt destory the instance and delete  tape502841a-f4
    4.  machine start and bootup the OVS service,  OVS read the ovs-db and will add-port br-int  tape502841a-f4, but failed to add into datapath because  tape502841a-f4 is not create yet.
    5. libvirt start instance and create  tape502841a-f4
    6. the network service of instance is not work because of  tape502841a-f4 is not in datapath 


    This lead to the PORT is different between ovs-db and ovs-datapath, and i have to restart ovs service to make it work.
    I am wonder why OVS do not check the DEV is really exist in system first when run 'ovs-vsctl add-port BRIDGE DEV'  ?   and How to solve this problem?


thank you 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150427/b185cc3b/attachment.html>

From shettyg at nicira.com  Mon Apr 27 06:53:12 2015
From: shettyg at nicira.com (Gurucharan Shetty)
Date: Mon, 27 Apr 2015 06:53:12 -0700
Subject: [ovs-discuss] ovsdb error
In-Reply-To: <CAN2QyzYw4y25CSO5tCZSBxwe2iGNCqBBYfw0X=RW+5hL_XNAYw@mail.gmail.com>
References: <CAN2QyzYw4y25CSO5tCZSBxwe2iGNCqBBYfw0X=RW+5hL_XNAYw@mail.gmail.com>
Message-ID: <CAHbON5o-2uu=t2cVaiebuDXzuqZQE_KAoy6T89SiknZfu92oUA@mail.gmail.com>

On Mon, Apr 27, 2015 at 4:49 AM, Vinllen Chen <cvinllen at gmail.com> wrote:
> Hi, Dear all:
>     My ovs was ok before, but recently, my ovs got an error when i add-port
> in bridge:
> ovs-vsctl add-br br0
> ovs-vsctl add-port br0 port0
> ovs-vsctl: Error detected while setting up 'port0'.  See ovs-vswitchd log
> for details.
It looks to me that you upgraded the Open vSwitch daemons but did not
upgrade the database file.
Usually a user does not have to worry about it, if they install OVS
via packages like rpm, debian etc. Does 'ovs-ctl stop' and 'ovs-ctl
start' help?

From shettyg at nicira.com  Mon Apr 27 07:09:52 2015
From: shettyg at nicira.com (Gurucharan Shetty)
Date: Mon, 27 Apr 2015 07:09:52 -0700
Subject: [ovs-discuss] ovsdb error
In-Reply-To: <CAN2Qyzb+o5AtwnrSySLymXuyFRDuOq_fa78nbbnOkhOmaNkPxg@mail.gmail.com>
References: <CAN2QyzYw4y25CSO5tCZSBxwe2iGNCqBBYfw0X=RW+5hL_XNAYw@mail.gmail.com>
 <CAHbON5o-2uu=t2cVaiebuDXzuqZQE_KAoy6T89SiknZfu92oUA@mail.gmail.com>
 <CAN2Qyzb+o5AtwnrSySLymXuyFRDuOq_fa78nbbnOkhOmaNkPxg@mail.gmail.com>
Message-ID: <CAHbON5q66uGjw5qAHJpZgfMqLwL6A0M+JRSKEHdeL9eiwJV34w@mail.gmail.com>

Stop your daemons, delete your database file and re-create it and see
if that helps.

On Mon, Apr 27, 2015 at 7:07 AM, Vinllen Chen <cvinllen at gmail.com> wrote:
> Hi, Dear Gurucharan:
>     Thankyou for your reply. But i didn't have upgrade the vswitchd daemon
> before. I install the ovs through source code, there is no commad "ovs-ctl"
> in my computer.
>
> On Mon, Apr 27, 2015 at 9:53 PM, Gurucharan Shetty <shettyg at nicira.com>
> wrote:
>>
>> On Mon, Apr 27, 2015 at 4:49 AM, Vinllen Chen <cvinllen at gmail.com> wrote:
>> > Hi, Dear all:
>> >     My ovs was ok before, but recently, my ovs got an error when i
>> > add-port
>> > in bridge:
>> > ovs-vsctl add-br br0
>> > ovs-vsctl add-port br0 port0
>> > ovs-vsctl: Error detected while setting up 'port0'.  See ovs-vswitchd
>> > log
>> > for details.
>> It looks to me that you upgraded the Open vSwitch daemons but did not
>> upgrade the database file.
>> Usually a user does not have to worry about it, if they install OVS
>> via packages like rpm, debian etc. Does 'ovs-ctl stop' and 'ovs-ctl
>> start' help?
>
>

From peterbryz at yahoo.com  Mon Apr 27 07:26:18 2015
From: peterbryz at yahoo.com (Pyotr Bryzgalov)
Date: Mon, 27 Apr 2015 23:26:18 +0900
Subject: [ovs-discuss] Subsequent packets get lost
In-Reply-To: <553E1681.1010201@linux.vnet.ibm.com>
References: <CCBAB4A4-3F55-4D3C-9B70-C2661B1B4F1A@yahoo.com>
 <553E1681.1010201@linux.vnet.ibm.com>
Message-ID: <89E1C5E3-CCE2-4C4E-8857-D02CA3FE736C@yahoo.com>

Thank you Gowrishankar,

I had MTU 1500. I set tap interfaces’ MTU to 1462 and it worked for GRE tunnel! 
Unfortunately, setting MTU to 1458 (1500 - 14 - 20 - 8)  does’t work for VXLAN. (8 bytes is vxlan header size)

Regards,
Peter  

> On 27Apr, 2015, at 19:59, gowrishankar <gowrishankar.m at linux.vnet.ibm.com> wrote:
> 
> On Monday 27 April 2015 04:03 PM, Peter Bryzgalov wrote:
>> Hi,
>> 
>> I have connected two Docker containers on two hosts through an OVS tunnel (tested GRE and VXLAN). I can ping and even login with ssh from one container to another through the tunnel, but I cannot use scp, iperf, etc., because for streams only the first packet reaches destination and all subsequent packets get lost. 
>> 
> 
> Make sure you have configured right MTU (1462) for docker bridge and container interfaces.
> 
> Hope this one http://wiredcraft.com/blog/multi-host-docker-network/ <http://wiredcraft.com/blog/multi-host-docker-network/>  helps you.
> 
> Thx,
> Gowrishankar
> 
>> For both servers:
>> 
>> OS: Ubuntu 12.04
>> Kernel: 3.13.0-49-generic
>> 
>> OVS version:
>> ovs-vsctl (Open vSwitch) 2.3.1
>> Compiled Apr 24 2015 19:17:31
>> DB Schema 7.6.2
>> 
>> ovs-vsctl show (on 172.19.5.5 server):
>>     Bridge ovs-bridge
>>         Port "tap10654"
>>             Interface "tap10654"
>>                 type: internal
>>         Port ovs_gre
>>             Interface ovs_gre
>>                 type: gre
>>                 options: {remote_ip="172.19.5.12"}
>>         Port ovs-bridge
>>             Interface ovs-bridge
>>                 type: internal
>> 
>> Tap interface is moved inside a Docker container namespace and assigned an IP address (10.0.0.5 on one server and 10.0.0.6 on another). 
>> 
>> I did tcpdump for perf session (fragment):
>> this packet passed:
>> 16:29:49.454168 IP 172.19.5.5 > 172.19.5.12: GREv0, length 94: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [P.], seq 1:25, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 24
>> these packets lost:
>> 16:29:49.454238 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 25:1473, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>> 16:29:49.454246 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 1473:2921, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>> 16:29:49.454248 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 2921:4369, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>> 16:29:49.454250 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 4369:5817, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>> 16:29:49.454253 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 5817:7265, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>> 16:29:49.454255 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 7265:8713, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>> 16:29:49.454257 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 8713:10161, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>> 16:29:49.454259 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 10161:11609, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>> 16:29:49.454264 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 11609:13057, ack 1, win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>> 
>> 
>> Regards,
>> Peter
>> 
>> 
>> _______________________________________________
>> discuss mailing list
>> discuss at openvswitch.org <mailto:discuss at openvswitch.org>
>> http://openvswitch.org/mailman/listinfo/discuss <http://openvswitch.org/mailman/listinfo/discuss>
> 
> 
> -- 
> Regards,
> Gowrishankar M
> Linux Networking

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150427/f7f71a1c/attachment-0001.html>

From blp at nicira.com  Mon Apr 27 08:12:09 2015
From: blp at nicira.com (Ben Pfaff)
Date: Mon, 27 Apr 2015 08:12:09 -0700
Subject: [ovs-discuss] why 'ovs-vsctl add-port br dev' DO NOT check dev
 is really exist or not ?
In-Reply-To: <25b6bd80.13a42.14cfac16a4b.Coremail.felix_zw@126.com>
References: <25b6bd80.13a42.14cfac16a4b.Coremail.felix_zw@126.com>
Message-ID: <20150427151209.GF2783@nicira.com>

On Mon, Apr 27, 2015 at 08:02:01PM +0800, ZY wrote:
>     Reproduce
>     1.  VM-1 is binding with tap: tape502841a-f4
>     2.  when machine reboot,  OVS service is down first and the info of tape502841a-f4  is store in ovs-db
>     3.  libvirt destory the instance and delete  tape502841a-f4
>     4.  machine start and bootup the OVS service,  OVS read the ovs-db and will add-port br-int  tape502841a-f4, but failed to add into datapath because  tape502841a-f4 is not create yet.

There's no "add-port" happening, it's just that the database still has
the same contents as before reboot.

>     5. libvirt start instance and create  tape502841a-f4
>     6. the network service of instance is not work because of  tape502841a-f4 is not in datapath 
> 
> 
>     This lead to the PORT is different between ovs-db and ovs-datapath, and i have to restart ovs service to make it work.
>     I am wonder why OVS do not check the DEV is really exist in system first when run 'ovs-vsctl add-port BRIDGE DEV'  ?   and How to solve this problem?

ovs-vsctl is just a database interface.  It doesn't know anything about
your system interface; in general, it cannot, because it does not
necessarily run on the same machine as ovs-vswitchd.

You might want to configure OVS to remove all the bridges on reboot.

From blp at nicira.com  Mon Apr 27 08:27:38 2015
From: blp at nicira.com (Ben Pfaff)
Date: Mon, 27 Apr 2015 08:27:38 -0700
Subject: [ovs-discuss] Using the Python IDL library issues
In-Reply-To: <BAY176-W31A629EA858090F03813CA91EA0@phx.gbl>
References: <BAY176-W31A629EA858090F03813CA91EA0@phx.gbl>
Message-ID: <20150427152738.GH2783@nicira.com>

On Sun, Apr 26, 2015 at 12:36:52PM -0700, Mir Ali wrote:
> I was hoping idl to load the database on the first idl.run() call but
> it doesn't seem like it is. The tables are always empty although the
> current set up is as shown below

It wouldn't normally be on the first idl.run() call, you have to wait
for the sequence number to change.

From blp at nicira.com  Mon Apr 27 08:38:17 2015
From: blp at nicira.com (Ben Pfaff)
Date: Mon, 27 Apr 2015 08:38:17 -0700
Subject: [ovs-discuss] Question on tunnel interfaces
In-Reply-To: <1036089648.4063399.1429942374890.JavaMail.yahoo@mail.yahoo.com>
References: <1036089648.4063399.1429942374890.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <20150427153817.GJ2783@nicira.com>

On Sat, Apr 25, 2015 at 06:12:54AM +0000, Padmanabhan Krishnan wrote:
> Hello,My question is related to the sending (encap) side of the OVS tunnel bridge.
> After the tunnel bridge (say br-tun) does the encapsulation (VXLAN or GRE), i assume it uses the host routing table to route the packet. So, when a frame is received by the br-tun from an in_port, after performing the necessary encapsulation does OVS send it over to kernel routing module to forward the frame on the right interface (routing)?
> In my example below, the end point 173 subnet is attached to say, eth2. The physical port 'eth2' is _not_ connected to OVS bridge 'br-tun'. But, depending on the 'remote_ip', the frame gets forwarded to the right interface.
> I will be obliged, if someone can explain, in terms of flow, as how forwarding happens after the frame gets encapsulated (br-tun)? Does routing of the frame fall under the scope of OVS?Is it a special functionality of the 'set_tunnel' action?

After encapsulation, OVS turns the packet over to the kernel TCP/IP
stack, which routes it appropriately.  OVS doesn't have control over how
exactly that happens, other than by controlling addressing.

The set_tunnel action just sets the tunnel key (e.g. in GRE the GRE key,
in VXLAN the VNI).

> Dumping the flow on br-tun using ofctl, i assume the below line is responsible for the encap:"
>  cookie=0x0, duration=14723.832s, table=22, n_packets=22, n_bytes=1826, idle_age=14704, dl_vlan=1 actions=strip_vlan,set_tunnel:0x3eb,output:2
> "
> Port 2 is vxlan-ad24f10f below.

I'd expect to see more information than just the tunnel key.  Check the
"ovs-dpctl show" output for port 2.

From blp at nicira.com  Mon Apr 27 08:40:35 2015
From: blp at nicira.com (Ben Pfaff)
Date: Mon, 27 Apr 2015 08:40:35 -0700
Subject: [ovs-discuss] why 'ovs-vsctl add-port br dev' DO NOT check dev
 is really exist or not ?
In-Reply-To: <10f7daac.ae46.14cfb86322f.Coremail.felix_zw@126.com>
References: <25b6bd80.13a42.14cfac16a4b.Coremail.felix_zw@126.com>
 <20150427151209.GF2783@nicira.com>
 <10f7daac.ae46.14cfb86322f.Coremail.felix_zw@126.com>
Message-ID: <20150427154035.GK2783@nicira.com>

When you configure ovs-vsctl to connect remotely with --db= and
configure the remote ovsdb-server to listen with --remote or "ovs-appctl
-t ovsdb-server ovsdb-server/add-remote".

On Mon, Apr 27, 2015 at 11:36:58PM +0800, ZY wrote:
> Thank you  Ben
> In what kind of scenario,  ovs-vsctl will run on a different machine as ovs-vswitchd ? How dose ovs-vsctl connect to the remote ovsdb server?
> A example will really help.  Great appreciate
> 
> 
> Best Regards    
> 
> 
> 
> 
> 
> 
> 
> At 2015-04-27 23:12:09, "Ben Pfaff" <blp at nicira.com> wrote:
> >On Mon, Apr 27, 2015 at 08:02:01PM +0800, ZY wrote:
> >>     Reproduce
> >>     1.  VM-1 is binding with tap: tape502841a-f4
> >>     2.  when machine reboot,  OVS service is down first and the info of tape502841a-f4  is store in ovs-db
> >>     3.  libvirt destory the instance and delete  tape502841a-f4
> >>     4.  machine start and bootup the OVS service,  OVS read the ovs-db and will add-port br-int  tape502841a-f4, but failed to add into datapath because  tape502841a-f4 is not create yet.
> >
> >There's no "add-port" happening, it's just that the database still has
> >the same contents as before reboot.
> >
> >>     5. libvirt start instance and create  tape502841a-f4
> >>     6. the network service of instance is not work because of  tape502841a-f4 is not in datapath 
> >> 
> >> 
> >>     This lead to the PORT is different between ovs-db and ovs-datapath, and i have to restart ovs service to make it work.
> >>     I am wonder why OVS do not check the DEV is really exist in system first when run 'ovs-vsctl add-port BRIDGE DEV'  ?   and How to solve this problem?
> >
> >ovs-vsctl is just a database interface.  It doesn't know anything about
> >your system interface; in general, it cannot, because it does not
> >necessarily run on the same machine as ovs-vswitchd.
> >
> >You might want to configure OVS to remove all the bridges on reboot.

From felix_zw at 126.com  Mon Apr 27 08:36:58 2015
From: felix_zw at 126.com (ZY)
Date: Mon, 27 Apr 2015 23:36:58 +0800 (CST)
Subject: [ovs-discuss] why 'ovs-vsctl add-port br dev' DO NOT check dev
 is really exist or not ?
In-Reply-To: <20150427151209.GF2783@nicira.com>
References: <25b6bd80.13a42.14cfac16a4b.Coremail.felix_zw@126.com>
 <20150427151209.GF2783@nicira.com>
Message-ID: <10f7daac.ae46.14cfb86322f.Coremail.felix_zw@126.com>

Thank you  Ben
In what kind of scenario,  ovs-vsctl will run on a different machine as ovs-vswitchd ? How dose ovs-vsctl connect to the remote ovsdb server?
A example will really help.  Great appreciate


Best Regards    







At 2015-04-27 23:12:09, "Ben Pfaff" <blp at nicira.com> wrote:
>On Mon, Apr 27, 2015 at 08:02:01PM +0800, ZY wrote:
>>     Reproduce
>>     1.  VM-1 is binding with tap: tape502841a-f4
>>     2.  when machine reboot,  OVS service is down first and the info of tape502841a-f4  is store in ovs-db
>>     3.  libvirt destory the instance and delete  tape502841a-f4
>>     4.  machine start and bootup the OVS service,  OVS read the ovs-db and will add-port br-int  tape502841a-f4, but failed to add into datapath because  tape502841a-f4 is not create yet.
>
>There's no "add-port" happening, it's just that the database still has
>the same contents as before reboot.
>
>>     5. libvirt start instance and create  tape502841a-f4
>>     6. the network service of instance is not work because of  tape502841a-f4 is not in datapath 
>> 
>> 
>>     This lead to the PORT is different between ovs-db and ovs-datapath, and i have to restart ovs service to make it work.
>>     I am wonder why OVS do not check the DEV is really exist in system first when run 'ovs-vsctl add-port BRIDGE DEV'  ?   and How to solve this problem?
>
>ovs-vsctl is just a database interface.  It doesn't know anything about
>your system interface; in general, it cannot, because it does not
>necessarily run on the same machine as ovs-vswitchd.
>
>You might want to configure OVS to remove all the bridges on reboot.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150427/48a0a95d/attachment-0001.html>

From mpalagum at Central.UH.EDU  Sat Apr 25 19:44:47 2015
From: mpalagum at Central.UH.EDU (Palagummi, Mydhili)
Date: Sat, 25 Apr 2015 21:44:47 -0500
Subject: [ovs-discuss] Configuring OVS on GENI
Message-ID: <DD12C072DE0EAE4FAA1E95CC1D4BED1D3974CFDB84@EXSERVER5.cougarnet.uh.edu>

Hello,

We have a question related to configuring OVS.

We built a topology in GENI using two OVS nodes and three Linux machines.(switches connected to each other, two nodes connected to switch1 and 1 node connected to switch2). We configured OVS in both switches as per the below tutorial.

http://geni-app-developer-documentation.readthedocs.org/en/latest/examples/example-3.html (this tutorial is for a single switch. We repeated the same for the second switch)

But we are not able to ping node3 from node1. Could you please let us know if we are doing something wrong?

Here is the OVS configuration on both the switches:
SWITCH1:
725406ec-3e20-46fe-85cf-8d5030bcfa4a
    Bridge "br-int3"
        Controller "tcp:127.0.0.1:6633"
        fail_mode: secure
        Port "p1"
            Interface "p1"
                type: patch
                options: {peer="p2"}
        Port "br-int3"
            Interface "br-int3"
                type: internal
        Port "eth3"
            Interface "eth3"
    Bridge "br-int2"
        Port "br-int2"
            Interface "br-int2"
                type: internal
        Port "eth2"
            Interface "eth2"
    Bridge br-int
        Controller "tcp:127.0.0.1:6633"
        fail_mode: secure
        Port br-int
            Interface br-int
                type: internal
        Port "eth1"
            Interface "eth1"
    ovs_version: "1.9.3"

SWITCH2:
725406ec-3e20-46fe-85cf-8d5030bcfa4a
    Bridge br-int
        Port br-int
            Interface br-int
                type: internal
        Port "eth1"
            Interface "eth1"
    Bridge "br-int2"
        Controller "tcp:127.0.0.1:6633"
        fail_mode: secure
        Port "eth2"
            Interface "eth2"
        Port "p2"
            Interface "p2"
                type: patch
                options: {peer="p1"}
        Port "br-int2"
            Interface "br-int2"
                type: internal
    ovs_version: "1.9.3"



Many thanks,
Mydhili Palagummi

From astgosen at ccu.edu.tw  Sun Apr 26 20:56:32 2015
From: astgosen at ccu.edu.tw (GosenChien)
Date: Mon, 27 Apr 2015 11:56:32 +0800
Subject: [ovs-discuss] [installation problem] Installation of OVS 2.3.1
 from the tarball on Citrix Xen Server 6.5
In-Reply-To: <20150417222726.GE8247@nicira.com>
References: <552DD78A.7040003@ccu.edu.tw> <20150415031414.GG12976@nicira.com>
 <552E0262.4010801@ccu.edu.tw> <20150415151554.GC7003@nicira.com>
 <552F2C73.70305@ccu.edu.tw> <20150416150918.GB6941@nicira.com>
 <552FD8B0.2070104@cs.ccu.edu.tw> <20150416155058.GI6941@nicira.com>
 <553072ED.40201@ccu.edu.tw> <553117A1.1000107@cs.ccu.edu.tw>
 <20150417222726.GE8247@nicira.com>
Message-ID: <553DB370.8040206@ccu.edu.tw>

All,
Sorry for late reply.
We believe some section need to be modified to meet the actual status 
for building Xen server.
Below is our suggestion:

1. The fonder path " /lib/modules/3.10.0+2xen/" doesn't exist anymore in 
the XenServer v6.5;
2. The path of openvswitch.ko in the DDK VM is wrong;

======================================================

But we believe there's still lots of work need to do since we modified 
the SPEC file and build the RPM packages successfully, the installation 
of RPMs in the Xen Server is still failed :

a. During installation, the package found the wrong path of the file 
"openvswitch.ko" ;
b. The kernel module RPM packages could not be installed -- the 
installation responded that the kernel version is wrong, but actually 
the kernel version is correct.

Thanks for your support. However, since our project is urgent so that 
we'll try other Linux distributions to meet our requirement ASAP.

Best Regards,
             Gosen Chien
*************************************
CCU CS Project Assistant
TEL: (05)272-0411#23134
E-mail:astgosen at ccu.edu.tw  <mailto:astgosen at ccu.edu.tw>
        astgosen at novatw.info  <mailto:astgosen at novatw.info>

Ben Pfaff 於 西元2015年04月18日 06:27 寫道:
> Really this thread reads as you repeatedly changing things randomly in
> the hopes that it will work.  I suggest that a more systematic
> approach is more likely to work.  When it does, if the documentation
> is wrong or misleading, please explain, and we'll improve it.
>
> On Fri, Apr 17, 2015 at 10:24:33PM +0800, Po-Ching Lin wrote:
>> Dear Ben,
>>
>>        We specified kernel_flavor to be xen before, but rpmbuild simply complained
>> that source dir /lib/modules/3.10.0+2xen/build doesn't exist. We
>> don't specify kernel_flavor this time, but it seems that the variable kernel_flavor
>> is left in the path name. According to INSTALL.XenServer, xen is the choice for
>> kernel_flavor, but we don't have that directory under /lib/modules, so the error
>> happened. We run the rpmbuild command on DDK VM. Is that correct, or should we
>> manully create that directory under /lib/modules? Any suggestions are appreciated.
>> Thanks.
>>
>> Po-Ching
>>
>> GosenChien-IMAP ??? 2015/4/17 ?????? 10:41 ??????:
>>> All :
>>>
>>> Below is the output log after using the instruction to build the RPM packages:
>>>
>>> --------------------------------------------------------------------------
>>> [Steps]
>>> 1. Left the openvswitch-xen.spec without any changes;
>>> 2. Enter <ovs folder>/xenserver/ directory;
>>> 3. Issue the command of rpmbuild :
>>>> *rpmbuild -bb openvswitch-xen.spec -D "openvswitch_version 2.3.1" -D "kernel_name xen" -D "kernel_version 3.10.0+2" -D "xen_version 4.4.1-1.9.0.459.28798*
>>> [Result]
>>> 1. Output--
>>> Executing (%prep)???/bin/sh -e /var/tmp/rpm-tmp.34945
>>> Executing (%build)???/bin/sh -e /var/tmp/rpm-tmp.16395
>>> checking for a BSD-compatible install... /usr/bin/install -c
>>> checking whether build environment is sane... yes
>>> checking for a thread-safe mkdir -p... /bin/mkdir -p
>>> checking for gawk... gawk
>>> checking whether make sets $(MAKE)... yes
>>> checking for gcc... gcc
>>> checking whether the C compiler works... yes
>>> checking for C compiler default output file name... a.out
>>> checking for suffix of executables...
>>> checking whether we are cross compiling... no
>>> checking for suffix of object files... o
>>> checking whether we are using the GNU C compiler... yes
>>> checking whether gcc accepts -g... yes
>>> checking for gcc option to accept ISO C89... none needed
>>> checking for style of include used by make... GNU
>>> checking dependency style of gcc... gcc3
>>> checking whether gcc and cc understand -c and -o together... yes
>>> checking how to run the C preprocessor... gcc -E
>>> checking for grep that handles long lines and -e... /bin/grep
>>> checking for fgrep... /bin/grep -F
>>> checking for egrep... /bin/grep -E
>>> checking for perl... /usr/bin/perl
>>> checking for ANSI C header files... yes
>>> checking for sys/types.h... yes
>>> checking for sys/stat.h... yes
>>> checking for stdlib.h... yes
>>> checking for string.h... yes
>>> checking for memory.h... yes
>>> checking for strings.h... yes
>>> checking for inttypes.h... yes
>>> checking for stdint.h... yes
>>> checking for unistd.h... yes
>>> checking minix/config.h usability... no
>>> checking minix/config.h presence... no
>>> checking for minix/config.h... no
>>> checking whether it is safe to define __EXTENSIONS__... yes
>>> checking whether byte ordering is bigendian... no
>>> checking for special C compiler options needed for large files... no
>>> checking for _FILE_OFFSET_BITS value needed for large files... no
>>> checking build system type... x86_64-unknown-linux-gnu
>>> checking host system type... x86_64-unknown-linux-gnu
>>> checking how to print strings... printf
>>> checking for a sed that does not truncate output... /bin/sed
>>> checking for ld used by gcc... /usr/bin/ld
>>> checking if the linker (/usr/bin/ld) is GNU ld... yes
>>> checking for BSD- or MS-compatible name lister (nm)... /usr/bin/nm -B
>>> checking the name lister (/usr/bin/nm -B) interface... BSD nm
>>> checking whether ln -s works... yes
>>> checking the maximum length of command line arguments... 98304
>>> checking whether the shell understands some XSI constructs... yes
>>> checking whether the shell understands "+="... yes
>>> checking how to convert x86_64-unknown-linux-gnu file names to x86_64-unknown-linux-gnu format... func_convert_file_noop
>>> checking how to convert x86_64-unknown-linux-gnu file names to toolchain format... func_convert_file_noop
>>> checking for /usr/bin/ld option to reload object files... -r
>>> checking for objdump... objdump
>>> checking how to recognize dependent libraries... pass_all
>>> checking for dlltool... no
>>> checking how to associate runtime and link libraries... printf %s\n
>>> checking for ar... ar
>>> checking for archiver @FILE support... @
>>> checking for strip... strip
>>> checking for ranlib... ranlib
>>> checking command to parse /usr/bin/nm -B output from gcc object... ok
>>> checking for sysroot... no
>>> checking for mt... no
>>> checking if : is a manifest tool... no
>>> checking for dlfcn.h... yes
>>> checking for objdir... .libs
>>> checking if gcc supports -fno-rtti -fno-exceptions... no
>>> checking for gcc option to produce PIC... -fPIC -DPIC
>>> checking if gcc PIC flag -fPIC -DPIC works... yes
>>> checking if gcc static flag -static works... yes
>>> checking if gcc supports -c -o file.o... yes
>>> checking if gcc supports -c -o file.o... (cached) yes
>>> checking whether the gcc linker (/usr/bin/ld -m elf_x86_64) supports shared libraries... yes
>>> checking dynamic linker characteristics... GNU/Linux ld.so
>>> checking how to hardcode library paths into programs... immediate
>>> checking whether stripping libraries is possible... yes
>>> checking if libtool supports shared libraries... yes
>>> checking whether to build shared libraries... no
>>> checking whether to build static libraries... yes
>>> checking for library containing pow... -lm
>>> checking for library containing clock_gettime... -lrt
>>> checking for library containing timer_create... none required
>>> checking for library containing pthread_sigmask... none required
>>> checking whether strerror_r is declared... yes
>>> checking for strerror_r... yes
>>> checking whether strerror_r returns char *... yes
>>> checking vmware.h usability... no
>>> checking vmware.h presence... no
>>> checking for vmware.h... no
>>> checking windows.h usability... no
>>> checking windows.h presence... no
>>> checking for windows.h... no
>>> checking for linux/netlink.h... yes
>>> checking for pkg-config... /usr/bin/pkg-config
>>> checking whether compiling and linking against OpenSSL works... yes
>>> checking for Python 2.x for x >= 4... /usr/bin/python
>>> checking for uuid Python module... no
>>> checking whether to add python/compat to PYTHONPATH... yes
>>> checking for dot... no
>>> checking net/if_packet.h usability... yes
>>> checking net/if_packet.h presence... yes
>>> checking for net/if_packet.h... yes
>>> checking net/if_dl.h usability... no
>>> checking net/if_dl.h presence... no
>>> checking for net/if_dl.h... no
>>> checking whether strtok_r macro segfaults on some inputs... yes
>>> checking whether sys_siglist is declared... yes
>>> checking for struct stat.st_mtim.tv_nsec... yes
>>> checking for struct stat.st_mtimensec... no
>>> checking for struct ifreq.ifr_flagshigh... no
>>> checking for mlockall... yes
>>> checking for strnlen... yes
>>> checking for getloadavg... yes
>>> checking for statvfs... yes
>>> checking for getmntent_r... yes
>>> checking mntent.h usability... yes
>>> checking mntent.h presence... yes
>>> checking for mntent.h... yes
>>> checking sys/statvfs.h usability... yes
>>> checking sys/statvfs.h presence... yes
>>> checking for sys/statvfs.h... yes
>>> checking linux/types.h usability... yes
>>> checking linux/types.h presence... yes
>>> checking for linux/types.h... yes
>>> checking linux/if_ether.h usability... yes
>>> checking linux/if_ether.h presence... yes
>>> checking for linux/if_ether.h... yes
>>> checking stdatomic.h usability... no
>>> checking stdatomic.h presence... no
>>> checking for stdatomic.h... no
>>> checking for net/if_mib.h... no
>>> checking for library containing backtrace... none required
>>> checking whether libc supports hooks for malloc and related functions... yes
>>> checking valgrind/valgrind.h usability... no
>>> checking valgrind/valgrind.h presence... no
>>> checking for valgrind/valgrind.h... no
>>> checking for connect in -lsocket... no
>>> checking for library containing gethostbyname... none required
>>> checking XenServer release... 6.5.0
>>> checking for groff... yes
>>> checking whether make is GNU make... yes
>>> checking whether gcc has <threads.h> that supports thread_local... no
>>> checking whether gcc supports __thread... yes
>>> checking for library containing __atomic_load_8... no
>>> checking whether gcc supports GCC 4.0+ atomic built-ins... yes
>>> checking value of __atomic_always_lock_free(1)... unsupported
>>> checking value of __atomic_always_lock_free(2)... unsupported
>>> checking value of __atomic_always_lock_free(4)... unsupported
>>> checking value of __atomic_always_lock_free(8)... unsupported
>>> checking for library containing aio_write... none required
>>> checking for pthread_set_name_np... no
>>> checking for pthread_setname_np() variant... none
>>> checking whether __linux__ is defined... true
>>> checking for working posix_memalign... yes
>>> checking whether the preprocessor supports include_next... yes
>>> checking whether system header files limit the line length... no
>>> checking for stdio.h... yes
>>> checking for string.h... (cached) yes
>>> checking whether gcc accepts -Werror... yes
>>> checking whether gcc accepts -Wall... yes
>>> checking whether gcc accepts -Wextra... yes
>>> checking whether gcc accepts -Wno-sign-compare... yes
>>> checking whether gcc accepts -Wpointer-arith... yes
>>> checking whether gcc accepts -Wdeclaration-after-statement... yes
>>> checking whether gcc accepts -Wformat-security... no
>>> checking whether gcc accepts -Wno-format-zero-length... yes
>>> checking whether gcc accepts -Wswitch-enum... yes
>>> checking whether gcc accepts -Wunused-parameter... yes
>>> checking whether gcc accepts -Wstrict-aliasing... yes
>>> checking whether gcc accepts -Wbad-function-cast... yes
>>> checking whether gcc accepts -Wcast-align... yes
>>> checking whether gcc accepts -Wstrict-prototypes... no
>>> checking whether gcc accepts -Wold-style-definition... no
>>> checking whether gcc accepts -Wmissing-prototypes... yes
>>> checking whether gcc accepts -Wmissing-field-initializers... yes
>>> checking whether gcc accepts -Wthread-safety... no
>>> checking whether gcc accepts -Wno-unused... yes
>>> checking whether gcc accepts -Wno-unused-parameter... yes
>>> checking target hint for cgcc... x86_64
>>> checking whether make has GNU make $(if) extension... yes
>>> checking for Linux build directory... no
>>> *configure: error: source dir /lib/modules/3.10.0+2%{kernel_flavor}/build doesn't exist*
>>>
>>> 2. We found that the program still couldn't find the target folder : /lib/modules/*3.10.0+2%{kernel_flavor}*/build
>>>
>>> --------------------------------------------------------------------------
>>>
>>> It seems that the main problem is still the same.
>>> Any suggestion is welcome. :-)
>>>
>>> Best Regards,
>>>              Gosen Chien
>>> *************************************
>>> CCU CS Project assistant
>>> No.168, Sec. 1, University Rd., Min-Hsiung Township, Chia-yi County 62102, Taiwan
>>> TEL: (05)272-0411#23134
>>> E-mail:astgosen at ccu.edu.tw  <mailto:astgosen at ccu.edu.tw>
>>>         astgosen at novatw.info  <mailto:astgosen at novatw.info>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150427/bf9326e5/attachment-0001.html>

From duankebo at huawei.com  Mon Apr 27 03:58:01 2015
From: duankebo at huawei.com (Duankebo (Frank))
Date: Mon, 27 Apr 2015 10:58:01 +0000
Subject: [ovs-discuss] can't match vlan packet in OVS
Message-ID: <D7E5E3A5A61527479B3F85C3FB29614D89179C8E@SZXEMA504-MBX.china.huawei.com>

Hi guys:

    I have a VM(virtual machine) connected to an OVS vSwitch through a port. I set the port's vlan tag(1 in the following example). So when VM send out a packet, vSwitch will 
attach a vlan tag(vlan id = 1) to the packet. But It seems the vlan tag is attached only when the packet is sent out by vSwitch to physical network. 
	I want to add some openflow entries to OVS, which need to match packet by what network it come from, I use dl_vlan to mach in the openflow entries, 
Unfortunately, the match doesn't work, because the vlan tag has not be attached yet. Are there some other ways to match a specific vlan packet in the vSwitch?

	Thank you!



_uuid               : 0a356b09-b95d-4e02-9119-7e91f2066744
bond_downdelay      : 0
bond_fake_iface     : false
bond_mode           : []
bond_updelay        : 0
external_ids        : {}
fake_bridge         : false
interfaces          : [bbe064a5-1bc9-40c5-9cd1-c890088f8163]
name                : "qvo748e5b58-7b"
tag                 : 1
trunks              : []
vlan_mode           : []

From blp at nicira.com  Mon Apr 27 10:15:45 2015
From: blp at nicira.com (Ben Pfaff)
Date: Mon, 27 Apr 2015 10:15:45 -0700
Subject: [ovs-discuss] can't match vlan packet in OVS
In-Reply-To: <D7E5E3A5A61527479B3F85C3FB29614D89179C8E@SZXEMA504-MBX.china.huawei.com>
References: <D7E5E3A5A61527479B3F85C3FB29614D89179C8E@SZXEMA504-MBX.china.huawei.com>
Message-ID: <20150427171545.GA29666@nicira.com>

On Mon, Apr 27, 2015 at 10:58:01AM +0000, Duankebo (Frank) wrote:
>     I have a VM(virtual machine) connected to an OVS vSwitch through a port. I set the port's vlan tag(1 in the following example). So when VM send out a packet, vSwitch will 
> attach a vlan tag(vlan id = 1) to the packet. But It seems the vlan tag is attached only when the packet is sent out by vSwitch to physical network. 
> 	I want to add some openflow entries to OVS, which need to match packet by what network it come from, I use dl_vlan to mach in the openflow entries, 
> Unfortunately, the match doesn't work, because the vlan tag has not be attached yet. Are there some other ways to match a specific vlan packet in the vSwitch?

You can match on the input port (in_port).

From blp at nicira.com  Mon Apr 27 10:19:09 2015
From: blp at nicira.com (Ben Pfaff)
Date: Mon, 27 Apr 2015 10:19:09 -0700
Subject: [ovs-discuss] Configuring OVS on GENI
In-Reply-To: <DD12C072DE0EAE4FAA1E95CC1D4BED1D3974CFDB84@EXSERVER5.cougarnet.uh.edu>
References: <DD12C072DE0EAE4FAA1E95CC1D4BED1D3974CFDB84@EXSERVER5.cougarnet.uh.edu>
Message-ID: <20150427171909.GC29666@nicira.com>

On Sat, Apr 25, 2015 at 09:44:47PM -0500, Palagummi, Mydhili wrote:
> We have a question related to configuring OVS.
> 
> We built a topology in GENI using two OVS nodes and three Linux machines.(switches connected to each other, two nodes connected to switch1 and 1 node connected to switch2). We configured OVS in both switches as per the below tutorial.
> 
> http://geni-app-developer-documentation.readthedocs.org/en/latest/examples/example-3.html (this tutorial is for a single switch. We repeated the same for the second switch)
> 
> But we are not able to ping node3 from node1. Could you please let us know if we are doing something wrong?

One problem I see is that you have two different machines running OVS
that are trying to use "patch" ports to connect to each other.  "patch"
ports only work within a single host.

From mir_ali at outlook.com  Mon Apr 27 11:05:09 2015
From: mir_ali at outlook.com (Mir Ali)
Date: Mon, 27 Apr 2015 11:05:09 -0700
Subject: [ovs-discuss] Using the Python IDL library issues
In-Reply-To: <20150427152738.GH2783@nicira.com>
References: <BAY176-W31A629EA858090F03813CA91EA0@phx.gbl>,
 <20150427152738.GH2783@nicira.com>
Message-ID: <BAY176-W35B6CE5FB182FCDEA0A8E891E90@phx.gbl>

Realized I wasn't running the script as root. Ran the same using sudo and it worked. :-)

Thanks

> Date: Mon, 27 Apr 2015 08:27:38 -0700
> From: blp at nicira.com
> To: mir_ali at outlook.com
> CC: discuss at openvswitch.org
> Subject: Re: [ovs-discuss] Using the Python IDL library issues
> 
> On Sun, Apr 26, 2015 at 12:36:52PM -0700, Mir Ali wrote:
> > I was hoping idl to load the database on the first idl.run() call but
> > it doesn't seem like it is. The tables are always empty although the
> > current set up is as shown below
> 
> It wouldn't normally be on the first idl.run() call, you have to wait
> for the sequence number to change.
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150427/98dc8b08/attachment.html>

From mir_ali at outlook.com  Mon Apr 27 11:07:52 2015
From: mir_ali at outlook.com (Mir Ali)
Date: Mon, 27 Apr 2015 11:07:52 -0700
Subject: [ovs-discuss] ovsdb error
In-Reply-To: <CAHbON5q66uGjw5qAHJpZgfMqLwL6A0M+JRSKEHdeL9eiwJV34w@mail.gmail.com>
References: <CAN2QyzYw4y25CSO5tCZSBxwe2iGNCqBBYfw0X=RW+5hL_XNAYw@mail.gmail.com>,
 <CAHbON5o-2uu=t2cVaiebuDXzuqZQE_KAoy6T89SiknZfu92oUA@mail.gmail.com>,
 <CAN2Qyzb+o5AtwnrSySLymXuyFRDuOq_fa78nbbnOkhOmaNkPxg@mail.gmail.com>,
 <CAHbON5q66uGjw5qAHJpZgfMqLwL6A0M+JRSKEHdeL9eiwJV34w@mail.gmail.com>
Message-ID: <BAY176-W519BC658A74120BA843F5A91E90@phx.gbl>

Most likely the openvswitch.ko module is not loaded. Load it again, restart all services and try again.

> Date: Mon, 27 Apr 2015 07:09:52 -0700
> From: shettyg at nicira.com
> To: cvinllen at gmail.com; discuss at openvswitch.org
> Subject: Re: [ovs-discuss] ovsdb error
> 
> Stop your daemons, delete your database file and re-create it and see
> if that helps.
> 
> On Mon, Apr 27, 2015 at 7:07 AM, Vinllen Chen <cvinllen at gmail.com> wrote:
> > Hi, Dear Gurucharan:
> >     Thankyou for your reply. But i didn't have upgrade the vswitchd daemon
> > before. I install the ovs through source code, there is no commad "ovs-ctl"
> > in my computer.
> >
> > On Mon, Apr 27, 2015 at 9:53 PM, Gurucharan Shetty <shettyg at nicira.com>
> > wrote:
> >>
> >> On Mon, Apr 27, 2015 at 4:49 AM, Vinllen Chen <cvinllen at gmail.com> wrote:
> >> > Hi, Dear all:
> >> >     My ovs was ok before, but recently, my ovs got an error when i
> >> > add-port
> >> > in bridge:
> >> > ovs-vsctl add-br br0
> >> > ovs-vsctl add-port br0 port0
> >> > ovs-vsctl: Error detected while setting up 'port0'.  See ovs-vswitchd
> >> > log
> >> > for details.
> >> It looks to me that you upgraded the Open vSwitch daemons but did not
> >> upgrade the database file.
> >> Usually a user does not have to worry about it, if they install OVS
> >> via packages like rpm, debian etc. Does 'ovs-ctl stop' and 'ovs-ctl
> >> start' help?
> >
> >
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150427/754202d4/attachment-0001.html>

From gustavomiotto at gmail.com  Mon Apr 27 11:17:14 2015
From: gustavomiotto at gmail.com (Gustavo Miotto)
Date: Mon, 27 Apr 2015 15:17:14 -0300
Subject: [ovs-discuss]  In-band control
Message-ID: <CAC0zTB_ABOS5Znbk6KjTm_Q=Z=kgwuRdc2ufde=m5QEKprrt3w@mail.gmail.com>

Hello,
 I instantiate a topology on mininet where my controllers are Docker
containers and the switches are configured with inband control. However
when the topology starts and the controllers initiates the connection the
computer uses 100% of all CPU cores and the computer hangs. After a lot of
iterations, changing controllers or without controllers (I tried to ping
from a controller to the switch -- and the switch hangs the computer in the
same way) I guess that the problem is with the switch itself. Does someone
have an idea and can help me?
Any help will be appreciated.

Thanks in advance.

Att,
 Gustavo Miotto
 Master Degree Student in Computer Networks
 UFRGS - Brazil
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150427/54972ac6/attachment.html>

From gowrishankar.m at linux.vnet.ibm.com  Mon Apr 27 11:34:36 2015
From: gowrishankar.m at linux.vnet.ibm.com (gowrishankar)
Date: Tue, 28 Apr 2015 00:04:36 +0530
Subject: [ovs-discuss] Subsequent packets get lost
In-Reply-To: <89E1C5E3-CCE2-4C4E-8857-D02CA3FE736C@yahoo.com>
References: <CCBAB4A4-3F55-4D3C-9B70-C2661B1B4F1A@yahoo.com>
 <553E1681.1010201@linux.vnet.ibm.com>
 <89E1C5E3-CCE2-4C4E-8857-D02CA3FE736C@yahoo.com>
Message-ID: <553E813C.80502@linux.vnet.ibm.com>

On Monday 27 April 2015 07:56 PM, Pyotr Bryzgalov wrote:
> Thank you Gowrishankar,
>
> I had MTU 1500. I set tap interfaces’ MTU to 1462 and it worked for 
> GRE tunnel!
> Unfortunately, setting MTU to 1458 (1500 - 14 - 20 - 8)  does’t work 
> for VXLAN. (8 bytes is vxlan header size)
>

In case of GRE:
outer ip header - 20 bytes
gre header  - 4 bytes
inner eth frame - (14+1500) bytes (no vlan tagging)

In case of VxLAN:
outer ip header - 20 bytes
outer udp header - 8 bytes
vxlan header  - 8 bytes
inner eth frame - (14+1500) bytes (no vlan tagging)

So, 1500-50=1450. If you use vlan inside containers, outer ethernet mtu 
then has to be 1446 bytes.

Thx,
Gowrishankar

> Regards,
> Peter
>
>> On 27Apr, 2015, at 19:59, gowrishankar 
>> <gowrishankar.m at linux.vnet.ibm.com 
>> <mailto:gowrishankar.m at linux.vnet.ibm.com>> wrote:
>>
>> On Monday 27 April 2015 04:03 PM, Peter Bryzgalov wrote:
>>> Hi,
>>>
>>> I have connected two Docker containers on two hosts through an OVS 
>>> tunnel (tested GRE and VXLAN). I can ping and even login with ssh 
>>> from one container to another through the tunnel, but I cannot use 
>>> scp, iperf, etc., because for streams only the first packet reaches 
>>> destination and all subsequent packets get lost.
>>>
>>
>> Make sure you have configured right MTU (1462) for docker bridge and 
>> container interfaces.
>>
>> Hope this one http://wiredcraft.com/blog/multi-host-docker-network/ 
>> helps you.
>>
>> Thx,
>> Gowrishankar
>>
>>> For both servers:
>>>
>>> OS: Ubuntu 12.04
>>> Kernel: 3.13.0-49-generic
>>>
>>> OVS version:
>>> ovs-vsctl (Open vSwitch) 2.3.1
>>> Compiled Apr 24 2015 19:17:31
>>> DB Schema 7.6.2
>>>
>>> ovs-vsctl show (on 172.19.5.5 server):
>>>     Bridge ovs-bridge
>>>         Port "tap10654"
>>>             Interface "tap10654"
>>>                 type: internal
>>>         Port ovs_gre
>>>             Interface ovs_gre
>>>                 type: gre
>>>                 options: {remote_ip="172.19.5.12"}
>>>         Port ovs-bridge
>>>             Interface ovs-bridge
>>>                 type: internal
>>>
>>> Tap interface is moved inside a Docker container namespace and 
>>> assigned an IP address (10.0.0.5 on one server and 10.0.0.6 on 
>>> another).
>>>
>>> I did tcpdump for perf session (fragment):
>>> this packet passed:
>>> 16:29:49.454168 IP 172.19.5.5 > 172.19.5.12: GREv0, length 94: IP 
>>> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [P.], seq 1:25, ack 1, win 
>>> 229, options [nop,nop,TS val 62341003 ecr 212259725], length 24
>>> these packets lost:
>>> 16:29:49.454238 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 
>>> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 25:1473, ack 1, win 
>>> 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>>> 16:29:49.454246 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 
>>> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 1473:2921, ack 1, win 
>>> 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>>> 16:29:49.454248 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 
>>> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 2921:4369, ack 1, win 
>>> 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>>> 16:29:49.454250 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 
>>> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 4369:5817, ack 1, win 
>>> 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>>> 16:29:49.454253 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 
>>> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 5817:7265, ack 1, win 
>>> 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>>> 16:29:49.454255 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 
>>> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 7265:8713, ack 1, win 
>>> 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>>> 16:29:49.454257 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 
>>> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 8713:10161, ack 1, 
>>> win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>>> 16:29:49.454259 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 
>>> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 10161:11609, ack 1, 
>>> win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>>> 16:29:49.454264 IP 172.19.5.5 > 172.19.5.12: GREv0, length 1518: IP 
>>> 10.0.0.5.39330 > 10.0.0.6.5001: Flags [.], seq 11609:13057, ack 1, 
>>> win 229, options [nop,nop,TS val 62341003 ecr 212259725], length 1448
>>>
>>>
>>> Regards,
>>> Peter
>>>
>>>
>>> _______________________________________________
>>> discuss mailing list
>>> discuss at openvswitch.org
>>> http://openvswitch.org/mailman/listinfo/discuss
>>
>>
>> -- 
>> Regards,
>> Gowrishankar M
>> Linux Networking
>
>
>
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss


-- 
Regards,
Gowrishankar M
Linux Networking

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150428/fa10cc64/attachment-0001.html>

From kprad1 at yahoo.com  Mon Apr 27 12:44:10 2015
From: kprad1 at yahoo.com (Padmanabhan Krishnan)
Date: Mon, 27 Apr 2015 19:44:10 +0000 (UTC)
Subject: [ovs-discuss] Question on tunnel interfaces
In-Reply-To: <20150427153817.GJ2783@nicira.com>
References: <1036089648.4063399.1429942374890.JavaMail.yahoo@mail.yahoo.com>
 <20150427153817.GJ2783@nicira.com>
Message-ID: <836732685.5457708.1430163850984.JavaMail.yahoo@mail.yahoo.com>

Thanks a lot Ben and Jesse.

Just wanted to clarify, from your statements:

“OVS simply hands the packet over to the kernel IP stack.”

"After encapsulation, OVS turns the packet over to the kernel TCP/IP
Stack"

Is the above (handling the frame to kernel to do the routing) a special functionality of the tunnel bridge/port?

For example, if a VM connected to a regular OVS bridge (br-int) sends a frame destined to a 173.x.. subnet (attached to eth2), i assume OVS will bridge the frame and not hand it over to the kernel, right? 

More information below:

Lab-135:~/devstack/devstack$ sudo ovs-dpctl --version
ovs-dpctl (Open vSwitch) 2.0.2
Compiled Aug 15 2014 14:31:02

Lab-135:~/devstack/devstack$ sudo ovs-vsctl show
78e151e6-ca8b-4338-8b62-a0fee0c1c24f
    Bridge br-tun
        Port br-tun
            Interface br-tun
                type: internal
        Port "vxlan-ad24f10f"
            Interface "vxlan-ad24f10f"
                type: vxlan
                options: {df_default="true", in_key=flow, local_ip="173.36.241.17", out_key=flow, remote_ip="173.36.241.15"}
        Port patch-int
            Interface patch-int
                type: patch
                options: {peer=patch-tun}


Lab-135:~/devstack/devstack$ sudo ovs-dpctl show
system at ovs-system:
        lookups: hit:188973 missed:16649 lost:0
        flows: 4
        port 0: ovs-system (internal)
        port 1: br-int (internal)
        port 2: br-tun (internal)
        port 3: br-ethd (internal)
        port 4: vxlan_sys_4789 (vxlan: df_default=false, ttl=0)
        port 5: qvoaeac2bb5-70

Ben, you asked for the above output. Even, with a "-m" it returned only the above.


Lab-135:~/devstack/devstack$ sudo ovs-dpctl dump-flows
skb_priority(0),in_port(5),eth(src=fa:16:3e:04:30:4e,dst=fa:16:3e:d6:37:1f),eth_type(0x0800),ipv4(src=44.50.12.4/0.0.0.0,dst=44.50.12.2/0.0.0.0,proto=1/0,tos=0/0x3,ttl=64/0,frag=no/0xff), packets:257, bytes:25186, used:0.972s, actions:set(tunnel(tun_id=0x3eb,src=173.36.241.17,dst=173.36.241.15,tos=0x0,ttl=64,flags(df,key))),4
skb_priority(0),tunnel(tun_id=0x3eb,src=173.36.241.15,dst=173.36.241.17,tos=0x0,ttl=64,flags(key)),in_port(4),skb_mark(0),eth(src=fa:16:3e:d6:37:1f,dst=fa:16:3e:04:30:4e),eth_type(0x0800),ipv4(src=44.50.12.2/0.0.0.0,dst=44.50.12.4/0.0.0.0,proto=1/0,tos=0/0,ttl=64/0,frag=no/0xff), packets:258, bytes:25284, used:0.968s, actions:5

 Thanks,Padmanabhan


     On Monday, April 27, 2015 8:38 AM, Ben Pfaff <blp at nicira.com> wrote:
   

 On Sat, Apr 25, 2015 at 06:12:54AM +0000, Padmanabhan Krishnan wrote:
> Hello,My question is related to the sending (encap) side of the OVS tunnel bridge.
> After the tunnel bridge (say br-tun) does the encapsulation (VXLAN or GRE), i assume it uses the host routing table to route the packet. So, when a frame is received by the br-tun from an in_port, after performing the necessary encapsulation does OVS send it over to kernel routing module to forward the frame on the right interface (routing)?
> In my example below, the end point 173 subnet is attached to say, eth2. The physical port 'eth2' is _not_ connected to OVS bridge 'br-tun'. But, depending on the 'remote_ip', the frame gets forwarded to the right interface.
> I will be obliged, if someone can explain, in terms of flow, as how forwarding happens after the frame gets encapsulated (br-tun)? Does routing of the frame fall under the scope of OVS?Is it a special functionality of the 'set_tunnel' action?

After encapsulation, OVS turns the packet over to the kernel TCP/IP
stack, which routes it appropriately.  OVS doesn't have control over how
exactly that happens, other than by controlling addressing.

The set_tunnel action just sets the tunnel key (e.g. in GRE the GRE key,
in VXLAN the VNI).

> Dumping the flow on br-tun using ofctl, i assume the below line is responsible for the encap:"
>  cookie=0x0, duration=14723.832s, table=22, n_packets=22, n_bytes=1826, idle_age=14704, dl_vlan=1 actions=strip_vlan,set_tunnel:0x3eb,output:2
> "
> Port 2 is vxlan-ad24f10f below.

I'd expect to see more information than just the tunnel key.  Check the
"ovs-dpctl show" output for port 2.


  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150427/68ba8e1d/attachment.html>

From davidjoshuaevans at gmail.com  Mon Apr 27 13:01:16 2015
From: davidjoshuaevans at gmail.com (David Evans)
Date: Mon, 27 Apr 2015 15:01:16 -0500
Subject: [ovs-discuss] How does OpenFlow protocol action become flow table
	entry?
Message-ID: <D163FFBC.27B25%davidjoshuaevans@gmail.com>

Hi all, (Ben particularly)

I have been trolling through the source looking for  how OXM/NXM actions end
up as functioning entries in flow tables.
I understand that ofp-actions.c and the ofp_raw_action_type enumeration is
at the centre of it all.
I get how the incoming OpenFlow command strings are processed  by
encode/decode fns but that¹s about it
But I don¹t understand the path of adding these actions

I want to use the ActionExperimenter from RYU to drive new arbitrary packet
modifiers via the experimenter extension to open flow.
I know I could use ovs-ofctl and actions.c  and add new instructions that
way, but I want to stick to OpenFlow so I can drive with other controllers
like Ryu.




Regards,
Dave.


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150427/b876db34/attachment.html>

From jesse at nicira.com  Mon Apr 27 13:10:53 2015
From: jesse at nicira.com (Jesse Gross)
Date: Mon, 27 Apr 2015 13:10:53 -0700
Subject: [ovs-discuss] Question on tunnel interfaces
In-Reply-To: <836732685.5457708.1430163850984.JavaMail.yahoo@mail.yahoo.com>
References: <1036089648.4063399.1429942374890.JavaMail.yahoo@mail.yahoo.com>
 <20150427153817.GJ2783@nicira.com>
 <836732685.5457708.1430163850984.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <CAEP_g=_udrj1LwS835+k2Yy1UhaDWbS6WR7DNuCwN1FhkKNP_Q@mail.gmail.com>

On Mon, Apr 27, 2015 at 12:44 PM, Padmanabhan Krishnan <kprad1 at yahoo.com> wrote:
> Thanks a lot Ben and Jesse.
>
> Just wanted to clarify, from your statements:
>
> “OVS simply hands the packet over to the kernel IP stack.”
>
> "After encapsulation, OVS turns the packet over to the kernel TCP/IP
> Stack"
>
> Is the above (handling the frame to kernel to do the routing) a special
> functionality of the tunnel bridge/port?
>
> For example, if a VM connected to a regular OVS bridge (br-int) sends a
> frame destined to a 173.x.. subnet (attached to eth2), i assume OVS will
> bridge the frame and not hand it over to the kernel, right?

Yes, this is specific to tunnel ports because outputting to a tunnel
implies the use of the IP stack. There is no implicit routing for
other types of devices.

From blp at nicira.com  Mon Apr 27 13:18:38 2015
From: blp at nicira.com (Ben Pfaff)
Date: Mon, 27 Apr 2015 13:18:38 -0700
Subject: [ovs-discuss] How does OpenFlow protocol action become flow
 table entry?
In-Reply-To: <D163FFBC.27B25%davidjoshuaevans@gmail.com>
References: <D163FFBC.27B25%davidjoshuaevans@gmail.com>
Message-ID: <20150427201838.GA22567@nicira.com>

On Mon, Apr 27, 2015 at 03:01:16PM -0500, David Evans wrote:
> I have been trolling through the source looking for  how OXM/NXM actions end
> up as functioning entries in flow tables.
> I understand that ofp-actions.c and the ofp_raw_action_type enumeration is
> at the centre of it all.
> I get how the incoming OpenFlow command strings are processed  by
> encode/decode fns but that?s about it?
> But I don?t understand the path of adding these actions
> 
> I want to use the ActionExperimenter from RYU to drive new arbitrary packet
> modifiers via the experimenter extension to open flow.
> I know I could use ovs-ofctl and actions.c  and add new instructions that
> way, but I want to stick to OpenFlow so I can drive with other controllers
> like Ryu.

Did you read the FAQ?

### Q: How do I add support for a new OpenFlow action?

A: Add your new action to "enum ofp_raw_action_type" in
   lib/ofp-actions.c, following the existing pattern.  Then recompile
   and fix all of the new warnings, implementing new functionality for
   the new action as needed.  (If you configure with --enable-Werror,
   as described in [INSTALL.md], then it is impossible to miss any
   warnings.)

   If you need to add an OpenFlow vendor extension action for a vendor
   that doesn't yet have any extension actions, then you will also
   need to edit build-aux/extract-ofp-actions.

From davidjoshuaevans at gmail.com  Mon Apr 27 13:50:13 2015
From: davidjoshuaevans at gmail.com (David Evans)
Date: Mon, 27 Apr 2015 15:50:13 -0500
Subject: [ovs-discuss] How does OpenFlow protocol action become flow
 table entry?
In-Reply-To: <20150427201838.GA22567@nicira.com>
References: <D163FFBC.27B25%davidjoshuaevans@gmail.com>
 <20150427201838.GA22567@nicira.com>
Message-ID: <D1640534.27B2E%davidjoshuaevans@gmail.com>

Thanks Ben 
Yes.
And I have that side of it written, but which part pushes the action into
the tables for a bridge?
How is it dispatched when ovs is running?


Regards,
Dave.

On 4/27/15, 3:18 PM, "Ben Pfaff" <blp at nicira.com> wrote:

>On Mon, Apr 27, 2015 at 03:01:16PM -0500, David Evans wrote:
>> I have been trolling through the source looking for  how OXM/NXM
>>actions end
>> up as functioning entries in flow tables.
>> I understand that ofp-actions.c and the ofp_raw_action_type enumeration
>>is
>> at the centre of it all.
>> I get how the incoming OpenFlow command strings are processed  by
>> encode/decode fns but that?s about it?
>> But I don?t understand the path of adding these actions
>> 
>> I want to use the ActionExperimenter from RYU to drive new arbitrary
>>packet
>> modifiers via the experimenter extension to open flow.
>> I know I could use ovs-ofctl and actions.c  and add new instructions
>>that
>> way, but I want to stick to OpenFlow so I can drive with other
>>controllers
>> like Ryu.
>
>Did you read the FAQ?
>
>### Q: How do I add support for a new OpenFlow action?
>
>A: Add your new action to "enum ofp_raw_action_type" in
>   lib/ofp-actions.c, following the existing pattern.  Then recompile
>   and fix all of the new warnings, implementing new functionality for
>   the new action as needed.  (If you configure with --enable-Werror,
>   as described in [INSTALL.md], then it is impossible to miss any
>   warnings.)
>
>   If you need to add an OpenFlow vendor extension action for a vendor
>   that doesn't yet have any extension actions, then you will also
>   need to edit build-aux/extract-ofp-actions.



From blp at nicira.com  Mon Apr 27 13:52:37 2015
From: blp at nicira.com (Ben Pfaff)
Date: Mon, 27 Apr 2015 13:52:37 -0700
Subject: [ovs-discuss] How does OpenFlow protocol action become flow
 table entry?
In-Reply-To: <D1640534.27B2E%davidjoshuaevans@gmail.com>
References: <D163FFBC.27B25%davidjoshuaevans@gmail.com>
 <20150427201838.GA22567@nicira.com>
 <D1640534.27B2E%davidjoshuaevans@gmail.com>
Message-ID: <20150427205237.GD22567@nicira.com>

Do you mean, where is the code that actually performs the action?
Usually that's in ofproto/ofproto-dpif-xlate.c, as part of action
translation.

On Mon, Apr 27, 2015 at 03:50:13PM -0500, David Evans wrote:
> Thanks Ben 
> Yes.
> And I have that side of it written, but which part pushes the action into
> the tables for a bridge?
> How is it dispatched when ovs is running?
> 
> 
> Regards,
> Dave.
> 
> On 4/27/15, 3:18 PM, "Ben Pfaff" <blp at nicira.com> wrote:
> 
> >On Mon, Apr 27, 2015 at 03:01:16PM -0500, David Evans wrote:
> >> I have been trolling through the source looking for  how OXM/NXM
> >>actions end
> >> up as functioning entries in flow tables.
> >> I understand that ofp-actions.c and the ofp_raw_action_type enumeration
> >>is
> >> at the centre of it all.
> >> I get how the incoming OpenFlow command strings are processed  by
> >> encode/decode fns but that?s about it?
> >> But I don?t understand the path of adding these actions
> >> 
> >> I want to use the ActionExperimenter from RYU to drive new arbitrary
> >>packet
> >> modifiers via the experimenter extension to open flow.
> >> I know I could use ovs-ofctl and actions.c  and add new instructions
> >>that
> >> way, but I want to stick to OpenFlow so I can drive with other
> >>controllers
> >> like Ryu.
> >
> >Did you read the FAQ?
> >
> >### Q: How do I add support for a new OpenFlow action?
> >
> >A: Add your new action to "enum ofp_raw_action_type" in
> >   lib/ofp-actions.c, following the existing pattern.  Then recompile
> >   and fix all of the new warnings, implementing new functionality for
> >   the new action as needed.  (If you configure with --enable-Werror,
> >   as described in [INSTALL.md], then it is impossible to miss any
> >   warnings.)
> >
> >   If you need to add an OpenFlow vendor extension action for a vendor
> >   that doesn't yet have any extension actions, then you will also
> >   need to edit build-aux/extract-ofp-actions.
> 
> 

From peterbryz at yahoo.com  Mon Apr 27 19:49:24 2015
From: peterbryz at yahoo.com (Peter Bryzgalov)
Date: Tue, 28 Apr 2015 11:49:24 +0900
Subject: [ovs-discuss] Subsequent packets get lost
In-Reply-To: <553E813C.80502@linux.vnet.ibm.com>
References: <CCBAB4A4-3F55-4D3C-9B70-C2661B1B4F1A@yahoo.com>
 <553E1681.1010201@linux.vnet.ibm.com>
 <89E1C5E3-CCE2-4C4E-8857-D02CA3FE736C@yahoo.com>
 <553E813C.80502@linux.vnet.ibm.com>
Message-ID: <DACA6FA5-3F4D-4BCC-8B7F-CCE999F5AE98@yahoo.com>

Hi, 

Thank you, Gowrishankar!
MTU 1450 perfectly worked for vxlan!

Regards,
Peter


From zhouhan at gmail.com  Mon Apr 27 23:05:19 2015
From: zhouhan at gmail.com (Han Zhou)
Date: Tue, 28 Apr 2015 14:05:19 +0800
Subject: [ovs-discuss] ovs-docker: why need to use veth pair instead of
	internal port?
Message-ID: <CADtzDC=BUjAgPThRjQwHKg+Ff-15vLnRa98dtiH+MnBmhq4PpA@mail.gmail.com>

Hello everyone,

I have a question about the ovs-docker utility. Why can't internal
port work for docker case? For native support, does it mean we need a
new port type?

Best regards,
Han

From shanmugam.s at bizruntime.com  Mon Apr 27 23:13:18 2015
From: shanmugam.s at bizruntime.com (Shanmugam Sundaram)
Date: Tue, 28 Apr 2015 11:43:18 +0530
Subject: [ovs-discuss] ovs-docker: why need to use veth pair instead of
 internal port?
In-Reply-To: <CADtzDC=BUjAgPThRjQwHKg+Ff-15vLnRa98dtiH+MnBmhq4PpA@mail.gmail.com>
References: <CADtzDC=BUjAgPThRjQwHKg+Ff-15vLnRa98dtiH+MnBmhq4PpA@mail.gmail.com>
Message-ID: <CANb-gXSKJwxxubXf1Z77O1vx834u+Wzo2sB=xwreNdmuNmEs8Q@mail.gmail.com>

Hi Han,

Dockers uses NameSpaces for isolation, to connect between network
namespaces, we have to go with veth pairs.

regards,
Shan

On Tue, Apr 28, 2015 at 11:35 AM, Han Zhou <zhouhan at gmail.com> wrote:

> Hello everyone,
>
> I have a question about the ovs-docker utility. Why can't internal
> port work for docker case? For native support, does it mean we need a
> new port type?
>
> Best regards,
> Han
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss
>



-- 
regards,
*Shan*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150428/4e3657c7/attachment-0001.html>

From zhouhan at gmail.com  Mon Apr 27 23:19:25 2015
From: zhouhan at gmail.com (Han Zhou)
Date: Tue, 28 Apr 2015 14:19:25 +0800
Subject: [ovs-discuss] ovs-docker: why need to use veth pair instead of
 internal port?
In-Reply-To: <CANb-gXSKJwxxubXf1Z77O1vx834u+Wzo2sB=xwreNdmuNmEs8Q@mail.gmail.com>
References: <CADtzDC=BUjAgPThRjQwHKg+Ff-15vLnRa98dtiH+MnBmhq4PpA@mail.gmail.com>
 <CANb-gXSKJwxxubXf1Z77O1vx834u+Wzo2sB=xwreNdmuNmEs8Q@mail.gmail.com>
Message-ID: <CADtzDC=v1_tOGpE3ZNCUpjAc=cCvU31354WZ8uURxJEHP__a4w@mail.gmail.com>

Hi Shan,

Thanks, but why can't we just add an internal port to OVS bridge and
put into namespace?
And what's the native support mentioned in INSTALL.docker.md?

Best regards,
Han

On Tue, Apr 28, 2015 at 2:13 PM, Shanmugam Sundaram
<shanmugam.s at bizruntime.com> wrote:
> Hi Han,
>
> Dockers uses NameSpaces for isolation, to connect between network
> namespaces, we have to go with veth pairs.
>
> regards,
> Shan
>
> On Tue, Apr 28, 2015 at 11:35 AM, Han Zhou <zhouhan at gmail.com> wrote:
>>
>> Hello everyone,
>>
>> I have a question about the ovs-docker utility. Why can't internal
>> port work for docker case? For native support, does it mean we need a
>> new port type?
>>
>> Best regards,
>> Han
>> _______________________________________________
>> discuss mailing list
>> discuss at openvswitch.org
>> http://openvswitch.org/mailman/listinfo/discuss
>
>
>
>
> --
> regards,
> Shan

From shanmugam.s at bizruntime.com  Tue Apr 28 00:00:51 2015
From: shanmugam.s at bizruntime.com (Shanmugam Sundaram)
Date: Tue, 28 Apr 2015 12:30:51 +0530
Subject: [ovs-discuss] ovs-docker: why need to use veth pair instead of
 internal port?
In-Reply-To: <CADtzDC=v1_tOGpE3ZNCUpjAc=cCvU31354WZ8uURxJEHP__a4w@mail.gmail.com>
References: <CADtzDC=BUjAgPThRjQwHKg+Ff-15vLnRa98dtiH+MnBmhq4PpA@mail.gmail.com>
 <CANb-gXSKJwxxubXf1Z77O1vx834u+Wzo2sB=xwreNdmuNmEs8Q@mail.gmail.com>
 <CADtzDC=v1_tOGpE3ZNCUpjAc=cCvU31354WZ8uURxJEHP__a4w@mail.gmail.com>
Message-ID: <CANb-gXQmx95w_vo_6shobiLtieNe7KJrNhnr0GeWpoZx54ASdQ@mail.gmail.com>

On Tue, Apr 28, 2015 at 11:49 AM, Han Zhou <zhouhan at gmail.com> wrote:

> Hi Shan,
>
> Thanks, but why can't we just add an internal port to OVS bridge and
> put into namespace?
>

Internal port is  single port that is connects to hosts IP stack.
veth pair, come with pair of ports, like a pipe, one end in one namespace
(your host) and another end in docker containers namespace.

So, packets send at one end is received at another end .


> And what's the native support mentioned in INSTALL.docker.md?
>

Docker uses linux bridges natively i.e., when you launch a container, it
creates its own veth pair, and sets up IP etc. It also removes the veth
pair, etc when a docker container is deleted.

Docker does not have a native support for Open vSwitch Bridges. i.e., you
have to manually add Docker in OVS Bridge and remove the veth pair, when
the docker is deleted.

AFAIK, Native integration of Docker with Open vSwitch, is on the road-map.


>
> Best regards,
> Han
>
> On Tue, Apr 28, 2015 at 2:13 PM, Shanmugam Sundaram
> <shanmugam.s at bizruntime.com> wrote:
> > Hi Han,
> >
> > Dockers uses NameSpaces for isolation, to connect between network
> > namespaces, we have to go with veth pairs.
> >
> > regards,
> > Shan
> >
> > On Tue, Apr 28, 2015 at 11:35 AM, Han Zhou <zhouhan at gmail.com> wrote:
> >>
> >> Hello everyone,
> >>
> >> I have a question about the ovs-docker utility. Why can't internal
> >> port work for docker case? For native support, does it mean we need a
> >> new port type?
> >>
> >> Best regards,
> >> Han
> >> _______________________________________________
> >> discuss mailing list
> >> discuss at openvswitch.org
> >> http://openvswitch.org/mailman/listinfo/discuss
> >
> >
> >
> >
> > --
> > regards,
> > Shan
>



-- 
regards,
*Shan*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150428/1c7ac32a/attachment.html>

From zhouhan at gmail.com  Tue Apr 28 00:57:25 2015
From: zhouhan at gmail.com (Han Zhou)
Date: Tue, 28 Apr 2015 15:57:25 +0800
Subject: [ovs-discuss] ovs-docker: why need to use veth pair instead of
 internal port?
In-Reply-To: <CANb-gXQmx95w_vo_6shobiLtieNe7KJrNhnr0GeWpoZx54ASdQ@mail.gmail.com>
References: <CADtzDC=BUjAgPThRjQwHKg+Ff-15vLnRa98dtiH+MnBmhq4PpA@mail.gmail.com>
 <CANb-gXSKJwxxubXf1Z77O1vx834u+Wzo2sB=xwreNdmuNmEs8Q@mail.gmail.com>
 <CADtzDC=v1_tOGpE3ZNCUpjAc=cCvU31354WZ8uURxJEHP__a4w@mail.gmail.com>
 <CANb-gXQmx95w_vo_6shobiLtieNe7KJrNhnr0GeWpoZx54ASdQ@mail.gmail.com>
Message-ID: <CADtzDCmjEM5Yr3iK=Z_N4Z=zUw=mmDB1RqQ0dmfka_w7KB1TVw@mail.gmail.com>

Hi,

On Tue, Apr 28, 2015 at 3:00 PM, Shanmugam Sundaram
<shanmugam.s at bizruntime.com> wrote:
> On Tue, Apr 28, 2015 at 11:49 AM, Han Zhou <zhouhan at gmail.com> wrote:
>>
>> Hi Shan,
>>
>> Thanks, but why can't we just add an internal port to OVS bridge and
>> put into namespace?
>
>
> Internal port is  single port that is connects to hosts IP stack.
> veth pair, come with pair of ports, like a pipe, one end in one namespace
> (your host) and another end in docker containers namespace.
>
> So, packets send at one end is received at another end .
>

Internal port is widely used in namespaces, e.g. usecase of openstack
neutron dhcp node.
For my understanding, veth pair is required only when using linux
bridge. With OVS, a pair of veth devices can be replaced by a single
internal port, with better performance.

So I am curious what's the limitation for internal ports to be working
with docker.

>>
>> And what's the native support mentioned in INSTALL.docker.md?
>
>
> Docker uses linux bridges natively i.e., when you launch a container, it
> creates its own veth pair, and sets up IP etc. It also removes the veth
> pair, etc when a docker container is deleted.
>
> Docker does not have a native support for Open vSwitch Bridges. i.e., you
> have to manually add Docker in OVS Bridge and remove the veth pair, when the
> docker is deleted.
>
> AFAIK, Native integration of Docker with Open vSwitch, is on the road-map.
>

My question is, what's the key changes required for the "Native" support.

Regards,
Han

>>
>>
>> Best regards,
>> Han
>>
>> On Tue, Apr 28, 2015 at 2:13 PM, Shanmugam Sundaram
>> <shanmugam.s at bizruntime.com> wrote:
>> > Hi Han,
>> >
>> > Dockers uses NameSpaces for isolation, to connect between network
>> > namespaces, we have to go with veth pairs.
>> >
>> > regards,
>> > Shan
>> >
>> > On Tue, Apr 28, 2015 at 11:35 AM, Han Zhou <zhouhan at gmail.com> wrote:
>> >>
>> >> Hello everyone,
>> >>
>> >> I have a question about the ovs-docker utility. Why can't internal
>> >> port work for docker case? For native support, does it mean we need a
>> >> new port type?
>> >>
>> >> Best regards,
>> >> Han
>> >> _______________________________________________
>> >> discuss mailing list
>> >> discuss at openvswitch.org
>> >> http://openvswitch.org/mailman/listinfo/discuss
>> >
>> >
>> >
>> >
>> > --
>> > regards,
>> > Shan
>
>
>
>
> --
> regards,
> Shan

From shettyg at nicira.com  Tue Apr 28 07:06:28 2015
From: shettyg at nicira.com (Gurucharan Shetty)
Date: Tue, 28 Apr 2015 07:06:28 -0700
Subject: [ovs-discuss] ovs-docker: why need to use veth pair instead of
 internal port?
In-Reply-To: <CADtzDC=v1_tOGpE3ZNCUpjAc=cCvU31354WZ8uURxJEHP__a4w@mail.gmail.com>
References: <CADtzDC=BUjAgPThRjQwHKg+Ff-15vLnRa98dtiH+MnBmhq4PpA@mail.gmail.com>
 <CANb-gXSKJwxxubXf1Z77O1vx834u+Wzo2sB=xwreNdmuNmEs8Q@mail.gmail.com>
 <CADtzDC=v1_tOGpE3ZNCUpjAc=cCvU31354WZ8uURxJEHP__a4w@mail.gmail.com>
Message-ID: <CAHbON5pATRCwOEU+Aoms+oWG7zp9X_w3sAetaJ9AaLALSKh59g@mail.gmail.com>

On Mon, Apr 27, 2015 at 11:19 PM, Han Zhou <zhouhan at gmail.com> wrote:
> Hi Shan,
>
> Thanks, but why can't we just add an internal port to OVS bridge and
> put into namespace?
> And what's the native support mentioned in INSTALL.docker.md?
You can do it, and its performance is a lot better. But
1. once a OVS internal port has been moved inside a namespace, the
ovs-vswitchd daemon running in the root namespace can no longer see it
and starts complaining.
2. If you are depending on network counters to figure out how much
packets have gone through etc, it gets confusing.
3. When you upgrade your kernel module, the internal interfaces will
disappear from inside the container, likely causing unexpected
behavior for the applications running inside and you will also need a
mechanism to move them all back in after the interface are re-created.

So to take the easier path, ovs-docker utility does not use OVS
internal interfaces but rather uses veth pairs.


>
> Best regards,
> Han
>
> On Tue, Apr 28, 2015 at 2:13 PM, Shanmugam Sundaram
> <shanmugam.s at bizruntime.com> wrote:
>> Hi Han,
>>
>> Dockers uses NameSpaces for isolation, to connect between network
>> namespaces, we have to go with veth pairs.
>>
>> regards,
>> Shan
>>
>> On Tue, Apr 28, 2015 at 11:35 AM, Han Zhou <zhouhan at gmail.com> wrote:
>>>
>>> Hello everyone,
>>>
>>> I have a question about the ovs-docker utility. Why can't internal
>>> port work for docker case? For native support, does it mean we need a
>>> new port type?
>>>
>>> Best regards,
>>> Han
>>> _______________________________________________
>>> discuss mailing list
>>> discuss at openvswitch.org
>>> http://openvswitch.org/mailman/listinfo/discuss
>>
>>
>>
>>
>> --
>> regards,
>> Shan
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss

From shettyg at nicira.com  Tue Apr 28 07:16:07 2015
From: shettyg at nicira.com (Gurucharan Shetty)
Date: Tue, 28 Apr 2015 07:16:07 -0700
Subject: [ovs-discuss] ovs-docker: why need to use veth pair instead of
 internal port?
In-Reply-To: <CAHbON5pATRCwOEU+Aoms+oWG7zp9X_w3sAetaJ9AaLALSKh59g@mail.gmail.com>
References: <CADtzDC=BUjAgPThRjQwHKg+Ff-15vLnRa98dtiH+MnBmhq4PpA@mail.gmail.com>
 <CANb-gXSKJwxxubXf1Z77O1vx834u+Wzo2sB=xwreNdmuNmEs8Q@mail.gmail.com>
 <CADtzDC=v1_tOGpE3ZNCUpjAc=cCvU31354WZ8uURxJEHP__a4w@mail.gmail.com>
 <CAHbON5pATRCwOEU+Aoms+oWG7zp9X_w3sAetaJ9AaLALSKh59g@mail.gmail.com>
Message-ID: <CAHbON5oSrJW=6b7SOu+jKKLAt7zT9gCPGspBhKWRqyjxGDUcLw@mail.gmail.com>

>> And what's the native support mentioned in INSTALL.docker.md?

When the document was written, there was an attempt made to make
docker daemon OVS aware. There was no interest for that exact work
piece of work from Docker. Instead, Docker is currently working on
Network plugins here: https://github.com/docker/libnetwork. Once that
work matures, there will be a "native" integration in the sense that
you can have your OVS interface inside a container before the
application starts. Does that answer your question?

From mpalagum at Central.UH.EDU  Mon Apr 27 11:49:36 2015
From: mpalagum at Central.UH.EDU (Palagummi, Mydhili)
Date: Mon, 27 Apr 2015 13:49:36 -0500
Subject: [ovs-discuss] Configuring OVS on GENI
In-Reply-To: <20150427171909.GC29666@nicira.com>
References: <DD12C072DE0EAE4FAA1E95CC1D4BED1D3974CFDB84@EXSERVER5.cougarnet.uh.edu>,
 <20150427171909.GC29666@nicira.com>
Message-ID: <DD12C072DE0EAE4FAA1E95CC1D4BED1D3974CFDB86@EXSERVER5.cougarnet.uh.edu>

Hello Ben,

I removed the patch ports. Thanks for that. But I just figured out that I made a rookie mistake. I added a route in the kernel routing table and it works now. 

Thanks for your time.

Best regards,
Mydhili Palagummi
________________________________________
From: Ben Pfaff [blp at nicira.com]
Sent: Monday, April 27, 2015 12:19 PM
To: Palagummi, Mydhili
Cc: discuss at openvswitch.org; smsimon at uh.edu; assingh3 at uh.edu; Shahane, Sachin
Subject: Re: [ovs-discuss] Configuring OVS on GENI

On Sat, Apr 25, 2015 at 09:44:47PM -0500, Palagummi, Mydhili wrote:
> We have a question related to configuring OVS.
>
> We built a topology in GENI using two OVS nodes and three Linux machines.(switches connected to each other, two nodes connected to switch1 and 1 node connected to switch2). We configured OVS in both switches as per the below tutorial.
>
> http://geni-app-developer-documentation.readthedocs.org/en/latest/examples/example-3.html (this tutorial is for a single switch. We repeated the same for the second switch)
>
> But we are not able to ping node3 from node1. Could you please let us know if we are doing something wrong?

One problem I see is that you have two different machines running OVS
that are trying to use "patch" ports to connect to each other.  "patch"
ports only work within a single host.

From fbl at sysclose.org  Tue Apr 28 10:25:20 2015
From: fbl at sysclose.org (Flavio Leitner)
Date: Tue, 28 Apr 2015 14:25:20 -0300
Subject: [ovs-discuss] ovs-docker: why need to use veth pair instead of
 internal port?
In-Reply-To: <CAHbON5pATRCwOEU+Aoms+oWG7zp9X_w3sAetaJ9AaLALSKh59g@mail.gmail.com>
References: <CADtzDC=BUjAgPThRjQwHKg+Ff-15vLnRa98dtiH+MnBmhq4PpA@mail.gmail.com>
 <CANb-gXSKJwxxubXf1Z77O1vx834u+Wzo2sB=xwreNdmuNmEs8Q@mail.gmail.com>
 <CADtzDC=v1_tOGpE3ZNCUpjAc=cCvU31354WZ8uURxJEHP__a4w@mail.gmail.com>
 <CAHbON5pATRCwOEU+Aoms+oWG7zp9X_w3sAetaJ9AaLALSKh59g@mail.gmail.com>
Message-ID: <20150428142520.7501e6c6@x240.home>

On Tue, 28 Apr 2015 07:06:28 -0700
Gurucharan Shetty <shettyg at nicira.com> wrote:

> On Mon, Apr 27, 2015 at 11:19 PM, Han Zhou <zhouhan at gmail.com> wrote:
> > Hi Shan,
> >
> > Thanks, but why can't we just add an internal port to OVS bridge and
> > put into namespace?
> > And what's the native support mentioned in INSTALL.docker.md?
> You can do it, and its performance is a lot better. But

I recently tested both and didn't notice any significant performance
gains between veth pairs and internal ports.  Actually the numbers were
very close and the code difference seems to be only the very beginning
part the stack where veth has to find out it's for the OVS datapath and
veth scrubbing the packet.  Other than that, the code path is pretty
much the same.

Also, veth does the right thing scrubbing the packet when crossing
the namespace which internal ports don't do and could be considered a
security issue.

> 1. once a OVS internal port has been moved inside a namespace, the
> ovs-vswitchd daemon running in the root namespace can no longer see it
> and starts complaining.

Yes, when querying ovsdb some of the values (ifindex, mac_in_use,
stats) relies on the interface's name which is not available to the
OVS daemon, so it doesn't work properly.

> 2. If you are depending on network counters to figure out how much
> packets have gone through etc, it gets confusing.
> 3. When you upgrade your kernel module, the internal interfaces will
> disappear from inside the container, likely causing unexpected
> behavior for the applications running inside and you will also need a
> mechanism to move them all back in after the interface are re-created.
> 
> So to take the easier path, ovs-docker utility does not use OVS
> internal interfaces but rather uses veth pairs.

Even if the issues above get fixed, the final result is a vswitch where
the port is not available in the vswitch namespace and the other netns
has a vswitch port which imposes some limitations, i.e. can you add the
port to another bridge?

fbl

> > Best regards,
> > Han
> >
> > On Tue, Apr 28, 2015 at 2:13 PM, Shanmugam Sundaram
> > <shanmugam.s at bizruntime.com> wrote:
> >> Hi Han,
> >>
> >> Dockers uses NameSpaces for isolation, to connect between network
> >> namespaces, we have to go with veth pairs.
> >>
> >> regards,
> >> Shan
> >>
> >> On Tue, Apr 28, 2015 at 11:35 AM, Han Zhou <zhouhan at gmail.com>
> >> wrote:
> >>>
> >>> Hello everyone,
> >>>
> >>> I have a question about the ovs-docker utility. Why can't internal
> >>> port work for docker case? For native support, does it mean we
> >>> need a new port type?
> >>>
> >>> Best regards,
> >>> Han
> >>> _______________________________________________
> >>> discuss mailing list
> >>> discuss at openvswitch.org
> >>> http://openvswitch.org/mailman/listinfo/discuss
> >>
> >>
> >>
> >>
> >> --
> >> regards,
> >> Shan
> > _______________________________________________
> > discuss mailing list
> > discuss at openvswitch.org
> > http://openvswitch.org/mailman/listinfo/discuss
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss



From kprad1 at yahoo.com  Tue Apr 28 20:16:00 2015
From: kprad1 at yahoo.com (Padmanabhan Krishnan)
Date: Wed, 29 Apr 2015 03:16:00 +0000 (UTC)
Subject: [ovs-discuss] Question on tunnel interfaces
In-Reply-To: <CAEP_g=_udrj1LwS835+k2Yy1UhaDWbS6WR7DNuCwN1FhkKNP_Q@mail.gmail.com>
References: <1036089648.4063399.1429942374890.JavaMail.yahoo@mail.yahoo.com>
 <20150427153817.GJ2783@nicira.com>
 <836732685.5457708.1430163850984.JavaMail.yahoo@mail.yahoo.com>
 <CAEP_g=_udrj1LwS835+k2Yy1UhaDWbS6WR7DNuCwN1FhkKNP_Q@mail.gmail.com>
Message-ID: <1317810223.147928.1430277360761.JavaMail.yahoo@mail.yahoo.com>

A quick follow-up on this.Even for the reverse traffic, does the kernel hand over all traffic received on the interface (173.x.. subnet attached to eth2) to "br-tun" which will decapsulate the frame, if it came in with the proper tunnel id? I am assuming OVS cannot register with the kernel to hand over only tunnel frames, right? 
Thanks,Paddu

     On Monday, April 27, 2015 1:11 PM, Jesse Gross <jesse at nicira.com> wrote:
   

 On Mon, Apr 27, 2015 at 12:44 PM, Padmanabhan Krishnan <kprad1 at yahoo.com> wrote:
> Thanks a lot Ben and Jesse.
>
> Just wanted to clarify, from your statements:
>
> “OVS simply hands the packet over to the kernel IP stack.”
>
> "After encapsulation, OVS turns the packet over to the kernel TCP/IP
> Stack"
>
> Is the above (handling the frame to kernel to do the routing) a special
> functionality of the tunnel bridge/port?
>
> For example, if a VM connected to a regular OVS bridge (br-int) sends a
> frame destined to a 173.x.. subnet (attached to eth2), i assume OVS will
> bridge the frame and not hand it over to the kernel, right?

Yes, this is specific to tunnel ports because outputting to a tunnel
implies the use of the IP stack. There is no implicit routing for
other types of devices.

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150429/f8dfb520/attachment.html>

From blp at nicira.com  Tue Apr 28 20:30:46 2015
From: blp at nicira.com (Ben Pfaff)
Date: Tue, 28 Apr 2015 20:30:46 -0700
Subject: [ovs-discuss] Question on tunnel interfaces
In-Reply-To: <1317810223.147928.1430277360761.JavaMail.yahoo@mail.yahoo.com>
References: <1036089648.4063399.1429942374890.JavaMail.yahoo@mail.yahoo.com>
 <20150427153817.GJ2783@nicira.com>
 <836732685.5457708.1430163850984.JavaMail.yahoo@mail.yahoo.com>
 <CAEP_g=_udrj1LwS835+k2Yy1UhaDWbS6WR7DNuCwN1FhkKNP_Q@mail.gmail.com>
 <1317810223.147928.1430277360761.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <20150429033046.GR25659@nicira.com>

OVS only gets tunnel frames.

On Wed, Apr 29, 2015 at 03:16:00AM +0000, Padmanabhan Krishnan wrote:
> A quick follow-up on this.Even for the reverse traffic, does the
> kernel hand over all traffic received on the interface (173.x.. subnet
> attached to eth2) to "br-tun" which will decapsulate the frame, if it
> came in with the proper tunnel id? I am assuming OVS cannot register
> with the kernel to hand over only tunnel frames, right?  Thanks,Paddu
> 
>      On Monday, April 27, 2015 1:11 PM, Jesse Gross <jesse at nicira.com> wrote:
>    
> 
>  On Mon, Apr 27, 2015 at 12:44 PM, Padmanabhan Krishnan <kprad1 at yahoo.com> wrote:
> > Thanks a lot Ben and Jesse.
> >
> > Just wanted to clarify, from your statements:
> >
> > “OVS simply hands the packet over to the kernel IP stack.”
> >
> > "After encapsulation, OVS turns the packet over to the kernel TCP/IP
> > Stack"
> >
> > Is the above (handling the frame to kernel to do the routing) a special
> > functionality of the tunnel bridge/port?
> >
> > For example, if a VM connected to a regular OVS bridge (br-int) sends a
> > frame destined to a 173.x.. subnet (attached to eth2), i assume OVS will
> > bridge the frame and not hand it over to the kernel, right?
> 
> Yes, this is specific to tunnel ports because outputting to a tunnel
> implies the use of the IP stack. There is no implicit routing for
> other types of devices.
> 
>   

From blp at nicira.com  Wed Apr 29 07:26:38 2015
From: blp at nicira.com (Ben Pfaff)
Date: Wed, 29 Apr 2015 07:26:38 -0700
Subject: [ovs-discuss] IGMP fields added to the flow structure causes
 problem?
In-Reply-To: <554074BB.70609@alliedtelesis.co.nz>
References: <553836BC.4040606@alliedtelesis.co.nz>
 <20150423230817.GA1644@nicira.com>
 <a0659fd0e2d4455ba3bbe530ebad0518@svr-chch-ex1.atlnz.lc>
 <554074BB.70609@alliedtelesis.co.nz>
Message-ID: <20150429142638.GB8746@nicira.com>

I'm glad to hear that you're tracking down the problem.  Good luck.

On Wed, Apr 29, 2015 at 06:05:48AM +0000, Tony van der Peet wrote:
> OK, downloaded OVS from top of master, and wrote a unit test that 
> hopefully would have reproduced the problem (I guess I should run that 
> test on the version we are actually using). Anyway, the test passed. 
> Looking more closely at the code, I can see that in flow_put and 
> flow_del in dpif-netdev.c, the way the hashes are calculated seems to 
> have changed. I suspect that this is why the code no longer exhibits 
> this behaviour.
> 
> So, for now I don't think I want any help on this issue. I'll keep 
> working on this as a background activity, but will probably do an update 
> from the upstream repo sometime soon and see if the problem goes away 
> after that.
> 
> Thanks for the earlier response.
> 
> Tony
> 
> On 25/04/15 07:14, Tony van der Peet wrote:
> > Just to get dates in order:
> >
> > Jun/2014 - deliveries to master branch that introduce IGMP fields to flow structure
> > Sep/2014 - we update from tip of master
> > Apr/2014 - I notice this potential issue
> >
> > I am running a simple ryu application (using code from https://github.com/samrussell/nss) and connecting my desktop PC to our main LAN. Flows with multicast addresses appear to come and go, but I suspect it's IGMPv3 Membership Reports (type 0x22) that are causing flows to be created that then persist.
> >
> > In this application at least, matching is done purely on source and destination MAC, so the existence of these flows is probably not that much of a problem since the flows will cover many other packets that aren't Membership reports. It's not really that surprising that this might not be noticed since the switch is behaving perfectly normally and acceptably.
> >
> > To your point of reproducing on unmodified OpenVSwitch, yes, I will do that, and report further. Time zones and public holidays mean that it won't be until next week.
> >
> > Tony
> > ________________________________________
> > From: Ben Pfaff <blp at nicira.com>
> > Sent: Friday, 24 April 2015 11:08 a.m.
> > To: Tony van der Peet
> > Cc: discuss at openvswitch.org
> > Subject: Re: [ovs-discuss] IGMP fields added to the flow structure causes problem?
> >
> > On Thu, Apr 23, 2015 at 12:03:08AM +0000, Tony van der Peet wrote:
> >> I have been investigating some anomalous behaviour in a switch
> >> (developed by us, based on OpenVSwitch code). It appears that flows
> >> added as a result of receiving IGMP packets are never deleted. Here's
> >> one of the flows (this is a switch running a simple MAC learning
> >> application, so you don't see the upper level fields).
> >>
> >> recirc_id(0),in_port(2),eth(src=38:60:77:8b:d9:0a,dst=01:00:5e:00:00:16),eth_type(0x0800),ipv4(frag=no), packets:26, bytes:2236, used:9.600s, actions:1,6,5,4,3
> >>
> >> Here's a log message I'm seeing:
> >>
> >> 2015 Apr 23 12:33:23 awplus ovs-vswitchd: 02570|dpif(revalidator4)|WARN|system at ovs-system: failed to flow_del (No such file or directory)
> >>   skb_priority(0),skb_mark(0),recirc_id(0),dp_hash(0),in_port(2),eth(src=38:60:77:8b:d9:0a,dst=01:00:5e:00:00:16),eth_type(0x0800),ipv4(src=10.33.22.24,dst=224.0.0.22,proto=2,tos=0xc0,ttl=1,frag=no)
> > Thanks for the report.  I'm a little surprised to hear about this, since
> > that code is somewhat old (I think you said September 2014) and I don't
> > remember getting similar reports before.  Can you explain how to
> > reproduce the problem (with unmodified OVS)?
> >

From zhouhan at gmail.com  Wed Apr 29 08:13:24 2015
From: zhouhan at gmail.com (Han Zhou)
Date: Wed, 29 Apr 2015 23:13:24 +0800
Subject: [ovs-discuss] ovs-docker: why need to use veth pair instead of
 internal port?
In-Reply-To: <20150428142520.7501e6c6@x240.home>
References: <CADtzDC=BUjAgPThRjQwHKg+Ff-15vLnRa98dtiH+MnBmhq4PpA@mail.gmail.com>
 <CANb-gXSKJwxxubXf1Z77O1vx834u+Wzo2sB=xwreNdmuNmEs8Q@mail.gmail.com>
 <CADtzDC=v1_tOGpE3ZNCUpjAc=cCvU31354WZ8uURxJEHP__a4w@mail.gmail.com>
 <CAHbON5pATRCwOEU+Aoms+oWG7zp9X_w3sAetaJ9AaLALSKh59g@mail.gmail.com>
 <20150428142520.7501e6c6@x240.home>
Message-ID: <CADtzDCkvAb5on2Qo6dZ+rtDwfPcj9DSG4ZykHdk6hjvhSiq6vw@mail.gmail.com>

Flavio, Guru, thank you both for sharings!

On Wed, Apr 29, 2015 at 1:25 AM, Flavio Leitner <fbl at sysclose.org> wrote:
> On Tue, 28 Apr 2015 07:06:28 -0700
> Gurucharan Shetty <shettyg at nicira.com> wrote:
>
>> On Mon, Apr 27, 2015 at 11:19 PM, Han Zhou <zhouhan at gmail.com> wrote:
>> > Hi Shan,
>> >
>> > Thanks, but why can't we just add an internal port to OVS bridge and
>> > put into namespace?
>> > And what's the native support mentioned in INSTALL.docker.md?
>> You can do it, and its performance is a lot better. But
>
> I recently tested both and didn't notice any significant performance
> gains between veth pairs and internal ports.  Actually the numbers were
> very close and the code difference seems to be only the very beginning
> part the stack where veth has to find out it's for the OVS datapath and
> veth scrubbing the packet.  Other than that, the code path is pretty
> much the same.
>
That's surprising. Could you share the actual throughput you achieved?

> Also, veth does the right thing scrubbing the packet when crossing
> the namespace which internal ports don't do and could be considered a
> security issue.
>
>> 1. once a OVS internal port has been moved inside a namespace, the
>> ovs-vswitchd daemon running in the root namespace can no longer see it
>> and starts complaining.
>
> Yes, when querying ovsdb some of the values (ifindex, mac_in_use,
> stats) relies on the interface's name which is not available to the
> OVS daemon, so it doesn't work properly.
>
Yes, I saw the log: ioctl(SIOCGIFINDEX) on test0 device failed: No such device
But I wonder why send/recv packets still work. In the function
netdev_linux_send() it also needs to call netdev_get_ifindex().
Openstack Neutron dhcp use internal ports in namespaces, and there's
no problem AFAIK, except the warning logs "No such device" when the
ports are being putting to netns.

>> 2. If you are depending on network counters to figure out how much
>> packets have gone through etc, it gets confusing.
>> 3. When you upgrade your kernel module, the internal interfaces will
>> disappear from inside the container, likely causing unexpected
>> behavior for the applications running inside and you will also need a
>> mechanism to move them all back in after the interface are re-created.
>>
>> So to take the easier path, ovs-docker utility does not use OVS
>> internal interfaces but rather uses veth pairs.
>
> Even if the issues above get fixed, the final result is a vswitch where
> the port is not available in the vswitch namespace and the other netns
> has a vswitch port which imposes some limitations, i.e. can you add the
> port to another bridge?
>

Make sense. So it seems not worth the effort of replacing veth pairs
by internal ports, if there is no or little performance penalty,
according to your test results.

> fbl


Han

From zhouhan at gmail.com  Wed Apr 29 08:27:53 2015
From: zhouhan at gmail.com (Han Zhou)
Date: Wed, 29 Apr 2015 23:27:53 +0800
Subject: [ovs-discuss] ovs-docker: why need to use veth pair instead of
 internal port?
In-Reply-To: <CAHbON5oSrJW=6b7SOu+jKKLAt7zT9gCPGspBhKWRqyjxGDUcLw@mail.gmail.com>
References: <CADtzDC=BUjAgPThRjQwHKg+Ff-15vLnRa98dtiH+MnBmhq4PpA@mail.gmail.com>
 <CANb-gXSKJwxxubXf1Z77O1vx834u+Wzo2sB=xwreNdmuNmEs8Q@mail.gmail.com>
 <CADtzDC=v1_tOGpE3ZNCUpjAc=cCvU31354WZ8uURxJEHP__a4w@mail.gmail.com>
 <CAHbON5pATRCwOEU+Aoms+oWG7zp9X_w3sAetaJ9AaLALSKh59g@mail.gmail.com>
 <CAHbON5oSrJW=6b7SOu+jKKLAt7zT9gCPGspBhKWRqyjxGDUcLw@mail.gmail.com>
Message-ID: <CADtzDC=BpafHguu5ctX8RjqiCC-1N-y3tNYSo=S-uafTKt1WEQ@mail.gmail.com>

Hi Guru,

On Tue, Apr 28, 2015 at 10:16 PM, Gurucharan Shetty <shettyg at nicira.com> wrote:
>>> And what's the native support mentioned in INSTALL.docker.md?
>
> When the document was written, there was an attempt made to make
> docker daemon OVS aware. There was no interest for that exact work
> piece of work from Docker. Instead, Docker is currently working on
> Network plugins here: https://github.com/docker/libnetwork. Once that
> work matures, there will be a "native" integration in the sense that
> you can have your OVS interface inside a container before the
> application starts. Does that answer your question?

Yes, thanks for the pointer. Is it related to
https://github.com/docker/docker/issues/9983?
So is veth still the chosen solution? Or is it necessary to have a new
native docker ovs port type?
According to http://www.opencloudblog.com/?p=96 there is huge
performance penalty with veth, but Flavio in the other thread of this
email mentioned there is no significant difference. I may have a test
myself later on...

Best regards,
Han

From shettyg at nicira.com  Wed Apr 29 08:28:19 2015
From: shettyg at nicira.com (Gurucharan Shetty)
Date: Wed, 29 Apr 2015 08:28:19 -0700
Subject: [ovs-discuss] ovs-docker: why need to use veth pair instead of
 internal port?
In-Reply-To: <CADtzDCkvAb5on2Qo6dZ+rtDwfPcj9DSG4ZykHdk6hjvhSiq6vw@mail.gmail.com>
References: <CADtzDC=BUjAgPThRjQwHKg+Ff-15vLnRa98dtiH+MnBmhq4PpA@mail.gmail.com>
 <CANb-gXSKJwxxubXf1Z77O1vx834u+Wzo2sB=xwreNdmuNmEs8Q@mail.gmail.com>
 <CADtzDC=v1_tOGpE3ZNCUpjAc=cCvU31354WZ8uURxJEHP__a4w@mail.gmail.com>
 <CAHbON5pATRCwOEU+Aoms+oWG7zp9X_w3sAetaJ9AaLALSKh59g@mail.gmail.com>
 <20150428142520.7501e6c6@x240.home>
 <CADtzDCkvAb5on2Qo6dZ+rtDwfPcj9DSG4ZykHdk6hjvhSiq6vw@mail.gmail.com>
Message-ID: <CAHbON5q-XTrTYgKN-NTO5mNs-R9OMKBhrujgcXWxjD=-4=qWOg@mail.gmail.com>

>>
>
> Make sense. So it seems not worth the effort of replacing veth pairs
> by internal ports, if there is no or little performance penalty,
> according to your test results.
I have personally not done any testing, so I have heard conflicting reports.
There are a couple of blog entries which show that OVS internal
devices perform a lot better.
http://www.opencloudblog.com/?p=96

>
>> fbl
>
>
> Han

From shettyg at nicira.com  Wed Apr 29 08:32:12 2015
From: shettyg at nicira.com (Gurucharan Shetty)
Date: Wed, 29 Apr 2015 08:32:12 -0700
Subject: [ovs-discuss] ovs-docker: why need to use veth pair instead of
 internal port?
In-Reply-To: <CADtzDC=BpafHguu5ctX8RjqiCC-1N-y3tNYSo=S-uafTKt1WEQ@mail.gmail.com>
References: <CADtzDC=BUjAgPThRjQwHKg+Ff-15vLnRa98dtiH+MnBmhq4PpA@mail.gmail.com>
 <CANb-gXSKJwxxubXf1Z77O1vx834u+Wzo2sB=xwreNdmuNmEs8Q@mail.gmail.com>
 <CADtzDC=v1_tOGpE3ZNCUpjAc=cCvU31354WZ8uURxJEHP__a4w@mail.gmail.com>
 <CAHbON5pATRCwOEU+Aoms+oWG7zp9X_w3sAetaJ9AaLALSKh59g@mail.gmail.com>
 <CAHbON5oSrJW=6b7SOu+jKKLAt7zT9gCPGspBhKWRqyjxGDUcLw@mail.gmail.com>
 <CADtzDC=BpafHguu5ctX8RjqiCC-1N-y3tNYSo=S-uafTKt1WEQ@mail.gmail.com>
Message-ID: <CAHbON5oz0=HnkDu0D0E4p1Uk8--VPA6CHkQU34v_LN479HOcig@mail.gmail.com>

>
> Yes, thanks for the pointer. Is it related to
> https://github.com/docker/docker/issues/9983?
Yes. Same starting point.

> So is veth still the chosen solution? Or is it necessary to have a new
> native docker ovs port type?
veth is the chosen solution. A plugin is supposed to return back a
veth pair and libnetwork will insert them into the container.

> According to http://www.opencloudblog.com/?p=96 there is huge
> performance penalty with veth, but Flavio in the other thread of this
> email mentioned there is no significant difference. I may have a test
> myself later on...
That will be useful. Dave Tucker (from socketplane) had also mentioned
that according to his tests OVS internal devices perform a lot better.

>
> Best regards,
> Han

From Tony.vanderPeet at alliedtelesis.co.nz  Tue Apr 28 23:05:48 2015
From: Tony.vanderPeet at alliedtelesis.co.nz (Tony van der Peet)
Date: Wed, 29 Apr 2015 06:05:48 +0000
Subject: [ovs-discuss] IGMP fields added to the flow structure causes
 problem?
In-Reply-To: <a0659fd0e2d4455ba3bbe530ebad0518@svr-chch-ex1.atlnz.lc>
References: <553836BC.4040606@alliedtelesis.co.nz>,
 <20150423230817.GA1644@nicira.com>
 <a0659fd0e2d4455ba3bbe530ebad0518@svr-chch-ex1.atlnz.lc>
Message-ID: <554074BB.70609@alliedtelesis.co.nz>

OK, downloaded OVS from top of master, and wrote a unit test that 
hopefully would have reproduced the problem (I guess I should run that 
test on the version we are actually using). Anyway, the test passed. 
Looking more closely at the code, I can see that in flow_put and 
flow_del in dpif-netdev.c, the way the hashes are calculated seems to 
have changed. I suspect that this is why the code no longer exhibits 
this behaviour.

So, for now I don't think I want any help on this issue. I'll keep 
working on this as a background activity, but will probably do an update 
from the upstream repo sometime soon and see if the problem goes away 
after that.

Thanks for the earlier response.

Tony

On 25/04/15 07:14, Tony van der Peet wrote:
> Just to get dates in order:
>
> Jun/2014 - deliveries to master branch that introduce IGMP fields to flow structure
> Sep/2014 - we update from tip of master
> Apr/2014 - I notice this potential issue
>
> I am running a simple ryu application (using code from https://github.com/samrussell/nss) and connecting my desktop PC to our main LAN. Flows with multicast addresses appear to come and go, but I suspect it's IGMPv3 Membership Reports (type 0x22) that are causing flows to be created that then persist.
>
> In this application at least, matching is done purely on source and destination MAC, so the existence of these flows is probably not that much of a problem since the flows will cover many other packets that aren't Membership reports. It's not really that surprising that this might not be noticed since the switch is behaving perfectly normally and acceptably.
>
> To your point of reproducing on unmodified OpenVSwitch, yes, I will do that, and report further. Time zones and public holidays mean that it won't be until next week.
>
> Tony
> ________________________________________
> From: Ben Pfaff <blp at nicira.com>
> Sent: Friday, 24 April 2015 11:08 a.m.
> To: Tony van der Peet
> Cc: discuss at openvswitch.org
> Subject: Re: [ovs-discuss] IGMP fields added to the flow structure causes problem?
>
> On Thu, Apr 23, 2015 at 12:03:08AM +0000, Tony van der Peet wrote:
>> I have been investigating some anomalous behaviour in a switch
>> (developed by us, based on OpenVSwitch code). It appears that flows
>> added as a result of receiving IGMP packets are never deleted. Here's
>> one of the flows (this is a switch running a simple MAC learning
>> application, so you don't see the upper level fields).
>>
>> recirc_id(0),in_port(2),eth(src=38:60:77:8b:d9:0a,dst=01:00:5e:00:00:16),eth_type(0x0800),ipv4(frag=no), packets:26, bytes:2236, used:9.600s, actions:1,6,5,4,3
>>
>> Here's a log message I'm seeing:
>>
>> 2015 Apr 23 12:33:23 awplus ovs-vswitchd: 02570|dpif(revalidator4)|WARN|system at ovs-system: failed to flow_del (No such file or directory)
>>   skb_priority(0),skb_mark(0),recirc_id(0),dp_hash(0),in_port(2),eth(src=38:60:77:8b:d9:0a,dst=01:00:5e:00:00:16),eth_type(0x0800),ipv4(src=10.33.22.24,dst=224.0.0.22,proto=2,tos=0xc0,ttl=1,frag=no)
> Thanks for the report.  I'm a little surprised to hear about this, since
> that code is somewhat old (I think you said September 2014) and I don't
> remember getting similar reports before.  Can you explain how to
> reproduce the problem (with unmodified OVS)?
>

From navneet.singh2012 at gmail.com  Wed Apr 29 10:03:05 2015
From: navneet.singh2012 at gmail.com (Navneet Singh)
Date: Wed, 29 Apr 2015 22:33:05 +0530
Subject: [ovs-discuss] QoS using patch ports
Message-ID: <CAOCzzULO5t7t_BNj+OkvbRX4eCwqdDCOTgX1DAhoXOCFRgK_dw@mail.gmail.com>

Hi All

I need to configure OVS queues using OVS patch ports. Below is my setup.


---------------------------------------------------------------------------------------------------------------------------
|
|                ____________                      ___*192.168.1.1*__
|               |       br0             |  patch-port  |           br1
      |
|               |                  eth1|-----------------| eth2
      |
|               |_eth0________|                    |_________eth3_|
                  /
 \
                 /
   \
                /
    \
               /
       \
            Laptop-1
 Laptop-2
            IP-192.168.1.100
IP-192.168.1.11


I'm able to ping Laptop-1 and Laptop-2 but not able to achieve rate limit
when I'm applying QOS policy at port eth1 of br0.
I'm using below command..

ovs-vsctl set port eth1 qos=@newqos -- --id=@newqos create qos
> type=linux-htb queues=0=@q0,1=@q1 -- --id=@q0 create queue
> other-config:min-rate=1000000 other-config:max-rate=1000000 -- --id=@q1
> create queue other-config:min-rate=3000000 other-config:max-rate=300000
> 0


Thanks in advance

--
Navneet
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150429/99c772e0/attachment-0001.html>

From mark.d.gray at intel.com  Wed Apr 29 10:52:30 2015
From: mark.d.gray at intel.com (Gray, Mark D)
Date: Wed, 29 Apr 2015 17:52:30 +0000
Subject: [ovs-discuss] typical dpcls flow addition rates
Message-ID: <738D45BC1F695740A983F43CFE1B7EA92E23F15B@IRSMSX108.ger.corp.intel.com>

Hi,

We have been investigating options for optimizing the ovs userspace datapath and hope to post patches for this over the next months. One of the vectors that we have started looking at is the dpcls wildcard classifier. However, in order to understand what our options are to optimize this, we would really like to understand how it gets used in most deployments. A lot of good work was done for OVS 1.11 to introduce megaflows which should reduce the number of flow additions/sec in the datapath. Is there any data that shows, in real world deployments, how often additions need to be made to the fast path considering that the dpcls is now wildcarded?

Thanks,

Mark

From marco at nuvula.ch  Thu Apr 30 03:08:01 2015
From: marco at nuvula.ch (Marco Kuendig)
Date: Thu, 30 Apr 2015 12:08:01 +0200
Subject: [ovs-discuss] Crash in openvswitch 2.0.2
In-Reply-To: <5537613B.5070804@ubuntu.com>
References: <40952DEC-8655-4B97-9B71-1DBD65E11138@nuvula.ch>
 <41FBC0F8-2336-444C-B08F-6736F73E6FA6@nuvula.ch>
 <CANr6G5zJFBDX1rWL6e2++ije4ucCMmViCv=0vrKn+zz62JDKsA@mail.gmail.com>
 <321030EF-0481-4FD2-B979-8B0A63C3D19D@nuvula.ch>
 <CANr6G5weMs1tLeLmDSfb_yL9Gk6Zz88dy0XpZ99UjQVi+_w_Sw@mail.gmail.com>
 <68DDEDA0-481E-49EF-BB94-7FD9AE7373EF@nuvula.ch>
 <20DD9129-AEDD-4FC6-BFD5-A8F10545230B@nuvula.ch>
 <CANr6G5znSOe9gFUMwa6AP-zaRNiRXrfnqM6UUHsoVgQWEsN2Jg@mail.gmail.com>
 <EF09D73F-A631-484A-AE08-307C927ABEB3@nuvula.ch>
 <62395DBA-764B-4332-8D77-EF5EF189D623@canonical.com>
 <3E5B9556-CB9F-4D5B-8A6D-A615C099BAD7@nuvula.ch>
 <3FE189EC-49E0-47CC-BD59-2F6E7B04B9A4@ubuntu.com>
 <8CE70C04-9A31-4499-938A-85EC4D13E0BB@nuvula.ch>
 <C222441F-23C1-470A-987E-123B00879EA9@ubuntu.com>
 <117DA076-BD34-4C01-94AE-22949AEF0E42@nuvula.ch> <55241FD8.1040704@ubuntu.com>
 <A00A93E9-6A58-458C-8E8B-C8542176ADDA@nuvula.ch> <553519F7.3060901@ubuntu.com>
 <CA907DB2-9B8D-4BEA-A902-8F9E436268A8@nuvula.ch> <5537613B.5070804@ubuntu.com>
Message-ID: <DEB79FE9-5392-4CDB-9EC7-04FCB784CD61@nuvula.ch>

Hi James

sorry for the very late reply. Had some email filtering issues and missed that message. 

have now updated all servers to that non-optimized package.

So I do have now:

4 servers with 3.16 kernel and unoptimized ovs package
1 server with 3.13 kernel and unoptimized ovs package

Will report back how it goes.

cheers
marco


 <http://www.nuvula.ch/>
Marco Kuendig / CEO / Founder 
marco at nuvula.ch <mailto:marco at nuvula.ch> / +41 78 751 99 71

Marco's Google Hangout <https://plus.google.com/hangouts/_/nuvula.ch/marco>
Nuvula AG - Hybrid Clouds 
Weierbachstrasse 7b 8193 Eglisau Switzerland 
http://www.nuvula.ch <http://www.nuvula.ch/>
> On 22 Apr 2015, at 10:52, James Page <james.page at ubuntu.com> wrote:
> 
> -----BEGIN PGP SIGNED MESSAGE-----
> Hash: SHA256
> 
> Marco
> 
> Apologies for my foobar in not managing to provide un-optimized
> binaries when I thought I had - apparently the ovs packaging
> outsmarted me.
> 
> I've push a verified -O0 build to ppa:james-page/openvswitch
> 
> If you could retry with the latest packages from that PPA that would
> be great - then we can really figure out whether this is an optimizer
> issue or not...
> 
> Regards
> 
> James
> 
> On 21/04/15 08:01, Marco Kuendig wrote:
>> thanks James for the answer. No problem.
>> 
>> Let me know if I can test anything and I will give it a try.
>> 
>> cheers marco
>> 
>> 
>> Nuvula AG <http://www.nuvula.ch/>
>> 
>> Marco Kuendig / CEO / Founder marco at nuvula.ch
>> <mailto:marco at nuvula.ch> / +41 78 751 99 71
>> 
>> Marco's Google Hangout
>> <https://plus.google.com/hangouts/_/nuvula.ch/marco>
>> 
>> Nuvula AG - Hybrid Clouds Weierbachstrasse 7b 8193 Eglisau
>> Switzerland http://www.nuvula.ch <http://www.nuvula.ch/>
>> 
>> 
>>> On 20 Apr 2015, at 17:23, James Page <james.page at ubuntu.com 
>>> <mailto:james.page at ubuntu.com>> wrote:
>>> 
>> Hi Marco
>> 
>> Not ignoring you - just a bit busy with Ubuntu 15.04 release at
>> the moment - so apologies for any lag.
>> 
>> On 16/04/15 21:13, Marco Kuendig wrote:
>>>>> #2  0x0000000000460cd2 in format_odp_key_attr 
>>>>> (a=a at entry=0x19798d4, ma=ma at entry=0x0,
>>>>> ds=ds at entry=0x7ffc6c10bd10, verbose=verbose at entry=true) at
>>>>> ../lib/odp-util.c:1332
>> 
>> The thing that has us puzzled is why at this point in the stack is
>> the automatic variable 'is_exact' not true:
>> 
>> case OVS_KEY_ATTR_UNSPEC: case __OVS_KEY_ATTR_MAX: default: 
>> format_generic_odp_key(a, ds); if (!is_exact) { ds_put_char(ds,
>> '/'); format_generic_odp_key(ma, ds); } break; }
>> 
>> As the 'ma' parameter is 0, this should mean that is_exact
>> follows:
>> 
>> is_exact = ma ? odp_mask_attr_is_exact(ma) : true;
>> 
>> and as ma == 0 then is_exact should == true.  But for some reason
>> its no t.
>> 
>> As you see this with the un-optimized package, we can't blame the 
>> optimizer - so something else must be happening - maybe an
>> overflow?
>> 
>> That would have to happen in L952->L978 so not a huge amount of
>> scope.
>> 
>> It might be good to see if we can determine whether namebuf is the 
>> culprit.
>> 
>> 
> 
> - -- 
> James Page
> Ubuntu and Debian Developer
> james.page at ubuntu.com
> jamespage at debian.org
> -----BEGIN PGP SIGNATURE-----
> Version: GnuPG v2
> 
> iQIcBAEBCAAGBQJVN2E7AAoJEL/srsug59jDLJcQAKKzaKdfp7YvrEcasIaLKffh
> mO0KO6MbVWp+42gaW/1XuT3wa2nZuVgjGaytb5NC/EJy1O3viQVQMWJIJosBoK5f
> xbxC1z+3IRhnF8r27elql8nE/bxLVGpj4jUXySV7Ad1ede/3P3T30TcnhCkXNaKi
> 2CcOE9MUAj+2sp4C3VUXwRxdTZio1dJ+A6lDoA65p7brWroKNhY1Y0g1ct97tVE+
> YLaZK3oOuVt6++CX5KPE7hR1XBk5ojKxMUtIDP5T/az7zDSokVk2GR3CYJHg57kh
> SfvGw4r0PbkKn0W3E4u3HSCimlizy40Ior9qUuvNC8F4kDq7LWW3WE6ggb+X34N0
> 5AetDHEgRB7eFBTWlLmC4Gop7mrQP/wBqmDJJoMr+jxEJC8HoSpRYoFixAPi+6w7
> O3SqOPCMpND0EHqCF60fn5zUFyXWEqWgrunEauhqPJ6swo1Uzyu52ONSZQ+V27UY
> bqnDBjq5JAU5QbSTAY52ugAsW+GGobykdduxuL0Uz8cppZ/Vlkm/wh8XtAfN3nTh
> GbYItkp9xRNesq6Q+beL0tFVLJWuvQNDv4LsFBzgAGRE/9Aw91A1T2GtOvLbLACa
> SmM2FMt4NBVV7ANqKUP1F8mACyKtbhepPVO2Oidx/ytogO+oZYtNaRNK+UwQvj/0
> lFtr4VM3A0nI8s0zFeyP
> =mulJ
> -----END PGP SIGNATURE-----

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150430/541fb431/attachment.html>

From ashujain9727 at gmail.com  Wed Apr 29 09:55:12 2015
From: ashujain9727 at gmail.com (abhishek jain)
Date: Wed, 29 Apr 2015 22:25:12 +0530
Subject: [ovs-discuss] configure qos using patch ports
Message-ID: <CA+9-LvugQ+0EwjYO9ncy7_iA7cqwTCCfYYKUWPzPy7Xcdem4Hw@mail.gmail.com>

Hi

I need to configure OVS queues using OVS patch ports.Below is the setup..


---------------------------------------------------------------------------------------------------------------------------
|                                                            192.168.1.1

|                ____________                      ______________
|               |       br0          |  patch-port    |
br1         |
|               |               eth1| --------------------|
eth2                 |
|               |_eth0________|                    |_________eth3__|

/                                                          \

/                                                            \

/                                                               \

/                                                                  \
            Laptop-1
Laptop-2
            IP-192.168.1.100
IP-192.168.1.11


I'm able to ping Laptop-1 and Laptop-2 but not able to achieve rate limit
when I'm applying QOS policy at port eth1 of br0.
I'm using below command..

ovs-vsctl set port eth1 qos=@newqos -- --id=@newqos create qos
type=linux-htb queues=0=@q0,1=@q1 -- --id=@q0 create queue
other-config:min-rate=1000000 other-config:max-rate=1000000 -- --id=@q1
create queue other-config:min-rate=3000000 other-config:max-rate=300000
0
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150429/d067fef8/attachment-0001.html>

From Tony.vanderPeet at alliedtelesis.co.nz  Wed Apr 29 17:20:34 2015
From: Tony.vanderPeet at alliedtelesis.co.nz (Tony van der Peet)
Date: Thu, 30 Apr 2015 00:20:34 +0000
Subject: [ovs-discuss] IGMP fields added to the flow structure causes
 problem?
In-Reply-To: <20150429142638.GB8746@nicira.com>
References: <553836BC.4040606@alliedtelesis.co.nz>
 <20150423230817.GA1644@nicira.com>
 <a0659fd0e2d4455ba3bbe530ebad0518@svr-chch-ex1.atlnz.lc>
 <554074BB.70609@alliedtelesis.co.nz> <20150429142638.GB8746@nicira.com>
Message-ID: <55417551.1090203@alliedtelesis.co.nz>

Just to finalise this thread:

+ my earlier test must have been incorrectly specifying the packet, and 
I decided to specify the packet as a hex string instead, using a packet 
captured from our LAN
+ running my test on the Sep/2014 snapshot revealed the issue
+ running my test on the Apr/2015 snapshot showed the flow deletion 
worked, ie no issue

Seems as if I should do an upgrade!

Tony

On 30/04/15 02:26, Ben Pfaff wrote:
> I'm glad to hear that you're tracking down the problem.  Good luck.
>
> On Wed, Apr 29, 2015 at 06:05:48AM +0000, Tony van der Peet wrote:
>> OK, downloaded OVS from top of master, and wrote a unit test that
>> hopefully would have reproduced the problem (I guess I should run that
>> test on the version we are actually using). Anyway, the test passed.
>> Looking more closely at the code, I can see that in flow_put and
>> flow_del in dpif-netdev.c, the way the hashes are calculated seems to
>> have changed. I suspect that this is why the code no longer exhibits
>> this behaviour.
>>
>> So, for now I don't think I want any help on this issue. I'll keep
>> working on this as a background activity, but will probably do an update
>> from the upstream repo sometime soon and see if the problem goes away
>> after that.
>>
>> Thanks for the earlier response.
>>
>> Tony
>>
>> On 25/04/15 07:14, Tony van der Peet wrote:
>>> Just to get dates in order:
>>>
>>> Jun/2014 - deliveries to master branch that introduce IGMP fields to flow structure
>>> Sep/2014 - we update from tip of master
>>> Apr/2014 - I notice this potential issue
>>>
>>> I am running a simple ryu application (using code from https://github.com/samrussell/nss) and connecting my desktop PC to our main LAN. Flows with multicast addresses appear to come and go, but I suspect it's IGMPv3 Membership Reports (type 0x22) that are causing flows to be created that then persist.
>>>
>>> In this application at least, matching is done purely on source and destination MAC, so the existence of these flows is probably not that much of a problem since the flows will cover many other packets that aren't Membership reports. It's not really that surprising that this might not be noticed since the switch is behaving perfectly normally and acceptably.
>>>
>>> To your point of reproducing on unmodified OpenVSwitch, yes, I will do that, and report further. Time zones and public holidays mean that it won't be until next week.
>>>
>>> Tony
>>> ________________________________________
>>> From: Ben Pfaff <blp at nicira.com>
>>> Sent: Friday, 24 April 2015 11:08 a.m.
>>> To: Tony van der Peet
>>> Cc: discuss at openvswitch.org
>>> Subject: Re: [ovs-discuss] IGMP fields added to the flow structure causes problem?
>>>
>>> On Thu, Apr 23, 2015 at 12:03:08AM +0000, Tony van der Peet wrote:
>>>> I have been investigating some anomalous behaviour in a switch
>>>> (developed by us, based on OpenVSwitch code). It appears that flows
>>>> added as a result of receiving IGMP packets are never deleted. Here's
>>>> one of the flows (this is a switch running a simple MAC learning
>>>> application, so you don't see the upper level fields).
>>>>
>>>> recirc_id(0),in_port(2),eth(src=38:60:77:8b:d9:0a,dst=01:00:5e:00:00:16),eth_type(0x0800),ipv4(frag=no), packets:26, bytes:2236, used:9.600s, actions:1,6,5,4,3
>>>>
>>>> Here's a log message I'm seeing:
>>>>
>>>> 2015 Apr 23 12:33:23 awplus ovs-vswitchd: 02570|dpif(revalidator4)|WARN|system at ovs-system: failed to flow_del (No such file or directory)
>>>>    skb_priority(0),skb_mark(0),recirc_id(0),dp_hash(0),in_port(2),eth(src=38:60:77:8b:d9:0a,dst=01:00:5e:00:00:16),eth_type(0x0800),ipv4(src=10.33.22.24,dst=224.0.0.22,proto=2,tos=0xc0,ttl=1,frag=no)
>>> Thanks for the report.  I'm a little surprised to hear about this, since
>>> that code is somewhat old (I think you said September 2014) and I don't
>>> remember getting similar reports before.  Can you explain how to
>>> reproduce the problem (with unmodified OVS)?
>>>

From haleema.s.mahmood at gmail.com  Wed Apr 29 23:52:45 2015
From: haleema.s.mahmood at gmail.com (Haleema Sadia Mahmood)
Date: Thu, 30 Apr 2015 11:52:45 +0500
Subject: [ovs-discuss] Queue-Stats command not working
Message-ID: <D96B032E-A664-4D8D-A876-03C94E517290@gmail.com>

Hey everyone,

So I am trying to configure queues on a mininet topology. The command that I use is, (here s1-eth1 is my port 1) 

sudo ovs-vsctl set port s1-eth1 qos=@newqos - -  - -id=@newqos create qos type=linux-htb queues=0=@q0  - -  - -id=@q0 create queue other-config:max-rate=100000000 other-config:min-rate=5000000 - -

The qos is attached to the port, checked it from sudo ovs-vsctl list port s1-eth1, and the queues are created.

But when I try to use the command 
sudo ovs-ofctl queue-stats s1 s1-eth1 -O OpenFlow13

it returns : OFPST_QUEUE reply (OF1.3) (xid=0x4): 0 queues

And when I try
sudo ovs-ofctl queue-stats s1 -O OpenFlow13

it returns: OFPST_QUEUE reply (OF1.3) (xid=0x2): 0 queues

I am using OVS 2.3.90, and the version of OpenFlow version is 1.3.

Also when I try to check the queues with iperf sending udp packets on the queue created, the rate is not limited on the queue.

Any ideas what am I missing while setting this queue?

Thanks!

Best,
Haleema
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150430/92a53664/attachment.html>

From shettyg at nicira.com  Thu Apr 30 08:53:36 2015
From: shettyg at nicira.com (Gurucharan Shetty)
Date: Thu, 30 Apr 2015 08:53:36 -0700
Subject: [ovs-discuss] configure qos using patch ports
In-Reply-To: <CA+9-LvugQ+0EwjYO9ncy7_iA7cqwTCCfYYKUWPzPy7Xcdem4Hw@mail.gmail.com>
References: <CA+9-LvugQ+0EwjYO9ncy7_iA7cqwTCCfYYKUWPzPy7Xcdem4Hw@mail.gmail.com>
Message-ID: <CAHbON5qtpmFLkrXJegzY5VyZ61nfgP2HqCOwb0DJZw8ZpQAN0w@mail.gmail.com>

Removing floodlight-dev as I do not subscribe to that mailing list.

How are eth1 and eth2 on 2 different machines (based on the diagram)
connected via  a patch port?
If "br0" and "br1" are on a single machine, and "eth1" and "eth2" are
OVS virtual ports, you cannot add QoS to them.

On Wed, Apr 29, 2015 at 9:55 AM, abhishek jain <ashujain9727 at gmail.com> wrote:
> Hi
>
> I need to configure OVS queues using OVS patch ports.Below is the setup..
>
>
> ---------------------------------------------------------------------------------------------------------------------------
> |                                                            192.168.1.1
> |                ____________                      ______________
> |               |       br0          |  patch-port    |           br1
> |
> |               |               eth1| --------------------| eth2
> |
> |               |_eth0________|                    |_________eth3__|
>                   /
> \
>                  /
> \
>                 /
> \
>                /
> \
>             Laptop-1
> Laptop-2
>             IP-192.168.1.100
> IP-192.168.1.11
>
>
> I'm able to ping Laptop-1 and Laptop-2 but not able to achieve rate limit
> when I'm applying QOS policy at port eth1 of br0.
> I'm using below command..
>
> ovs-vsctl set port eth1 qos=@newqos -- --id=@newqos create qos
> type=linux-htb queues=0=@q0,1=@q1 -- --id=@q0 create queue
> other-config:min-rate=1000000 other-config:max-rate=1000000 -- --id=@q1
> create queue other-config:min-rate=3000000 other-config:max-rate=300000
> 0
>
>
> _______________________________________________
> discuss mailing list
> discuss at openvswitch.org
> http://openvswitch.org/mailman/listinfo/discuss
>

From shettyg at nicira.com  Thu Apr 30 09:04:06 2015
From: shettyg at nicira.com (Gurucharan Shetty)
Date: Thu, 30 Apr 2015 09:04:06 -0700
Subject: [ovs-discuss] configure qos using patch ports
In-Reply-To: <CA+9-LvtcbEEgWvHQPb+qsd7BGU-9xiBegEPLZVQhex89kyGVPw@mail.gmail.com>
References: <CA+9-LvugQ+0EwjYO9ncy7_iA7cqwTCCfYYKUWPzPy7Xcdem4Hw@mail.gmail.com>
 <CAHbON5qtpmFLkrXJegzY5VyZ61nfgP2HqCOwb0DJZw8ZpQAN0w@mail.gmail.com>
 <CA+9-LvtcbEEgWvHQPb+qsd7BGU-9xiBegEPLZVQhex89kyGVPw@mail.gmail.com>
Message-ID: <CAHbON5oLFzuCVoNdr1kJi0iaZfS6t4QZ6jn7hXXiOkucU3i_hw@mail.gmail.com>

I don't understand what you mean, you will have to elaborate.

On Thu, Apr 30, 2015 at 9:02 AM, abhishek jain <ashujain9727 at gmail.com> wrote:
> Hi Gurucharan
>
> Thanks for the reply.
> Eth1 and eth2 are on same machine.I'm able to configure qos for the output
> port through veth pair
>
> On Apr 30, 2015 9:23 PM, "Gurucharan Shetty" <shettyg at nicira.com> wrote:
>>
>> Removing floodlight-dev as I do not subscribe to that mailing list.
>>
>> How are eth1 and eth2 on 2 different machines (based on the diagram)
>> connected via  a patch port?
>> If "br0" and "br1" are on a single machine, and "eth1" and "eth2" are
>> OVS virtual ports, you cannot add QoS to them.
>>
>> On Wed, Apr 29, 2015 at 9:55 AM, abhishek jain <ashujain9727 at gmail.com>
>> wrote:
>> > Hi
>> >
>> > I need to configure OVS queues using OVS patch ports.Below is the
>> > setup..
>> >
>> >
>> >
>> > ---------------------------------------------------------------------------------------------------------------------------
>> > |                                                            192.168.1.1
>> > |                ____________                      ______________
>> > |               |       br0          |  patch-port    |           br1
>> > |
>> > |               |               eth1| --------------------| eth2
>> > |
>> > |               |_eth0________|                    |_________eth3__|
>> >                   /
>> > \
>> >                  /
>> > \
>> >                 /
>> > \
>> >                /
>> > \
>> >             Laptop-1
>> > Laptop-2
>> >             IP-192.168.1.100
>> > IP-192.168.1.11
>> >
>> >
>> > I'm able to ping Laptop-1 and Laptop-2 but not able to achieve rate
>> > limit
>> > when I'm applying QOS policy at port eth1 of br0.
>> > I'm using below command..
>> >
>> > ovs-vsctl set port eth1 qos=@newqos -- --id=@newqos create qos
>> > type=linux-htb queues=0=@q0,1=@q1 -- --id=@q0 create queue
>> > other-config:min-rate=1000000 other-config:max-rate=1000000 -- --id=@q1
>> > create queue other-config:min-rate=3000000 other-config:max-rate=300000
>> > 0
>> >
>> >
>> > _______________________________________________
>> > discuss mailing list
>> > discuss at openvswitch.org
>> > http://openvswitch.org/mailman/listinfo/discuss
>> >

From ABDUL.RASHEED at LNTTECHSERVICES.COM  Thu Apr 30 09:08:43 2015
From: ABDUL.RASHEED at LNTTECHSERVICES.COM (Abdul Rasheed Shaik)
Date: Thu, 30 Apr 2015 16:08:43 +0000
Subject: [ovs-discuss] CLI session with OpenvSwitch
Message-ID: <20FA96CBE1A24D4191A5EABB5763AB0B013243CA@POCITMSEXMB05.LntUniverse.com>

Hi,

I have a requirement like, I would like to configure VLANs, and Show the VLAN details from the OpenDayLight controller northbound. For this we are planning to write a CLI southbound interface which will communicate with the OVS using CLI protocol (ExpectJ java library).

This our current requirement, now the question is like,  Is this is possible with openvswitch? (i.e telenet to OVS and issues commands from remote locations).

Please help me in understanding this.

Thanks & Regards,
Abdul

L&T Technology Services Ltd

www.LntTechservices.com<http://www.lnttechservices.com/>

This Email may contain confidential or privileged information for the intended recipient (s). If you are not the intended recipient, please do not use or disseminate the information, notify the sender and delete it from your system.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150430/28f4215c/attachment.html>

From shettyg at nicira.com  Thu Apr 30 09:10:49 2015
From: shettyg at nicira.com (Gurucharan Shetty)
Date: Thu, 30 Apr 2015 09:10:49 -0700
Subject: [ovs-discuss] configure qos using patch ports
In-Reply-To: <CA+9-LvtncdjK7ALjLV28jm4-FJ2w_8oDT+o_GRMjnt86a83Y_A@mail.gmail.com>
References: <CA+9-LvugQ+0EwjYO9ncy7_iA7cqwTCCfYYKUWPzPy7Xcdem4Hw@mail.gmail.com>
 <CAHbON5qtpmFLkrXJegzY5VyZ61nfgP2HqCOwb0DJZw8ZpQAN0w@mail.gmail.com>
 <CA+9-LvtcbEEgWvHQPb+qsd7BGU-9xiBegEPLZVQhex89kyGVPw@mail.gmail.com>
 <CAHbON5oLFzuCVoNdr1kJi0iaZfS6t4QZ6jn7hXXiOkucU3i_hw@mail.gmail.com>
 <CA+9-LvtncdjK7ALjLV28jm4-FJ2w_8oDT+o_GRMjnt86a83Y_A@mail.gmail.com>
Message-ID: <CAHbON5q+40+YsBVoa1ACdHs+Xs1M1sbikz8_Fzj9+k_NjcQp-w@mail.gmail.com>

There was a large discussion on QoS in this mailing in the last couple
of months. If you read it, you will likely get hints on how to debug.

On Thu, Apr 30, 2015 at 9:06 AM, abhishek jain <ashujain9727 at gmail.com> wrote:
> I'm able to solve the issue using veth pair instead of patch ports as patch
> port doesnt support qos.

From blp at nicira.com  Thu Apr 30 09:50:44 2015
From: blp at nicira.com (Ben Pfaff)
Date: Thu, 30 Apr 2015 09:50:44 -0700
Subject: [ovs-discuss] CLI session with OpenvSwitch
In-Reply-To: <20FA96CBE1A24D4191A5EABB5763AB0B013243CA@POCITMSEXMB05.LntUniverse.com>
References: <20FA96CBE1A24D4191A5EABB5763AB0B013243CA@POCITMSEXMB05.LntUniverse.com>
Message-ID: <20150430165044.GA30302@nicira.com>

On Thu, Apr 30, 2015 at 04:08:43PM +0000, Abdul Rasheed Shaik wrote:
> I have a requirement like, I would like to configure VLANs, and Show
> the VLAN details from the OpenDayLight controller northbound. For
> this we are planning to write a CLI southbound interface which will
> communicate with the OVS using CLI protocol (ExpectJ java library).
> 
> This our current requirement, now the question is like, Is this is
> possible with openvswitch? (i.e telenet to OVS and issues commands
> from remote locations).

You could do that, but it's better to use OpenFlow and OVSDB.

From ABDUL.RASHEED at LNTTECHSERVICES.COM  Thu Apr 30 10:09:25 2015
From: ABDUL.RASHEED at LNTTECHSERVICES.COM (Abdul Rasheed Shaik)
Date: Thu, 30 Apr 2015 17:09:25 +0000
Subject: [ovs-discuss] CLI session with OpenvSwitch
In-Reply-To: <20150430165044.GA30302@nicira.com>
References: <20FA96CBE1A24D4191A5EABB5763AB0B013243CA@POCITMSEXMB05.LntUniverse.com>,
 <20150430165044.GA30302@nicira.com>
Message-ID: <20FA96CBE1A24D4191A5EABB5763AB0B01324497@POCITMSEXMB05.LntUniverse.com>

Thanks Ben,

Is there telnet/ssh services running in OVS?
Can you please point out some references for telneting to OVS  (which port and IP..etc)?

I know, OVSDB and OpenFlow agents are listening for the connections, but now we need
to exercise with the CLI interface.

Thanks & Regards,
Abdul Rasheed.
________________________________________
From: Ben Pfaff [blp at nicira.com]
Sent: Thursday, April 30, 2015 10:20 PM
To: Abdul Rasheed Shaik
Cc: discuss at openvswitch.org
Subject: Re: [ovs-discuss] CLI session with OpenvSwitch

On Thu, Apr 30, 2015 at 04:08:43PM +0000, Abdul Rasheed Shaik wrote:
> I have a requirement like, I would like to configure VLANs, and Show
> the VLAN details from the OpenDayLight controller northbound. For
> this we are planning to write a CLI southbound interface which will
> communicate with the OVS using CLI protocol (ExpectJ java library).
>
> This our current requirement, now the question is like, Is this is
> possible with openvswitch? (i.e telenet to OVS and issues commands
> from remote locations).

You could do that, but it's better to use OpenFlow and OVSDB.
L&T Technology Services Ltd

www.LntTechservices.com<http://www.lnttechservices.com/>

This Email may contain confidential or privileged information for the intended recipient (s). If you are not the intended recipient, please do not use or disseminate the information, notify the sender and delete it from your system.

From blp at nicira.com  Thu Apr 30 10:22:43 2015
From: blp at nicira.com (Ben Pfaff)
Date: Thu, 30 Apr 2015 10:22:43 -0700
Subject: [ovs-discuss] CLI session with OpenvSwitch
In-Reply-To: <20FA96CBE1A24D4191A5EABB5763AB0B01324497@POCITMSEXMB05.LntUniverse.com>
References: <20FA96CBE1A24D4191A5EABB5763AB0B013243CA@POCITMSEXMB05.LntUniverse.com>
 <20150430165044.GA30302@nicira.com>
 <20FA96CBE1A24D4191A5EABB5763AB0B01324497@POCITMSEXMB05.LntUniverse.com>
Message-ID: <20150430172243.GC30302@nicira.com>

The CLI programs included in Open vSwitch are just interfaces to
OpenFlow and OVSDB, so there's no advantage to interacting with them
indirectly through a CLI.

Open vSwitch itself does not run telnet or SSH.  The system on which
OVS is hosted may run one or both, but that is up to the local system
administrator.

On Thu, Apr 30, 2015 at 05:09:25PM +0000, Abdul Rasheed Shaik wrote:
> Thanks Ben,
> 
> Is there telnet/ssh services running in OVS?
> Can you please point out some references for telneting to OVS  (which port and IP..etc)?
> 
> I know, OVSDB and OpenFlow agents are listening for the connections, but now we need
> to exercise with the CLI interface.
> 
> Thanks & Regards,
> Abdul Rasheed.
> ________________________________________
> From: Ben Pfaff [blp at nicira.com]
> Sent: Thursday, April 30, 2015 10:20 PM
> To: Abdul Rasheed Shaik
> Cc: discuss at openvswitch.org
> Subject: Re: [ovs-discuss] CLI session with OpenvSwitch
> 
> On Thu, Apr 30, 2015 at 04:08:43PM +0000, Abdul Rasheed Shaik wrote:
> > I have a requirement like, I would like to configure VLANs, and Show
> > the VLAN details from the OpenDayLight controller northbound. For
> > this we are planning to write a CLI southbound interface which will
> > communicate with the OVS using CLI protocol (ExpectJ java library).
> >
> > This our current requirement, now the question is like, Is this is
> > possible with openvswitch? (i.e telenet to OVS and issues commands
> > from remote locations).
> 
> You could do that, but it's better to use OpenFlow and OVSDB.
> L&T Technology Services Ltd
> 
> www.LntTechservices.com<http://www.lnttechservices.com/>
> 
> This Email may contain confidential or privileged information for the intended recipient (s). If you are not the intended recipient, please do not use or disseminate the information, notify the sender and delete it from your system.

From wuhao.thu at gmail.com  Thu Apr 30 22:40:07 2015
From: wuhao.thu at gmail.com (Hao Wu)
Date: Thu, 30 Apr 2015 22:40:07 -0700
Subject: [ovs-discuss] What is the relationship between ofproto and
	ofproto_dpif?
Message-ID: <CAHmvmjGQmF4x8_4MEEb7F1K81FGMXE1Z7h4+ofshjp40BJLmTA@mail.gmail.com>

Hi all,

   I am confused about the relationship between struct ofproto and struct
ofproto_dpif. Intuitionally, ofproto_dpif should be the datapath interface
for a certain ofproto switch, but it is not included in the struct ofproto.
On the contrary, in struct ofproto_dpif, there is a ofproto instance, not a
pointer! It seems that it is the datapath interface that contains the
ofproto switch?

Many thanks.

+++++++++++++++++
Best,
Hao
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150430/3c5aa940/attachment.html>

From nghiem.gia.minh at gmail.com  Thu Apr 30 23:51:07 2015
From: nghiem.gia.minh at gmail.com (Minh Nghiem Gia)
Date: Fri, 1 May 2015 15:51:07 +0900
Subject: [ovs-discuss] why ovs it does not ask the controller
Message-ID: <CAAsS9QRK7crv=y75S0n5DAHG+RDpnUn7+x9w-dc=4WUJox2H5g@mail.gmail.com>

Hi openvswitch developers,

I have a simple question, however I could not find any way to answer is
"why ovs has no rules, it does not ask the controller". In theory, when a
new packet comes, if there is no matching found, the switch will ask the
controller for actions. In fact, I can see the Packet_in message if I use
mininet to connect to a controller on a different PC.
What I did is I installed both controller and OVS on the same PC which has
multiple network interfaces act as ports of OVS. Then I deleted all flow
rules on the switch (sudo ovs-ofctl del-flows br0) and executed a ping from
that PC to the gateway. I think the switch must ask the controller, but
there is no OF messages!

Please advice,
Thanks,
Minh.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150501/1a1ca0b4/attachment.html>

From ashujain9727 at gmail.com  Thu Apr 30 09:06:28 2015
From: ashujain9727 at gmail.com (abhishek jain)
Date: Thu, 30 Apr 2015 21:36:28 +0530
Subject: [ovs-discuss] configure qos using patch ports
In-Reply-To: <CAHbON5oLFzuCVoNdr1kJi0iaZfS6t4QZ6jn7hXXiOkucU3i_hw@mail.gmail.com>
References: <CA+9-LvugQ+0EwjYO9ncy7_iA7cqwTCCfYYKUWPzPy7Xcdem4Hw@mail.gmail.com>
 <CAHbON5qtpmFLkrXJegzY5VyZ61nfgP2HqCOwb0DJZw8ZpQAN0w@mail.gmail.com>
 <CA+9-LvtcbEEgWvHQPb+qsd7BGU-9xiBegEPLZVQhex89kyGVPw@mail.gmail.com>
 <CAHbON5oLFzuCVoNdr1kJi0iaZfS6t4QZ6jn7hXXiOkucU3i_hw@mail.gmail.com>
Message-ID: <CA+9-LvtncdjK7ALjLV28jm4-FJ2w_8oDT+o_GRMjnt86a83Y_A@mail.gmail.com>

I'm able to solve the issue using veth pair instead of patch ports as patch
port doesnt support qos.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150430/c782657a/attachment.html>

From vkg.2006 at gmail.com  Thu Apr 30 23:37:58 2015
From: vkg.2006 at gmail.com (Vipin Garg)
Date: Thu, 30 Apr 2015 23:37:58 -0700
Subject: [ovs-discuss] OVS connection with OpenDayLight via
	OF-CONFIG/OpenFlow
Message-ID: <CAKv4ra8_daOPqebD9JbH5nSNb8xGMb3_Jkguin9EGS_kZOXu1w@mail.gmail.com>

Hello,



I have downloaded OpenvSwitch-2.3.1, Cross Compiled it for PowerPC platform
[Linux 3-8.13] .  I have downloaded the executables and running  following
executable –



1461      0       0       S       ./ovsdb-server --verbose
--remote=punix:/usr/local/var/run/openvswitch/db.sock
--remote=db:Open_vSwitch,Open_vSwitch,manager_options --pidfile --detach

1512      0       0       S       ./ovs-vswitchd --verbose --pidfile –detach



Now, I am trying to  establish the Channel between the switch and
 OpenDayLight [distribution-karaf-0.2.3-Helium-SR3 ] so that I can manage
my switch via Daylight. I have following questions –



1.       In my switch, I do have any bridge interface (in linux kernel on
physical switch ). So, is there a way to setup  controller IP address
without bridge.CLI --  ovs-vsctl set-controller BRIDGE TARGET  -- requires
BRIDGE as one of the parameter.

Is there a workaround for this ?



2.       What is  CLI -- ovs-vsctl set-manager --  command for ?  Which
this CLI (with my controller IP set-manager tcp:192.168.222.100:6640 ), I
can see my switch on OpenDayLight  under ‘Connection Manager’ tab. What is
this for and it this channel also use OpenFlow/OF-CONFIG protocol ?



Basically, what I want is to program my physical-switch from DayLight using
OF-CONFIG. I am not too much interested in OpenFlow & related flow tables
at the moment. Please guide me…



Thanks

Vipin Garg
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://openvswitch.org/pipermail/discuss/attachments/20150430/f44eb1cb/attachment.html>

